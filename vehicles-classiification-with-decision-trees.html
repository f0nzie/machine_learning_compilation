<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 25 Vehicles classiification with Decision Trees | A Machine Learning Compilation</title>
<meta name="author" content="Several authors. Compiled by Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Machine Learning Compilation</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li class="book-part">The Basics of Machine Learning</li>
<li><a class="" href="introduction-to-pca.html"><span class="header-section-number">2</span> Introduction to PCA</a></li>
<li><a class="" href="comparison-of-two-pca-packages.html"><span class="header-section-number">3</span> Comparison of two PCA packages</a></li>
<li><a class="" href="detailed-study-of-principal-component-analysis.html"><span class="header-section-number">4</span> Detailed study of Principal Component Analysis</a></li>
<li><a class="" href="detection-of-diabetes-using-logistic-regression.html"><span class="header-section-number">5</span> Detection of diabetes using Logistic Regression</a></li>
<li><a class="" href="sensitivity-analysis-for-a-neural-network.html"><span class="header-section-number">6</span> Sensitivity analysis for a neural network</a></li>
<li><a class="" href="data-visualization-for-ml-models.html"><span class="header-section-number">7</span> Data Visualization for ML models</a></li>
<li class="book-part">Feature Engineering</li>
<li><a class="" href="ten-methods-to-assess-variable-importance.html"><span class="header-section-number">8</span> Ten methods to assess Variable Importance</a></li>
<li><a class="" href="employee-attrition-using-feature-importance.html"><span class="header-section-number">9</span> Employee Attrition using Feature Importance</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="a-gentle-introduction-to-support-vector-machines.html"><span class="header-section-number">10</span> A gentle introduction to Support Vector Machines</a></li>
<li><a class="" href="broad-view-of-svm.html"><span class="header-section-number">11</span> Broad view of SVM</a></li>
<li><a class="" href="feature-selection-to-enhance-cancer-detection.html"><span class="header-section-number">12</span> Feature Selection to enhance cancer detection</a></li>
<li><a class="" href="dealing-with-unbalanced-data.html"><span class="header-section-number">13</span> Dealing with unbalanced data</a></li>
<li><a class="" href="imputting-missing-values-with-random-forest.html"><span class="header-section-number">14</span> Imputting missing values with Random Forest</a></li>
<li><a class="" href="tuning-of-support-vector-machine-prediction.html"><span class="header-section-number">15</span> Tuning of Support Vector Machine prediction</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="introduction-to-algorithms-for-classification.html"><span class="header-section-number">16</span> Introduction to algorithms for Classification</a></li>
<li><a class="" href="comparing-classification-algorithms.html"><span class="header-section-number">17</span> Comparing Classification algorithms</a></li>
<li><a class="" href="who-buys-social-network-ads.html"><span class="header-section-number">18</span> Who buys Social Network ads</a></li>
<li><a class="" href="predicting-ozone-levels.html"><span class="header-section-number">19</span> Predicting Ozone levels</a></li>
<li><a class="" href="building-a-naive-bayes-classifier.html"><span class="header-section-number">20</span> Building a Naive Bayes Classifier</a></li>
<li><a class="" href="linear-and-non-linear-algorithms-for-classification.html"><span class="header-section-number">21</span> Linear and Non-Linear Algorithms for Classification</a></li>
<li><a class="" href="detect-mines-vs-rocks-with-random-forest.html"><span class="header-section-number">22</span> Detect mines vs rocks with Random Forest</a></li>
<li><a class="" href="predicting-the-type-of-glass.html"><span class="header-section-number">23</span> Predicting the type of glass</a></li>
<li><a class="" href="naive-bayes-for-sms-spam.html"><span class="header-section-number">24</span> Naive Bayes for SMS spam</a></li>
<li><a class="active" href="vehicles-classiification-with-decision-trees.html"><span class="header-section-number">25</span> Vehicles classiification with Decision Trees</a></li>
<li><a class="" href="applying-naive-bayes-on-the-titanic-case.html"><span class="header-section-number">26</span> Applying Naive-Bayes on the Titanic case</a></li>
<li><a class="" href="classification-on-bad-loans.html"><span class="header-section-number">27</span> Classification on bad loans</a></li>
<li><a class="" href="predicting-flu-outcome-comparing-eight-classification-algorithms.html"><span class="header-section-number">28</span> Predicting Flu outcome comparing eight classification algorithms</a></li>
<li><a class="" href="a-detailed-study-of-bike-sharing-demand.html"><span class="header-section-number">29</span> A detailed study of bike sharing demand</a></li>
<li><a class="" href="prediction-of-arrhythmia-with-deep-neural-nets.html"><span class="header-section-number">30</span> Prediction of arrhythmia with deep neural nets</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression-with-islr.html"><span class="header-section-number">31</span> Linear Regression with ISLR</a></li>
<li><a class="" href="evaluation-of-three-linear-regression-models.html"><span class="header-section-number">32</span> Evaluation of three linear regression models</a></li>
<li><a class="" href="comparison-of-six-linear-regression-algorithms.html"><span class="header-section-number">33</span> Comparison of six Linear Regression algorithms</a></li>
<li><a class="" href="comparing-regression-models.html"><span class="header-section-number">34</span> Comparing regression models</a></li>
<li><a class="" href="finding-the-factors-of-happiness.html"><span class="header-section-number">35</span> Finding the factors of happiness</a></li>
<li><a class="" href="regression-with-a-neural-network.html"><span class="header-section-number">36</span> Regression with a neural network</a></li>
<li><a class="" href="comparing-multiple-regression-vs-a-neural-network.html"><span class="header-section-number">37</span> Comparing Multiple Regression vs a Neural Network</a></li>
<li><a class="" href="temperature-modeling-using-nested-dataframes.html"><span class="header-section-number">38</span> Temperature modeling using nested dataframes</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="credit-scoring-with-neuralnet.html"><span class="header-section-number">39</span> Credit Scoring with neuralnet</a></li>
<li><a class="" href="wine-classification-with-neuralnet.html"><span class="header-section-number">40</span> Wine classification with neuralnet</a></li>
<li><a class="" href="predicting-the-rating-of-cereals.html"><span class="header-section-number">41</span> Predicting the rating of cereals</a></li>
<li><a class="" href="fitting-a-linear-model-with-neural-networks.html"><span class="header-section-number">42</span> Fitting a linear model with neural networks</a></li>
<li><a class="" href="visualization-of-neural-networks.html"><span class="header-section-number">43</span> Visualization of neural networks</a></li>
<li><a class="" href="build-a-fully-connected-r-neural-network-from-scratch.html"><span class="header-section-number">44</span> Build a fully connected R neural network from scratch</a></li>
<li><a class="" href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">45</span> Tuning Hyperparameters in a Neural Network</a></li>
<li><a class="" href="deep-learning-tips-for-classification-and-regression.html"><span class="header-section-number">46</span> Deep Learning tips for Classification and Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></li>
<li><a class="" href="q-q-normal-to-compare-data-to-distributions.html"><span class="header-section-number">B</span> Q-Q normal to compare data to distributions</a></li>
<li><a class="" href="qq-and-pp-plots.html"><span class="header-section-number">C</span> QQ and PP Plots</a></li>
<li><a class="" href="visualizing-residuals.html"><span class="header-section-number">D</span> Visualizing residuals</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/f0nzie/machine_learning_compilation">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="vehicles-classiification-with-decision-trees" class="section level1">
<h1>
<span class="header-section-number">25</span> Vehicles classiification with Decision Trees<a class="anchor" aria-label="anchor" href="#vehicles-classiification-with-decision-trees"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li>Datasets: Vehicle (mlbench)</li>
<li>Algorithms:
<ul>
<li>Decision Trees</li>
</ul>
</li>
<li>Instructions: book “Applied Predictive Modeling Techniques”, Lewis, N.D.</li>
</ul>
<div id="load-packages-1" class="section level2">
<h2>
<span class="header-section-number">25.1</span> Load packages<a class="anchor" aria-label="anchor" href="#load-packages-1"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb552"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mlbench</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Vehicle</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">Vehicle</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    846 obs. of  19 variables:</span>
<span class="co">#&gt;  $ Comp        : num  95 91 104 93 85 107 97 90 86 93 ...</span>
<span class="co">#&gt;  $ Circ        : num  48 41 50 41 44 57 43 43 34 44 ...</span>
<span class="co">#&gt;  $ D.Circ      : num  83 84 106 82 70 106 73 66 62 98 ...</span>
<span class="co">#&gt;  $ Rad.Ra      : num  178 141 209 159 205 172 173 157 140 197 ...</span>
<span class="co">#&gt;  $ Pr.Axis.Ra  : num  72 57 66 63 103 50 65 65 61 62 ...</span>
<span class="co">#&gt;  $ Max.L.Ra    : num  10 9 10 9 52 6 6 9 7 11 ...</span>
<span class="co">#&gt;  $ Scat.Ra     : num  162 149 207 144 149 255 153 137 122 183 ...</span>
<span class="co">#&gt;  $ Elong       : num  42 45 32 46 45 26 42 48 54 36 ...</span>
<span class="co">#&gt;  $ Pr.Axis.Rect: num  20 19 23 19 19 28 19 18 17 22 ...</span>
<span class="co">#&gt;  $ Max.L.Rect  : num  159 143 158 143 144 169 143 146 127 146 ...</span>
<span class="co">#&gt;  $ Sc.Var.Maxis: num  176 170 223 160 241 280 176 162 141 202 ...</span>
<span class="co">#&gt;  $ Sc.Var.maxis: num  379 330 635 309 325 957 361 281 223 505 ...</span>
<span class="co">#&gt;  $ Ra.Gyr      : num  184 158 220 127 188 264 172 164 112 152 ...</span>
<span class="co">#&gt;  $ Skew.Maxis  : num  70 72 73 63 127 85 66 67 64 64 ...</span>
<span class="co">#&gt;  $ Skew.maxis  : num  6 9 14 6 9 5 13 3 2 4 ...</span>
<span class="co">#&gt;  $ Kurt.maxis  : num  16 14 9 10 11 9 1 3 14 14 ...</span>
<span class="co">#&gt;  $ Kurt.Maxis  : num  187 189 188 199 180 181 200 193 200 195 ...</span>
<span class="co">#&gt;  $ Holl.Ra     : num  197 199 196 207 183 183 204 202 208 204 ...</span>
<span class="co">#&gt;  $ Class       : Factor w/ 4 levels "bus","opel","saab",..: 4 4 3 4 1 1 1 4 4 3 ...</span></code></pre></div>
<div class="sourceCode" id="cb553"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Vehicle</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       Comp      </span>
<span class="co">#&gt;  Min.   : 73.0  </span>
<span class="co">#&gt;  1st Qu.: 87.0  </span>
<span class="co">#&gt;  Median : 93.0  </span>
<span class="co">#&gt;  Mean   : 93.7  </span>
<span class="co">#&gt;  3rd Qu.:100.0  </span>
<span class="co">#&gt;  Max.   :119.0</span></code></pre></div>
<div class="sourceCode" id="cb554"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Vehicle</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;       Circ     </span>
<span class="co">#&gt;  Min.   :33.0  </span>
<span class="co">#&gt;  1st Qu.:40.0  </span>
<span class="co">#&gt;  Median :44.0  </span>
<span class="co">#&gt;  Mean   :44.9  </span>
<span class="co">#&gt;  3rd Qu.:49.0  </span>
<span class="co">#&gt;  Max.   :59.0</span></code></pre></div>
<div class="sourceCode" id="cb555"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">Vehicle</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span>
<span class="co">#&gt; $levels</span>
<span class="co">#&gt; [1] "bus"  "opel" "saab" "van" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "factor"</span></code></pre></div>
</div>
<div id="prepare-data" class="section level2">
<h2>
<span class="header-section-number">25.2</span> Prepare data<a class="anchor" aria-label="anchor" href="#prepare-data"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb556"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">107</span><span class="op">)</span>
<span class="va">N</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Vehicle</span><span class="op">)</span>
<span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, <span class="fl">500</span>, <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb557"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># training and test sets</span>
<span class="va">trainset</span> <span class="op">&lt;-</span> <span class="va">Vehicle</span><span class="op">[</span><span class="va">train</span>,<span class="op">]</span>
<span class="va">testset</span>  <span class="op">&lt;-</span> <span class="va">Vehicle</span><span class="op">[</span><span class="op">-</span><span class="va">train</span>,<span class="op">]</span></code></pre></div>
</div>
<div id="estimate-the-decision-tree" class="section level2">
<h2>
<span class="header-section-number">25.3</span> Estimate the decision tree<a class="anchor" aria-label="anchor" href="#estimate-the-decision-tree"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb558"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tree/man/tree.html">tree</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">trainset</span>, split <span class="op">=</span> <span class="st">"deviance"</span><span class="op">)</span>
<span class="va">fit</span>
<span class="co">#&gt; node), split, n, deviance, yval, (yprob)</span>
<span class="co">#&gt;       * denotes terminal node</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   1) root 500 1000 opel ( 0 0 0 0 )  </span>
<span class="co">#&gt;     2) Elong &lt; 41.5 215  500 saab ( 0 0 0 0 )  </span>
<span class="co">#&gt;       4) Max.L.Ra &lt; 7.5 51   50 bus ( 1 0 0 0 )  </span>
<span class="co">#&gt;         8) Comp &lt; 93.5 12   20 bus ( 0 0 0 0 )  </span>
<span class="co">#&gt;          16) Pr.Axis.Ra &lt; 67.5 7    8 saab ( 0 0 1 0 ) *</span>
<span class="co">#&gt;          17) Pr.Axis.Ra &gt; 67.5 5    0 bus ( 1 0 0 0 ) *</span>
<span class="co">#&gt;         9) Comp &gt; 93.5 39    9 bus ( 1 0 0 0 ) *</span>
<span class="co">#&gt;       5) Max.L.Ra &gt; 7.5 164  200 opel ( 0 1 0 0 )  </span>
<span class="co">#&gt;        10) Sc.Var.maxis &lt; 723 149  200 saab ( 0 0 1 0 )  </span>
<span class="co">#&gt;          20) Comp &lt; 109.5 137  200 opel ( 0 1 0 0 ) *</span>
<span class="co">#&gt;          21) Comp &gt; 109.5 12    0 saab ( 0 0 1 0 ) *</span>
<span class="co">#&gt;        11) Sc.Var.maxis &gt; 723 15    7 opel ( 0 1 0 0 ) *</span>
<span class="co">#&gt;     3) Elong &gt; 41.5 285  700 van ( 0 0 0 0 )  </span>
<span class="co">#&gt;       6) Sc.Var.maxis &lt; 305.5 116  200 van ( 0 0 0 1 )  </span>
<span class="co">#&gt;        12) Max.L.Rect &lt; 128.5 40   90 saab ( 0 0 0 0 )  </span>
<span class="co">#&gt;          24) Scat.Ra &lt; 120.5 15   30 van ( 0 0 0 1 ) *</span>
<span class="co">#&gt;          25) Scat.Ra &gt; 120.5 25   30 saab ( 0 0 1 0 ) *</span>
<span class="co">#&gt;        13) Max.L.Rect &gt; 128.5 76   90 van ( 0 0 0 1 )  </span>
<span class="co">#&gt;          26) Max.L.Rect &lt; 138.5 38   60 van ( 0 0 0 1 )  </span>
<span class="co">#&gt;            52) Circ &lt; 37.5 17   10 van ( 0 0 0 1 ) *</span>
<span class="co">#&gt;            53) Circ &gt; 37.5 21   40 opel ( 0 0 0 0 ) *</span>
<span class="co">#&gt;          27) Max.L.Rect &gt; 138.5 38   20 van ( 0 0 0 1 ) *</span>
<span class="co">#&gt;       7) Sc.Var.maxis &gt; 305.5 169  400 bus ( 0 0 0 0 )  </span>
<span class="co">#&gt;        14) Max.L.Ra &lt; 8.5 116  200 bus ( 1 0 0 0 )  </span>
<span class="co">#&gt;          28) D.Circ &lt; 76.5 97  100 bus ( 1 0 0 0 )  </span>
<span class="co">#&gt;            56) Skew.maxis &lt; 10.5 87   70 bus ( 1 0 0 0 )  </span>
<span class="co">#&gt;             112) Max.L.Rect &lt; 134.5 12   20 bus ( 0 0 0 0 ) *</span>
<span class="co">#&gt;             113) Max.L.Rect &gt; 134.5 75   20 bus ( 1 0 0 0 ) *</span>
<span class="co">#&gt;            57) Skew.maxis &gt; 10.5 10   20 opel ( 0 0 0 0 ) *</span>
<span class="co">#&gt;          29) D.Circ &gt; 76.5 19   30 opel ( 0 1 0 0 ) *</span>
<span class="co">#&gt;        15) Max.L.Ra &gt; 8.5 53   20 van ( 0 0 0 1 ) *</span></code></pre></div>
<div class="sourceCode" id="cb559"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fit &lt;- tree(Class ~., data = Vehicle[train,], split ="deviance")</span>
<span class="co"># fit</span></code></pre></div>
<blockquote>
<p>We use deviance as the splitting criteria, a common alternative is to use
split=“gini”.</p>
</blockquote>
<blockquote>
<p>At each branch of the tree (after root) we see in order:
1. The branch number (e.g. in this case 1,2,14 and 15);
2. the split (e.g. Elong &lt; 41.5);
3. the number of samples going along that split (e.g. 229);
4. the deviance associated with that split (e.g. 489.1);
5. the predicted class (e.g. opel);
6. the associated probabilities (e.g. ( 0.222707 0.410480 0.366812 0.000000
);
7. and for a terminal node (or leaf), the symbol "*".</p>
</blockquote>
<div class="sourceCode" id="cb560"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Classification tree:</span>
<span class="co">#&gt; tree(formula = Class ~ ., data = trainset, split = "deviance")</span>
<span class="co">#&gt; Variables actually used in tree construction:</span>
<span class="co">#&gt;  [1] "Elong"        "Max.L.Ra"     "Comp"         "Pr.Axis.Ra"   "Sc.Var.maxis"</span>
<span class="co">#&gt;  [6] "Max.L.Rect"   "Scat.Ra"      "Circ"         "D.Circ"       "Skew.maxis"  </span>
<span class="co">#&gt; Number of terminal nodes:  16 </span>
<span class="co">#&gt; Residual mean deviance:  0.943 = 456 / 484 </span>
<span class="co">#&gt; Misclassification error rate: 0.252 = 126 / 500</span></code></pre></div>
<blockquote>
<p>Notice that summary(fit) shows:
1. The type of tree, in this case a Classification tree;
2. the formula used to fit the tree;
3. the variables used to fit the tree;
4. the number of terminal nodes in this case 15;
5. the residual mean deviance - 0.9381;
6. the misclassification error rate 0.232 or 23.2%.</p>
</blockquote>
<div class="sourceCode" id="cb561"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="302-classification_226-vehicle-mlbench-tree_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="assess-model" class="section level2">
<h2>
<span class="header-section-number">25.4</span> Assess model<a class="anchor" aria-label="anchor" href="#assess-model"><i class="fas fa-link"></i></a>
</h2>
<p>Unfortunately, classification trees have a tendency to overfit the data. One
approach to reduce this risk is to use cross-validation. For each hold out
sample we fit the model and note at what level the tree gives the best results
(using deviance or the misclassification rate). Then we hold out a different
sample and repeat. This can be carried out using the <code><a href="https://rdrr.io/pkg/tree/man/cv.tree.html">cv.tree()</a></code> function.
We use a leave-one-out cross-validation using the misclassification rate and
deviance (<code>FUN=prune.misclass</code>, followed by <code>FUN=prune.tree</code>).</p>
<div class="sourceCode" id="cb562"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fitM.cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tree/man/cv.tree.html">cv.tree</a></span><span class="op">(</span><span class="va">fit</span>, K<span class="op">=</span><span class="fl">346</span>, FUN <span class="op">=</span> <span class="va">prune.misclass</span><span class="op">)</span>
<span class="va">fitP.cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tree/man/cv.tree.html">cv.tree</a></span><span class="op">(</span><span class="va">fit</span>, K<span class="op">=</span><span class="fl">346</span>, FUN <span class="op">=</span> <span class="va">prune.tree</span><span class="op">)</span></code></pre></div>
<p>The results are plotted out side by side in Figure 1.2. The jagged lines
shows where the minimum deviance / misclassification occurred with the
cross-validated tree. Since the cross validated misclassification and deviance
both reach their minimum close to the number of branches in the original
fitted tree there is little to be gained from pruning this tree</p>
<div class="sourceCode" id="cb563"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">fitM.cv</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">fitP.cv</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="302-classification_226-vehicle-mlbench-tree_files/figure-html/plot-fit-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="make-predictions-1" class="section level2">
<h2>
<span class="header-section-number">25.5</span> Make predictions<a class="anchor" aria-label="anchor" href="#make-predictions-1"><i class="fas fa-link"></i></a>
</h2>
<p>We use the validation data set and the fitted decision tree to predict vehicle
classes; then we display the confusion matrix and calculate the error rate of
the fitted tree. Overall, the model has an error rate of 32%.</p>
<div class="sourceCode" id="cb564"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">testLabels</span> <span class="op">&lt;-</span> <span class="va">Vehicle</span><span class="op">$</span><span class="va">Class</span><span class="op">[</span><span class="op">-</span><span class="va">train</span><span class="op">]</span>
<span class="va">testLabels</span>
<span class="co">#&gt;   [1] van  bus  bus  van  van  bus  bus  saab opel bus  van  saab van  saab saab</span>
<span class="co">#&gt;  [16] van  saab opel van  saab saab saab bus  bus  saab opel bus  opel bus  opel</span>
<span class="co">#&gt;  [31] van  opel opel saab saab bus  bus  bus  van  van  saab opel bus  opel van </span>
<span class="co">#&gt;  [46] opel saab bus  van  bus  opel van  saab bus  opel bus  opel opel van  bus </span>
<span class="co">#&gt;  [61] van  saab opel bus  van  saab opel opel saab saab saab opel bus  van  bus </span>
<span class="co">#&gt;  [76] opel bus  saab bus  bus  bus  opel opel van  saab bus  bus  bus  van  saab</span>
<span class="co">#&gt;  [91] opel van  van  bus  bus  opel bus  opel saab opel bus  opel bus  saab van </span>
<span class="co">#&gt; [106] van  saab saab bus  van  opel van  saab opel saab saab van  van  van  van </span>
<span class="co">#&gt; [121] bus  bus  opel bus  bus  van  saab bus  opel bus  bus  bus  bus  opel van </span>
<span class="co">#&gt; [136] saab saab bus  opel van  bus  saab bus  van  bus  opel van  saab opel saab</span>
<span class="co">#&gt; [151] opel van  saab van  saab opel bus  van  bus  saab saab opel opel bus  bus </span>
<span class="co">#&gt; [166] opel van  van  bus  van  van  saab bus  saab opel saab opel bus  bus  bus </span>
<span class="co">#&gt; [181] saab bus  opel opel saab saab saab van  van  opel opel van  van  opel bus </span>
<span class="co">#&gt; [196] saab bus  van  opel opel bus  bus  bus  opel saab opel van  bus  opel opel</span>
<span class="co">#&gt; [211] saab opel bus  opel opel opel van  opel van  saab saab van  saab saab saab</span>
<span class="co">#&gt; [226] saab van  van  van  saab bus  van  van  bus  saab opel saab saab opel saab</span>
<span class="co">#&gt; [241] saab saab saab van  saab opel bus  saab bus  opel opel opel saab bus  van </span>
<span class="co">#&gt; [256] opel saab opel bus  bus  saab van  opel bus  saab van  opel saab saab saab</span>
<span class="co">#&gt; [271] saab van  opel bus  bus  bus  opel saab saab saab van  saab bus  opel saab</span>
<span class="co">#&gt; [286] van  opel bus  saab saab opel opel van  saab bus  opel bus  van  van  opel</span>
<span class="co">#&gt; [301] bus  bus  saab bus  van  saab bus  van  saab van  opel bus  bus  opel saab</span>
<span class="co">#&gt; [316] opel bus  bus  saab van  saab saab bus  opel opel opel bus  saab bus  van </span>
<span class="co">#&gt; [331] bus  van  saab opel saab van  opel opel van  bus  saab saab van  saab opel</span>
<span class="co">#&gt; [346] saab</span>
<span class="co">#&gt; Levels: bus opel saab van</span></code></pre></div>
<div class="sourceCode" id="cb565"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Confusion Matrix</span>
<span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">testset</span><span class="op">)</span>
<span class="co"># find column whih has the maximum of all rows </span>
<span class="va">pred.class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/colnames.html">colnames</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/maxCol.html">max.col</a></span><span class="op">(</span><span class="va">pred</span>, ties.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"random"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="va">cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">testLabels</span>, <span class="va">pred.class</span>, 
      dnn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Observed Class"</span>, <span class="st">"Predicted Class"</span><span class="op">)</span><span class="op">)</span>
<span class="va">cm</span>
<span class="co">#&gt;               Predicted Class</span>
<span class="co">#&gt; Observed Class bus opel saab van</span>
<span class="co">#&gt;           bus   85    1    1   5</span>
<span class="co">#&gt;           opel   3   70   10   2</span>
<span class="co">#&gt;           saab   7   67   14   7</span>
<span class="co">#&gt;           van    1    4    5  64</span></code></pre></div>
<div class="sourceCode" id="cb566"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sensitivity</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">cm</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cm</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.673</span></code></pre></div>
<div class="sourceCode" id="cb567"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># pred &lt;- predict(fit, newdata = Vehicle[-train,])</span>
<span class="co"># pred.class &lt;- colnames(pred)[max.col(pred, ties.method = c("random"))]</span>
<span class="co"># table(Vehicle$Class[-train], pred.class, </span>
<span class="co">#       dnn = c("Observed Class", "Predicted Class"))</span></code></pre></div>
<div class="sourceCode" id="cb568"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">error_rate</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pred.class</span> <span class="op">==</span> <span class="va">testset</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">testset</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.round.html">round</a></span><span class="op">(</span><span class="va">error_rate</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.327</span></code></pre></div>
<div class="sourceCode" id="cb569"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># error_rate = (1 - sum(pred.class == Vehicle$Class[-train])/346)</span>
<span class="co"># round(error_rate,3)</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="naive-bayes-for-sms-spam.html"><span class="header-section-number">24</span> Naive Bayes for SMS spam</a></div>
<div class="next"><a href="applying-naive-bayes-on-the-titanic-case.html"><span class="header-section-number">26</span> Applying Naive-Bayes on the Titanic case</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#vehicles-classiification-with-decision-trees"><span class="header-section-number">25</span> Vehicles classiification with Decision Trees</a></li>
<li><a class="nav-link" href="#load-packages-1"><span class="header-section-number">25.1</span> Load packages</a></li>
<li><a class="nav-link" href="#prepare-data"><span class="header-section-number">25.2</span> Prepare data</a></li>
<li><a class="nav-link" href="#estimate-the-decision-tree"><span class="header-section-number">25.3</span> Estimate the decision tree</a></li>
<li><a class="nav-link" href="#assess-model"><span class="header-section-number">25.4</span> Assess model</a></li>
<li><a class="nav-link" href="#make-predictions-1"><span class="header-section-number">25.5</span> Make predictions</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/f0nzie/machine_learning_compilation/blob/master/302-classification_226-vehicle-mlbench-tree.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/f0nzie/machine_learning_compilation/edit/master/302-classification_226-vehicle-mlbench-tree.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Machine Learning Compilation</strong>" was written by Several authors. Compiled by Alfonso R. Reyes. It was last built on 2020-11-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
