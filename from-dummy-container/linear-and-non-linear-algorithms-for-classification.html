<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 21 Linear and Non-Linear Algorithms for Classification | A Machine Learning Compilation</title>
<meta name="author" content="Several authors. Compiled by Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Machine Learning Compilation</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li class="book-part">The Basics of Machine Learning</li>
<li><a class="" href="introduction-to-pca.html"><span class="header-section-number">2</span> Introduction to PCA</a></li>
<li><a class="" href="comparison-of-two-pca-packages.html"><span class="header-section-number">3</span> Comparison of two PCA packages</a></li>
<li><a class="" href="detailed-study-of-principal-component-analysis.html"><span class="header-section-number">4</span> Detailed study of Principal Component Analysis</a></li>
<li><a class="" href="detection-of-diabetes-using-logistic-regression.html"><span class="header-section-number">5</span> Detection of diabetes using Logistic Regression</a></li>
<li><a class="" href="sensitivity-analysis-for-a-neural-network.html"><span class="header-section-number">6</span> Sensitivity analysis for a neural network</a></li>
<li><a class="" href="data-visualization-for-ml-models.html"><span class="header-section-number">7</span> Data Visualization for ML models</a></li>
<li class="book-part">Feature Engineering</li>
<li><a class="" href="ten-methods-to-assess-variable-importance.html"><span class="header-section-number">8</span> Ten methods to assess Variable Importance</a></li>
<li><a class="" href="employee-attrition-using-feature-importance.html"><span class="header-section-number">9</span> Employee Attrition using Feature Importance</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="a-gentle-introduction-to-support-vector-machines.html"><span class="header-section-number">10</span> A gentle introduction to Support Vector Machines</a></li>
<li><a class="" href="broad-view-of-svm.html"><span class="header-section-number">11</span> Broad view of SVM</a></li>
<li><a class="" href="feature-selection-to-enhance-cancer-detection.html"><span class="header-section-number">12</span> Feature Selection to enhance cancer detection</a></li>
<li><a class="" href="dealing-with-unbalanced-data.html"><span class="header-section-number">13</span> Dealing with unbalanced data</a></li>
<li><a class="" href="imputting-missing-values-with-random-forest.html"><span class="header-section-number">14</span> Imputting missing values with Random Forest</a></li>
<li><a class="" href="tuning-of-support-vector-machine-prediction.html"><span class="header-section-number">15</span> Tuning of Support Vector Machine prediction</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="introduction-to-algorithms-for-classification.html"><span class="header-section-number">16</span> Introduction to algorithms for Classification</a></li>
<li><a class="" href="comparing-classification-algorithms.html"><span class="header-section-number">17</span> Comparing Classification algorithms</a></li>
<li><a class="" href="who-buys-social-network-ads.html"><span class="header-section-number">18</span> Who buys Social Network ads</a></li>
<li><a class="" href="predicting-ozone-levels.html"><span class="header-section-number">19</span> Predicting Ozone levels</a></li>
<li><a class="" href="building-a-naive-bayes-classifier.html"><span class="header-section-number">20</span> Building a Naive Bayes Classifier</a></li>
<li><a class="active" href="linear-and-non-linear-algorithms-for-classification.html"><span class="header-section-number">21</span> Linear and Non-Linear Algorithms for Classification</a></li>
<li><a class="" href="detect-mines-vs-rocks-with-random-forest.html"><span class="header-section-number">22</span> Detect mines vs rocks with Random Forest</a></li>
<li><a class="" href="predicting-the-type-of-glass.html"><span class="header-section-number">23</span> Predicting the type of glass</a></li>
<li><a class="" href="naive-bayes-for-sms-spam.html"><span class="header-section-number">24</span> Naive Bayes for SMS spam</a></li>
<li><a class="" href="vehicles-classiification-with-decision-trees.html"><span class="header-section-number">25</span> Vehicles classiification with Decision Trees</a></li>
<li><a class="" href="applying-naive-bayes-on-the-titanic-case.html"><span class="header-section-number">26</span> Applying Naive-Bayes on the Titanic case</a></li>
<li><a class="" href="classification-on-bad-loans.html"><span class="header-section-number">27</span> Classification on bad loans</a></li>
<li><a class="" href="predicting-flu-outcome-comparing-eight-classification-algorithms.html"><span class="header-section-number">28</span> Predicting Flu outcome comparing eight classification algorithms</a></li>
<li><a class="" href="a-detailed-study-of-bike-sharing-demand.html"><span class="header-section-number">29</span> A detailed study of bike sharing demand</a></li>
<li><a class="" href="prediction-of-arrhythmia-with-deep-neural-nets.html"><span class="header-section-number">30</span> Prediction of arrhythmia with deep neural nets</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression-with-islr.html"><span class="header-section-number">31</span> Linear Regression with ISLR</a></li>
<li><a class="" href="evaluation-of-three-linear-regression-models.html"><span class="header-section-number">32</span> Evaluation of three linear regression models</a></li>
<li><a class="" href="comparison-of-six-linear-regression-algorithms.html"><span class="header-section-number">33</span> Comparison of six Linear Regression algorithms</a></li>
<li><a class="" href="comparing-regression-models.html"><span class="header-section-number">34</span> Comparing regression models</a></li>
<li><a class="" href="finding-the-factors-of-happiness.html"><span class="header-section-number">35</span> Finding the factors of happiness</a></li>
<li><a class="" href="regression-with-a-neural-network.html"><span class="header-section-number">36</span> Regression with a neural network</a></li>
<li><a class="" href="comparing-multiple-regression-vs-a-neural-network.html"><span class="header-section-number">37</span> Comparing Multiple Regression vs a Neural Network</a></li>
<li><a class="" href="temperature-modeling-using-nested-dataframes.html"><span class="header-section-number">38</span> Temperature modeling using nested dataframes</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="credit-scoring-with-neuralnet.html"><span class="header-section-number">39</span> Credit Scoring with neuralnet</a></li>
<li><a class="" href="wine-classification-with-neuralnet.html"><span class="header-section-number">40</span> Wine classification with neuralnet</a></li>
<li><a class="" href="predicting-the-rating-of-cereals.html"><span class="header-section-number">41</span> Predicting the rating of cereals</a></li>
<li><a class="" href="fitting-a-linear-model-with-neural-networks.html"><span class="header-section-number">42</span> Fitting a linear model with neural networks</a></li>
<li><a class="" href="visualization-of-neural-networks.html"><span class="header-section-number">43</span> Visualization of neural networks</a></li>
<li><a class="" href="build-a-fully-connected-r-neural-network-from-scratch.html"><span class="header-section-number">44</span> Build a fully connected R neural network from scratch</a></li>
<li><a class="" href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">45</span> Tuning Hyperparameters in a Neural Network</a></li>
<li><a class="" href="deep-learning-tips-for-classification-and-regression.html"><span class="header-section-number">46</span> Deep Learning tips for Classification and Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></li>
<li><a class="" href="q-q-normal-to-compare-data-to-distributions.html"><span class="header-section-number">B</span> Q-Q normal to compare data to distributions</a></li>
<li><a class="" href="qq-and-pp-plots.html"><span class="header-section-number">C</span> QQ and PP Plots</a></li>
<li><a class="" href="visualizing-residuals.html"><span class="header-section-number">D</span> Visualizing residuals</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hadley/r-pkgs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="linear-and-non-linear-algorithms-for-classification" class="section level1">
<h1>
<span class="header-section-number">21</span> Linear and Non-Linear Algorithms for Classification<a class="anchor" aria-label="anchor" href="#linear-and-non-linear-algorithms-for-classification"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li>Datasets: <code>BreastCancer</code>
</li>
<li>Algorithms: <em>LG, LDA, GLMNET, KNN, CARTM NB, SVM</em>
</li>
</ul>
<div id="introduction-10" class="section level2">
<h2>
<span class="header-section-number">21.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-10"><i class="fas fa-link"></i></a>
</h2>
<p>In this classification problem we apply these algorithms:</p>
<ul>
<li>
<p>Linear</p>
<ol style="list-style-type: decimal">
<li>LG (logistic regression)</li>
<li>LDA (linear discriminant analysis)</li>
<li>GLMNET (Regularized logistic regression)</li>
</ol>
</li>
<li>
<p>Non-linear</p>
<ol start="4" style="list-style-type: decimal">
<li>KNN (k-Nearest Neighbors)</li>
<li>CART (Classification and Regression Trees)</li>
<li>NB (Naive Bayes)</li>
<li>SVM (Support Vector Machines)</li>
</ol>
</li>
</ul>
<div class="sourceCode" id="cb462"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mlbench</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: lattice</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/collectivemedia/tictoc">tictoc</a></span><span class="op">)</span>

<span class="co"># Load data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">BreastCancer</span><span class="op">)</span></code></pre></div>
</div>
<div id="workflow-2" class="section level2">
<h2>
<span class="header-section-number">21.2</span> Workflow<a class="anchor" aria-label="anchor" href="#workflow-2"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Load dataset</li>
<li>Create train and validation datasets, 80/20</li>
<li>Inspect dataset:</li>
</ol>
<ul>
<li>dimension</li>
<li>class of variables</li>
<li><code>skimr</code></li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Clean up features</li>
</ol>
<ul>
<li>Convert character to numeric</li>
<li>Frequency table on class</li>
<li>remove NAs</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Visualize features</li>
</ol>
<ul>
<li>histograms (loop on variables)</li>
<li>density plots (loop)</li>
<li>boxplot (loop)</li>
<li>Pairwise jittered plot</li>
<li>Barplots for all features (loop)</li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li>Train as-is<br>
</li>
</ol>
<ul>
<li>
<p>Set the train control to</p>
<ul>
<li>10 cross-validations</li>
<li>3 repetitions</li>
<li>Metric: Accuracy</li>
</ul>
</li>
<li><p>Train the models</p></li>
<li><p>Numeric comparison of model results</p></li>
<li>
<p>Visual comparison</p>
<ul>
<li>dot plot</li>
</ul>
</li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>Train with data transformation</li>
</ol>
<ul>
<li>
<p>data transformatiom</p>
<ul>
<li>BoxCox</li>
</ul>
</li>
<li><p>Train models</p></li>
<li><p>Numeric comparison</p></li>
<li>
<p>Visual comparison</p>
<ul>
<li>dot plot</li>
</ul>
</li>
</ul>
<ol start="8" style="list-style-type: decimal">
<li>Tune the best model: SVM</li>
</ol>
<ul>
<li>
<p>Set the train control to</p>
<ul>
<li>10 cross-validations</li>
<li>3 repetitions</li>
<li>Metric: Accuracy</li>
</ul>
</li>
<li>
<p>Train the models</p>
<ul>
<li>Radial SVM</li>
<li>Sigma vector</li>
<li><code>.C</code></li>
<li>BoxCox</li>
</ul>
</li>
<li><p>Evaluate tuning parameters</p></li>
</ul>
<ol start="9" style="list-style-type: decimal">
<li>Tune the best model: KNN</li>
</ol>
<ul>
<li>
<p>Set the train control to</p>
<ul>
<li>10 cross-validations</li>
<li>3 repetitions</li>
<li>Metric: Accuracy</li>
</ul>
</li>
<li>
<p>Train the models</p>
<ul>
<li>.k</li>
<li>BoxCox</li>
</ul>
</li>
<li>
<p>Evaluate tuning parameters</p>
<ul>
<li>Scatter plot 10, Ensembling</li>
</ul>
</li>
<li>
<p>Select the algorithms</p>
<ul>
<li>Bagged CART</li>
<li>Random Forest</li>
<li>Stochastic Gradient Boosting</li>
<li>C5.0</li>
</ul>
</li>
<li>
<p>Numeric comparison</p>
<ul>
<li>resamples</li>
<li>summary</li>
</ul>
</li>
<li>
<p>Visual comparison</p>
<ul>
<li>dot plot<br>
</li>
</ul>
</li>
</ul>
<ol start="11" style="list-style-type: decimal">
<li>Finalize the model</li>
</ol>
<ul>
<li>
<p>Back transformation</p>
<ul>
<li><code>preProcess</code></li>
<li><code>predict</code></li>
</ul>
</li>
</ul>
<ol start="12" style="list-style-type: decimal">
<li>Apply model to validation set</li>
</ol>
<ul>
<li><p>Prepare validation set</p></li>
<li><p>Transform the dataset</p></li>
<li>
<p>Make prediction</p>
<ul>
<li><code>knn3Train</code></li>
</ul>
</li>
<li>
<p>Calculate accuracy</p>
<ul>
<li>Confusion Matrix</li>
</ul>
</li>
</ul>
</div>
<div id="inspect-the-dataset" class="section level2">
<h2>
<span class="header-section-number">21.3</span> Inspect the dataset<a class="anchor" aria-label="anchor" href="#inspect-the-dataset"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb463"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">BreastCancer</span><span class="op">)</span>
<span class="co">#&gt; Rows: 699</span>
<span class="co">#&gt; Columns: 11</span>
<span class="co">#&gt; $ Id              &lt;chr&gt; "1000025", "1002945", "1015425", "1016277", "1017023"…</span>
<span class="co">#&gt; $ Cl.thickness    &lt;ord&gt; 5, 5, 3, 6, 4, 8, 1, 2, 2, 4, 1, 2, 5, 1, 8, 7, 4, 4,…</span>
<span class="co">#&gt; $ Cell.size       &lt;ord&gt; 1, 4, 1, 8, 1, 10, 1, 1, 1, 2, 1, 1, 3, 1, 7, 4, 1, 1…</span>
<span class="co">#&gt; $ Cell.shape      &lt;ord&gt; 1, 4, 1, 8, 1, 10, 1, 2, 1, 1, 1, 1, 3, 1, 5, 6, 1, 1…</span>
<span class="co">#&gt; $ Marg.adhesion   &lt;ord&gt; 1, 5, 1, 1, 3, 8, 1, 1, 1, 1, 1, 1, 3, 1, 10, 4, 1, 1…</span>
<span class="co">#&gt; $ Epith.c.size    &lt;ord&gt; 2, 7, 2, 3, 2, 7, 2, 2, 2, 2, 1, 2, 2, 2, 7, 6, 2, 2,…</span>
<span class="co">#&gt; $ Bare.nuclei     &lt;fct&gt; 1, 10, 2, 4, 1, 10, 10, 1, 1, 1, 1, 1, 3, 3, 9, 1, 1,…</span>
<span class="co">#&gt; $ Bl.cromatin     &lt;fct&gt; 3, 3, 3, 3, 3, 9, 3, 3, 1, 2, 3, 2, 4, 3, 5, 4, 2, 3,…</span>
<span class="co">#&gt; $ Normal.nucleoli &lt;fct&gt; 1, 2, 1, 7, 1, 7, 1, 1, 1, 1, 1, 1, 4, 1, 5, 3, 1, 1,…</span>
<span class="co">#&gt; $ Mitoses         &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 5, 1, 1, 1, 1, 1, 4, 1, 1, 1,…</span>
<span class="co">#&gt; $ Class           &lt;fct&gt; benign, benign, benign, benign, benign, malignant, be…</span></code></pre></div>
<div class="sourceCode" id="cb464"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">BreastCancer</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 699 x 11</span>
<span class="co">#&gt;   Id    Cl.thickness Cell.size Cell.shape Marg.adhesion Epith.c.size Bare.nuclei</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;ord&gt;        &lt;ord&gt;     &lt;ord&gt;      &lt;ord&gt;         &lt;ord&gt;        &lt;fct&gt;      </span>
<span class="co">#&gt; 1 1000… 5            1         1          1             2            1          </span>
<span class="co">#&gt; 2 1002… 5            4         4          5             7            10         </span>
<span class="co">#&gt; 3 1015… 3            1         1          1             2            2          </span>
<span class="co">#&gt; 4 1016… 6            8         8          1             3            4          </span>
<span class="co">#&gt; 5 1017… 4            1         1          3             2            1          </span>
<span class="co">#&gt; 6 1017… 8            10        10         8             7            10         </span>
<span class="co">#&gt; # … with 693 more rows, and 4 more variables: Bl.cromatin &lt;fct&gt;,</span>
<span class="co">#&gt; #   Normal.nucleoli &lt;fct&gt;, Mitoses &lt;fct&gt;, Class &lt;fct&gt;</span></code></pre></div>
<div class="sourceCode" id="cb465"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Split out validation dataset</span>
<span class="co"># create a list of 80% of the rows in the original dataset we can use for training</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">validationIndex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/createDataPartition.html">createDataPartition</a></span><span class="op">(</span><span class="va">BreastCancer</span><span class="op">$</span><span class="va">Class</span>, 
                                       p<span class="op">=</span><span class="fl">0.80</span>, 
                                       list<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># select 20% of the data for validation</span>
<span class="va">validation</span> <span class="op">&lt;-</span> <span class="va">BreastCancer</span><span class="op">[</span><span class="op">-</span><span class="va">validationIndex</span>,<span class="op">]</span>
<span class="co"># use the remaining 80% of data to training and testing the models</span>
<span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">BreastCancer</span><span class="op">[</span><span class="va">validationIndex</span>,<span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb466"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># dimensions of dataset</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">validation</span><span class="op">)</span>
<span class="co">#&gt; [1] 139  11</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>
<span class="co">#&gt; [1] 560  11</span></code></pre></div>
<div class="sourceCode" id="cb467"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># peek</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataset</span>, n<span class="op">=</span><span class="fl">20</span><span class="op">)</span>
<span class="co">#&gt;         Id Cl.thickness Cell.size Cell.shape Marg.adhesion Epith.c.size</span>
<span class="co">#&gt; 1  1000025            5         1          1             1            2</span>
<span class="co">#&gt; 2  1002945            5         4          4             5            7</span>
<span class="co">#&gt; 3  1015425            3         1          1             1            2</span>
<span class="co">#&gt; 5  1017023            4         1          1             3            2</span>
<span class="co">#&gt; 6  1017122            8        10         10             8            7</span>
<span class="co">#&gt; 7  1018099            1         1          1             1            2</span>
<span class="co">#&gt; 8  1018561            2         1          2             1            2</span>
<span class="co">#&gt; 9  1033078            2         1          1             1            2</span>
<span class="co">#&gt; 10 1033078            4         2          1             1            2</span>
<span class="co">#&gt; 11 1035283            1         1          1             1            1</span>
<span class="co">#&gt; 13 1041801            5         3          3             3            2</span>
<span class="co">#&gt; 14 1043999            1         1          1             1            2</span>
<span class="co">#&gt; 15 1044572            8         7          5            10            7</span>
<span class="co">#&gt; 16 1047630            7         4          6             4            6</span>
<span class="co">#&gt; 18 1049815            4         1          1             1            2</span>
<span class="co">#&gt; 19 1050670           10         7          7             6            4</span>
<span class="co">#&gt; 21 1054590            7         3          2            10            5</span>
<span class="co">#&gt; 22 1054593           10         5          5             3            6</span>
<span class="co">#&gt; 23 1056784            3         1          1             1            2</span>
<span class="co">#&gt; 24 1057013            8         4          5             1            2</span>
<span class="co">#&gt;    Bare.nuclei Bl.cromatin Normal.nucleoli Mitoses     Class</span>
<span class="co">#&gt; 1            1           3               1       1    benign</span>
<span class="co">#&gt; 2           10           3               2       1    benign</span>
<span class="co">#&gt; 3            2           3               1       1    benign</span>
<span class="co">#&gt; 5            1           3               1       1    benign</span>
<span class="co">#&gt; 6           10           9               7       1 malignant</span>
<span class="co">#&gt; 7           10           3               1       1    benign</span>
<span class="co">#&gt; 8            1           3               1       1    benign</span>
<span class="co">#&gt; 9            1           1               1       5    benign</span>
<span class="co">#&gt; 10           1           2               1       1    benign</span>
<span class="co">#&gt; 11           1           3               1       1    benign</span>
<span class="co">#&gt; 13           3           4               4       1 malignant</span>
<span class="co">#&gt; 14           3           3               1       1    benign</span>
<span class="co">#&gt; 15           9           5               5       4 malignant</span>
<span class="co">#&gt; 16           1           4               3       1 malignant</span>
<span class="co">#&gt; 18           1           3               1       1    benign</span>
<span class="co">#&gt; 19          10           4               1       2 malignant</span>
<span class="co">#&gt; 21          10           5               4       4 malignant</span>
<span class="co">#&gt; 22           7           7              10       1 malignant</span>
<span class="co">#&gt; 23           1           2               1       1    benign</span>
<span class="co">#&gt; 24        &lt;NA&gt;           7               3       1 malignant</span></code></pre></div>
<div class="sourceCode" id="cb468"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/skimr">skimr</a></span><span class="op">)</span>
<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/skim.html">skim</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ── Data Summary ────────────────────────</span>
<span class="co">#&gt;                            Values </span>
<span class="co">#&gt; Name                       dataset</span>
<span class="co">#&gt; Number of rows             560    </span>
<span class="co">#&gt; Number of columns          11     </span>
<span class="co">#&gt; _______________________           </span>
<span class="co">#&gt; Column type frequency:            </span>
<span class="co">#&gt;   character                1      </span>
<span class="co">#&gt;   factor                   10     </span>
<span class="co">#&gt; ________________________          </span>
<span class="co">#&gt; Group variables            None   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Variable type: character ────────────────────────────────────────────────────</span>
<span class="co">#&gt;   skim_variable n_missing complete_rate   min   max empty n_unique whitespace</span>
<span class="co">#&gt; 1 Id                    0             1     5     8     0      523          0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Variable type: factor ───────────────────────────────────────────────────────</span>
<span class="co">#&gt;    skim_variable   n_missing complete_rate ordered n_unique</span>
<span class="co">#&gt;  1 Cl.thickness            0         1     TRUE          10</span>
<span class="co">#&gt;  2 Cell.size               0         1     TRUE          10</span>
<span class="co">#&gt;  3 Cell.shape              0         1     TRUE          10</span>
<span class="co">#&gt;  4 Marg.adhesion           0         1     TRUE          10</span>
<span class="co">#&gt;  5 Epith.c.size            0         1     TRUE          10</span>
<span class="co">#&gt;  6 Bare.nuclei            12         0.979 FALSE         10</span>
<span class="co">#&gt;  7 Bl.cromatin             0         1     FALSE         10</span>
<span class="co">#&gt;  8 Normal.nucleoli         0         1     FALSE         10</span>
<span class="co">#&gt;  9 Mitoses                 0         1     FALSE          9</span>
<span class="co">#&gt; 10 Class                   0         1     FALSE          2</span>
<span class="co">#&gt;    top_counts                   </span>
<span class="co">#&gt;  1 1: 113, 3: 94, 5: 94, 4: 62  </span>
<span class="co">#&gt;  2 1: 307, 10: 55, 3: 43, 2: 36 </span>
<span class="co">#&gt;  3 1: 281, 10: 48, 3: 47, 2: 46 </span>
<span class="co">#&gt;  4 1: 331, 2: 44, 10: 44, 3: 42 </span>
<span class="co">#&gt;  5 2: 304, 3: 60, 4: 40, 1: 38  </span>
<span class="co">#&gt;  6 1: 327, 10: 102, 2: 28, 5: 24</span>
<span class="co">#&gt;  7 3: 136, 2: 134, 1: 118, 7: 64</span>
<span class="co">#&gt;  8 1: 347, 10: 50, 3: 36, 2: 29 </span>
<span class="co">#&gt;  9 1: 466, 3: 29, 2: 23, 4: 10  </span>
<span class="co">#&gt; 10 ben: 367, mal: 193</span></code></pre></div>
<div class="sourceCode" id="cb469"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># types</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataset</span>, <span class="va">class</span><span class="op">)</span>
<span class="co">#&gt; $Id</span>
<span class="co">#&gt; [1] "character"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Cl.thickness</span>
<span class="co">#&gt; [1] "ordered" "factor" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Cell.size</span>
<span class="co">#&gt; [1] "ordered" "factor" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Cell.shape</span>
<span class="co">#&gt; [1] "ordered" "factor" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Marg.adhesion</span>
<span class="co">#&gt; [1] "ordered" "factor" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Epith.c.size</span>
<span class="co">#&gt; [1] "ordered" "factor" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Bare.nuclei</span>
<span class="co">#&gt; [1] "factor"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Bl.cromatin</span>
<span class="co">#&gt; [1] "factor"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Normal.nucleoli</span>
<span class="co">#&gt; [1] "factor"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Mitoses</span>
<span class="co">#&gt; [1] "factor"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Class</span>
<span class="co">#&gt; [1] "factor"</span></code></pre></div>
<p>We can see that besides the <code>Id</code>, the attributes are factors. This makes sense. I think for modeling it may be more useful to work with the data as numbers than factors. Factors might make things easier for decision tree algorithms (or not). Given that there is an ordinal relationship between the levels we can expose that structure to other algorithms better if we work directly with the integer numbers.</p>
</div>
<div id="clean-up" class="section level2">
<h2>
<span class="header-section-number">21.4</span> clean up<a class="anchor" aria-label="anchor" href="#clean-up"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb470"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Remove redundant variable Id</span>
<span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb471"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># convert input values to numeric</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">dataset</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/as.numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb472"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># summary</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>
<span class="co">#&gt;   Cl.thickness     Cell.size       Cell.shape    Marg.adhesion  </span>
<span class="co">#&gt;  Min.   : 1.00   Min.   : 1.00   Min.   : 1.00   Min.   : 1.00  </span>
<span class="co">#&gt;  1st Qu.: 2.00   1st Qu.: 1.00   1st Qu.: 1.00   1st Qu.: 1.00  </span>
<span class="co">#&gt;  Median : 4.00   Median : 1.00   Median : 1.00   Median : 1.00  </span>
<span class="co">#&gt;  Mean   : 4.44   Mean   : 3.14   Mean   : 3.21   Mean   : 2.79  </span>
<span class="co">#&gt;  3rd Qu.: 6.00   3rd Qu.: 5.00   3rd Qu.: 5.00   3rd Qu.: 4.00  </span>
<span class="co">#&gt;  Max.   :10.00   Max.   :10.00   Max.   :10.00   Max.   :10.00  </span>
<span class="co">#&gt;                                                                 </span>
<span class="co">#&gt;   Epith.c.size    Bare.nuclei     Bl.cromatin    Normal.nucleoli</span>
<span class="co">#&gt;  Min.   : 1.00   Min.   : 1.00   Min.   : 1.00   Min.   : 1.00  </span>
<span class="co">#&gt;  1st Qu.: 2.00   1st Qu.: 1.00   1st Qu.: 2.00   1st Qu.: 1.00  </span>
<span class="co">#&gt;  Median : 2.00   Median : 1.00   Median : 3.00   Median : 1.00  </span>
<span class="co">#&gt;  Mean   : 3.23   Mean   : 3.48   Mean   : 3.45   Mean   : 2.94  </span>
<span class="co">#&gt;  3rd Qu.: 4.00   3rd Qu.: 5.25   3rd Qu.: 5.00   3rd Qu.: 4.00  </span>
<span class="co">#&gt;  Max.   :10.00   Max.   :10.00   Max.   :10.00   Max.   :10.00  </span>
<span class="co">#&gt;                  NA's   :12                                     </span>
<span class="co">#&gt;     Mitoses            Class    </span>
<span class="co">#&gt;  Min.   : 1.00   benign   :367  </span>
<span class="co">#&gt;  1st Qu.: 1.00   malignant:193  </span>
<span class="co">#&gt;  Median : 1.00                  </span>
<span class="co">#&gt;  Mean   : 1.59                  </span>
<span class="co">#&gt;  3rd Qu.: 1.00                  </span>
<span class="co">#&gt;  Max.   :10.00                  </span>
<span class="co">#&gt; </span></code></pre></div>
<div class="sourceCode" id="cb473"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/skim.html">skim</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ── Data Summary ────────────────────────</span>
<span class="co">#&gt;                            Values </span>
<span class="co">#&gt; Name                       dataset</span>
<span class="co">#&gt; Number of rows             560    </span>
<span class="co">#&gt; Number of columns          10     </span>
<span class="co">#&gt; _______________________           </span>
<span class="co">#&gt; Column type frequency:            </span>
<span class="co">#&gt;   factor                   1      </span>
<span class="co">#&gt;   numeric                  9      </span>
<span class="co">#&gt; ________________________          </span>
<span class="co">#&gt; Group variables            None   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Variable type: factor ───────────────────────────────────────────────────────</span>
<span class="co">#&gt;   skim_variable n_missing complete_rate ordered n_unique top_counts        </span>
<span class="co">#&gt; 1 Class                 0             1 FALSE          2 ben: 367, mal: 193</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Variable type: numeric ──────────────────────────────────────────────────────</span>
<span class="co">#&gt;   skim_variable   n_missing complete_rate  mean    sd    p0   p25   p50   p75</span>
<span class="co">#&gt; 1 Cl.thickness            0         1      4.44  2.83     1     2     4  6   </span>
<span class="co">#&gt; 2 Cell.size               0         1      3.14  3.07     1     1     1  5   </span>
<span class="co">#&gt; 3 Cell.shape              0         1      3.21  2.97     1     1     1  5   </span>
<span class="co">#&gt; 4 Marg.adhesion           0         1      2.79  2.85     1     1     1  4   </span>
<span class="co">#&gt; 5 Epith.c.size            0         1      3.23  2.22     1     2     2  4   </span>
<span class="co">#&gt; 6 Bare.nuclei            12         0.979  3.48  3.62     1     1     1  5.25</span>
<span class="co">#&gt; 7 Bl.cromatin             0         1      3.45  2.43     1     2     3  5   </span>
<span class="co">#&gt; 8 Normal.nucleoli         0         1      2.94  3.08     1     1     1  4   </span>
<span class="co">#&gt; 9 Mitoses                 0         1      1.59  1.70     1     1     1  1   </span>
<span class="co">#&gt;    p100 hist </span>
<span class="co">#&gt; 1    10 ▇▇▆▃▃</span>
<span class="co">#&gt; 2    10 ▇▂▁▁▂</span>
<span class="co">#&gt; 3    10 ▇▂▁▁▁</span>
<span class="co">#&gt; 4    10 ▇▂▁▁▁</span>
<span class="co">#&gt; 5    10 ▇▂▂▁▁</span>
<span class="co">#&gt; 6    10 ▇▁▁▁▂</span>
<span class="co">#&gt; 7    10 ▇▅▁▂▁</span>
<span class="co">#&gt; 8    10 ▇▁▁▁▂</span>
<span class="co">#&gt; 9    10 ▇▁▁▁▁</span></code></pre></div>
<blockquote>
<p>we can see we have 13 NA values for the Bare.nuclei attribute. This suggests we may need to remove the records (or impute values) with <code>NA</code> values for some analysis and modeling techniques.</p>
</blockquote>
</div>
<div id="analyze-the-class-variable" class="section level2">
<h2>
<span class="header-section-number">21.5</span> Analyze the class variable<a class="anchor" aria-label="anchor" href="#analyze-the-class-variable"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb474"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># class distribution</span>
<span class="fu"><a href="https://rdrr.io/pkg/mice/man/cbind.html">cbind</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span>, 
      percentage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/prop.table.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>
<span class="co">#&gt;           freq percentage</span>
<span class="co">#&gt; benign     367       65.5</span>
<span class="co">#&gt; malignant  193       34.5</span></code></pre></div>
<blockquote>
<p>There is indeed a 65% to 35% split for benign-malignant in the class values which is imbalanced, but not so much that we need to be thinking about rebalancing the dataset, at least not yet.</p>
</blockquote>
<div id="remove-nas" class="section level3">
<h3>
<span class="header-section-number">21.5.1</span> remove NAs<a class="anchor" aria-label="anchor" href="#remove-nas"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb475"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># summarize correlations between input variables</span>
<span class="va">complete_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.cor.html">cor</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[</span><span class="va">complete_cases</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;                 Cl.thickness Cell.size Cell.shape Marg.adhesion Epith.c.size</span>
<span class="co">#&gt; Cl.thickness           1.000     0.665      0.667         0.486        0.543</span>
<span class="co">#&gt; Cell.size              0.665     1.000      0.904         0.722        0.773</span>
<span class="co">#&gt; Cell.shape             0.667     0.904      1.000         0.694        0.739</span>
<span class="co">#&gt; Marg.adhesion          0.486     0.722      0.694         1.000        0.643</span>
<span class="co">#&gt; Epith.c.size           0.543     0.773      0.739         0.643        1.000</span>
<span class="co">#&gt; Bare.nuclei            0.598     0.700      0.721         0.669        0.614</span>
<span class="co">#&gt; Bl.cromatin            0.565     0.752      0.739         0.692        0.628</span>
<span class="co">#&gt; Normal.nucleoli        0.570     0.737      0.741         0.644        0.642</span>
<span class="co">#&gt; Mitoses                0.347     0.453      0.432         0.419        0.485</span>
<span class="co">#&gt;                 Bare.nuclei Bl.cromatin Normal.nucleoli Mitoses</span>
<span class="co">#&gt; Cl.thickness          0.598       0.565           0.570   0.347</span>
<span class="co">#&gt; Cell.size             0.700       0.752           0.737   0.453</span>
<span class="co">#&gt; Cell.shape            0.721       0.739           0.741   0.432</span>
<span class="co">#&gt; Marg.adhesion         0.669       0.692           0.644   0.419</span>
<span class="co">#&gt; Epith.c.size          0.614       0.628           0.642   0.485</span>
<span class="co">#&gt; Bare.nuclei           1.000       0.685           0.605   0.351</span>
<span class="co">#&gt; Bl.cromatin           0.685       1.000           0.692   0.356</span>
<span class="co">#&gt; Normal.nucleoli       0.605       0.692           1.000   0.432</span>
<span class="co">#&gt; Mitoses               0.351       0.356           0.432   1.000</span></code></pre></div>
<blockquote>
<p>We can see some modest to high correlation between some of the attributes. For example between cell shape and cell size at 0.90 correlation.</p>
</blockquote>
</div>
</div>
<div id="unimodal-visualization" class="section level2">
<h2>
<span class="header-section-number">21.6</span> Unimodal visualization<a class="anchor" aria-label="anchor" href="#unimodal-visualization"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb476"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># histograms each attribute</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="302-algo-comparison_322-class_BreastCancer-mlbench-multi_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>We can see that almost all of the distributions have an exponential or bimodal shape to them.</p>
</blockquote>
<div class="sourceCode" id="cb477"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># density plot for each attribute</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">complete_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[</span><span class="va">complete_cases</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="302-algo-comparison_322-class_BreastCancer-mlbench-multi_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>These plots add more support to our initial ideas. We can see bimodal distributions (two bumps) and exponential-looking distributions.</p>
</blockquote>
<div class="sourceCode" id="cb478"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># boxplots for each attribute</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="302-algo-comparison_322-class_BreastCancer-mlbench-multi_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="multimodal-visualization" class="section level2">
<h2>
<span class="header-section-number">21.7</span> Multimodal visualization<a class="anchor" aria-label="anchor" href="#multimodal-visualization"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb479"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># scatter plot matrix</span>
<span class="va">jittered_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, <span class="va">jitter</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ellipse/man/pairs.html">pairs</a></span><span class="op">(</span><span class="va">jittered_x</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span>, col<span class="op">=</span><span class="va">dataset</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="302-algo-comparison_322-class_BreastCancer-mlbench-multi_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>We can see that the black (benign) a part to be clustered around the bottom-right corner (smaller values) and red (malignant) are all over the place.</p>
</blockquote>
<div class="sourceCode" id="cb480"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># bar plots of each variable by class</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">Class</span>,<span class="va">dataset</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, 
            legend.text<span class="op">=</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">unique</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="302-algo-comparison_322-class_BreastCancer-mlbench-multi_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="algorithms-evaluation" class="section level2">
<h2>
<span class="header-section-number">21.8</span> Algorithms Evaluation<a class="anchor" aria-label="anchor" href="#algorithms-evaluation"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Linear Algorithms: Logistic Regression (LG), Linear Discriminate Analysis (LDA) and Regularized Logistic Regression (GLMNET).</p></li>
<li><p>Nonlinear Algorithms: k-Nearest Neighbors (KNN), Classiﬁcation and Regression Trees (CART), Naive Bayes (NB) and Support Vector Machines with Radial Basis Functions (SVM).</p></li>
</ul>
<p>For simplicity, we will use Accuracy and Kappa metrics. Given that it is a medical test, we could have gone with the Area Under ROC Curve (AUC) and looked at the sensitivity and speciﬁcity to select the best algorithms.</p>
<div class="sourceCode" id="cb481"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 10-fold cross-validation with 3 repeats</span>
<span class="va">trainControl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"repeatedcv"</span>, number<span class="op">=</span><span class="fl">10</span>, repeats<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">metric</span> <span class="op">&lt;-</span> <span class="st">"Accuracy"</span></code></pre></div>
<div class="sourceCode" id="cb482"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html">tic</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># LG</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"glm"</span>, metric<span class="op">=</span><span class="va">metric</span>,
                 trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># LDA</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.lda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"lda"</span>, metric<span class="op">=</span><span class="va">metric</span>,
                 trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># GLMNET</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.glmnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"glmnet"</span>, metric<span class="op">=</span><span class="va">metric</span>,
                    trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># KNN</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.knn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"knn"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                 trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># CART</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.cart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"rpart"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                  trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># Naive Bayes</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"nb"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># SVM</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.svm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"svmRadial"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                 trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>

<span class="co"># Compare algorithms</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/resamples.html">resamples</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>LG     <span class="op">=</span> <span class="va">fit.glm</span>, 
                          LDA    <span class="op">=</span> <span class="va">fit.lda</span>, 
                          GLMNET <span class="op">=</span> <span class="va">fit.glmnet</span>, 
                          KNN    <span class="op">=</span> <span class="va">fit.knn</span>, 
                          CART   <span class="op">=</span> <span class="va">fit.cart</span>, 
                          NB     <span class="op">=</span> <span class="va">fit.nb</span>, 
                          SVM    <span class="op">=</span> <span class="va">fit.svm</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html">toc</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; 13.39 sec elapsed</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; summary.resamples(object = results)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Models: LG, LDA, GLMNET, KNN, CART, NB, SVM </span>
<span class="co">#&gt; Number of resamples: 30 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Accuracy </span>
<span class="co">#&gt;         Min. 1st Qu. Median  Mean 3rd Qu. Max. NA's</span>
<span class="co">#&gt; LG     0.909   0.945  0.964 0.968   0.995    1    0</span>
<span class="co">#&gt; LDA    0.907   0.945  0.964 0.963   0.982    1    0</span>
<span class="co">#&gt; GLMNET 0.927   0.964  0.964 0.973   0.995    1    0</span>
<span class="co">#&gt; KNN    0.927   0.964  0.982 0.976   1.000    1    0</span>
<span class="co">#&gt; CART   0.833   0.927  0.945 0.943   0.964    1    0</span>
<span class="co">#&gt; NB     0.927   0.963  0.981 0.970   0.982    1    0</span>
<span class="co">#&gt; SVM    0.907   0.945  0.964 0.965   0.982    1    0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Kappa </span>
<span class="co">#&gt;         Min. 1st Qu. Median  Mean 3rd Qu. Max. NA's</span>
<span class="co">#&gt; LG     0.806   0.880  0.921 0.930   0.990    1    0</span>
<span class="co">#&gt; LDA    0.786   0.880  0.918 0.917   0.959    1    0</span>
<span class="co">#&gt; GLMNET 0.843   0.918  0.922 0.940   0.990    1    0</span>
<span class="co">#&gt; KNN    0.843   0.920  0.959 0.947   1.000    1    0</span>
<span class="co">#&gt; CART   0.630   0.840  0.879 0.876   0.920    1    0</span>
<span class="co">#&gt; NB     0.835   0.918  0.959 0.934   0.960    1    0</span>
<span class="co">#&gt; SVM    0.804   0.883  0.922 0.926   0.960    1    0</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/graphics-defunct.html">dotplot</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="302-algo-comparison_322-class_BreastCancer-mlbench-multi_files/figure-html/models-first-run-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>We can see good accuracy across the board. All algorithms have a mean accuracy above 90%, well above the baseline of 65% if we just predicted benign. The problem is learnable. We can see that KNN (97.08%) and logistic regression (NB was 96.2% and GLMNET was 96.4%) had the highest accuracy on the problem.</p>
</blockquote>
</div>
<div id="data-transform" class="section level2">
<h2>
<span class="header-section-number">21.9</span> Data transform<a class="anchor" aria-label="anchor" href="#data-transform"><i class="fas fa-link"></i></a>
</h2>
<p>We know we have some skewed distributions. There are transform methods that we can use to adjust and normalize these distributions. A favorite for positive input attributes (which we have in this case) is the Box-Cox transform.</p>
<div class="sourceCode" id="cb483"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 10-fold cross-validation with 3 repeats</span>
<span class="va">trainControl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"repeatedcv"</span>, number<span class="op">=</span><span class="fl">10</span>, repeats<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">metric</span> <span class="op">&lt;-</span> <span class="st">"Accuracy"</span>

<span class="co"># LG</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.glm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"glm"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                 preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, 
                 trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># LDA</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.lda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"lda"</span>, metric<span class="op">=</span><span class="va">metric</span>,
                 preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, 
                 trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># GLMNET</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.glmnet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"glmnet"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                    preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, 
                    trControl<span class="op">=</span><span class="va">trainControl</span>, 
                    na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># KNN</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.knn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"knn"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                 preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, 
                 trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># CART</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.cart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"rpart"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                  preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, 
                  trControl<span class="op">=</span><span class="va">trainControl</span>, 
                  na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co"># Naive Bayes</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"nb"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 1</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 24</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 28</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 20</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 11</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 18</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 54</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 3</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 23</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 21</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 27</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 53</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 12</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 9</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 2</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 17</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 9</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 55</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 23</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Numerical 0 probability for all classes with</span>
<span class="co">#&gt; observation 32</span>
<span class="co"># SVM</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.svm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"svmRadial"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                 preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, 
                 trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>

<span class="co"># Compare algorithms</span>
<span class="va">transformResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/resamples.html">resamples</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>LG     <span class="op">=</span> <span class="va">fit.glm</span>, 
                                  LDA    <span class="op">=</span> <span class="va">fit.lda</span>, 
                                  GLMNET <span class="op">=</span> <span class="va">fit.glmnet</span>, 
                                  KNN    <span class="op">=</span> <span class="va">fit.knn</span>, 
                                  CART   <span class="op">=</span> <span class="va">fit.cart</span>, 
                                  NB     <span class="op">=</span> <span class="va">fit.nb</span>, 
                                  SVM    <span class="op">=</span> <span class="va">fit.svm</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">transformResults</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; summary.resamples(object = transformResults)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Models: LG, LDA, GLMNET, KNN, CART, NB, SVM </span>
<span class="co">#&gt; Number of resamples: 30 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Accuracy </span>
<span class="co">#&gt;         Min. 1st Qu. Median  Mean 3rd Qu. Max. NA's</span>
<span class="co">#&gt; LG     0.909   0.963  0.982 0.973   0.996    1    0</span>
<span class="co">#&gt; LDA    0.927   0.964  0.981 0.974   0.982    1    0</span>
<span class="co">#&gt; GLMNET 0.944   0.964  0.982 0.980   1.000    1    0</span>
<span class="co">#&gt; KNN    0.909   0.964  0.981 0.976   0.982    1    0</span>
<span class="co">#&gt; CART   0.833   0.927  0.945 0.943   0.964    1    0</span>
<span class="co">#&gt; NB     0.927   0.964  0.982 0.978   1.000    1    0</span>
<span class="co">#&gt; SVM    0.927   0.964  0.982 0.980   1.000    1    0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Kappa </span>
<span class="co">#&gt;         Min. 1st Qu. Median  Mean 3rd Qu. Max. NA's</span>
<span class="co">#&gt; LG     0.806   0.919  0.959 0.941   0.990    1    0</span>
<span class="co">#&gt; LDA    0.847   0.921  0.959 0.945   0.961    1    0</span>
<span class="co">#&gt; GLMNET 0.878   0.922  0.960 0.957   1.000    1    0</span>
<span class="co">#&gt; KNN    0.806   0.922  0.959 0.949   0.961    1    0</span>
<span class="co">#&gt; CART   0.630   0.840  0.879 0.876   0.920    1    0</span>
<span class="co">#&gt; NB     0.843   0.922  0.960 0.953   1.000    1    0</span>
<span class="co">#&gt; SVM    0.847   0.922  0.960 0.957   1.000    1    0</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/graphics-defunct.html">dotplot</a></span><span class="op">(</span><span class="va">transformResults</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="302-algo-comparison_322-class_BreastCancer-mlbench-multi_files/figure-html/models-second-run-BoxCox-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>We can see that the accuracy of the previous best algorithm KNN was elevated to 97.14%. We have a new ranking, showing SVM with the most accurate mean accuracy at 97.20%.</p>
</blockquote>
</div>
<div id="tuning-svm" class="section level2">
<h2>
<span class="header-section-number">21.10</span> Tuning SVM<a class="anchor" aria-label="anchor" href="#tuning-svm"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb484"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 10-fold cross-validation with 3 repeats</span>
<span class="va">trainControl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"repeatedcv"</span>, number<span class="op">=</span><span class="fl">10</span>, repeats<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">metric</span> <span class="op">&lt;-</span> <span class="st">"Accuracy"</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>

<span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>.sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span><span class="op">)</span>, 
                    .C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="va">fit.svm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"svmRadial"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                 tuneGrid<span class="op">=</span><span class="va">grid</span>, 
                 preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, trControl<span class="op">=</span><span class="va">trainControl</span>, 
                 na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">fit.svm</span><span class="op">)</span>
<span class="co">#&gt; Support Vector Machines with Radial Basis Function Kernel </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 560 samples</span>
<span class="co">#&gt;   9 predictor</span>
<span class="co">#&gt;   2 classes: 'benign', 'malignant' </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pre-processing: Box-Cox transformation (9) </span>
<span class="co">#&gt; Resampling: Cross-Validated (10 fold, repeated 3 times) </span>
<span class="co">#&gt; Summary of sample sizes: 493, 492, 493, 493, 493, 494, ... </span>
<span class="co">#&gt; Resampling results across tuning parameters:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   sigma  C   Accuracy  Kappa</span>
<span class="co">#&gt;   0.025   1  0.979     0.956</span>
<span class="co">#&gt;   0.025   2  0.979     0.954</span>
<span class="co">#&gt;   0.025   3  0.979     0.956</span>
<span class="co">#&gt;   0.025   4  0.977     0.950</span>
<span class="co">#&gt;   0.025   5  0.977     0.950</span>
<span class="co">#&gt;   0.025   6  0.978     0.951</span>
<span class="co">#&gt;   0.025   7  0.979     0.954</span>
<span class="co">#&gt;   0.025   8  0.979     0.956</span>
<span class="co">#&gt;   0.025   9  0.979     0.956</span>
<span class="co">#&gt;   0.025  10  0.979     0.956</span>
<span class="co">#&gt;   0.050   1  0.980     0.957</span>
<span class="co">#&gt;   0.050   2  0.980     0.957</span>
<span class="co">#&gt;   0.050   3  0.979     0.956</span>
<span class="co">#&gt;   0.050   4  0.980     0.957</span>
<span class="co">#&gt;   0.050   5  0.980     0.957</span>
<span class="co">#&gt;   0.050   6  0.980     0.957</span>
<span class="co">#&gt;   0.050   7  0.979     0.956</span>
<span class="co">#&gt;   0.050   8  0.979     0.954</span>
<span class="co">#&gt;   0.050   9  0.979     0.954</span>
<span class="co">#&gt;   0.050  10  0.979     0.954</span>
<span class="co">#&gt;   0.100   1  0.980     0.957</span>
<span class="co">#&gt;   0.100   2  0.980     0.957</span>
<span class="co">#&gt;   0.100   3  0.979     0.956</span>
<span class="co">#&gt;   0.100   4  0.978     0.953</span>
<span class="co">#&gt;   0.100   5  0.978     0.952</span>
<span class="co">#&gt;   0.100   6  0.975     0.946</span>
<span class="co">#&gt;   0.100   7  0.976     0.948</span>
<span class="co">#&gt;   0.100   8  0.976     0.948</span>
<span class="co">#&gt;   0.100   9  0.976     0.948</span>
<span class="co">#&gt;   0.100  10  0.975     0.946</span>
<span class="co">#&gt;   0.150   1  0.980     0.957</span>
<span class="co">#&gt;   0.150   2  0.978     0.953</span>
<span class="co">#&gt;   0.150   3  0.978     0.953</span>
<span class="co">#&gt;   0.150   4  0.976     0.949</span>
<span class="co">#&gt;   0.150   5  0.976     0.948</span>
<span class="co">#&gt;   0.150   6  0.975     0.946</span>
<span class="co">#&gt;   0.150   7  0.974     0.944</span>
<span class="co">#&gt;   0.150   8  0.972     0.939</span>
<span class="co">#&gt;   0.150   9  0.970     0.934</span>
<span class="co">#&gt;   0.150  10  0.968     0.930</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Accuracy was used to select the optimal model using the largest value.</span>
<span class="co">#&gt; The final values used for the model were sigma = 0.15 and C = 1.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">fit.svm</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="302-algo-comparison_322-class_BreastCancer-mlbench-multi_files/figure-html/model-svm-run-takes_a_while-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>We can see that we have made very little difference to the results. The most accurate model had a score of 97.31% (the same as our previously rounded score of 97.20%) using a <code>sigma = 0.1</code> and <code>C = 1</code>. We could tune further, but I don’t expect a payoﬀ.</p>
</blockquote>
</div>
<div id="tuning-knn" class="section level2">
<h2>
<span class="header-section-number">21.11</span> Tuning KNN<a class="anchor" aria-label="anchor" href="#tuning-knn"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb485"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 10-fold cross-validation with 3 repeats</span>
<span class="va">trainControl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"repeatedcv"</span>, number<span class="op">=</span><span class="fl">10</span>, repeats<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">metric</span> <span class="op">&lt;-</span> <span class="st">"Accuracy"</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>

<span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>.k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">20</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">fit.knn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"knn"</span>, metric<span class="op">=</span><span class="va">metric</span>, 
                 tuneGrid<span class="op">=</span><span class="va">grid</span>, 
                 preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, trControl<span class="op">=</span><span class="va">trainControl</span>, 
                 na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>
<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">fit.knn</span><span class="op">)</span>
<span class="co">#&gt; k-Nearest Neighbors </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; 560 samples</span>
<span class="co">#&gt;   9 predictor</span>
<span class="co">#&gt;   2 classes: 'benign', 'malignant' </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pre-processing: Box-Cox transformation (9) </span>
<span class="co">#&gt; Resampling: Cross-Validated (10 fold, repeated 3 times) </span>
<span class="co">#&gt; Summary of sample sizes: 493, 492, 493, 493, 493, 494, ... </span>
<span class="co">#&gt; Resampling results across tuning parameters:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   k   Accuracy  Kappa</span>
<span class="co">#&gt;    1  0.958     0.908</span>
<span class="co">#&gt;    2  0.960     0.912</span>
<span class="co">#&gt;    3  0.968     0.931</span>
<span class="co">#&gt;    4  0.970     0.935</span>
<span class="co">#&gt;    5  0.972     0.939</span>
<span class="co">#&gt;    6  0.973     0.942</span>
<span class="co">#&gt;    7  0.976     0.949</span>
<span class="co">#&gt;    8  0.975     0.946</span>
<span class="co">#&gt;    9  0.976     0.947</span>
<span class="co">#&gt;   10  0.976     0.949</span>
<span class="co">#&gt;   11  0.976     0.949</span>
<span class="co">#&gt;   12  0.976     0.947</span>
<span class="co">#&gt;   13  0.974     0.945</span>
<span class="co">#&gt;   14  0.975     0.946</span>
<span class="co">#&gt;   15  0.976     0.947</span>
<span class="co">#&gt;   16  0.975     0.946</span>
<span class="co">#&gt;   17  0.976     0.947</span>
<span class="co">#&gt;   18  0.976     0.947</span>
<span class="co">#&gt;   19  0.978     0.951</span>
<span class="co">#&gt;   20  0.977     0.950</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Accuracy was used to select the optimal model using the largest value.</span>
<span class="co">#&gt; The final value used for the model was k = 19.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">fit.knn</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="302-algo-comparison_322-class_BreastCancer-mlbench-multi_files/figure-html/model-knn-run-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>We can see again that tuning has made little difference, settling on a value of <code>k = 7</code> with an accuracy of 97.19%. This is higher than the previous 97.14%, but very similar (or perhaps identical!) to the result achieved by the tuned SVM.</p>
</blockquote>
</div>
<div id="ensemble" class="section level2">
<h2>
<span class="header-section-number">21.12</span> Ensemble<a class="anchor" aria-label="anchor" href="#ensemble"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb486"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 10-fold cross-validation with 3 repeats</span>
<span class="va">trainControl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"repeatedcv"</span>, number<span class="op">=</span><span class="fl">10</span>, repeats<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">metric</span> <span class="op">&lt;-</span> <span class="st">"Accuracy"</span>

<span class="co"># Bagged CART</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.treebag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"treebag"</span>, 
                     metric<span class="op">=</span><span class="va">metric</span>, 
                     trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>

<span class="co"># Random Forest</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"rf"</span>, 
                metric<span class="op">=</span><span class="va">metric</span>, preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, 
                trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>

<span class="co"># Stochastic Gradient Boosting</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.gbm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"gbm"</span>, 
                 metric<span class="op">=</span><span class="va">metric</span>, preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, 
                 trControl<span class="op">=</span><span class="va">trainControl</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>

<span class="co"># C5.0</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="va">fit.c50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op">(</span><span class="va">Class</span><span class="op">~</span><span class="va">.</span>, data<span class="op">=</span><span class="va">dataset</span>, method<span class="op">=</span><span class="st">"C5.0"</span>, 
                 metric<span class="op">=</span><span class="va">metric</span>, preProc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span>, 
                 trControl<span class="op">=</span><span class="va">trainControl</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>

<span class="co"># Compare results</span>
<span class="va">ensembleResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/resamples.html">resamples</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>BAG <span class="op">=</span> <span class="va">fit.treebag</span>, 
                                  RF  <span class="op">=</span> <span class="va">fit.rf</span>, 
                                  GBM <span class="op">=</span> <span class="va">fit.gbm</span>, 
                                  C50 <span class="op">=</span> <span class="va">fit.c50</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">ensembleResults</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; summary.resamples(object = ensembleResults)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Models: BAG, RF, GBM, C50 </span>
<span class="co">#&gt; Number of resamples: 30 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Accuracy </span>
<span class="co">#&gt;      Min. 1st Qu. Median  Mean 3rd Qu. Max. NA's</span>
<span class="co">#&gt; BAG 0.907   0.963  0.982 0.973   0.982    1    0</span>
<span class="co">#&gt; RF  0.926   0.981  0.982 0.979   0.995    1    0</span>
<span class="co">#&gt; GBM 0.929   0.963  0.981 0.973   0.995    1    0</span>
<span class="co">#&gt; C50 0.907   0.964  0.982 0.972   0.982    1    0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Kappa </span>
<span class="co">#&gt;      Min. 1st Qu. Median  Mean 3rd Qu. Max. NA's</span>
<span class="co">#&gt; BAG 0.804   0.920  0.959 0.942    0.96    1    0</span>
<span class="co">#&gt; RF  0.841   0.959  0.960 0.955    0.99    1    0</span>
<span class="co">#&gt; GBM 0.844   0.919  0.959 0.941    0.99    1    0</span>
<span class="co">#&gt; C50 0.795   0.918  0.959 0.939    0.96    1    0</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/graphics-defunct.html">dotplot</a></span><span class="op">(</span><span class="va">ensembleResults</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="302-algo-comparison_322-class_BreastCancer-mlbench-multi_files/figure-html/models-ensembling-run-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>We see that Random Forest was the most accurate with a score of 97.26%. Very similar to our tuned models above. We could spend time tuning the parameters of Random Forest (e.g. increasing the number of trees) and the other ensemble methods, but I don’t expect to see better accuracy scores other than random statistical fluctuations.</p>
</blockquote>
</div>
<div id="finalize-model" class="section level2">
<h2>
<span class="header-section-number">21.13</span> Finalize model<a class="anchor" aria-label="anchor" href="#finalize-model"><i class="fas fa-link"></i></a>
</h2>
<p>We now need to finalize the model, which really means choose which model we would like to use. For simplicity I would probably select the KNN method, at the expense of the memory required to store the training dataset. SVM would be a good choice to trade-oﬀ space and time complexity. I probably would not select the Random Forest algorithm given the complexity of the model. It seems overkill for this dataset, lots of trees with little benefit in Accuracy.</p>
<p>Let’s go with the KNN algorithm. This is really simple, as we do not need to store a model. We do need to capture the parameters of the Box-Cox transform though. And we also need to prepare the data by removing the unused Id attribute and converting all of the inputs to numeric format.</p>
<p>The implementation of KNN (<code><a href="https://rdrr.io/pkg/caret/man/knn3.html">knn3()</a></code>) belongs to the caret package and does not support missing values. We will have to remove the rows with missing values from the training dataset as well as the validation dataset. The code below shows the preparation of the pre-processing parameters using the training dataset.</p>
<div class="sourceCode" id="cb487"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># prepare parameters for data transform</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>

<span class="va">datasetNoMissing</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="va">datasetNoMissing</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>

<span class="co"># transform</span>
<span class="va">preprocessParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/preProcess.html">preProcess</a></span><span class="op">(</span><span class="va">x</span>, method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BoxCox"</span><span class="op">)</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">preprocessParams</span>, <span class="va">x</span><span class="op">)</span></code></pre></div>
</div>
<div id="prepare-the-validation-set" class="section level2">
<h2>
<span class="header-section-number">21.14</span> Prepare the validation set<a class="anchor" aria-label="anchor" href="#prepare-the-validation-set"><i class="fas fa-link"></i></a>
</h2>
<p>Next we need to prepare the validation dataset for making a prediction. We must:</p>
<ol style="list-style-type: decimal">
<li>Remove the Id attribute.</li>
<li>Remove those rows with missing data.</li>
<li>Convert all input attributes to numeric.</li>
<li>Apply the Box-Cox transform to the input attributes using parameters prepared on the training dataset.</li>
</ol>
<div class="sourceCode" id="cb488"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># prepare the validation dataset</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>

<span class="co"># remove id column</span>
<span class="va">validation</span> <span class="op">&lt;-</span> <span class="va">validation</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>

<span class="co"># remove missing values (not allowed in this implementation of knn)</span>
<span class="va">validation</span> <span class="op">&lt;-</span> <span class="va">validation</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">validation</span><span class="op">)</span>,<span class="op">]</span>

<span class="co"># convert to numeric</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">validation</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/as.numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">validation</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># transform the validation dataset</span>
<span class="va">validationX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">preprocessParams</span>, <span class="va">validation</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb489"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># make predictions</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>
<span class="co"># knn3Train(train, test, cl, k = 1, l = 0, prob = TRUE, use.all = TRUE)</span>
<span class="co"># k: number of neighbours considered.</span>
<span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/knn3.html">knn3Train</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">validationX</span>, <span class="va">datasetNoMissing</span><span class="op">$</span><span class="va">Class</span>, 
                         k <span class="op">=</span> <span class="fl">9</span>, 
                         prob <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># convert </span>
<span class="fu"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html">confusionMatrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/as.factor.html">as.factor</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">)</span>, <span class="va">validation</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span>
<span class="co">#&gt; Confusion Matrix and Statistics</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            Reference</span>
<span class="co">#&gt; Prediction  benign malignant</span>
<span class="co">#&gt;   benign        83         1</span>
<span class="co">#&gt;   malignant      4        47</span>
<span class="co">#&gt;                                         </span>
<span class="co">#&gt;                Accuracy : 0.963         </span>
<span class="co">#&gt;                  95% CI : (0.916, 0.988)</span>
<span class="co">#&gt;     No Information Rate : 0.644         </span>
<span class="co">#&gt;     P-Value [Acc &gt; NIR] : &lt;2e-16        </span>
<span class="co">#&gt;                                         </span>
<span class="co">#&gt;                   Kappa : 0.92          </span>
<span class="co">#&gt;                                         </span>
<span class="co">#&gt;  Mcnemar's Test P-Value : 0.371         </span>
<span class="co">#&gt;                                         </span>
<span class="co">#&gt;             Sensitivity : 0.954         </span>
<span class="co">#&gt;             Specificity : 0.979         </span>
<span class="co">#&gt;          Pos Pred Value : 0.988         </span>
<span class="co">#&gt;          Neg Pred Value : 0.922         </span>
<span class="co">#&gt;              Prevalence : 0.644         </span>
<span class="co">#&gt;          Detection Rate : 0.615         </span>
<span class="co">#&gt;    Detection Prevalence : 0.622         </span>
<span class="co">#&gt;       Balanced Accuracy : 0.967         </span>
<span class="co">#&gt;                                         </span>
<span class="co">#&gt;        'Positive' Class : benign        </span>
<span class="co">#&gt; </span></code></pre></div>
<blockquote>
<p>We can see that the accuracy of the final model on the validation dataset is 99.26%. This is optimistic because there is only 136 rows, but it does show that we have an accurate standalone model that we could use on other unclassified data.</p>
</blockquote>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="building-a-naive-bayes-classifier.html"><span class="header-section-number">20</span> Building a Naive Bayes Classifier</a></div>
<div class="next"><a href="detect-mines-vs-rocks-with-random-forest.html"><span class="header-section-number">22</span> Detect mines vs rocks with Random Forest</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#linear-and-non-linear-algorithms-for-classification"><span class="header-section-number">21</span> Linear and Non-Linear Algorithms for Classification</a></li>
<li><a class="nav-link" href="#introduction-10"><span class="header-section-number">21.1</span> Introduction</a></li>
<li><a class="nav-link" href="#workflow-2"><span class="header-section-number">21.2</span> Workflow</a></li>
<li><a class="nav-link" href="#inspect-the-dataset"><span class="header-section-number">21.3</span> Inspect the dataset</a></li>
<li><a class="nav-link" href="#clean-up"><span class="header-section-number">21.4</span> clean up</a></li>
<li>
<a class="nav-link" href="#analyze-the-class-variable"><span class="header-section-number">21.5</span> Analyze the class variable</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#remove-nas"><span class="header-section-number">21.5.1</span> remove NAs</a></li></ul>
</li>
<li><a class="nav-link" href="#unimodal-visualization"><span class="header-section-number">21.6</span> Unimodal visualization</a></li>
<li><a class="nav-link" href="#multimodal-visualization"><span class="header-section-number">21.7</span> Multimodal visualization</a></li>
<li><a class="nav-link" href="#algorithms-evaluation"><span class="header-section-number">21.8</span> Algorithms Evaluation</a></li>
<li><a class="nav-link" href="#data-transform"><span class="header-section-number">21.9</span> Data transform</a></li>
<li><a class="nav-link" href="#tuning-svm"><span class="header-section-number">21.10</span> Tuning SVM</a></li>
<li><a class="nav-link" href="#tuning-knn"><span class="header-section-number">21.11</span> Tuning KNN</a></li>
<li><a class="nav-link" href="#ensemble"><span class="header-section-number">21.12</span> Ensemble</a></li>
<li><a class="nav-link" href="#finalize-model"><span class="header-section-number">21.13</span> Finalize model</a></li>
<li><a class="nav-link" href="#prepare-the-validation-set"><span class="header-section-number">21.14</span> Prepare the validation set</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hadley/r-pkgs/blob/master/302-algo-comparison_322-class_BreastCancer-mlbench-multi.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hadley/r-pkgs/edit/master/302-algo-comparison_322-class_BreastCancer-mlbench-multi.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Machine Learning Compilation</strong>" was written by Several authors. Compiled by Alfonso R. Reyes. It was last built on 2020-11-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
