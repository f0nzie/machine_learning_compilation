<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Comparison of two PCA packages | A Machine Learning Compilation</title>
<meta name="author" content="Several authors. Compiled by Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Machine Learning Compilation</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li class="book-part">The Basics of Machine Learning</li>
<li><a class="" href="introduction-to-pca.html"><span class="header-section-number">2</span> Introduction to PCA</a></li>
<li><a class="active" href="comparison-of-two-pca-packages.html"><span class="header-section-number">3</span> Comparison of two PCA packages</a></li>
<li><a class="" href="detailed-study-of-principal-component-analysis.html"><span class="header-section-number">4</span> Detailed study of Principal Component Analysis</a></li>
<li><a class="" href="detection-of-diabetes-using-logistic-regression.html"><span class="header-section-number">5</span> Detection of diabetes using Logistic Regression</a></li>
<li><a class="" href="sensitivity-analysis-for-a-neural-network.html"><span class="header-section-number">6</span> Sensitivity analysis for a neural network</a></li>
<li><a class="" href="data-visualization-for-ml-models.html"><span class="header-section-number">7</span> Data Visualization for ML models</a></li>
<li class="book-part">Feature Engineering</li>
<li><a class="" href="ten-methods-to-assess-variable-importance.html"><span class="header-section-number">8</span> Ten methods to assess Variable Importance</a></li>
<li><a class="" href="employee-attrition-using-feature-importance.html"><span class="header-section-number">9</span> Employee Attrition using Feature Importance</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="a-gentle-introduction-to-support-vector-machines.html"><span class="header-section-number">10</span> A gentle introduction to Support Vector Machines</a></li>
<li><a class="" href="broad-view-of-svm.html"><span class="header-section-number">11</span> Broad view of SVM</a></li>
<li><a class="" href="feature-selection-to-enhance-cancer-detection.html"><span class="header-section-number">12</span> Feature Selection to enhance cancer detection</a></li>
<li><a class="" href="dealing-with-unbalanced-data.html"><span class="header-section-number">13</span> Dealing with unbalanced data</a></li>
<li><a class="" href="imputting-missing-values-with-random-forest.html"><span class="header-section-number">14</span> Imputting missing values with Random Forest</a></li>
<li><a class="" href="tuning-of-support-vector-machine-prediction.html"><span class="header-section-number">15</span> Tuning of Support Vector Machine prediction</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="introduction-to-algorithms-for-classification.html"><span class="header-section-number">16</span> Introduction to algorithms for Classification</a></li>
<li><a class="" href="comparing-classification-algorithms.html"><span class="header-section-number">17</span> Comparing Classification algorithms</a></li>
<li><a class="" href="who-buys-social-network-ads.html"><span class="header-section-number">18</span> Who buys Social Network ads</a></li>
<li><a class="" href="predicting-ozone-levels.html"><span class="header-section-number">19</span> Predicting Ozone levels</a></li>
<li><a class="" href="building-a-naive-bayes-classifier.html"><span class="header-section-number">20</span> Building a Naive Bayes Classifier</a></li>
<li><a class="" href="linear-and-non-linear-algorithms-for-classification.html"><span class="header-section-number">21</span> Linear and Non-Linear Algorithms for Classification</a></li>
<li><a class="" href="detect-mines-vs-rocks-with-random-forest.html"><span class="header-section-number">22</span> Detect mines vs rocks with Random Forest</a></li>
<li><a class="" href="predicting-the-type-of-glass.html"><span class="header-section-number">23</span> Predicting the type of glass</a></li>
<li><a class="" href="naive-bayes-for-sms-spam.html"><span class="header-section-number">24</span> Naive Bayes for SMS spam</a></li>
<li><a class="" href="vehicles-classiification-with-decision-trees.html"><span class="header-section-number">25</span> Vehicles classiification with Decision Trees</a></li>
<li><a class="" href="applying-naive-bayes-on-the-titanic-case.html"><span class="header-section-number">26</span> Applying Naive-Bayes on the Titanic case</a></li>
<li><a class="" href="classification-on-bad-loans.html"><span class="header-section-number">27</span> Classification on bad loans</a></li>
<li><a class="" href="predicting-flu-outcome-comparing-eight-classification-algorithms.html"><span class="header-section-number">28</span> Predicting Flu outcome comparing eight classification algorithms</a></li>
<li><a class="" href="a-detailed-study-of-bike-sharing-demand.html"><span class="header-section-number">29</span> A detailed study of bike sharing demand</a></li>
<li><a class="" href="prediction-of-arrhythmia-with-deep-neural-nets.html"><span class="header-section-number">30</span> Prediction of arrhythmia with deep neural nets</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression-with-islr.html"><span class="header-section-number">31</span> Linear Regression with ISLR</a></li>
<li><a class="" href="evaluation-of-three-linear-regression-models.html"><span class="header-section-number">32</span> Evaluation of three linear regression models</a></li>
<li><a class="" href="comparison-of-six-linear-regression-algorithms.html"><span class="header-section-number">33</span> Comparison of six Linear Regression algorithms</a></li>
<li><a class="" href="comparing-regression-models.html"><span class="header-section-number">34</span> Comparing regression models</a></li>
<li><a class="" href="finding-the-factors-of-happiness.html"><span class="header-section-number">35</span> Finding the factors of happiness</a></li>
<li><a class="" href="regression-with-a-neural-network.html"><span class="header-section-number">36</span> Regression with a neural network</a></li>
<li><a class="" href="comparing-multiple-regression-vs-a-neural-network.html"><span class="header-section-number">37</span> Comparing Multiple Regression vs a Neural Network</a></li>
<li><a class="" href="temperature-modeling-using-nested-dataframes.html"><span class="header-section-number">38</span> Temperature modeling using nested dataframes</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="credit-scoring-with-neuralnet.html"><span class="header-section-number">39</span> Credit Scoring with neuralnet</a></li>
<li><a class="" href="wine-classification-with-neuralnet.html"><span class="header-section-number">40</span> Wine classification with neuralnet</a></li>
<li><a class="" href="predicting-the-rating-of-cereals.html"><span class="header-section-number">41</span> Predicting the rating of cereals</a></li>
<li><a class="" href="fitting-a-linear-model-with-neural-networks.html"><span class="header-section-number">42</span> Fitting a linear model with neural networks</a></li>
<li><a class="" href="visualization-of-neural-networks.html"><span class="header-section-number">43</span> Visualization of neural networks</a></li>
<li><a class="" href="build-a-fully-connected-r-neural-network-from-scratch.html"><span class="header-section-number">44</span> Build a fully connected R neural network from scratch</a></li>
<li><a class="" href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">45</span> Tuning Hyperparameters in a Neural Network</a></li>
<li><a class="" href="deep-learning-tips-for-classification-and-regression.html"><span class="header-section-number">46</span> Deep Learning tips for Classification and Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></li>
<li><a class="" href="q-q-normal-to-compare-data-to-distributions.html"><span class="header-section-number">B</span> Q-Q normal to compare data to distributions</a></li>
<li><a class="" href="qq-and-pp-plots.html"><span class="header-section-number">C</span> QQ and PP Plots</a></li>
<li><a class="" href="visualizing-residuals.html"><span class="header-section-number">D</span> Visualizing residuals</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/f0nzie/machine_learning_compilation">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="comparison-of-two-pca-packages" class="section level1">
<h1>
<span class="header-section-number">3</span> Comparison of two PCA packages<a class="anchor" aria-label="anchor" href="#comparison-of-two-pca-packages"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li><p>Datasets: <code>decathlon2</code></p></li>
<li>
<p>Algorithms:</p>
<ul>
<li>PCA</li>
</ul>
</li>
</ul>
<div id="prcomp-vs-princomp" class="section level2">
<h2>
<span class="header-section-number">3.1</span> prcomp vs princomp<a class="anchor" aria-label="anchor" href="#prcomp-vs-princomp"><i class="fas fa-link"></i></a>
</h2>
<p><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/118-principal-component-analysis-in-r-prcomp-vs-princomp/" class="uri">http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/118-principal-component-analysis-in-r-prcomp-vs-princomp/</a></p>
</div>
<div id="general-methods-for-principal-component-analysis" class="section level2">
<h2>
<span class="header-section-number">3.2</span> General methods for principal component analysis<a class="anchor" aria-label="anchor" href="#general-methods-for-principal-component-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>There are two general methods to perform PCA in R :</p>
<ul>
<li>Spectral decomposition which examines the covariances / correlations between variables</li>
<li>Singular value decomposition which examines the covariances / correlations between individuals</li>
</ul>
<p>The function princomp() uses the spectral decomposition approach. The functions prcomp() and PCA()[FactoMineR] use the singular value decomposition (SVD).</p>
<div id="prcomp-and-princomp-functions" class="section level3">
<h3>
<span class="header-section-number">3.2.1</span> prcomp() and princomp() functions<a class="anchor" aria-label="anchor" href="#prcomp-and-princomp-functions"><i class="fas fa-link"></i></a>
</h3>
<p>The simplified format of these 2 functions are :</p>
<pre><code><a href="https://rdrr.io/r/stats/prcomp.html">prcomp(x, scale = FALSE)
princomp(x, cor = FALSE, scores = TRUE)</a></code></pre>
<ol style="list-style-type: decimal">
<li><p>Arguments for prcomp():<br><code>x</code>: a numeric matrix or data frame<br><code>scale</code>: a logical value indicating whether the variables should be scaled to have unit variance before the analysis takes place</p></li>
<li><p>Arguments for princomp():<br><code>x</code>: a numeric matrix or data frame <code>cor</code>: a logical value. If TRUE, the data will be centered and scaled before the analysis <code>scores</code>: a logical value. If TRUE, the coordinates on each principal component are calculated</p></li>
</ol>
</div>
<div id="loading-factoextra" class="section level3">
<h3>
<span class="header-section-number">3.2.2</span> Loading factoextra<a class="anchor" aria-label="anchor" href="#loading-factoextra"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("factoextra")</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</span></code></pre></div>
</div>
<div id="loading-the-decathlon-dataset" class="section level3">
<h3>
<span class="header-section-number">3.2.3</span> Loading the decathlon dataset<a class="anchor" aria-label="anchor" href="#loading-the-decathlon-dataset"><i class="fas fa-link"></i></a>
</h3>
<p>We’ll use the data sets <code>decathlon2</code> [in factoextra], which has been already described at: PCA - Data format.</p>
<p>Briefly, it contains:</p>
<ul>
<li>Active individuals (rows 1 to 23) and active variables (columns 1 to 10), which are used to perform the principal component analysis</li>
<li>Supplementary individuals (rows 24 to 27) and supplementary variables (columns 11 to 13), which coordinates will be predicted using the PCA information and parameters obtained with active individuals/variables.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.sthda.com/english/rpkgs/factoextra">"factoextra"</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">decathlon2</span><span class="op">)</span>
<span class="va">decathlon2.active</span> <span class="op">&lt;-</span> <span class="va">decathlon2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">23</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">decathlon2.active</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;           X100m Long.jump Shot.put High.jump X400m X110m.hurdle</span>
<span class="co">#&gt; SEBRLE     11.0      7.58     14.8      2.07  49.8         14.7</span>
<span class="co">#&gt; CLAY       10.8      7.40     14.3      1.86  49.4         14.1</span>
<span class="co">#&gt; BERNARD    11.0      7.23     14.2      1.92  48.9         15.0</span>
<span class="co">#&gt; YURKOV     11.3      7.09     15.2      2.10  50.4         15.3</span>
<span class="co">#&gt; ZSIVOCZKY  11.1      7.30     13.5      2.01  48.6         14.2</span>
<span class="co">#&gt; McMULLEN   10.8      7.31     13.8      2.13  49.9         14.4</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">decathlon2.supplementary</span> <span class="op">&lt;-</span> <span class="va">decathlon2</span><span class="op">[</span><span class="fl">24</span><span class="op">:</span><span class="fl">27</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">decathlon2.supplementary</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;         X100m Long.jump Shot.put High.jump X400m X110m.hurdle</span>
<span class="co">#&gt; KARPOV   11.0      7.30     14.8      2.04  48.4         14.1</span>
<span class="co">#&gt; WARNERS  11.1      7.60     14.3      1.98  48.7         14.2</span>
<span class="co">#&gt; Nool     10.8      7.53     14.3      1.88  48.8         14.8</span>
<span class="co">#&gt; Drews    10.9      7.38     13.1      1.88  48.5         14.0</span></code></pre></div>
</div>
</div>
<div id="compute-pca-in-r-using-prcomp" class="section level2">
<h2>
<span class="header-section-number">3.3</span> Compute PCA in R using prcomp()<a class="anchor" aria-label="anchor" href="#compute-pca-in-r-using-prcomp"><i class="fas fa-link"></i></a>
</h2>
<p>In this section we’ll provide an easy-to-use R code to compute and visualize PCA in R using the prcomp() function and the factoextra package.</p>
<p>`. Load factoextra for visualization</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>compute PCA</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># compute PCA</span>
<span class="va">res.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">decathlon2.active</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Visualize eigenvalues (scree plot). Show the percentage of variances explained by each principal component.</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Visualize eigenvalues (scree plot).</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_eig</a></span><span class="op">(</span><span class="va">res.pca</span>, addlabels <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110a-PCA-prcomp_vs_princomp_files/figure-html/unnamed-chunk-7-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>From the plot above, we might want to stop at the fifth principal component. 87% of the information (variances) contained in the data are retained by the first five principal components.</p>
</blockquote>
</div>
<div id="plots-quality-and-contribution" class="section level2">
<h2>
<span class="header-section-number">3.4</span> Plots: quality and contribution<a class="anchor" aria-label="anchor" href="#plots-quality-and-contribution"><i class="fas fa-link"></i></a>
</h2>
<ol start="4" style="list-style-type: decimal">
<li>Graph of individuals. Individuals with a similar profile are grouped together.</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Graph of individuals.</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>,
             col.ind <span class="op">=</span> <span class="st">"cos2"</span>, <span class="co"># Color by the quality of representation</span>
             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,
             repel <span class="op">=</span> <span class="cn">TRUE</span>     <span class="co"># Avoid text overlapping</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110a-PCA-prcomp_vs_princomp_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;"></div>
<ol start="5" style="list-style-type: decimal">
<li>Graph of variables. Positive correlated variables point to the same side of the plot. Negative correlated variables point to opposite sides of the graph.</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Graph of variables.</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>,
             col.var <span class="op">=</span> <span class="st">"contrib"</span>, <span class="co"># Color by contributions to the PC</span>
             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,
             repel <span class="op">=</span> <span class="cn">TRUE</span>     <span class="co"># Avoid text overlapping</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110a-PCA-prcomp_vs_princomp_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;"></div>
<ol start="6" style="list-style-type: decimal">
<li>Biplot of individuals and variables</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Biplot of individuals and variables</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_biplot</a></span><span class="op">(</span><span class="va">res.pca</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>,
                col.var <span class="op">=</span> <span class="st">"#2E9FDF"</span>, <span class="co"># Variables color</span>
                col.ind <span class="op">=</span> <span class="st">"#696969"</span>  <span class="co"># Individuals color</span>
                <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110a-PCA-prcomp_vs_princomp_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="access-to-the-pca-results" class="section level2">
<h2>
<span class="header-section-number">3.5</span> Access to the PCA results<a class="anchor" aria-label="anchor" href="#access-to-the-pca-results"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span>
<span class="co"># Eigenvalues</span>
<span class="va">eig.val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">get_eigenvalue</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="va">eig.val</span>
<span class="co">#&gt;        eigenvalue variance.percent cumulative.variance.percent</span>
<span class="co">#&gt; Dim.1       4.124            41.24                        41.2</span>
<span class="co">#&gt; Dim.2       1.839            18.39                        59.6</span>
<span class="co">#&gt; Dim.3       1.239            12.39                        72.0</span>
<span class="co">#&gt; Dim.4       0.819             8.19                        80.2</span>
<span class="co">#&gt; Dim.5       0.702             7.02                        87.2</span>
<span class="co">#&gt; Dim.6       0.423             4.23                        91.5</span>
<span class="co">#&gt; Dim.7       0.303             3.03                        94.5</span>
<span class="co">#&gt; Dim.8       0.274             2.74                        97.2</span>
<span class="co">#&gt; Dim.9       0.155             1.55                        98.8</span>
<span class="co">#&gt; Dim.10      0.122             1.22                       100.0</span>
  
<span class="co"># Results for Variables</span>
<span class="va">res.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="va">res.var</span><span class="op">$</span><span class="va">coord</span>          <span class="co"># Coordinates</span>
<span class="co">#&gt;                 Dim.1   Dim.2   Dim.3   Dim.4  Dim.5    Dim.6    Dim.7    Dim.8</span>
<span class="co">#&gt; X100m        -0.85063  0.1794 -0.3016  0.0336 -0.194  0.03537 -0.09134 -0.10472</span>
<span class="co">#&gt; Long.jump     0.79418 -0.2809  0.1905 -0.1154  0.233 -0.03373 -0.15433 -0.39738</span>
<span class="co">#&gt; Shot.put      0.73391 -0.0854 -0.5176  0.1285 -0.249 -0.23979 -0.00989  0.02436</span>
<span class="co">#&gt; High.jump     0.61008  0.4652 -0.3301  0.1446  0.403 -0.28464  0.02816  0.08441</span>
<span class="co">#&gt; X400m        -0.70160 -0.2902 -0.2835  0.4308  0.104 -0.04929  0.28611 -0.23355</span>
<span class="co">#&gt; X110m.hurdle -0.76413  0.0247 -0.4489 -0.0169  0.224  0.00263 -0.37007 -0.00834</span>
<span class="co">#&gt; Discus        0.74321 -0.0497 -0.1765  0.3950 -0.408  0.19854 -0.14273 -0.03956</span>
<span class="co">#&gt; Pole.vault   -0.21727 -0.8075 -0.0941 -0.3390 -0.222 -0.32746 -0.01039  0.03291</span>
<span class="co">#&gt; Javeline      0.42823 -0.3861 -0.6041 -0.3317  0.198  0.36210  0.13356  0.05284</span>
<span class="co">#&gt; X1500m        0.00428 -0.7845  0.2195  0.4480  0.263  0.04205 -0.11137  0.19447</span>
<span class="co">#&gt;                Dim.9   Dim.10</span>
<span class="co">#&gt; X100m        -0.3031  0.04442</span>
<span class="co">#&gt; Long.jump    -0.0516  0.02972</span>
<span class="co">#&gt; Shot.put      0.0478  0.21745</span>
<span class="co">#&gt; High.jump    -0.1121 -0.13357</span>
<span class="co">#&gt; X400m         0.0822 -0.03417</span>
<span class="co">#&gt; X110m.hurdle  0.1618 -0.01563</span>
<span class="co">#&gt; Discus        0.0134 -0.17259</span>
<span class="co">#&gt; Pole.vault   -0.0258 -0.13721</span>
<span class="co">#&gt; Javeline     -0.0405 -0.00385</span>
<span class="co">#&gt; X1500m       -0.1022  0.06283</span>
<span class="va">res.var</span><span class="op">$</span><span class="va">contrib</span>        <span class="co"># Contributions to the PCs</span>
<span class="co">#&gt;                 Dim.1   Dim.2  Dim.3   Dim.4 Dim.5    Dim.6   Dim.7   Dim.8</span>
<span class="co">#&gt; X100m        1.75e+01  1.7505  7.339  0.1376  5.39  0.29592  2.7571  3.9952</span>
<span class="co">#&gt; Long.jump    1.53e+01  4.2904  2.930  1.6249  7.75  0.26900  7.8716 57.5332</span>
<span class="co">#&gt; Shot.put     1.31e+01  0.3967 21.620  2.0141  8.82 13.59686  0.0323  0.2162</span>
<span class="co">#&gt; High.jump    9.02e+00 11.7716  8.793  2.5499 23.12 19.15961  0.2620  2.5957</span>
<span class="co">#&gt; X400m        1.19e+01  4.5799  6.488 22.6509  1.54  0.57451 27.0527 19.8734</span>
<span class="co">#&gt; X110m.hurdle 1.42e+01  0.0333 16.261  0.0348  7.17  0.00164 45.2616  0.0254</span>
<span class="co">#&gt; Discus       1.34e+01  0.1341  2.515 19.0413 23.76  9.32175  6.7323  0.5702</span>
<span class="co">#&gt; Pole.vault   1.14e+00 35.4619  0.714 14.0231  7.01 25.35762  0.0357  0.3947</span>
<span class="co">#&gt; Javeline     4.45e+00  8.1087 29.453 13.4296  5.58 31.00496  5.8957  1.0173</span>
<span class="co">#&gt; X1500m       4.44e-04 33.4729  3.887 24.4939  9.88  0.41813  4.0989 13.7787</span>
<span class="co">#&gt;               Dim.9  Dim.10</span>
<span class="co">#&gt; X100m        59.174  1.6176</span>
<span class="co">#&gt; Long.jump     1.715  0.7241</span>
<span class="co">#&gt; Shot.put      1.471 38.7677</span>
<span class="co">#&gt; High.jump     8.102 14.6265</span>
<span class="co">#&gt; X400m         4.349  0.9573</span>
<span class="co">#&gt; X110m.hurdle 16.858  0.2003</span>
<span class="co">#&gt; Discus        0.115 24.4217</span>
<span class="co">#&gt; Pole.vault    0.428 15.4356</span>
<span class="co">#&gt; Javeline      1.054  0.0122</span>
<span class="co">#&gt; X1500m        6.734  3.2370</span>
<span class="va">res.var</span><span class="op">$</span><span class="va">cos2</span>           <span class="co"># Quality of representation </span>
<span class="co">#&gt;                 Dim.1    Dim.2   Dim.3    Dim.4  Dim.5    Dim.6    Dim.7</span>
<span class="co">#&gt; X100m        7.24e-01 0.032184 0.09094 0.001127 0.0378 1.25e-03 8.34e-03</span>
<span class="co">#&gt; Long.jump    6.31e-01 0.078881 0.03631 0.013315 0.0544 1.14e-03 2.38e-02</span>
<span class="co">#&gt; Shot.put     5.39e-01 0.007294 0.26791 0.016504 0.0619 5.75e-02 9.77e-05</span>
<span class="co">#&gt; High.jump    3.72e-01 0.216424 0.10896 0.020895 0.1622 8.10e-02 7.93e-04</span>
<span class="co">#&gt; X400m        4.92e-01 0.084203 0.08039 0.185611 0.0108 2.43e-03 8.19e-02</span>
<span class="co">#&gt; X110m.hurdle 5.84e-01 0.000612 0.20150 0.000285 0.0503 6.93e-06 1.37e-01</span>
<span class="co">#&gt; Discus       5.52e-01 0.002466 0.03116 0.156032 0.1667 3.94e-02 2.04e-02</span>
<span class="co">#&gt; Pole.vault   4.72e-02 0.651977 0.00885 0.114911 0.0491 1.07e-01 1.08e-04</span>
<span class="co">#&gt; Javeline     1.83e-01 0.149080 0.36497 0.110048 0.0391 1.31e-01 1.78e-02</span>
<span class="co">#&gt; X1500m       1.83e-05 0.615409 0.04817 0.200713 0.0693 1.77e-03 1.24e-02</span>
<span class="co">#&gt;                 Dim.8    Dim.9   Dim.10</span>
<span class="co">#&gt; X100m        1.10e-02 0.091848 1.97e-03</span>
<span class="co">#&gt; Long.jump    1.58e-01 0.002661 8.83e-04</span>
<span class="co">#&gt; Shot.put     5.93e-04 0.002284 4.73e-02</span>
<span class="co">#&gt; High.jump    7.12e-03 0.012575 1.78e-02</span>
<span class="co">#&gt; X400m        5.45e-02 0.006750 1.17e-03</span>
<span class="co">#&gt; X110m.hurdle 6.96e-05 0.026166 2.44e-04</span>
<span class="co">#&gt; Discus       1.56e-03 0.000179 2.98e-02</span>
<span class="co">#&gt; Pole.vault   1.08e-03 0.000664 1.88e-02</span>
<span class="co">#&gt; Javeline     2.79e-03 0.001637 1.49e-05</span>
<span class="co">#&gt; X1500m       3.78e-02 0.010453 3.95e-03</span>
<span class="co"># Results for individuals</span>
<span class="va">res.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="va">res.ind</span><span class="op">$</span><span class="va">coord</span>          <span class="co"># Coordinates</span>
<span class="co">#&gt;              Dim.1  Dim.2  Dim.3   Dim.4     Dim.5   Dim.6   Dim.7    Dim.8</span>
<span class="co">#&gt; SEBRLE       0.191 -1.554 -0.628  0.0821  1.142614 -0.4639 -0.2080  0.04346</span>
<span class="co">#&gt; CLAY         0.790 -2.420  1.357  1.2698 -0.806848  1.3042 -0.2129  0.61724</span>
<span class="co">#&gt; BERNARD     -1.329 -1.612 -0.196 -1.9209  0.082343 -0.4006 -0.4064  0.70386</span>
<span class="co">#&gt; YURKOV      -0.869  0.433 -2.474  0.6972  0.398858  0.1029 -0.3249  0.11500</span>
<span class="co">#&gt; ZSIVOCZKY   -0.106  2.023  1.305 -0.0993 -0.197024  0.8955  0.0883 -0.20234</span>
<span class="co">#&gt; McMULLEN     0.119  0.992  0.844  1.3122  1.585871  0.1866  0.4783  0.29309</span>
<span class="co">#&gt; MARTINEAU   -2.392  1.285 -0.898  0.3731 -2.243352 -0.4567 -0.2998 -0.29163</span>
<span class="co">#&gt; HERNU       -1.891 -1.178 -0.156  0.8913 -0.126741  0.4362 -0.5661 -1.52940</span>
<span class="co">#&gt; BARRAS      -1.774  0.413  0.658  0.2287 -0.233837  0.0903  0.2159  0.68258</span>
<span class="co">#&gt; NOOL        -2.777  1.573  0.607 -1.5555  1.424184  0.4972 -0.5321 -0.43339</span>
<span class="co">#&gt; BOURGUIGNON -4.414 -1.264 -0.010  0.6668  0.419152 -0.0820 -0.5983  0.56362</span>
<span class="co">#&gt; Sebrle       3.451 -1.217 -1.678 -0.8087 -0.025053 -0.0828  0.0102 -0.03059</span>
<span class="co">#&gt; Clay         3.316 -1.623 -0.618 -0.3168  0.569165  0.7772  0.2575 -0.58064</span>
<span class="co">#&gt; Karpov       4.070  0.798  1.015  0.3134 -0.797426 -0.3296 -1.3637  0.34531</span>
<span class="co">#&gt; Macey        1.848  2.064 -0.979  0.5847 -0.000216 -0.1973 -0.2693 -0.36322</span>
<span class="co">#&gt; Warners      1.387 -0.282  2.000 -1.0196 -0.040540 -0.5567 -0.2674 -0.10947</span>
<span class="co">#&gt; Zsivoczky    0.472  0.927 -1.728 -0.1848  0.407303 -0.1138  0.0399  0.53804</span>
<span class="co">#&gt; Hernu        0.276  1.166  0.171 -0.8487 -0.689480 -0.3317  0.4431  0.24729</span>
<span class="co">#&gt; Bernard      1.367  1.478  0.831  0.7453  0.859802 -0.3281  0.3636  0.00617</span>
<span class="co">#&gt; Schwarzl    -0.710 -0.658  1.041 -0.9272 -0.288757 -0.6889  0.5657 -0.68705</span>
<span class="co">#&gt; Pogorelov   -0.214 -0.861  0.298  1.3556 -0.015053 -1.5938  0.7837 -0.03762</span>
<span class="co">#&gt; Schoenbeck  -0.495 -1.300  0.103 -0.2493 -0.645226  0.1617  0.8575 -0.25585</span>
<span class="co">#&gt; Barras      -0.316  0.819 -0.862 -0.5894 -0.779739  1.1742  0.9451  0.36555</span>
<span class="co">#&gt;                Dim.9  Dim.10</span>
<span class="co">#&gt; SEBRLE      -0.65934  0.0327</span>
<span class="co">#&gt; CLAY        -0.06013 -0.3172</span>
<span class="co">#&gt; BERNARD      0.17008 -0.0991</span>
<span class="co">#&gt; YURKOV      -0.10952 -0.1197</span>
<span class="co">#&gt; ZSIVOCZKY   -0.52310 -0.3484</span>
<span class="co">#&gt; McMULLEN    -0.10562 -0.3932</span>
<span class="co">#&gt; MARTINEAU   -0.22342 -0.6164</span>
<span class="co">#&gt; HERNU        0.00618  0.5537</span>
<span class="co">#&gt; BARRAS      -0.66928  0.5309</span>
<span class="co">#&gt; NOOL        -0.11578 -0.0962</span>
<span class="co">#&gt; BOURGUIGNON  0.52581  0.0586</span>
<span class="co">#&gt; Sebrle      -0.84721  0.2197</span>
<span class="co">#&gt; Clay         0.40978 -0.6160</span>
<span class="co">#&gt; Karpov       0.19306  0.2172</span>
<span class="co">#&gt; Macey        0.36826  0.2125</span>
<span class="co">#&gt; Warners      0.18028  0.2421</span>
<span class="co">#&gt; Zsivoczky    0.58597 -0.1427</span>
<span class="co">#&gt; Hernu        0.06691 -0.2087</span>
<span class="co">#&gt; Bernard      0.27949  0.3207</span>
<span class="co">#&gt; Schwarzl    -0.00836 -0.3021</span>
<span class="co">#&gt; Pogorelov   -0.13053 -0.0370</span>
<span class="co">#&gt; Schoenbeck   0.56422  0.2968</span>
<span class="co">#&gt; Barras       0.10226  0.6119</span>
<span class="va">res.ind</span><span class="op">$</span><span class="va">contrib</span>        <span class="co"># Contributions to the PCs</span>
<span class="co">#&gt;               Dim.1  Dim.2    Dim.3   Dim.4    Dim.5   Dim.6    Dim.7    Dim.8</span>
<span class="co">#&gt; SEBRLE       0.0385  5.712 1.39e+00  0.0357 8.09e+00  2.2126  0.62143 2.99e-02</span>
<span class="co">#&gt; CLAY         0.6581 13.854 6.46e+00  8.5557 4.03e+00 17.4880  0.65141 6.04e+00</span>
<span class="co">#&gt; BERNARD      1.8627  6.144 1.35e-01 19.5783 4.20e-02  1.6502  2.37365 7.85e+00</span>
<span class="co">#&gt; YURKOV       0.7969  0.443 2.15e+01  2.5794 9.86e-01  0.1088  1.51656 2.09e-01</span>
<span class="co">#&gt; ZSIVOCZKY    0.0118  9.682 5.97e+00  0.0523 2.41e-01  8.2456  0.11192 6.49e-01</span>
<span class="co">#&gt; McMULLEN     0.0148  2.325 2.50e+00  9.1353 1.56e+01  0.3579  3.28702 1.36e+00</span>
<span class="co">#&gt; MARTINEAU    6.0337  3.904 2.83e+00  0.7386 3.12e+01  2.1441  1.29111 1.35e+00</span>
<span class="co">#&gt; HERNU        3.7700  3.284 8.58e-02  4.2151 9.96e-02  1.9566  4.60485 3.71e+01</span>
<span class="co">#&gt; BARRAS       3.3194  0.402 1.52e+00  0.2776 3.39e-01  0.0838  0.67004 7.38e+00</span>
<span class="co">#&gt; NOOL         8.1299  5.849 1.29e+00 12.8376 1.26e+01  2.5413  4.06767 2.98e+00</span>
<span class="co">#&gt; BOURGUIGNON 20.5373  3.776 3.53e-04  2.3588 1.09e+00  0.0691  5.14425 5.03e+00</span>
<span class="co">#&gt; Sebrle      12.5584  3.502 9.88e+00  3.4701 3.89e-03  0.0705  0.00148 1.48e-02</span>
<span class="co">#&gt; Clay        11.5936  6.232 1.34e+00  0.5325 2.01e+00  6.2097  0.95282 5.34e+00</span>
<span class="co">#&gt; Karpov      17.4661  1.507 3.61e+00  0.5210 3.94e+00  1.1168 26.72016 1.89e+00</span>
<span class="co">#&gt; Macey        3.6021 10.073 3.36e+00  1.8139 2.89e-07  0.4001  1.04191 2.09e+00</span>
<span class="co">#&gt; Warners      2.0291  0.188 1.40e+01  5.5159 1.02e-02  3.1867  1.02738 1.90e-01</span>
<span class="co">#&gt; Zsivoczky    0.2344  2.031 1.05e+01  0.1813 1.03e+00  0.1332  0.02289 4.59e+00</span>
<span class="co">#&gt; Hernu        0.0805  3.214 1.02e-01  3.8217 2.95e+00  1.1311  2.82103 9.69e-01</span>
<span class="co">#&gt; Bernard      1.9708  5.166 2.43e+00  2.9474 4.58e+00  1.1066  1.89945 6.02e-04</span>
<span class="co">#&gt; Schwarzl     0.5318  1.025 3.80e+00  4.5612 5.17e-01  4.8796  4.59812 7.48e+00</span>
<span class="co">#&gt; Pogorelov    0.0484  1.753 3.11e-01  9.7503 1.40e-03 26.1167  8.82532 2.24e-02</span>
<span class="co">#&gt; Schoenbeck   0.2586  3.997 3.72e-02  0.3297 2.58e+00  0.2689 10.56627 1.04e+00</span>
<span class="co">#&gt; Barras       0.1052  1.588 2.61e+00  1.8430 3.77e+00 14.1743 12.83542 2.12e+00</span>
<span class="co">#&gt;                Dim.9  Dim.10</span>
<span class="co">#&gt; SEBRLE      12.17748  0.0382</span>
<span class="co">#&gt; CLAY         0.10126  3.5857</span>
<span class="co">#&gt; BERNARD      0.81032  0.3499</span>
<span class="co">#&gt; YURKOV       0.33601  0.5107</span>
<span class="co">#&gt; ZSIVOCZKY    7.66492  4.3274</span>
<span class="co">#&gt; McMULLEN     0.31250  5.5105</span>
<span class="co">#&gt; MARTINEAU    1.39820 13.5440</span>
<span class="co">#&gt; HERNU        0.00107 10.9278</span>
<span class="co">#&gt; BARRAS      12.54733 10.0454</span>
<span class="co">#&gt; NOOL         0.37548  0.3300</span>
<span class="co">#&gt; BOURGUIGNON  7.74457  0.1222</span>
<span class="co">#&gt; Sebrle      20.10555  1.7206</span>
<span class="co">#&gt; Clay         4.70357 13.5271</span>
<span class="co">#&gt; Karpov       1.04399  1.6819</span>
<span class="co">#&gt; Macey        3.79877  1.6096</span>
<span class="co">#&gt; Warners      0.91042  2.0890</span>
<span class="co">#&gt; Zsivoczky    9.61785  0.7261</span>
<span class="co">#&gt; Hernu        0.12540  1.5523</span>
<span class="co">#&gt; Bernard      2.18807  3.6657</span>
<span class="co">#&gt; Schwarzl     0.00196  3.2536</span>
<span class="co">#&gt; Pogorelov    0.47727  0.0487</span>
<span class="co">#&gt; Schoenbeck   8.91730  3.1402</span>
<span class="co">#&gt; Barras       0.29289 13.3453</span>
<span class="va">res.ind</span><span class="op">$</span><span class="va">cos2</span>           <span class="co"># Quality of representation </span>
<span class="co">#&gt;               Dim.1  Dim.2    Dim.3   Dim.4    Dim.5    Dim.6    Dim.7    Dim.8</span>
<span class="co">#&gt; SEBRLE      0.00753 0.4975 8.13e-02 0.00139 2.69e-01 0.044324 8.91e-03 3.89e-04</span>
<span class="co">#&gt; CLAY        0.04870 0.4570 1.44e-01 0.12579 5.08e-02 0.132691 3.54e-03 2.97e-02</span>
<span class="co">#&gt; BERNARD     0.19720 0.2900 4.29e-03 0.41182 7.57e-04 0.017913 1.84e-02 5.53e-02</span>
<span class="co">#&gt; YURKOV      0.09611 0.0238 7.78e-01 0.06181 2.02e-02 0.001345 1.34e-02 1.68e-03</span>
<span class="co">#&gt; ZSIVOCZKY   0.00157 0.5764 2.40e-01 0.00139 5.47e-03 0.112918 1.10e-03 5.76e-03</span>
<span class="co">#&gt; McMULLEN    0.00218 0.1522 1.10e-01 0.26649 3.89e-01 0.005388 3.54e-02 1.33e-02</span>
<span class="co">#&gt; MARTINEAU   0.40401 0.1165 5.69e-02 0.00983 3.55e-01 0.014721 6.34e-03 6.00e-03</span>
<span class="co">#&gt; HERNU       0.39928 0.1551 2.73e-03 0.08870 1.79e-03 0.021248 3.58e-02 2.61e-01</span>
<span class="co">#&gt; BARRAS      0.61624 0.0333 8.48e-02 0.01024 1.07e-02 0.001594 9.13e-03 9.12e-02</span>
<span class="co">#&gt; NOOL        0.48987 0.1571 2.34e-02 0.15369 1.29e-01 0.015701 1.80e-02 1.19e-02</span>
<span class="co">#&gt; BOURGUIGNON 0.85970 0.0705 4.45e-06 0.01962 7.75e-03 0.000297 1.58e-02 1.40e-02</span>
<span class="co">#&gt; Sebrle      0.67538 0.0840 1.60e-01 0.03708 3.56e-05 0.000389 5.85e-06 5.30e-05</span>
<span class="co">#&gt; Clay        0.68759 0.1648 2.39e-02 0.00627 2.03e-02 0.037763 4.15e-03 2.11e-02</span>
<span class="co">#&gt; Karpov      0.78367 0.0301 4.87e-02 0.00464 3.01e-02 0.005138 8.80e-02 5.64e-03</span>
<span class="co">#&gt; Macey       0.36344 0.4531 1.02e-01 0.03636 4.95e-09 0.004140 7.71e-03 1.40e-02</span>
<span class="co">#&gt; Warners     0.25565 0.0106 5.31e-01 0.13808 2.18e-04 0.041169 9.50e-03 1.59e-03</span>
<span class="co">#&gt; Zsivoczky   0.04505 0.1740 6.05e-01 0.00692 3.36e-02 0.002625 3.23e-04 5.87e-02</span>
<span class="co">#&gt; Hernu       0.02482 0.4418 9.46e-03 0.23420 1.55e-01 0.035771 6.38e-02 1.99e-02</span>
<span class="co">#&gt; Bernard     0.28935 0.3381 1.07e-01 0.08598 1.14e-01 0.016659 2.05e-02 5.88e-06</span>
<span class="co">#&gt; Schwarzl    0.11672 0.1003 2.51e-01 0.19889 1.93e-02 0.109806 7.40e-02 1.09e-01</span>
<span class="co">#&gt; Pogorelov   0.00780 0.1259 1.50e-02 0.31210 3.85e-05 0.431416 1.04e-01 2.40e-04</span>
<span class="co">#&gt; Schoenbeck  0.06707 0.4620 2.90e-03 0.01699 1.14e-01 0.007150 2.01e-01 1.79e-02</span>
<span class="co">#&gt; Barras      0.01897 0.1277 1.41e-01 0.06604 1.16e-01 0.262130 1.70e-01 2.54e-02</span>
<span class="co">#&gt;                Dim.9   Dim.10</span>
<span class="co">#&gt; SEBRLE      8.95e-02 0.000221</span>
<span class="co">#&gt; CLAY        2.82e-04 0.007847</span>
<span class="co">#&gt; BERNARD     3.23e-03 0.001096</span>
<span class="co">#&gt; YURKOV      1.53e-03 0.001822</span>
<span class="co">#&gt; ZSIVOCZKY   3.85e-02 0.017092</span>
<span class="co">#&gt; McMULLEN    1.73e-03 0.023927</span>
<span class="co">#&gt; MARTINEAU   3.52e-03 0.026821</span>
<span class="co">#&gt; HERNU       4.27e-06 0.034229</span>
<span class="co">#&gt; BARRAS      8.77e-02 0.055153</span>
<span class="co">#&gt; NOOL        8.51e-04 0.000588</span>
<span class="co">#&gt; BOURGUIGNON 1.22e-02 0.000151</span>
<span class="co">#&gt; Sebrle      4.07e-02 0.002737</span>
<span class="co">#&gt; Clay        1.05e-02 0.023726</span>
<span class="co">#&gt; Karpov      1.76e-03 0.002232</span>
<span class="co">#&gt; Macey       1.44e-02 0.004803</span>
<span class="co">#&gt; Warners     4.32e-03 0.007784</span>
<span class="co">#&gt; Zsivoczky   6.96e-02 0.004127</span>
<span class="co">#&gt; Hernu       1.46e-03 0.014160</span>
<span class="co">#&gt; Bernard     1.21e-02 0.015917</span>
<span class="co">#&gt; Schwarzl    1.62e-05 0.021117</span>
<span class="co">#&gt; Pogorelov   2.89e-03 0.000232</span>
<span class="co">#&gt; Schoenbeck  8.70e-02 0.024083</span>
<span class="co">#&gt; Barras      1.99e-03 0.071184</span></code></pre></div>
</div>
<div id="predict-using-pca" class="section level2">
<h2>
<span class="header-section-number">3.6</span> Predict using PCA<a class="anchor" aria-label="anchor" href="#predict-using-pca"><i class="fas fa-link"></i></a>
</h2>
<p>In this section, we’ll show how to predict the coordinates of supplementary individuals and variables using only the information provided by the previously performed PCA.</p>
<ol style="list-style-type: decimal">
<li>Data: rows 24 to 27 and columns 1 to to 10 [in decathlon2 data sets]. The new data must contain columns (variables) with the same names and in the same order as the active data used to compute PCA.</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Data for the supplementary individuals</span>
<span class="va">ind.sup</span> <span class="op">&lt;-</span> <span class="va">decathlon2</span><span class="op">[</span><span class="fl">24</span><span class="op">:</span><span class="fl">27</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="va">ind.sup</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>
<span class="co">#&gt;         X100m Long.jump Shot.put High.jump X400m X110m.hurdle</span>
<span class="co">#&gt; KARPOV   11.0      7.30     14.8      2.04  48.4         14.1</span>
<span class="co">#&gt; WARNERS  11.1      7.60     14.3      1.98  48.7         14.2</span>
<span class="co">#&gt; Nool     10.8      7.53     14.3      1.88  48.8         14.8</span>
<span class="co">#&gt; Drews    10.9      7.38     13.1      1.88  48.5         14.0</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Predict the coordinates of new individuals data. Use the R base function predict():</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ind.sup.coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">res.pca</span>, newdata <span class="op">=</span> <span class="va">ind.sup</span><span class="op">)</span>
<span class="va">ind.sup.coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>
<span class="co">#&gt;            PC1    PC2   PC3    PC4</span>
<span class="co">#&gt; KARPOV   0.777 -0.762 1.597  1.686</span>
<span class="co">#&gt; WARNERS -0.378  0.119 1.701 -0.691</span>
<span class="co">#&gt; Nool    -0.547 -1.934 0.472 -2.228</span>
<span class="co">#&gt; Drews   -1.085 -0.017 2.982 -1.501</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Graph of individuals including the supplementary individuals:</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot of active individuals</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>, repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># Add supplementary individuals</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_add.html">fviz_add</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">ind.sup.coord</span>, color <span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110a-PCA-prcomp_vs_princomp_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>The predicted coordinates of individuals can be manually calculated as follow:</p>
<ol style="list-style-type: decimal">
<li>Center and scale the new individuals data using the center and the scale of the PCA</li>
<li>Calculate the predicted coordinates by multiplying the scaled values with the eigenvectors (loadings) of the principal components. The R code below can be used :</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Centering and scaling the supplementary individuals</span>
<span class="va">ind.scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">ind.sup</span>, 
                    center <span class="op">=</span> <span class="va">res.pca</span><span class="op">$</span><span class="va">center</span>,
                    scale <span class="op">=</span> <span class="va">res.pca</span><span class="op">$</span><span class="va">scale</span><span class="op">)</span>
<span class="co"># Coordinates of the individividuals</span>
<span class="va">coord_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ind</span>, <span class="va">loadings</span><span class="op">)</span><span class="op">{</span>
  <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">loadings</span><span class="op">*</span><span class="va">ind</span>
  <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">r</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">pca.loadings</span> <span class="op">&lt;-</span> <span class="va">res.pca</span><span class="op">$</span><span class="va">rotation</span>
<span class="va">ind.sup.coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ind.scaled</span>, <span class="fl">1</span>, <span class="va">coord_func</span>, <span class="va">pca.loadings</span> <span class="op">)</span><span class="op">)</span>
<span class="va">ind.sup.coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>
<span class="co">#&gt;            PC1    PC2   PC3    PC4</span>
<span class="co">#&gt; KARPOV   0.777 -0.762 1.597  1.686</span>
<span class="co">#&gt; WARNERS -0.378  0.119 1.701 -0.691</span>
<span class="co">#&gt; Nool    -0.547 -1.934 0.472 -2.228</span>
<span class="co">#&gt; Drews   -1.085 -0.017 2.982 -1.501</span></code></pre></div>
</div>
<div id="supplementary-variables" class="section level2">
<h2>
<span class="header-section-number">3.7</span> Supplementary variables<a class="anchor" aria-label="anchor" href="#supplementary-variables"><i class="fas fa-link"></i></a>
</h2>
<div id="qualitative-categorical-variables" class="section level3">
<h3>
<span class="header-section-number">3.7.1</span> Qualitative / categorical variables<a class="anchor" aria-label="anchor" href="#qualitative-categorical-variables"><i class="fas fa-link"></i></a>
</h3>
<p>The data sets decathlon2 contain a supplementary qualitative variable at columns 13 corresponding to the type of competitions.</p>
<p>Qualitative / categorical variables can be used to color individuals by groups. The grouping variable should be of same length as the number of active individuals (here 23).</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">decathlon2</span><span class="op">$</span><span class="va">Competition</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">23</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>,
             col.ind <span class="op">=</span> <span class="va">groups</span>, <span class="co"># color by groups</span>
             palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>,  <span class="st">"#FC4E07"</span><span class="op">)</span>,
             addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Concentration ellipses</span>
             ellipse.type <span class="op">=</span> <span class="st">"confidence"</span>,
             legend.title <span class="op">=</span> <span class="st">"Groups"</span>,
             repel <span class="op">=</span> <span class="cn">TRUE</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110a-PCA-prcomp_vs_princomp_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Calculate the coordinates for the levels of grouping variables. The coordinates for a given group is calculated as the mean coordinates of the individuals in the group.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">magrittr</span><span class="op">)</span> <span class="co"># for pipe %&gt;%</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>   <span class="co"># everything else</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>

<span class="co"># 1. Individual coordinates</span>
<span class="va">res.ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="co"># 2. Coordinate of groups</span>
<span class="va">coord.groups</span> <span class="op">&lt;-</span> <span class="va">res.ind</span><span class="op">$</span><span class="va">coord</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/deprecated.html">as_data_frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Dim.1</span>, <span class="va">Dim.2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>competition <span class="op">=</span> <span class="va">groups</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">competition</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>
    Dim.1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dim.1</span><span class="op">)</span>,
    Dim.2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Dim.2</span><span class="op">)</span>
    <span class="op">)</span>
<span class="co">#&gt; Warning: `as_data_frame()` is deprecated as of tibble 2.0.0.</span>
<span class="co">#&gt; Please use `as_tibble()` instead.</span>
<span class="co">#&gt; The signature and semantics have changed, see `?as_tibble`.</span>
<span class="co">#&gt; This warning is displayed once every 8 hours.</span>
<span class="co">#&gt; Call `lifecycle::last_warnings()` to see where this warning was generated.</span>
<span class="va">coord.groups</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   competition Dim.1  Dim.2</span>
<span class="co">#&gt;   &lt;fct&gt;       &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Decastar    -1.31 -0.119</span>
<span class="co">#&gt; 2 OlympicG     1.20  0.109</span></code></pre></div>
</div>
<div id="quantitative-variables" class="section level3">
<h3>
<span class="header-section-number">3.7.2</span> Quantitative variables<a class="anchor" aria-label="anchor" href="#quantitative-variables"><i class="fas fa-link"></i></a>
</h3>
<p>Data: columns 11:12. Should be of same length as the number of active individuals (here 23)</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">quanti.sup</span> <span class="op">&lt;-</span> <span class="va">decathlon2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">23</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">12</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">quanti.sup</span><span class="op">)</span>
<span class="co">#&gt;           Rank Points</span>
<span class="co">#&gt; SEBRLE       1   8217</span>
<span class="co">#&gt; CLAY         2   8122</span>
<span class="co">#&gt; BERNARD      4   8067</span>
<span class="co">#&gt; YURKOV       5   8036</span>
<span class="co">#&gt; ZSIVOCZKY    7   8004</span>
<span class="co">#&gt; McMULLEN     8   7995</span></code></pre></div>
<p>The coordinates of a given quantitative variable are calculated as the correlation between the quantitative variables and the principal components.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Predict coordinates and compute cos2</span>
<span class="va">quanti.coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">quanti.sup</span>, <span class="va">res.pca</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
<span class="va">quanti.cos2</span> <span class="op">&lt;-</span> <span class="va">quanti.coord</span><span class="op">^</span><span class="fl">2</span>
<span class="co"># Graph of variables including supplementary variables</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_add.html">fviz_add</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">quanti.coord</span>, color <span class="op">=</span><span class="st">"blue"</span>, geom<span class="op">=</span><span class="st">"arrow"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110a-PCA-prcomp_vs_princomp_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="theory-behind-pca-results" class="section level2">
<h2>
<span class="header-section-number">3.8</span> Theory behind PCA results<a class="anchor" aria-label="anchor" href="#theory-behind-pca-results"><i class="fas fa-link"></i></a>
</h2>
<div id="pca-results-for-variables" class="section level3">
<h3>
<span class="header-section-number">3.8.1</span> PCA results for variables<a class="anchor" aria-label="anchor" href="#pca-results-for-variables"><i class="fas fa-link"></i></a>
</h3>
<p>Here we’ll show how to calculate the PCA results for variables: coordinates, cos2 and contributions:</p>
<p><code>var.coord</code> = loadings * the component standard deviations <code>var.cos2</code> = var.coord^2 <code>var.contrib</code>. The contribution of a variable to a given principal component is (in percentage) : (var.cos2 * 100) / (total cos2 of the component)</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Helper function </span>
<span class="co">#::::::::::::::::::::::::::::::::::::::::</span>
<span class="va">var_coord_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">loadings</span>, <span class="va">comp.sdev</span><span class="op">)</span><span class="op">{</span>
  <span class="va">loadings</span><span class="op">*</span><span class="va">comp.sdev</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute Coordinates</span>
<span class="co">#::::::::::::::::::::::::::::::::::::::::</span>
<span class="va">loadings</span> <span class="op">&lt;-</span> <span class="va">res.pca</span><span class="op">$</span><span class="va">rotation</span>
<span class="va">sdev</span> <span class="op">&lt;-</span> <span class="va">res.pca</span><span class="op">$</span><span class="va">sdev</span>
<span class="va">var.coord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">loadings</span>, <span class="fl">1</span>, <span class="va">var_coord_func</span>, <span class="va">sdev</span><span class="op">)</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">var.coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;                 PC1     PC2    PC3     PC4</span>
<span class="co">#&gt; X100m        -0.851  0.1794 -0.302  0.0336</span>
<span class="co">#&gt; Long.jump     0.794 -0.2809  0.191 -0.1154</span>
<span class="co">#&gt; Shot.put      0.734 -0.0854 -0.518  0.1285</span>
<span class="co">#&gt; High.jump     0.610  0.4652 -0.330  0.1446</span>
<span class="co">#&gt; X400m        -0.702 -0.2902 -0.284  0.4308</span>
<span class="co">#&gt; X110m.hurdle -0.764  0.0247 -0.449 -0.0169</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute Cos2</span>
<span class="co">#::::::::::::::::::::::::::::::::::::::::</span>
<span class="va">var.cos2</span> <span class="op">&lt;-</span> <span class="va">var.coord</span><span class="op">^</span><span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">var.cos2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;                PC1      PC2    PC3      PC4</span>
<span class="co">#&gt; X100m        0.724 0.032184 0.0909 0.001127</span>
<span class="co">#&gt; Long.jump    0.631 0.078881 0.0363 0.013315</span>
<span class="co">#&gt; Shot.put     0.539 0.007294 0.2679 0.016504</span>
<span class="co">#&gt; High.jump    0.372 0.216424 0.1090 0.020895</span>
<span class="co">#&gt; X400m        0.492 0.084203 0.0804 0.185611</span>
<span class="co">#&gt; X110m.hurdle 0.584 0.000612 0.2015 0.000285</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute contributions</span>
<span class="co">#::::::::::::::::::::::::::::::::::::::::</span>
<span class="va">comp.cos2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">var.cos2</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span>
<span class="va">contrib</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">var.cos2</span>, <span class="va">comp.cos2</span><span class="op">)</span><span class="op">{</span><span class="va">var.cos2</span><span class="op">*</span><span class="fl">100</span><span class="op">/</span><span class="va">comp.cos2</span><span class="op">}</span>
<span class="va">var.contrib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">var.cos2</span>,<span class="fl">1</span>, <span class="va">contrib</span>, <span class="va">comp.cos2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">var.contrib</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;                PC1     PC2   PC3     PC4</span>
<span class="co">#&gt; X100m        17.54  1.7505  7.34  0.1376</span>
<span class="co">#&gt; Long.jump    15.29  4.2904  2.93  1.6249</span>
<span class="co">#&gt; Shot.put     13.06  0.3967 21.62  2.0141</span>
<span class="co">#&gt; High.jump     9.02 11.7716  8.79  2.5499</span>
<span class="co">#&gt; X400m        11.94  4.5799  6.49 22.6509</span>
<span class="co">#&gt; X110m.hurdle 14.16  0.0333 16.26  0.0348</span></code></pre></div>
</div>
<div id="pca-results-for-individuals" class="section level3">
<h3>
<span class="header-section-number">3.8.2</span> PCA results for individuals<a class="anchor" aria-label="anchor" href="#pca-results-for-individuals"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p><code>ind.coord</code> = res.pca$x</p></li>
<li>
<p>Cos2 of individuals. Two steps:</p>
<ul>
<li>Calculate the square distance between each individual and the PCA center of gravity: d2 = [(var1_ind_i - mean_var1)/sd_var1]^2 + …+ [(var10_ind_i - mean_var10)/sd_var10]^2 + …+..</li>
<li>Calculate the cos2 as ind.coord^2/d2</li>
</ul>
</li>
<li><p>Contributions of individuals to the principal components: 100 * (1 / number_of_individuals)*(ind.coord^2 / comp_sdev^2). Note that the sum of all the contributions per column is 100</p></li>
</ul>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Coordinates of individuals</span>
<span class="co">#::::::::::::::::::::::::::::::::::</span>
<span class="va">ind.coord</span> <span class="op">&lt;-</span> <span class="va">res.pca</span><span class="op">$</span><span class="va">x</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ind.coord</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;              PC1    PC2    PC3     PC4</span>
<span class="co">#&gt; SEBRLE     0.191 -1.554 -0.628  0.0821</span>
<span class="co">#&gt; CLAY       0.790 -2.420  1.357  1.2698</span>
<span class="co">#&gt; BERNARD   -1.329 -1.612 -0.196 -1.9209</span>
<span class="co">#&gt; YURKOV    -0.869  0.433 -2.474  0.6972</span>
<span class="co">#&gt; ZSIVOCZKY -0.106  2.023  1.305 -0.0993</span>
<span class="co">#&gt; McMULLEN   0.119  0.992  0.844  1.3122</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Cos2 of individuals</span>
<span class="co">#:::::::::::::::::::::::::::::::::</span>
<span class="co"># 1. square of the distance between an individual and the</span>
<span class="co"># PCA center of gravity</span>
<span class="va">center</span> <span class="op">&lt;-</span> <span class="va">res.pca</span><span class="op">$</span><span class="va">center</span>
<span class="va">scale</span><span class="op">&lt;-</span> <span class="va">res.pca</span><span class="op">$</span><span class="va">scale</span>

<span class="va">getdistance</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ind_row</span>, <span class="va">center</span>, <span class="va">scale</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">ind_row</span><span class="op">-</span><span class="va">center</span><span class="op">)</span><span class="op">/</span><span class="va">scale</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">decathlon2.active</span>,<span class="fl">1</span>, <span class="va">getdistance</span>, <span class="va">center</span>, <span class="va">scale</span><span class="op">)</span>
<span class="co"># 2. Compute the cos2. The sum of each row is 1</span>
<span class="va">cos2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ind.coord</span>, <span class="va">d2</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">ind.coord</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">d2</span><span class="op">)</span><span class="op">}</span>
<span class="va">ind.cos2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ind.coord</span>, <span class="fl">2</span>, <span class="va">cos2</span>, <span class="va">d2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ind.cos2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;               PC1    PC2     PC3     PC4</span>
<span class="co">#&gt; SEBRLE    0.00753 0.4975 0.08133 0.00139</span>
<span class="co">#&gt; CLAY      0.04870 0.4570 0.14363 0.12579</span>
<span class="co">#&gt; BERNARD   0.19720 0.2900 0.00429 0.41182</span>
<span class="co">#&gt; YURKOV    0.09611 0.0238 0.77823 0.06181</span>
<span class="co">#&gt; ZSIVOCZKY 0.00157 0.5764 0.23975 0.00139</span>
<span class="co">#&gt; McMULLEN  0.00218 0.1522 0.11014 0.26649</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Contributions of individuals</span>
<span class="co">#:::::::::::::::::::::::::::::::</span>
<span class="va">contrib</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ind.coord</span>, <span class="va">comp.sdev</span>, <span class="va">n.ind</span><span class="op">)</span><span class="op">{</span>
  <span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n.ind</span><span class="op">)</span><span class="op">*</span><span class="va">ind.coord</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">comp.sdev</span><span class="op">^</span><span class="fl">2</span>
<span class="op">}</span>
<span class="va">ind.contrib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ind.coord</span>, <span class="fl">1</span>, <span class="va">contrib</span>, 
                       <span class="va">res.pca</span><span class="op">$</span><span class="va">sdev</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ind.coord</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ind.contrib</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;              PC1    PC2    PC3     PC4</span>
<span class="co">#&gt; SEBRLE    0.0385  5.712  1.385  0.0357</span>
<span class="co">#&gt; CLAY      0.6581 13.854  6.460  8.5557</span>
<span class="co">#&gt; BERNARD   1.8627  6.144  0.135 19.5783</span>
<span class="co">#&gt; YURKOV    0.7969  0.443 21.476  2.5794</span>
<span class="co">#&gt; ZSIVOCZKY 0.0118  9.682  5.975  0.0523</span>
<span class="co">#&gt; McMULLEN  0.0148  2.325  2.497  9.1353</span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="introduction-to-pca.html"><span class="header-section-number">2</span> Introduction to PCA</a></div>
<div class="next"><a href="detailed-study-of-principal-component-analysis.html"><span class="header-section-number">4</span> Detailed study of Principal Component Analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#comparison-of-two-pca-packages"><span class="header-section-number">3</span> Comparison of two PCA packages</a></li>
<li><a class="nav-link" href="#prcomp-vs-princomp"><span class="header-section-number">3.1</span> prcomp vs princomp</a></li>
<li>
<a class="nav-link" href="#general-methods-for-principal-component-analysis"><span class="header-section-number">3.2</span> General methods for principal component analysis</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#prcomp-and-princomp-functions"><span class="header-section-number">3.2.1</span> prcomp() and princomp() functions</a></li>
<li><a class="nav-link" href="#loading-factoextra"><span class="header-section-number">3.2.2</span> Loading factoextra</a></li>
<li><a class="nav-link" href="#loading-the-decathlon-dataset"><span class="header-section-number">3.2.3</span> Loading the decathlon dataset</a></li>
</ul>
</li>
<li><a class="nav-link" href="#compute-pca-in-r-using-prcomp"><span class="header-section-number">3.3</span> Compute PCA in R using prcomp()</a></li>
<li><a class="nav-link" href="#plots-quality-and-contribution"><span class="header-section-number">3.4</span> Plots: quality and contribution</a></li>
<li><a class="nav-link" href="#access-to-the-pca-results"><span class="header-section-number">3.5</span> Access to the PCA results</a></li>
<li><a class="nav-link" href="#predict-using-pca"><span class="header-section-number">3.6</span> Predict using PCA</a></li>
<li>
<a class="nav-link" href="#supplementary-variables"><span class="header-section-number">3.7</span> Supplementary variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#qualitative-categorical-variables"><span class="header-section-number">3.7.1</span> Qualitative / categorical variables</a></li>
<li><a class="nav-link" href="#quantitative-variables"><span class="header-section-number">3.7.2</span> Quantitative variables</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#theory-behind-pca-results"><span class="header-section-number">3.8</span> Theory behind PCA results</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pca-results-for-variables"><span class="header-section-number">3.8.1</span> PCA results for variables</a></li>
<li><a class="nav-link" href="#pca-results-for-individuals"><span class="header-section-number">3.8.2</span> PCA results for individuals</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/f0nzie/machine_learning_compilation/blob/master/001-meta_110a-PCA-prcomp_vs_princomp.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/f0nzie/machine_learning_compilation/edit/master/001-meta_110a-PCA-prcomp_vs_princomp.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Machine Learning Compilation</strong>" was written by Several authors. Compiled by Alfonso R. Reyes. It was last built on 2020-11-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
