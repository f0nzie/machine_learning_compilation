<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 46 Deep Learning tips for Classification and Regression | A Machine Learning Compilation</title>
<meta name="author" content="Several authors. Compiled by Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Machine Learning Compilation</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li class="book-part">The Basics of Machine Learning</li>
<li><a class="" href="introduction-to-pca.html"><span class="header-section-number">2</span> Introduction to PCA</a></li>
<li><a class="" href="comparison-of-two-pca-packages.html"><span class="header-section-number">3</span> Comparison of two PCA packages</a></li>
<li><a class="" href="detailed-study-of-principal-component-analysis.html"><span class="header-section-number">4</span> Detailed study of Principal Component Analysis</a></li>
<li><a class="" href="detection-of-diabetes-using-logistic-regression.html"><span class="header-section-number">5</span> Detection of diabetes using Logistic Regression</a></li>
<li><a class="" href="sensitivity-analysis-for-a-neural-network.html"><span class="header-section-number">6</span> Sensitivity analysis for a neural network</a></li>
<li><a class="" href="data-visualization-for-ml-models.html"><span class="header-section-number">7</span> Data Visualization for ML models</a></li>
<li class="book-part">Feature Engineering</li>
<li><a class="" href="ten-methods-to-assess-variable-importance.html"><span class="header-section-number">8</span> Ten methods to assess Variable Importance</a></li>
<li><a class="" href="employee-attrition-using-feature-importance.html"><span class="header-section-number">9</span> Employee Attrition using Feature Importance</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="a-gentle-introduction-to-support-vector-machines.html"><span class="header-section-number">10</span> A gentle introduction to Support Vector Machines</a></li>
<li><a class="" href="broad-view-of-svm.html"><span class="header-section-number">11</span> Broad view of SVM</a></li>
<li><a class="" href="feature-selection-to-enhance-cancer-detection.html"><span class="header-section-number">12</span> Feature Selection to enhance cancer detection</a></li>
<li><a class="" href="dealing-with-unbalanced-data.html"><span class="header-section-number">13</span> Dealing with unbalanced data</a></li>
<li><a class="" href="imputting-missing-values-with-random-forest.html"><span class="header-section-number">14</span> Imputting missing values with Random Forest</a></li>
<li><a class="" href="tuning-of-support-vector-machine-prediction.html"><span class="header-section-number">15</span> Tuning of Support Vector Machine prediction</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="introduction-to-algorithms-for-classification.html"><span class="header-section-number">16</span> Introduction to algorithms for Classification</a></li>
<li><a class="" href="comparing-classification-algorithms.html"><span class="header-section-number">17</span> Comparing Classification algorithms</a></li>
<li><a class="" href="who-buys-social-network-ads.html"><span class="header-section-number">18</span> Who buys Social Network ads</a></li>
<li><a class="" href="predicting-ozone-levels.html"><span class="header-section-number">19</span> Predicting Ozone levels</a></li>
<li><a class="" href="building-a-naive-bayes-classifier.html"><span class="header-section-number">20</span> Building a Naive Bayes Classifier</a></li>
<li><a class="" href="linear-and-non-linear-algorithms-for-classification.html"><span class="header-section-number">21</span> Linear and Non-Linear Algorithms for Classification</a></li>
<li><a class="" href="detect-mines-vs-rocks-with-random-forest.html"><span class="header-section-number">22</span> Detect mines vs rocks with Random Forest</a></li>
<li><a class="" href="predicting-the-type-of-glass.html"><span class="header-section-number">23</span> Predicting the type of glass</a></li>
<li><a class="" href="naive-bayes-for-sms-spam.html"><span class="header-section-number">24</span> Naive Bayes for SMS spam</a></li>
<li><a class="" href="vehicles-classiification-with-decision-trees.html"><span class="header-section-number">25</span> Vehicles classiification with Decision Trees</a></li>
<li><a class="" href="applying-naive-bayes-on-the-titanic-case.html"><span class="header-section-number">26</span> Applying Naive-Bayes on the Titanic case</a></li>
<li><a class="" href="classification-on-bad-loans.html"><span class="header-section-number">27</span> Classification on bad loans</a></li>
<li><a class="" href="predicting-flu-outcome-comparing-eight-classification-algorithms.html"><span class="header-section-number">28</span> Predicting Flu outcome comparing eight classification algorithms</a></li>
<li><a class="" href="a-detailed-study-of-bike-sharing-demand.html"><span class="header-section-number">29</span> A detailed study of bike sharing demand</a></li>
<li><a class="" href="prediction-of-arrhythmia-with-deep-neural-nets.html"><span class="header-section-number">30</span> Prediction of arrhythmia with deep neural nets</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression-with-islr.html"><span class="header-section-number">31</span> Linear Regression with ISLR</a></li>
<li><a class="" href="evaluation-of-three-linear-regression-models.html"><span class="header-section-number">32</span> Evaluation of three linear regression models</a></li>
<li><a class="" href="comparison-of-six-linear-regression-algorithms.html"><span class="header-section-number">33</span> Comparison of six Linear Regression algorithms</a></li>
<li><a class="" href="comparing-regression-models.html"><span class="header-section-number">34</span> Comparing regression models</a></li>
<li><a class="" href="finding-the-factors-of-happiness.html"><span class="header-section-number">35</span> Finding the factors of happiness</a></li>
<li><a class="" href="regression-with-a-neural-network.html"><span class="header-section-number">36</span> Regression with a neural network</a></li>
<li><a class="" href="comparing-multiple-regression-vs-a-neural-network.html"><span class="header-section-number">37</span> Comparing Multiple Regression vs a Neural Network</a></li>
<li><a class="" href="temperature-modeling-using-nested-dataframes.html"><span class="header-section-number">38</span> Temperature modeling using nested dataframes</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="credit-scoring-with-neuralnet.html"><span class="header-section-number">39</span> Credit Scoring with neuralnet</a></li>
<li><a class="" href="wine-classification-with-neuralnet.html"><span class="header-section-number">40</span> Wine classification with neuralnet</a></li>
<li><a class="" href="predicting-the-rating-of-cereals.html"><span class="header-section-number">41</span> Predicting the rating of cereals</a></li>
<li><a class="" href="fitting-a-linear-model-with-neural-networks.html"><span class="header-section-number">42</span> Fitting a linear model with neural networks</a></li>
<li><a class="" href="visualization-of-neural-networks.html"><span class="header-section-number">43</span> Visualization of neural networks</a></li>
<li><a class="" href="build-a-fully-connected-r-neural-network-from-scratch.html"><span class="header-section-number">44</span> Build a fully connected R neural network from scratch</a></li>
<li><a class="" href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">45</span> Tuning Hyperparameters in a Neural Network</a></li>
<li><a class="active" href="deep-learning-tips-for-classification-and-regression.html"><span class="header-section-number">46</span> Deep Learning tips for Classification and Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></li>
<li><a class="" href="q-q-normal-to-compare-data-to-distributions.html"><span class="header-section-number">B</span> Q-Q normal to compare data to distributions</a></li>
<li><a class="" href="qq-and-pp-plots.html"><span class="header-section-number">C</span> QQ and PP Plots</a></li>
<li><a class="" href="visualizing-residuals.html"><span class="header-section-number">D</span> Visualizing residuals</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/f0nzie/machine_learning_compilation">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="deep-learning-tips-for-classification-and-regression" class="section level1">
<h1>
<span class="header-section-number">46</span> Deep Learning tips for Classification and Regression<a class="anchor" aria-label="anchor" href="#deep-learning-tips-for-classification-and-regression"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li>Datasets: <code>spiral.csv</code>, <code>grid.csv</code>, <code>covtype.full.csv</code>
</li>
<li>Algorithms:
<ul>
<li>Deep Learning with <code>h2o</code>
</li>
</ul>
</li>
<li>Techniques:
<ul>
<li>Decision Boundaries</li>
<li>Hyper-parameter Tuning with Grid Search</li>
<li>Checkpointing</li>
<li>Cross-Validation</li>
</ul>
</li>
</ul>
<div id="introduction-26" class="section level2">
<h2>
<span class="header-section-number">46.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-26"><i class="fas fa-link"></i></a>
</h2>
<p>Source: <a href="http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html" class="uri">http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html</a></p>
<p>Repo: <a href="https://github.com/h2oai/h2o-tutorials" class="uri">https://github.com/h2oai/h2o-tutorials</a></p>
<p>This tutorial shows how a H2O Deep Learning model can be used to do supervised classification and regression. A great tutorial about Deep Learning is given by Quoc Le here and here. This tutorial covers usage of H2O from R. A python version of this tutorial will be available as well in a separate document. This file is available in plain R, R markdown and regular markdown formats, and the plots are available as PDF files. All documents are available on Github.</p>
<p>If run from plain R, execute R in the directory of this script. If run from RStudio, be sure to setwd() to the location of this script.<code><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html">h2o.init()</a></code> starts H2O in R’s current working directory. <code><a href="https://rdrr.io/pkg/h2o/man/h2o.importFile.html">h2o.importFile()</a></code> looks for files from the perspective of where H2O was started.</p>
<p>More examples and explanations can be found in our H2O Deep Learning booklet and on our H2O Github Repository. The PDF slide deck can be found on Github.</p>
</div>
<div id="h2o-r-package" class="section level2">
<h2>
<span class="header-section-number">46.2</span> H2O R Package<a class="anchor" aria-label="anchor" href="#h2o-r-package"><i class="fas fa-link"></i></a>
</h2>
<p>Load the H2O R package:</p>
<p>Source: <a href="http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html" class="uri">http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html</a></p>
<div class="sourceCode" id="cb1051"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## R installation instructions are at http://h2o.ai/download</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/h2oai/h2o-3">h2o</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ----------------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Your next step is to start H2O:</span>
<span class="co">#&gt;     &gt; h2o.init()</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For H2O package documentation, ask for help:</span>
<span class="co">#&gt;     &gt; ??h2o</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; After starting H2O, you can use the Web UI at http://localhost:54321</span>
<span class="co">#&gt; For more information visit http://docs.h2o.ai</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ----------------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'h2o'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     cor, sd, var</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     &amp;&amp;, %*%, %in%, ||, apply, as.factor, as.numeric, colnames,</span>
<span class="co">#&gt;     colnames&lt;-, ifelse, is.character, is.factor, is.numeric, log,</span>
<span class="co">#&gt;     log10, log1p, log2, round, signif, trunc</span></code></pre></div>
</div>
<div id="start-h2o" class="section level2">
<h2>
<span class="header-section-number">46.3</span> Start H2O<a class="anchor" aria-label="anchor" href="#start-h2o"><i class="fas fa-link"></i></a>
</h2>
<p>Start up a 1-node H2O server on your local machine, and allow it to use all CPU cores and up to 2GB of memory:</p>
<div class="sourceCode" id="cb1052"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html">h2o.init</a></span><span class="op">(</span>nthreads<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, max_mem_size<span class="op">=</span><span class="st">"2G"</span><span class="op">)</span>
<span class="co">#&gt;  Connection successful!</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; R is connected to the H2O cluster: </span>
<span class="co">#&gt;     H2O cluster uptime:         36 minutes 39 seconds </span>
<span class="co">#&gt;     H2O cluster timezone:       Etc/UTC </span>
<span class="co">#&gt;     H2O data parsing timezone:  UTC </span>
<span class="co">#&gt;     H2O cluster version:        3.30.0.1 </span>
<span class="co">#&gt;     H2O cluster version age:    7 months and 16 days !!! </span>
<span class="co">#&gt;     H2O cluster name:           H2O_started_from_R_root_mwl453 </span>
<span class="co">#&gt;     H2O cluster total nodes:    1 </span>
<span class="co">#&gt;     H2O cluster total memory:   7.04 GB </span>
<span class="co">#&gt;     H2O cluster total cores:    8 </span>
<span class="co">#&gt;     H2O cluster allowed cores:  8 </span>
<span class="co">#&gt;     H2O cluster healthy:        TRUE </span>
<span class="co">#&gt;     H2O Connection ip:          localhost </span>
<span class="co">#&gt;     H2O Connection port:        54321 </span>
<span class="co">#&gt;     H2O Connection proxy:       NA </span>
<span class="co">#&gt;     H2O Internal Security:      FALSE </span>
<span class="co">#&gt;     H2O API Extensions:         Amazon S3, XGBoost, Algos, AutoML, Core V3, TargetEncoder, Core V4 </span>
<span class="co">#&gt;     R Version:                  R version 3.6.3 (2020-02-29)</span>
<span class="co">#&gt; Warning in h2o.clusterInfo(): </span>
<span class="co">#&gt; Your H2O cluster version is too old (7 months and 16 days)!</span>
<span class="co">#&gt; Please download and install the latest version from http://h2o.ai/download/</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.removeAll.html">h2o.removeAll</a></span><span class="op">(</span><span class="op">)</span> <span class="co">## clean slate - just in case the cluster was already running</span></code></pre></div>
<p>The <code>h2o.deeplearning</code> function fits H2O’s Deep Learning models from within R. We can run the example from the man page using the example function, or run a longer demonstration from the h2o package using the demo function::</p>
<div class="sourceCode" id="cb1053"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/args.html">args</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>
<span class="co">#&gt; function (x, y, training_frame, model_id = NULL, validation_frame = NULL, </span>
<span class="co">#&gt;     nfolds = 0, keep_cross_validation_models = TRUE, keep_cross_validation_predictions = FALSE, </span>
<span class="co">#&gt;     keep_cross_validation_fold_assignment = FALSE, fold_assignment = c("AUTO", </span>
<span class="co">#&gt;         "Random", "Modulo", "Stratified"), fold_column = NULL, </span>
<span class="co">#&gt;     ignore_const_cols = TRUE, score_each_iteration = FALSE, weights_column = NULL, </span>
<span class="co">#&gt;     offset_column = NULL, balance_classes = FALSE, class_sampling_factors = NULL, </span>
<span class="co">#&gt;     max_after_balance_size = 5, max_hit_ratio_k = 0, checkpoint = NULL, </span>
<span class="co">#&gt;     pretrained_autoencoder = NULL, overwrite_with_best_model = TRUE, </span>
<span class="co">#&gt;     use_all_factor_levels = TRUE, standardize = TRUE, activation = c("Tanh", </span>
<span class="co">#&gt;         "TanhWithDropout", "Rectifier", "RectifierWithDropout", </span>
<span class="co">#&gt;         "Maxout", "MaxoutWithDropout"), hidden = c(200, 200), </span>
<span class="co">#&gt;     epochs = 10, train_samples_per_iteration = -2, target_ratio_comm_to_comp = 0.05, </span>
<span class="co">#&gt;     seed = -1, adaptive_rate = TRUE, rho = 0.99, epsilon = 1e-08, </span>
<span class="co">#&gt;     rate = 0.005, rate_annealing = 1e-06, rate_decay = 1, momentum_start = 0, </span>
<span class="co">#&gt;     momentum_ramp = 1e+06, momentum_stable = 0, nesterov_accelerated_gradient = TRUE, </span>
<span class="co">#&gt;     input_dropout_ratio = 0, hidden_dropout_ratios = NULL, l1 = 0, </span>
<span class="co">#&gt;     l2 = 0, max_w2 = 3.4028235e+38, initial_weight_distribution = c("UniformAdaptive", </span>
<span class="co">#&gt;         "Uniform", "Normal"), initial_weight_scale = 1, initial_weights = NULL, </span>
<span class="co">#&gt;     initial_biases = NULL, loss = c("Automatic", "CrossEntropy", </span>
<span class="co">#&gt;         "Quadratic", "Huber", "Absolute", "Quantile"), distribution = c("AUTO", </span>
<span class="co">#&gt;         "bernoulli", "multinomial", "gaussian", "poisson", "gamma", </span>
<span class="co">#&gt;         "tweedie", "laplace", "quantile", "huber"), quantile_alpha = 0.5, </span>
<span class="co">#&gt;     tweedie_power = 1.5, huber_alpha = 0.9, score_interval = 5, </span>
<span class="co">#&gt;     score_training_samples = 10000, score_validation_samples = 0, </span>
<span class="co">#&gt;     score_duty_cycle = 0.1, classification_stop = 0, regression_stop = 1e-06, </span>
<span class="co">#&gt;     stopping_rounds = 5, stopping_metric = c("AUTO", "deviance", </span>
<span class="co">#&gt;         "logloss", "MSE", "RMSE", "MAE", "RMSLE", "AUC", "AUCPR", </span>
<span class="co">#&gt;         "lift_top_group", "misclassification", "mean_per_class_error", </span>
<span class="co">#&gt;         "custom", "custom_increasing"), stopping_tolerance = 0, </span>
<span class="co">#&gt;     max_runtime_secs = 0, score_validation_sampling = c("Uniform", </span>
<span class="co">#&gt;         "Stratified"), diagnostics = TRUE, fast_mode = TRUE, </span>
<span class="co">#&gt;     force_load_balance = TRUE, variable_importances = TRUE, replicate_training_data = TRUE, </span>
<span class="co">#&gt;     single_node_mode = FALSE, shuffle_training_data = FALSE, </span>
<span class="co">#&gt;     missing_values_handling = c("MeanImputation", "Skip"), quiet_mode = FALSE, </span>
<span class="co">#&gt;     autoencoder = FALSE, sparse = FALSE, col_major = FALSE, average_activation = 0, </span>
<span class="co">#&gt;     sparsity_beta = 0, max_categorical_features = 2147483647, </span>
<span class="co">#&gt;     reproducible = FALSE, export_weights_and_biases = FALSE, </span>
<span class="co">#&gt;     mini_batch_size = 1, categorical_encoding = c("AUTO", "Enum", </span>
<span class="co">#&gt;         "OneHotInternal", "OneHotExplicit", "Binary", "Eigen", </span>
<span class="co">#&gt;         "LabelEncoder", "SortByResponse", "EnumLimited"), elastic_averaging = FALSE, </span>
<span class="co">#&gt;     elastic_averaging_moving_rate = 0.9, elastic_averaging_regularization = 0.001, </span>
<span class="co">#&gt;     export_checkpoints_dir = NULL, verbose = FALSE) </span>
<span class="co">#&gt; NULL</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/example.html">example</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; h2.dpl&gt; ## Not run: </span>
<span class="co">#&gt; h2.dpl&gt; ##D library(h2o)</span>
<span class="co">#&gt; h2.dpl&gt; ##D h2o.init()</span>
<span class="co">#&gt; h2.dpl&gt; ##D iris_hf &lt;- as.h2o(iris)</span>
<span class="co">#&gt; h2.dpl&gt; ##D iris_dl &lt;- h2o.deeplearning(x = 1:4, y = 5, training_frame = iris_hf, seed=123456)</span>
<span class="co">#&gt; h2.dpl&gt; ##D </span>
<span class="co">#&gt; h2.dpl&gt; ##D # now make a prediction</span>
<span class="co">#&gt; h2.dpl&gt; ##D predictions &lt;- h2o.predict(iris_dl, iris_hf)</span>
<span class="co">#&gt; h2.dpl&gt; ## End(Not run)</span>
<span class="co">#&gt; h2.dpl&gt; </span>
<span class="co">#&gt; h2.dpl&gt; </span>
<span class="co">#&gt; h2.dpl&gt;</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/demo.html">demo</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>  <span class="co">#requires user interaction</span></code></pre></div>
<p>While <strong>H2O Deep Learning</strong> has many parameters, it was designed to be just as easy to use as the other supervised training methods in H2O. Early stopping, automatic data standardization and handling of categorical variables and missing values and adaptive learning rates (per weight) reduce the amount of parameters the user has to specify. Often, it’s just the number and sizes of hidden layers, the number of epochs and the activation function and maybe some regularization techniques.</p>
</div>
<div id="lets-have-some-fun-first-decision-boundaries" class="section level2">
<h2>
<span class="header-section-number">46.4</span> Let’s have some fun first: Decision Boundaries<a class="anchor" aria-label="anchor" href="#lets-have-some-fun-first-decision-boundaries"><i class="fas fa-link"></i></a>
</h2>
<p>We start with a small dataset representing red and black dots on a plane, arranged in the shape of two nested spirals. Then we task H2O’s machine learning methods to separate the red and black dots, i.e., recognize each spiral as such by assigning each point in the plane to one of the two spirals.</p>
<p>We visualize the nature of H2O Deep Learning (DL), H2O’s tree methods (GBM/DRF) and H2O’s generalized linear modeling (GLM) by plotting the decision boundary between the red and black spirals:</p>
<div class="sourceCode" id="cb1054"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1054-1" data-line-number="1"><span class="co"># setwd("~/h2o-tutorials/tutorials/deeplearning") ##For RStudio</span></a>
<a class="sourceLine" id="cb1054-2" data-line-number="2">spiral &lt;-<span class="st"> </span><span class="kw">h2o.importFile</span>(<span class="dt">path =</span> <span class="kw">normalizePath</span>(<span class="kw">file.path</span>(data_raw_dir, <span class="st">"spiral.csv"</span>)))</a>
<a class="sourceLine" id="cb1054-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1054-4" data-line-number="4">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1054-5" data-line-number="5"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1054-6" data-line-number="6">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1054-7" data-line-number="7"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1054-8" data-line-number="8">grid   &lt;-<span class="st"> </span><span class="kw">h2o.importFile</span>(<span class="dt">path =</span> <span class="kw">normalizePath</span>(<span class="kw">file.path</span>(data_raw_dir, <span class="st">"grid.csv"</span>)))</a>
<a class="sourceLine" id="cb1054-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1054-10" data-line-number="10">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1054-11" data-line-number="11"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1054-12" data-line-number="12">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1054-13" data-line-number="13"><span class="st">  </span><span class="er">|===============</span><span class="st">                                                       </span><span class="er">|</span><span class="st">  </span><span class="dv">22</span>%</a>
<a class="sourceLine" id="cb1054-14" data-line-number="14">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1054-15" data-line-number="15"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1054-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1054-17" data-line-number="17"><span class="co"># Define helper to plot contours</span></a>
<a class="sourceLine" id="cb1054-18" data-line-number="18">plotC &lt;-<span class="st"> </span><span class="cf">function</span>(name, model, <span class="dt">data=</span>spiral, <span class="dt">g=</span>grid) {</a>
<a class="sourceLine" id="cb1054-19" data-line-number="19">  data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(data) <span class="co">#get data from into R</span></a>
<a class="sourceLine" id="cb1054-20" data-line-number="20">  pred &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">h2o.predict</span>(model, g))</a>
<a class="sourceLine" id="cb1054-21" data-line-number="21">  n=<span class="fl">0.5</span><span class="op">*</span>(<span class="kw">sqrt</span>(<span class="kw">nrow</span>(g))<span class="op">-</span><span class="dv">1</span>); d &lt;-<span class="st"> </span><span class="fl">1.5</span>; h &lt;-<span class="st"> </span>d<span class="op">*</span>(<span class="op">-</span>n<span class="op">:</span>n)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb1054-22" data-line-number="22">  <span class="kw">plot</span>(data[,<span class="op">-</span><span class="dv">3</span>],<span class="dt">pch=</span><span class="dv">19</span>,<span class="dt">col=</span>data[,<span class="dv">3</span>],<span class="dt">cex=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb1054-23" data-line-number="23">       <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>d,d),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>d,d),<span class="dt">main=</span>name)</a>
<a class="sourceLine" id="cb1054-24" data-line-number="24">  <span class="kw">contour</span>(h,h,<span class="dt">z=</span><span class="kw">array</span>(<span class="kw">ifelse</span>(pred[,<span class="dv">1</span>]<span class="op">==</span><span class="st">"Red"</span>,<span class="dv">0</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1054-25" data-line-number="25">          <span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span>n<span class="op">+</span><span class="dv">1</span>,<span class="dv">2</span><span class="op">*</span>n<span class="op">+</span><span class="dv">1</span>)),<span class="dt">col=</span><span class="st">"blue"</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">add=</span>T)</a>
<a class="sourceLine" id="cb1054-26" data-line-number="26">}</a></code></pre></div>
<p>We build a few different models:</p>
<div class="sourceCode" id="cb1055"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>
<span class="fu">plotC</span><span class="op">(</span> <span class="st">"DL"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="fl">1e3</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="st">"GBM"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.gbm.html">h2o.gbm</a></span>         <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="st">"DRF"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.randomForest.html">h2o.randomForest</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="st">"GLM"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.glm.html">h2o.glm</a></span>         <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="604-nn-comparison-deep_learning_tips_files/figure-html/deeplearning_gbm_drf_glm-1.png" width="70%" style="display: block; margin: auto;">
Let’s investigate some more Deep Learning models. First, we explore the evolution over training time (number of passes over the data), and we use checkpointing to continue training the same model:</div>
<div class="sourceCode" id="cb1056"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>
<span class="va">ep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">250</span>,<span class="fl">500</span>,<span class="fl">750</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
                              model_id<span class="op">=</span><span class="st">"dl_1"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
            checkpoint<span class="op">=</span><span class="st">"dl_1"</span>,model_id<span class="op">=</span><span class="st">"dl_2"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,
            checkpoint<span class="op">=</span><span class="st">"dl_2"</span>,model_id<span class="op">=</span><span class="st">"dl_3"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,
            checkpoint<span class="op">=</span><span class="st">"dl_3"</span>,model_id<span class="op">=</span><span class="st">"dl_4"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/deeplearning_evolution_training_time-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>You can see how the network learns the structure of the spirals with enough training time. We explore different network architectures next:</p>
<div class="sourceCode" id="cb1057"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">hidden</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">13</span>,<span class="fl">17</span>,<span class="fl">19</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">42</span>,<span class="fl">42</span>,<span class="fl">42</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">200</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL hidden="</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">hidden</span>, collapse<span class="op">=</span><span class="st">"x"</span><span class="op">)</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span> ,<span class="va">spiral</span>, hidden<span class="op">=</span><span class="va">hidden</span>, epochs<span class="op">=</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/deeplearning_for_loop_hidden-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>It is clear that different configurations can achieve similar performance, and that tuning will be required for optimal performance. Next, we compare between different activation functions, including one with 50% dropout regularization in the hidden layers:</p>
<div class="sourceCode" id="cb1058"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">act</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tanh"</span>, <span class="st">"Maxout"</span>, <span class="st">"Rectifier"</span>, <span class="st">"RectifierWithDropout"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">act</span>,<span class="st">" activation"</span><span class="op">)</span>, 
        <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>, <span class="va">spiral</span>,
              activation <span class="op">=</span> <span class="va">act</span>, 
              hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>, 
              epochs <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/compare_activation_functions-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Clearly, the dropout rate was too high or the number of epochs was too low for the last configuration, which often ends up performing the best on larger datasets where generalization is important.</p>
<p>More information about the parameters can be found in the H2O Deep Learning booklet.</p>
</div>
<div id="cover-type-dataset" class="section level2">
<h2>
<span class="header-section-number">46.5</span> Cover Type Dataset<a class="anchor" aria-label="anchor" href="#cover-type-dataset"><i class="fas fa-link"></i></a>
</h2>
<p>We important the full cover type dataset (581k rows, 13 columns, 10 numerical, 3 categorical). We also split the data 3 ways: 60% for training, 20% for validation (hyper parameter tuning) and 20% for final testing.</p>
<div class="sourceCode" id="cb1059"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1059-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">h2o.importFile</span>(<span class="dt">path =</span> <span class="kw">normalizePath</span>(<span class="kw">file.path</span>(data_raw_dir, <span class="st">"covtype.full.csv"</span>)))</a>
<a class="sourceLine" id="cb1059-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1059-3" data-line-number="3">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1059-4" data-line-number="4"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1059-5" data-line-number="5">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1059-6" data-line-number="6"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1059-7" data-line-number="7"><span class="kw">dim</span>(df)</a>
<a class="sourceLine" id="cb1059-8" data-line-number="8"><span class="co">#&gt; [1] 581012     13</span></a>
<a class="sourceLine" id="cb1059-9" data-line-number="9">df</a>
<a class="sourceLine" id="cb1059-10" data-line-number="10"><span class="co">#&gt;   Elevation Aspect Slope Horizontal_Distance_To_Hydrology</span></a>
<a class="sourceLine" id="cb1059-11" data-line-number="11"><span class="co">#&gt; 1      3066    124     5                                0</span></a>
<a class="sourceLine" id="cb1059-12" data-line-number="12"><span class="co">#&gt; 2      3136     32    20                              450</span></a>
<a class="sourceLine" id="cb1059-13" data-line-number="13"><span class="co">#&gt; 3      2655     28    14                               42</span></a>
<a class="sourceLine" id="cb1059-14" data-line-number="14"><span class="co">#&gt; 4      3191     45    19                              323</span></a>
<a class="sourceLine" id="cb1059-15" data-line-number="15"><span class="co">#&gt; 5      3217     80    13                               30</span></a>
<a class="sourceLine" id="cb1059-16" data-line-number="16"><span class="co">#&gt; 6      3119    293    13                               30</span></a>
<a class="sourceLine" id="cb1059-17" data-line-number="17"><span class="co">#&gt;   Vertical_Distance_To_Hydrology Horizontal_Distance_To_Roadways Hillshade_9am</span></a>
<a class="sourceLine" id="cb1059-18" data-line-number="18"><span class="co">#&gt; 1                              0                            1533           229</span></a>
<a class="sourceLine" id="cb1059-19" data-line-number="19"><span class="co">#&gt; 2                            -38                            1290           211</span></a>
<a class="sourceLine" id="cb1059-20" data-line-number="20"><span class="co">#&gt; 3                              8                            1890           214</span></a>
<a class="sourceLine" id="cb1059-21" data-line-number="21"><span class="co">#&gt; 4                             88                            3932           221</span></a>
<a class="sourceLine" id="cb1059-22" data-line-number="22"><span class="co">#&gt; 5                              1                            3901           237</span></a>
<a class="sourceLine" id="cb1059-23" data-line-number="23"><span class="co">#&gt; 6                             10                            4810           182</span></a>
<a class="sourceLine" id="cb1059-24" data-line-number="24"><span class="co">#&gt;   Hillshade_Noon Hillshade_3pm Horizontal_Distance_To_Fire_Points</span></a>
<a class="sourceLine" id="cb1059-25" data-line-number="25"><span class="co">#&gt; 1            236           141                                459</span></a>
<a class="sourceLine" id="cb1059-26" data-line-number="26"><span class="co">#&gt; 2            193           111                               1112</span></a>
<a class="sourceLine" id="cb1059-27" data-line-number="27"><span class="co">#&gt; 3            209           128                               1001</span></a>
<a class="sourceLine" id="cb1059-28" data-line-number="28"><span class="co">#&gt; 4            195           100                               2919</span></a>
<a class="sourceLine" id="cb1059-29" data-line-number="29"><span class="co">#&gt; 5            217           109                               2859</span></a>
<a class="sourceLine" id="cb1059-30" data-line-number="30"><span class="co">#&gt; 6            237           194                               1200</span></a>
<a class="sourceLine" id="cb1059-31" data-line-number="31"><span class="co">#&gt;   Wilderness_Area Soil_Type Cover_Type</span></a>
<a class="sourceLine" id="cb1059-32" data-line-number="32"><span class="co">#&gt; 1          area_0   type_22    class_1</span></a>
<a class="sourceLine" id="cb1059-33" data-line-number="33"><span class="co">#&gt; 2          area_0   type_28    class_1</span></a>
<a class="sourceLine" id="cb1059-34" data-line-number="34"><span class="co">#&gt; 3          area_2    type_9    class_2</span></a>
<a class="sourceLine" id="cb1059-35" data-line-number="35"><span class="co">#&gt; 4          area_0   type_39    class_2</span></a>
<a class="sourceLine" id="cb1059-36" data-line-number="36"><span class="co">#&gt; 5          area_0   type_22    class_7</span></a>
<a class="sourceLine" id="cb1059-37" data-line-number="37"><span class="co">#&gt; 6          area_0   type_21    class_1</span></a>
<a class="sourceLine" id="cb1059-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1059-39" data-line-number="39"><span class="co">#&gt; [581012 rows x 13 columns]</span></a>
<a class="sourceLine" id="cb1059-40" data-line-number="40">splits &lt;-<span class="st"> </span><span class="kw">h2o.splitFrame</span>(df, <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>), <span class="dt">seed=</span><span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb1059-41" data-line-number="41">train  &lt;-<span class="st"> </span><span class="kw">h2o.assign</span>(splits[[<span class="dv">1</span>]], <span class="st">"train.hex"</span>) <span class="co"># 60%</span></a>
<a class="sourceLine" id="cb1059-42" data-line-number="42">valid  &lt;-<span class="st"> </span><span class="kw">h2o.assign</span>(splits[[<span class="dv">2</span>]], <span class="st">"valid.hex"</span>) <span class="co"># 20%</span></a>
<a class="sourceLine" id="cb1059-43" data-line-number="43">test   &lt;-<span class="st"> </span><span class="kw">h2o.assign</span>(splits[[<span class="dv">3</span>]], <span class="st">"test.hex"</span>)  <span class="co"># 20%</span></a></code></pre></div>
<p>Here’s a scalable way to do scatter plots via binning (works for categorical and numeric columns) to get more familiar with the dataset.</p>
<div class="sourceCode" id="cb1060"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># reset canvas</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Elevation"</span>,                       <span class="st">"Cover_Type"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Horizontal_Distance_To_Roadways"</span>, <span class="st">"Cover_Type"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Soil_Type"</span>,                       <span class="st">"Cover_Type"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Horizontal_Distance_To_Roadways"</span>, <span class="st">"Elevation"</span> <span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-1.png" width="70%" style="display: block; margin: auto;"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-2.png" width="70%" style="display: block; margin: auto;"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-3.png" width="70%" style="display: block; margin: auto;"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-4.png" width="70%" style="display: block; margin: auto;"></p>
<div id="first-run-of-h2o-deep-learning" class="section level3">
<h3>
<span class="header-section-number">46.5.1</span> First Run of H2O Deep Learning<a class="anchor" aria-label="anchor" href="#first-run-of-h2o-deep-learning"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s run our first Deep Learning model on the covtype dataset. We want to predict the <code>Cover_Type</code> column, a categorical feature with 7 levels, and the Deep Learning model will be tasked to perform (multi-class) classification. It uses the other 12 predictors of the dataset, of which 10 are numerical, and 2 are categorical with a total of 44 levels. We can expect the Deep Learning model to have 56 input neurons (after automatic one-hot encoding).</p>
<div class="sourceCode" id="cb1061"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">response</span> <span class="op">&lt;-</span> <span class="st">"Cover_Type"</span>
<span class="va">predictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/setops.html">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="va">response</span><span class="op">)</span>
<span class="va">predictors</span>
<span class="co">#&gt;  [1] "Elevation"                          "Aspect"                            </span>
<span class="co">#&gt;  [3] "Slope"                              "Horizontal_Distance_To_Hydrology"  </span>
<span class="co">#&gt;  [5] "Vertical_Distance_To_Hydrology"     "Horizontal_Distance_To_Roadways"   </span>
<span class="co">#&gt;  [7] "Hillshade_9am"                      "Hillshade_Noon"                    </span>
<span class="co">#&gt;  [9] "Hillshade_3pm"                      "Horizontal_Distance_To_Fire_Points"</span>
<span class="co">#&gt; [11] "Wilderness_Area"                    "Soil_Type"</span></code></pre></div>
<div class="sourceCode" id="cb1062"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">train_df</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    349015 obs. of  13 variables:</span>
<span class="co">#&gt;  $ Elevation                         : int  3136 3217 3119 2679 3261 2885 3227 2843 2853 2883 ...</span>
<span class="co">#&gt;  $ Aspect                            : int  32 80 293 48 322 26 32 12 124 177 ...</span>
<span class="co">#&gt;  $ Slope                             : int  20 13 13 7 13 9 6 18 12 9 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Hydrology  : int  450 30 30 150 30 192 108 335 30 426 ...</span>
<span class="co">#&gt;  $ Vertical_Distance_To_Hydrology    : int  -38 1 10 24 5 38 13 50 -5 126 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Roadways   : int  1290 3901 4810 1588 5701 3271 5542 2642 1485 2139 ...</span>
<span class="co">#&gt;  $ Hillshade_9am                     : int  211 237 182 223 186 216 219 199 240 225 ...</span>
<span class="co">#&gt;  $ Hillshade_Noon                    : int  193 217 237 224 226 220 227 201 231 246 ...</span>
<span class="co">#&gt;  $ Hillshade_3pm                     : int  111 109 194 136 180 140 145 135 119 153 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Fire_Points: int  1112 2859 1200 6265 769 2643 765 1719 2497 713 ...</span>
<span class="co">#&gt;  $ Wilderness_Area                   : Factor w/ 4 levels "area_0","area_1",..: 1 1 1 1 1 1 1 3 3 3 ...</span>
<span class="co">#&gt;  $ Soil_Type                         : Factor w/ 40 levels "type_0","type_1",..: 22 16 15 4 15 22 15 27 12 25 ...</span>
<span class="co">#&gt;  $ Cover_Type                        : Factor w/ 7 levels "class_1","class_2",..: 1 7 1 2 1 2 1 2 1 2 ...</span></code></pre></div>
<div class="sourceCode" id="cb1063"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">valid_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">valid</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">valid_df</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    116018 obs. of  13 variables:</span>
<span class="co">#&gt;  $ Elevation                         : int  3066 2655 2902 2994 2697 2990 3237 2884 2972 2696 ...</span>
<span class="co">#&gt;  $ Aspect                            : int  124 28 304 61 93 59 135 71 100 169 ...</span>
<span class="co">#&gt;  $ Slope                             : int  5 14 22 9 9 12 14 9 4 10 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Hydrology  : int  0 42 511 391 306 108 240 459 175 323 ...</span>
<span class="co">#&gt;  $ Vertical_Distance_To_Hydrology    : int  0 8 18 57 -2 10 -11 141 13 149 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Roadways   : int  1533 1890 1273 4286 553 2190 1189 1214 5031 2452 ...</span>
<span class="co">#&gt;  $ Hillshade_9am                     : int  229 214 155 227 234 229 241 231 227 228 ...</span>
<span class="co">#&gt;  $ Hillshade_Noon                    : int  236 209 223 222 227 215 233 222 234 244 ...</span>
<span class="co">#&gt;  $ Hillshade_3pm                     : int  141 128 206 128 125 117 118 124 142 148 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Fire_Points: int  459 1001 1347 1928 1716 1048 2748 1355 6198 1044 ...</span>
<span class="co">#&gt;  $ Wilderness_Area                   : Factor w/ 4 levels "area_0","area_1",..: 1 3 3 1 1 3 1 3 1 3 ...</span>
<span class="co">#&gt;  $ Soil_Type                         : Factor w/ 39 levels "type_0","type_1",..: 15 39 25 4 4 25 14 25 11 23 ...</span>
<span class="co">#&gt;  $ Cover_Type                        : Factor w/ 7 levels "class_1","class_2",..: 1 2 2 2 2 2 1 2 1 3 ...</span></code></pre></div>
<p>To keep it fast, we only run for one epoch (one pass over the training data).</p>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1064-1" data-line-number="1">m1 &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(</a>
<a class="sourceLine" id="cb1064-2" data-line-number="2">  <span class="dt">model_id=</span><span class="st">"dl_model_first"</span>, </a>
<a class="sourceLine" id="cb1064-3" data-line-number="3">  <span class="dt">training_frame =</span> train, </a>
<a class="sourceLine" id="cb1064-4" data-line-number="4">  <span class="dt">validation_frame =</span> valid,   <span class="co">## validation dataset: used for scoring and early stopping</span></a>
<a class="sourceLine" id="cb1064-5" data-line-number="5">  <span class="dt">x =</span> predictors,</a>
<a class="sourceLine" id="cb1064-6" data-line-number="6">  <span class="dt">y =</span> response,</a>
<a class="sourceLine" id="cb1064-7" data-line-number="7">  <span class="co">#activation="Rectifier",  ## default</span></a>
<a class="sourceLine" id="cb1064-8" data-line-number="8">  <span class="co">#hidden=c(200,200),       ## default: 2 hidden layers with 200 neurons each</span></a>
<a class="sourceLine" id="cb1064-9" data-line-number="9">  <span class="dt">epochs =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1064-10" data-line-number="10">  <span class="dt">variable_importances=</span>T    <span class="co">## not enabled by default</span></a>
<a class="sourceLine" id="cb1064-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb1064-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-13" data-line-number="13">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-14" data-line-number="14"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1064-15" data-line-number="15">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-16" data-line-number="16"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb1064-17" data-line-number="17">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-18" data-line-number="18"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb1064-19" data-line-number="19">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-20" data-line-number="20"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb1064-21" data-line-number="21">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-22" data-line-number="22"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb1064-23" data-line-number="23">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-24" data-line-number="24"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb1064-25" data-line-number="25">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-26" data-line-number="26"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb1064-27" data-line-number="27">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-28" data-line-number="28"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb1064-29" data-line-number="29">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-30" data-line-number="30"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb1064-31" data-line-number="31">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-32" data-line-number="32"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb1064-33" data-line-number="33">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-34" data-line-number="34"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1064-35" data-line-number="35"><span class="kw">summary</span>(m1)</a>
<a class="sourceLine" id="cb1064-36" data-line-number="36"><span class="co">#&gt; Model Details:</span></a>
<a class="sourceLine" id="cb1064-37" data-line-number="37"><span class="co">#&gt; ==============</span></a>
<a class="sourceLine" id="cb1064-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-39" data-line-number="39"><span class="co">#&gt; H2OMultinomialModel: deeplearning</span></a>
<a class="sourceLine" id="cb1064-40" data-line-number="40"><span class="co">#&gt; Model Key:  dl_model_first </span></a>
<a class="sourceLine" id="cb1064-41" data-line-number="41"><span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 53,007 weights/biases, 633.2 KB, 382,887 training samples, mini-batch size 1</span></a>
<a class="sourceLine" id="cb1064-42" data-line-number="42"><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></a>
<a class="sourceLine" id="cb1064-43" data-line-number="43"><span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span></a>
<a class="sourceLine" id="cb1064-44" data-line-number="44"><span class="co">#&gt; 2     2   200 Rectifier  0.00 % 0.000000 0.000000  0.051130 0.212618 0.000000</span></a>
<a class="sourceLine" id="cb1064-45" data-line-number="45"><span class="co">#&gt; 3     3   200 Rectifier  0.00 % 0.000000 0.000000  0.008042 0.006936 0.000000</span></a>
<a class="sourceLine" id="cb1064-46" data-line-number="46"><span class="co">#&gt; 4     4     7   Softmax      NA 0.000000 0.000000  0.100831 0.268094 0.000000</span></a>
<a class="sourceLine" id="cb1064-47" data-line-number="47"><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></a>
<a class="sourceLine" id="cb1064-48" data-line-number="48"><span class="co">#&gt; 1          NA         NA        NA       NA</span></a>
<a class="sourceLine" id="cb1064-49" data-line-number="49"><span class="co">#&gt; 2   -0.009454   0.121201  0.046923 0.121500</span></a>
<a class="sourceLine" id="cb1064-50" data-line-number="50"><span class="co">#&gt; 3   -0.026873   0.118570  0.720955 0.355757</span></a>
<a class="sourceLine" id="cb1064-51" data-line-number="51"><span class="co">#&gt; 4   -0.326300   0.493430 -0.562048 0.171816</span></a>
<a class="sourceLine" id="cb1064-52" data-line-number="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-53" data-line-number="53"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1064-54" data-line-number="54"><span class="co">#&gt; ** Reported on training data. **</span></a>
<a class="sourceLine" id="cb1064-55" data-line-number="55"><span class="co">#&gt; ** Metrics reported on temporary training frame with 10014 samples **</span></a>
<a class="sourceLine" id="cb1064-56" data-line-number="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-57" data-line-number="57"><span class="co">#&gt; Training Set Metrics: </span></a>
<a class="sourceLine" id="cb1064-58" data-line-number="58"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1064-59" data-line-number="59"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-60" data-line-number="60"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.129</span></a>
<a class="sourceLine" id="cb1064-61" data-line-number="61"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.359</span></a>
<a class="sourceLine" id="cb1064-62" data-line-number="62"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.417</span></a>
<a class="sourceLine" id="cb1064-63" data-line-number="63"><span class="co">#&gt; Mean Per-Class Error: 0.346</span></a>
<a class="sourceLine" id="cb1064-64" data-line-number="64"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span></a>
<a class="sourceLine" id="cb1064-65" data-line-number="65"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1064-66" data-line-number="66"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1064-67" data-line-number="67"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1064-68" data-line-number="68"><span class="co">#&gt; class_1    3080     507       0       0       5       0      16 0.1463</span></a>
<a class="sourceLine" id="cb1064-69" data-line-number="69"><span class="co">#&gt; class_2     627    4151      56       1      30      12       1 0.1490</span></a>
<a class="sourceLine" id="cb1064-70" data-line-number="70"><span class="co">#&gt; class_3       0      35     595       3       0      10       0 0.0747</span></a>
<a class="sourceLine" id="cb1064-71" data-line-number="71"><span class="co">#&gt; class_4       0       0      28      24       0       1       0 0.5472</span></a>
<a class="sourceLine" id="cb1064-72" data-line-number="72"><span class="co">#&gt; class_5       1      74       9       0      81       0       0 0.5091</span></a>
<a class="sourceLine" id="cb1064-73" data-line-number="73"><span class="co">#&gt; class_6       0      54     165       3       0      80       0 0.7351</span></a>
<a class="sourceLine" id="cb1064-74" data-line-number="74"><span class="co">#&gt; class_7      88       6       0       0       0       0     271 0.2575</span></a>
<a class="sourceLine" id="cb1064-75" data-line-number="75"><span class="co">#&gt; Totals     3796    4827     853      31     116     103     288 0.1730</span></a>
<a class="sourceLine" id="cb1064-76" data-line-number="76"><span class="co">#&gt;                     Rate</span></a>
<a class="sourceLine" id="cb1064-77" data-line-number="77"><span class="co">#&gt; class_1 =    528 / 3,608</span></a>
<a class="sourceLine" id="cb1064-78" data-line-number="78"><span class="co">#&gt; class_2 =    727 / 4,878</span></a>
<a class="sourceLine" id="cb1064-79" data-line-number="79"><span class="co">#&gt; class_3 =       48 / 643</span></a>
<a class="sourceLine" id="cb1064-80" data-line-number="80"><span class="co">#&gt; class_4 =        29 / 53</span></a>
<a class="sourceLine" id="cb1064-81" data-line-number="81"><span class="co">#&gt; class_5 =       84 / 165</span></a>
<a class="sourceLine" id="cb1064-82" data-line-number="82"><span class="co">#&gt; class_6 =      222 / 302</span></a>
<a class="sourceLine" id="cb1064-83" data-line-number="83"><span class="co">#&gt; class_7 =       94 / 365</span></a>
<a class="sourceLine" id="cb1064-84" data-line-number="84"><span class="co">#&gt; Totals  = 1,732 / 10,014</span></a>
<a class="sourceLine" id="cb1064-85" data-line-number="85"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-86" data-line-number="86"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span></a>
<a class="sourceLine" id="cb1064-87" data-line-number="87"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1064-88" data-line-number="88"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1064-89" data-line-number="89"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1064-90" data-line-number="90"><span class="co">#&gt; 1 1  0.827042</span></a>
<a class="sourceLine" id="cb1064-91" data-line-number="91"><span class="co">#&gt; 2 2  0.986219</span></a>
<a class="sourceLine" id="cb1064-92" data-line-number="92"><span class="co">#&gt; 3 3  0.998103</span></a>
<a class="sourceLine" id="cb1064-93" data-line-number="93"><span class="co">#&gt; 4 4  0.999800</span></a>
<a class="sourceLine" id="cb1064-94" data-line-number="94"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1064-95" data-line-number="95"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1064-96" data-line-number="96"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1064-97" data-line-number="97"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-98" data-line-number="98"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-99" data-line-number="99"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1064-100" data-line-number="100"><span class="co">#&gt; ** Reported on validation data. **</span></a>
<a class="sourceLine" id="cb1064-101" data-line-number="101"><span class="co">#&gt; ** Metrics reported on full validation frame **</span></a>
<a class="sourceLine" id="cb1064-102" data-line-number="102"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-103" data-line-number="103"><span class="co">#&gt; Validation Set Metrics: </span></a>
<a class="sourceLine" id="cb1064-104" data-line-number="104"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1064-105" data-line-number="105"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-106" data-line-number="106"><span class="co">#&gt; Extract validation frame with `h2o.getFrame("valid.hex")`</span></a>
<a class="sourceLine" id="cb1064-107" data-line-number="107"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.132</span></a>
<a class="sourceLine" id="cb1064-108" data-line-number="108"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.363</span></a>
<a class="sourceLine" id="cb1064-109" data-line-number="109"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.422</span></a>
<a class="sourceLine" id="cb1064-110" data-line-number="110"><span class="co">#&gt; Mean Per-Class Error: 0.338</span></a>
<a class="sourceLine" id="cb1064-111" data-line-number="111"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span></a>
<a class="sourceLine" id="cb1064-112" data-line-number="112"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1064-113" data-line-number="113"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1064-114" data-line-number="114"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1064-115" data-line-number="115"><span class="co">#&gt; class_1   36026    6217       1       0      55       7     194 0.1523</span></a>
<a class="sourceLine" id="cb1064-116" data-line-number="116"><span class="co">#&gt; class_2    7619   47602     661       4     336     131      27 0.1557</span></a>
<a class="sourceLine" id="cb1064-117" data-line-number="117"><span class="co">#&gt; class_3       1     371    6565      58       2     146       0 0.0809</span></a>
<a class="sourceLine" id="cb1064-118" data-line-number="118"><span class="co">#&gt; class_4       0       0     260     295       0       7       0 0.4751</span></a>
<a class="sourceLine" id="cb1064-119" data-line-number="119"><span class="co">#&gt; class_5      42     946      49       0     827       6       0 0.5578</span></a>
<a class="sourceLine" id="cb1064-120" data-line-number="120"><span class="co">#&gt; class_6       7     655    1693      33       0    1076       0 0.6894</span></a>
<a class="sourceLine" id="cb1064-121" data-line-number="121"><span class="co">#&gt; class_7     997      60       0       0       0       0    3042 0.2579</span></a>
<a class="sourceLine" id="cb1064-122" data-line-number="122"><span class="co">#&gt; Totals    44692   55851    9229     390    1220    1373    3263 0.1774</span></a>
<a class="sourceLine" id="cb1064-123" data-line-number="123"><span class="co">#&gt;                       Rate</span></a>
<a class="sourceLine" id="cb1064-124" data-line-number="124"><span class="co">#&gt; class_1 =   6,474 / 42,500</span></a>
<a class="sourceLine" id="cb1064-125" data-line-number="125"><span class="co">#&gt; class_2 =   8,778 / 56,380</span></a>
<a class="sourceLine" id="cb1064-126" data-line-number="126"><span class="co">#&gt; class_3 =      578 / 7,143</span></a>
<a class="sourceLine" id="cb1064-127" data-line-number="127"><span class="co">#&gt; class_4 =        267 / 562</span></a>
<a class="sourceLine" id="cb1064-128" data-line-number="128"><span class="co">#&gt; class_5 =    1,043 / 1,870</span></a>
<a class="sourceLine" id="cb1064-129" data-line-number="129"><span class="co">#&gt; class_6 =    2,388 / 3,464</span></a>
<a class="sourceLine" id="cb1064-130" data-line-number="130"><span class="co">#&gt; class_7 =    1,057 / 4,099</span></a>
<a class="sourceLine" id="cb1064-131" data-line-number="131"><span class="co">#&gt; Totals  = 20,585 / 116,018</span></a>
<a class="sourceLine" id="cb1064-132" data-line-number="132"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-133" data-line-number="133"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span></a>
<a class="sourceLine" id="cb1064-134" data-line-number="134"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1064-135" data-line-number="135"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1064-136" data-line-number="136"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1064-137" data-line-number="137"><span class="co">#&gt; 1 1  0.822571</span></a>
<a class="sourceLine" id="cb1064-138" data-line-number="138"><span class="co">#&gt; 2 2  0.984321</span></a>
<a class="sourceLine" id="cb1064-139" data-line-number="139"><span class="co">#&gt; 3 3  0.998035</span></a>
<a class="sourceLine" id="cb1064-140" data-line-number="140"><span class="co">#&gt; 4 4  0.999664</span></a>
<a class="sourceLine" id="cb1064-141" data-line-number="141"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1064-142" data-line-number="142"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1064-143" data-line-number="143"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1064-144" data-line-number="144"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-145" data-line-number="145"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-146" data-line-number="146"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-147" data-line-number="147"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-148" data-line-number="148"><span class="co">#&gt; Scoring History: </span></a>
<a class="sourceLine" id="cb1064-149" data-line-number="149"><span class="co">#&gt;             timestamp   duration training_speed  epochs iterations</span></a>
<a class="sourceLine" id="cb1064-150" data-line-number="150"><span class="co">#&gt; 1 2020-11-20 03:24:58  0.000 sec             NA 0.00000          0</span></a>
<a class="sourceLine" id="cb1064-151" data-line-number="151"><span class="co">#&gt; 2 2020-11-20 03:25:02  5.157 sec  10945 obs/sec 0.09947          1</span></a>
<a class="sourceLine" id="cb1064-152" data-line-number="152"><span class="co">#&gt; 3 2020-11-20 03:25:22 25.865 sec  14123 obs/sec 0.89690          9</span></a>
<a class="sourceLine" id="cb1064-153" data-line-number="153"><span class="co">#&gt; 4 2020-11-20 03:25:28 31.683 sec  14493 obs/sec 1.09705         11</span></a>
<a class="sourceLine" id="cb1064-154" data-line-number="154"><span class="co">#&gt;         samples training_rmse training_logloss training_r2</span></a>
<a class="sourceLine" id="cb1064-155" data-line-number="155"><span class="co">#&gt; 1      0.000000            NA               NA          NA</span></a>
<a class="sourceLine" id="cb1064-156" data-line-number="156"><span class="co">#&gt; 2  34718.000000       0.44203          0.62188     0.90148</span></a>
<a class="sourceLine" id="cb1064-157" data-line-number="157"><span class="co">#&gt; 3 313032.000000       0.36538          0.42521     0.93269</span></a>
<a class="sourceLine" id="cb1064-158" data-line-number="158"><span class="co">#&gt; 4 382887.000000       0.35945          0.41667     0.93485</span></a>
<a class="sourceLine" id="cb1064-159" data-line-number="159"><span class="co">#&gt;   training_classification_error validation_rmse validation_logloss</span></a>
<a class="sourceLine" id="cb1064-160" data-line-number="160"><span class="co">#&gt; 1                            NA              NA                 NA</span></a>
<a class="sourceLine" id="cb1064-161" data-line-number="161"><span class="co">#&gt; 2                       0.26143         0.44393            0.62273</span></a>
<a class="sourceLine" id="cb1064-162" data-line-number="162"><span class="co">#&gt; 3                       0.17845         0.36982            0.43433</span></a>
<a class="sourceLine" id="cb1064-163" data-line-number="163"><span class="co">#&gt; 4                       0.17296         0.36296            0.42196</span></a>
<a class="sourceLine" id="cb1064-164" data-line-number="164"><span class="co">#&gt;   validation_r2 validation_classification_error</span></a>
<a class="sourceLine" id="cb1064-165" data-line-number="165"><span class="co">#&gt; 1            NA                              NA</span></a>
<a class="sourceLine" id="cb1064-166" data-line-number="166"><span class="co">#&gt; 2       0.89898                         0.26367</span></a>
<a class="sourceLine" id="cb1064-167" data-line-number="167"><span class="co">#&gt; 3       0.92989                         0.18155</span></a>
<a class="sourceLine" id="cb1064-168" data-line-number="168"><span class="co">#&gt; 4       0.93247                         0.17743</span></a>
<a class="sourceLine" id="cb1064-169" data-line-number="169"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-170" data-line-number="170"><span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span></a>
<a class="sourceLine" id="cb1064-171" data-line-number="171"><span class="co">#&gt; =================================================</span></a>
<a class="sourceLine" id="cb1064-172" data-line-number="172"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-173" data-line-number="173"><span class="co">#&gt; Variable Importances: </span></a>
<a class="sourceLine" id="cb1064-174" data-line-number="174"><span class="co">#&gt;                             variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1064-175" data-line-number="175"><span class="co">#&gt; 1                          Elevation            1.000000          1.000000</span></a>
<a class="sourceLine" id="cb1064-176" data-line-number="176"><span class="co">#&gt; 2 Horizontal_Distance_To_Fire_Points            0.937127          0.937127</span></a>
<a class="sourceLine" id="cb1064-177" data-line-number="177"><span class="co">#&gt; 3    Horizontal_Distance_To_Roadways            0.925575          0.925575</span></a>
<a class="sourceLine" id="cb1064-178" data-line-number="178"><span class="co">#&gt; 4             Wilderness_Area.area_0            0.923445          0.923445</span></a>
<a class="sourceLine" id="cb1064-179" data-line-number="179"><span class="co">#&gt; 5             Wilderness_Area.area_2            0.840108          0.840108</span></a>
<a class="sourceLine" id="cb1064-180" data-line-number="180"><span class="co">#&gt;   percentage</span></a>
<a class="sourceLine" id="cb1064-181" data-line-number="181"><span class="co">#&gt; 1   0.031124</span></a>
<a class="sourceLine" id="cb1064-182" data-line-number="182"><span class="co">#&gt; 2   0.029167</span></a>
<a class="sourceLine" id="cb1064-183" data-line-number="183"><span class="co">#&gt; 3   0.028807</span></a>
<a class="sourceLine" id="cb1064-184" data-line-number="184"><span class="co">#&gt; 4   0.028741</span></a>
<a class="sourceLine" id="cb1064-185" data-line-number="185"><span class="co">#&gt; 5   0.026147</span></a>
<a class="sourceLine" id="cb1064-186" data-line-number="186"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-187" data-line-number="187"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1064-188" data-line-number="188"><span class="co">#&gt;                       variable relative_importance scaled_importance percentage</span></a>
<a class="sourceLine" id="cb1064-189" data-line-number="189"><span class="co">#&gt; 51           Soil_Type.type_14            0.442107          0.442107   0.013760</span></a>
<a class="sourceLine" id="cb1064-190" data-line-number="190"><span class="co">#&gt; 52           Soil_Type.type_17            0.433302          0.433302   0.013486</span></a>
<a class="sourceLine" id="cb1064-191" data-line-number="191"><span class="co">#&gt; 53               Hillshade_3pm            0.383027          0.383027   0.011921</span></a>
<a class="sourceLine" id="cb1064-192" data-line-number="192"><span class="co">#&gt; 54                      Aspect            0.309722          0.309722   0.009640</span></a>
<a class="sourceLine" id="cb1064-193" data-line-number="193"><span class="co">#&gt; 55       Soil_Type.missing(NA)            0.000000          0.000000   0.000000</span></a>
<a class="sourceLine" id="cb1064-194" data-line-number="194"><span class="co">#&gt; 56 Wilderness_Area.missing(NA)            0.000000          0.000000   0.000000</span></a></code></pre></div>
<p>Inspect the model in Flow for more information about model building etc. by issuing a cell with the content getModel “dl_model_first”, and pressing Ctrl-Enter.</p>
</div>
<div id="variable-importances" class="section level3">
<h3>
<span class="header-section-number">46.5.2</span> Variable Importances<a class="anchor" aria-label="anchor" href="#variable-importances"><i class="fas fa-link"></i></a>
</h3>
<p>Variable importances for Neural Network models are notoriously difficult to compute, and there are many pitfalls. H2O Deep Learning has implemented the method of Gedeon, and returns relative variable importances in descending order of importance.</p>
<div class="sourceCode" id="cb1065"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.varimp.html">h2o.varimp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                             variable relative_importance scaled_importance</span>
<span class="co">#&gt; 1                          Elevation               1.000             1.000</span>
<span class="co">#&gt; 2 Horizontal_Distance_To_Fire_Points               0.937             0.937</span>
<span class="co">#&gt; 3    Horizontal_Distance_To_Roadways               0.926             0.926</span>
<span class="co">#&gt; 4             Wilderness_Area.area_0               0.923             0.923</span>
<span class="co">#&gt; 5             Wilderness_Area.area_2               0.840             0.840</span>
<span class="co">#&gt; 6             Wilderness_Area.area_1               0.783             0.783</span>
<span class="co">#&gt;   percentage</span>
<span class="co">#&gt; 1     0.0311</span>
<span class="co">#&gt; 2     0.0292</span>
<span class="co">#&gt; 3     0.0288</span>
<span class="co">#&gt; 4     0.0287</span>
<span class="co">#&gt; 5     0.0261</span>
<span class="co">#&gt; 6     0.0244</span></code></pre></div>
</div>
<div id="early-stopping" class="section level3">
<h3>
<span class="header-section-number">46.5.3</span> Early Stopping<a class="anchor" aria-label="anchor" href="#early-stopping"><i class="fas fa-link"></i></a>
</h3>
<p>Now we run another, smaller network, and we let it stop automatically once the misclassification rate converges (specifically, if the moving average of length 2 does not improve by at least 1% for 2 consecutive scoring events). We also sample the validation set to 10,000 rows for faster scoring.</p>
<div class="sourceCode" id="cb1066"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1066-1" data-line-number="1">m2 &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(</a>
<a class="sourceLine" id="cb1066-2" data-line-number="2">  <span class="dt">model_id=</span><span class="st">"dl_model_faster"</span>, </a>
<a class="sourceLine" id="cb1066-3" data-line-number="3">  <span class="dt">training_frame=</span>train, </a>
<a class="sourceLine" id="cb1066-4" data-line-number="4">  <span class="dt">validation_frame=</span>valid,</a>
<a class="sourceLine" id="cb1066-5" data-line-number="5">  <span class="dt">x=</span>predictors,</a>
<a class="sourceLine" id="cb1066-6" data-line-number="6">  <span class="dt">y=</span>response,</a>
<a class="sourceLine" id="cb1066-7" data-line-number="7">  <span class="dt">hidden=</span><span class="kw">c</span>(<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">32</span>),                  <span class="co">## small network, runs faster</span></a>
<a class="sourceLine" id="cb1066-8" data-line-number="8">  <span class="dt">epochs=</span><span class="dv">1000000</span>,                      <span class="co">## hopefully converges earlier...</span></a>
<a class="sourceLine" id="cb1066-9" data-line-number="9">  <span class="dt">score_validation_samples=</span><span class="dv">10000</span>,      <span class="co">## sample the validation dataset (faster)</span></a>
<a class="sourceLine" id="cb1066-10" data-line-number="10">  <span class="dt">stopping_rounds=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1066-11" data-line-number="11">  <span class="dt">stopping_metric=</span><span class="st">"misclassification"</span>, <span class="co">## could be "MSE","logloss","r2"</span></a>
<a class="sourceLine" id="cb1066-12" data-line-number="12">  <span class="dt">stopping_tolerance=</span><span class="fl">0.01</span></a>
<a class="sourceLine" id="cb1066-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb1066-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-15" data-line-number="15">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1066-16" data-line-number="16"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1066-17" data-line-number="17">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1066-18" data-line-number="18"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1066-19" data-line-number="19"><span class="kw">summary</span>(m2)</a>
<a class="sourceLine" id="cb1066-20" data-line-number="20"><span class="co">#&gt; Model Details:</span></a>
<a class="sourceLine" id="cb1066-21" data-line-number="21"><span class="co">#&gt; ==============</span></a>
<a class="sourceLine" id="cb1066-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-23" data-line-number="23"><span class="co">#&gt; H2OMultinomialModel: deeplearning</span></a>
<a class="sourceLine" id="cb1066-24" data-line-number="24"><span class="co">#&gt; Model Key:  dl_model_faster </span></a>
<a class="sourceLine" id="cb1066-25" data-line-number="25"><span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 4,167 weights/biases, 57.9 KB, 6,100,399 training samples, mini-batch size 1</span></a>
<a class="sourceLine" id="cb1066-26" data-line-number="26"><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></a>
<a class="sourceLine" id="cb1066-27" data-line-number="27"><span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span></a>
<a class="sourceLine" id="cb1066-28" data-line-number="28"><span class="co">#&gt; 2     2    32 Rectifier  0.00 % 0.000000 0.000000  0.047239 0.209274 0.000000</span></a>
<a class="sourceLine" id="cb1066-29" data-line-number="29"><span class="co">#&gt; 3     3    32 Rectifier  0.00 % 0.000000 0.000000  0.000316 0.000145 0.000000</span></a>
<a class="sourceLine" id="cb1066-30" data-line-number="30"><span class="co">#&gt; 4     4    32 Rectifier  0.00 % 0.000000 0.000000  0.000624 0.000524 0.000000</span></a>
<a class="sourceLine" id="cb1066-31" data-line-number="31"><span class="co">#&gt; 5     5     7   Softmax      NA 0.000000 0.000000  0.131989 0.320338 0.000000</span></a>
<a class="sourceLine" id="cb1066-32" data-line-number="32"><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></a>
<a class="sourceLine" id="cb1066-33" data-line-number="33"><span class="co">#&gt; 1          NA         NA        NA       NA</span></a>
<a class="sourceLine" id="cb1066-34" data-line-number="34"><span class="co">#&gt; 2   -0.007746   0.308353  0.318408 0.318204</span></a>
<a class="sourceLine" id="cb1066-35" data-line-number="35"><span class="co">#&gt; 3   -0.048561   0.385372  0.532908 0.780092</span></a>
<a class="sourceLine" id="cb1066-36" data-line-number="36"><span class="co">#&gt; 4    0.048894   0.559214  0.703946 0.808040</span></a>
<a class="sourceLine" id="cb1066-37" data-line-number="37"><span class="co">#&gt; 5   -3.758495   3.397758 -2.136927 0.630783</span></a>
<a class="sourceLine" id="cb1066-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-39" data-line-number="39"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1066-40" data-line-number="40"><span class="co">#&gt; ** Reported on training data. **</span></a>
<a class="sourceLine" id="cb1066-41" data-line-number="41"><span class="co">#&gt; ** Metrics reported on temporary training frame with 10051 samples **</span></a>
<a class="sourceLine" id="cb1066-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-43" data-line-number="43"><span class="co">#&gt; Training Set Metrics: </span></a>
<a class="sourceLine" id="cb1066-44" data-line-number="44"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1066-45" data-line-number="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-46" data-line-number="46"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.115</span></a>
<a class="sourceLine" id="cb1066-47" data-line-number="47"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.339</span></a>
<a class="sourceLine" id="cb1066-48" data-line-number="48"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.389</span></a>
<a class="sourceLine" id="cb1066-49" data-line-number="49"><span class="co">#&gt; Mean Per-Class Error: 0.249</span></a>
<a class="sourceLine" id="cb1066-50" data-line-number="50"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span></a>
<a class="sourceLine" id="cb1066-51" data-line-number="51"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1066-52" data-line-number="52"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1066-53" data-line-number="53"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1066-54" data-line-number="54"><span class="co">#&gt; class_1    2915     759       1       0      13       2      52 0.2210</span></a>
<a class="sourceLine" id="cb1066-55" data-line-number="55"><span class="co">#&gt; class_2     234    4474      23       0      55      30       6 0.0722</span></a>
<a class="sourceLine" id="cb1066-56" data-line-number="56"><span class="co">#&gt; class_3       0      33     494       6       5      49       0 0.1584</span></a>
<a class="sourceLine" id="cb1066-57" data-line-number="57"><span class="co">#&gt; class_4       0       0      28      36       0       5       0 0.4783</span></a>
<a class="sourceLine" id="cb1066-58" data-line-number="58"><span class="co">#&gt; class_5       1      50       2       0     116       1       0 0.3176</span></a>
<a class="sourceLine" id="cb1066-59" data-line-number="59"><span class="co">#&gt; class_6       0      28      78       1       3     188       0 0.3691</span></a>
<a class="sourceLine" id="cb1066-60" data-line-number="60"><span class="co">#&gt; class_7      42       3       0       0       0       0     318 0.1240</span></a>
<a class="sourceLine" id="cb1066-61" data-line-number="61"><span class="co">#&gt; Totals     3192    5347     626      43     192     275     376 0.1502</span></a>
<a class="sourceLine" id="cb1066-62" data-line-number="62"><span class="co">#&gt;                     Rate</span></a>
<a class="sourceLine" id="cb1066-63" data-line-number="63"><span class="co">#&gt; class_1 =    827 / 3,742</span></a>
<a class="sourceLine" id="cb1066-64" data-line-number="64"><span class="co">#&gt; class_2 =    348 / 4,822</span></a>
<a class="sourceLine" id="cb1066-65" data-line-number="65"><span class="co">#&gt; class_3 =       93 / 587</span></a>
<a class="sourceLine" id="cb1066-66" data-line-number="66"><span class="co">#&gt; class_4 =        33 / 69</span></a>
<a class="sourceLine" id="cb1066-67" data-line-number="67"><span class="co">#&gt; class_5 =       54 / 170</span></a>
<a class="sourceLine" id="cb1066-68" data-line-number="68"><span class="co">#&gt; class_6 =      110 / 298</span></a>
<a class="sourceLine" id="cb1066-69" data-line-number="69"><span class="co">#&gt; class_7 =       45 / 363</span></a>
<a class="sourceLine" id="cb1066-70" data-line-number="70"><span class="co">#&gt; Totals  = 1,510 / 10,051</span></a>
<a class="sourceLine" id="cb1066-71" data-line-number="71"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-72" data-line-number="72"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span></a>
<a class="sourceLine" id="cb1066-73" data-line-number="73"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1066-74" data-line-number="74"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1066-75" data-line-number="75"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1066-76" data-line-number="76"><span class="co">#&gt; 1 1  0.849766</span></a>
<a class="sourceLine" id="cb1066-77" data-line-number="77"><span class="co">#&gt; 2 2  0.986568</span></a>
<a class="sourceLine" id="cb1066-78" data-line-number="78"><span class="co">#&gt; 3 3  0.997712</span></a>
<a class="sourceLine" id="cb1066-79" data-line-number="79"><span class="co">#&gt; 4 4  0.999503</span></a>
<a class="sourceLine" id="cb1066-80" data-line-number="80"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1066-81" data-line-number="81"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1066-82" data-line-number="82"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1066-83" data-line-number="83"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-84" data-line-number="84"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-85" data-line-number="85"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1066-86" data-line-number="86"><span class="co">#&gt; ** Reported on validation data. **</span></a>
<a class="sourceLine" id="cb1066-87" data-line-number="87"><span class="co">#&gt; ** Metrics reported on temporary validation frame with 10061 samples **</span></a>
<a class="sourceLine" id="cb1066-88" data-line-number="88"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-89" data-line-number="89"><span class="co">#&gt; Validation Set Metrics: </span></a>
<a class="sourceLine" id="cb1066-90" data-line-number="90"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1066-91" data-line-number="91"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-92" data-line-number="92"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.117</span></a>
<a class="sourceLine" id="cb1066-93" data-line-number="93"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.342</span></a>
<a class="sourceLine" id="cb1066-94" data-line-number="94"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.392</span></a>
<a class="sourceLine" id="cb1066-95" data-line-number="95"><span class="co">#&gt; Mean Per-Class Error: 0.232</span></a>
<a class="sourceLine" id="cb1066-96" data-line-number="96"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span></a>
<a class="sourceLine" id="cb1066-97" data-line-number="97"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1066-98" data-line-number="98"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1066-99" data-line-number="99"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1066-100" data-line-number="100"><span class="co">#&gt; class_1    2862     765       0       0      16       1      56 0.2265</span></a>
<a class="sourceLine" id="cb1066-101" data-line-number="101"><span class="co">#&gt; class_2     221    4487      25       1      75      32       7 0.0745</span></a>
<a class="sourceLine" id="cb1066-102" data-line-number="102"><span class="co">#&gt; class_3       0      32     503       7       5      66       0 0.1794</span></a>
<a class="sourceLine" id="cb1066-103" data-line-number="103"><span class="co">#&gt; class_4       0       1      12      45       0       5       0 0.2857</span></a>
<a class="sourceLine" id="cb1066-104" data-line-number="104"><span class="co">#&gt; class_5       1      54       3       0     104       0       0 0.3580</span></a>
<a class="sourceLine" id="cb1066-105" data-line-number="105"><span class="co">#&gt; class_6       0      33      90       0       3     198       0 0.3889</span></a>
<a class="sourceLine" id="cb1066-106" data-line-number="106"><span class="co">#&gt; class_7      33       7       0       0       0       0     311 0.1140</span></a>
<a class="sourceLine" id="cb1066-107" data-line-number="107"><span class="co">#&gt; Totals     3117    5379     633      53     203     302     374 0.1542</span></a>
<a class="sourceLine" id="cb1066-108" data-line-number="108"><span class="co">#&gt;                     Rate</span></a>
<a class="sourceLine" id="cb1066-109" data-line-number="109"><span class="co">#&gt; class_1 =    838 / 3,700</span></a>
<a class="sourceLine" id="cb1066-110" data-line-number="110"><span class="co">#&gt; class_2 =    361 / 4,848</span></a>
<a class="sourceLine" id="cb1066-111" data-line-number="111"><span class="co">#&gt; class_3 =      110 / 613</span></a>
<a class="sourceLine" id="cb1066-112" data-line-number="112"><span class="co">#&gt; class_4 =        18 / 63</span></a>
<a class="sourceLine" id="cb1066-113" data-line-number="113"><span class="co">#&gt; class_5 =       58 / 162</span></a>
<a class="sourceLine" id="cb1066-114" data-line-number="114"><span class="co">#&gt; class_6 =      126 / 324</span></a>
<a class="sourceLine" id="cb1066-115" data-line-number="115"><span class="co">#&gt; class_7 =       40 / 351</span></a>
<a class="sourceLine" id="cb1066-116" data-line-number="116"><span class="co">#&gt; Totals  = 1,551 / 10,061</span></a>
<a class="sourceLine" id="cb1066-117" data-line-number="117"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-118" data-line-number="118"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span></a>
<a class="sourceLine" id="cb1066-119" data-line-number="119"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1066-120" data-line-number="120"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1066-121" data-line-number="121"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1066-122" data-line-number="122"><span class="co">#&gt; 1 1  0.845840</span></a>
<a class="sourceLine" id="cb1066-123" data-line-number="123"><span class="co">#&gt; 2 2  0.985091</span></a>
<a class="sourceLine" id="cb1066-124" data-line-number="124"><span class="co">#&gt; 3 3  0.998112</span></a>
<a class="sourceLine" id="cb1066-125" data-line-number="125"><span class="co">#&gt; 4 4  0.999901</span></a>
<a class="sourceLine" id="cb1066-126" data-line-number="126"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1066-127" data-line-number="127"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1066-128" data-line-number="128"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1066-129" data-line-number="129"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-130" data-line-number="130"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-131" data-line-number="131"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-132" data-line-number="132"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-133" data-line-number="133"><span class="co">#&gt; Scoring History: </span></a>
<a class="sourceLine" id="cb1066-134" data-line-number="134"><span class="co">#&gt;              timestamp   duration training_speed   epochs iterations</span></a>
<a class="sourceLine" id="cb1066-135" data-line-number="135"><span class="co">#&gt; 1  2020-11-20 03:25:30  0.000 sec             NA  0.00000          0</span></a>
<a class="sourceLine" id="cb1066-136" data-line-number="136"><span class="co">#&gt; 2  2020-11-20 03:25:31  1.218 sec  86537 obs/sec  0.28663          1</span></a>
<a class="sourceLine" id="cb1066-137" data-line-number="137"><span class="co">#&gt; 3  2020-11-20 03:25:37  6.904 sec 117540 obs/sec  2.29412          8</span></a>
<a class="sourceLine" id="cb1066-138" data-line-number="138"><span class="co">#&gt; 4  2020-11-20 03:25:42 12.216 sec 124136 obs/sec  4.30227         15</span></a>
<a class="sourceLine" id="cb1066-139" data-line-number="139"><span class="co">#&gt; 5  2020-11-20 03:25:48 17.465 sec 127160 obs/sec  6.30821         22</span></a>
<a class="sourceLine" id="cb1066-140" data-line-number="140"><span class="co">#&gt; 6  2020-11-20 03:25:53 22.522 sec 129849 obs/sec  8.31226         29</span></a>
<a class="sourceLine" id="cb1066-141" data-line-number="141"><span class="co">#&gt; 7  2020-11-20 03:25:58 28.169 sec 132359 obs/sec 10.60271         37</span></a>
<a class="sourceLine" id="cb1066-142" data-line-number="142"><span class="co">#&gt; 8  2020-11-20 03:26:04 33.810 sec 134053 obs/sec 12.89398         45</span></a>
<a class="sourceLine" id="cb1066-143" data-line-number="143"><span class="co">#&gt; 9  2020-11-20 03:26:10 39.374 sec 135568 obs/sec 15.18461         53</span></a>
<a class="sourceLine" id="cb1066-144" data-line-number="144"><span class="co">#&gt; 10 2020-11-20 03:26:15 45.121 sec 136151 obs/sec 17.47890         61</span></a>
<a class="sourceLine" id="cb1066-145" data-line-number="145"><span class="co">#&gt; 11 2020-11-20 03:26:15 45.156 sec 136145 obs/sec 17.47890         61</span></a>
<a class="sourceLine" id="cb1066-146" data-line-number="146"><span class="co">#&gt;           samples training_rmse training_logloss training_r2</span></a>
<a class="sourceLine" id="cb1066-147" data-line-number="147"><span class="co">#&gt; 1        0.000000            NA               NA          NA</span></a>
<a class="sourceLine" id="cb1066-148" data-line-number="148"><span class="co">#&gt; 2   100037.000000       0.44433          0.61635     0.90055</span></a>
<a class="sourceLine" id="cb1066-149" data-line-number="149"><span class="co">#&gt; 3   800683.000000       0.37721          0.45233     0.92833</span></a>
<a class="sourceLine" id="cb1066-150" data-line-number="150"><span class="co">#&gt; 4  1501557.000000       0.36405          0.42387     0.93324</span></a>
<a class="sourceLine" id="cb1066-151" data-line-number="151"><span class="co">#&gt; 5  2201659.000000       0.35280          0.41546     0.93730</span></a>
<a class="sourceLine" id="cb1066-152" data-line-number="152"><span class="co">#&gt; 6  2901104.000000       0.35123          0.41707     0.93786</span></a>
<a class="sourceLine" id="cb1066-153" data-line-number="153"><span class="co">#&gt; 7  3700506.000000       0.34083          0.38757     0.94148</span></a>
<a class="sourceLine" id="cb1066-154" data-line-number="154"><span class="co">#&gt; 8  4500191.000000       0.34116          0.38573     0.94137</span></a>
<a class="sourceLine" id="cb1066-155" data-line-number="155"><span class="co">#&gt; 9  5299658.000000       0.33887          0.38902     0.94216</span></a>
<a class="sourceLine" id="cb1066-156" data-line-number="156"><span class="co">#&gt; 10 6100399.000000       0.34641          0.41733     0.93955</span></a>
<a class="sourceLine" id="cb1066-157" data-line-number="157"><span class="co">#&gt; 11 6100399.000000       0.33887          0.38902     0.94216</span></a>
<a class="sourceLine" id="cb1066-158" data-line-number="158"><span class="co">#&gt;    training_classification_error validation_rmse validation_logloss</span></a>
<a class="sourceLine" id="cb1066-159" data-line-number="159"><span class="co">#&gt; 1                             NA              NA                 NA</span></a>
<a class="sourceLine" id="cb1066-160" data-line-number="160"><span class="co">#&gt; 2                        0.26435         0.44000            0.60607</span></a>
<a class="sourceLine" id="cb1066-161" data-line-number="161"><span class="co">#&gt; 3                        0.19013         0.37728            0.45445</span></a>
<a class="sourceLine" id="cb1066-162" data-line-number="162"><span class="co">#&gt; 4                        0.17948         0.36368            0.42504</span></a>
<a class="sourceLine" id="cb1066-163" data-line-number="163"><span class="co">#&gt; 5                        0.16705         0.35426            0.41375</span></a>
<a class="sourceLine" id="cb1066-164" data-line-number="164"><span class="co">#&gt; 6                        0.16516         0.35363            0.41177</span></a>
<a class="sourceLine" id="cb1066-165" data-line-number="165"><span class="co">#&gt; 7                        0.15680         0.34155            0.38641</span></a>
<a class="sourceLine" id="cb1066-166" data-line-number="166"><span class="co">#&gt; 8                        0.15322         0.34093            0.38759</span></a>
<a class="sourceLine" id="cb1066-167" data-line-number="167"><span class="co">#&gt; 9                        0.15023         0.34191            0.39202</span></a>
<a class="sourceLine" id="cb1066-168" data-line-number="168"><span class="co">#&gt; 10                       0.16287         0.34426            0.40771</span></a>
<a class="sourceLine" id="cb1066-169" data-line-number="169"><span class="co">#&gt; 11                       0.15023         0.34191            0.39202</span></a>
<a class="sourceLine" id="cb1066-170" data-line-number="170"><span class="co">#&gt;    validation_r2 validation_classification_error</span></a>
<a class="sourceLine" id="cb1066-171" data-line-number="171"><span class="co">#&gt; 1             NA                              NA</span></a>
<a class="sourceLine" id="cb1066-172" data-line-number="172"><span class="co">#&gt; 2        0.90236                         0.25862</span></a>
<a class="sourceLine" id="cb1066-173" data-line-number="173"><span class="co">#&gt; 3        0.92821                         0.19133</span></a>
<a class="sourceLine" id="cb1066-174" data-line-number="174"><span class="co">#&gt; 4        0.93329                         0.17563</span></a>
<a class="sourceLine" id="cb1066-175" data-line-number="175"><span class="co">#&gt; 5        0.93670                         0.16539</span></a>
<a class="sourceLine" id="cb1066-176" data-line-number="176"><span class="co">#&gt; 6        0.93693                         0.17145</span></a>
<a class="sourceLine" id="cb1066-177" data-line-number="177"><span class="co">#&gt; 7        0.94116                         0.15525</span></a>
<a class="sourceLine" id="cb1066-178" data-line-number="178"><span class="co">#&gt; 8        0.94138                         0.15664</span></a>
<a class="sourceLine" id="cb1066-179" data-line-number="179"><span class="co">#&gt; 9        0.94104                         0.15416</span></a>
<a class="sourceLine" id="cb1066-180" data-line-number="180"><span class="co">#&gt; 10       0.94023                         0.16261</span></a>
<a class="sourceLine" id="cb1066-181" data-line-number="181"><span class="co">#&gt; 11       0.94104                         0.15416</span></a>
<a class="sourceLine" id="cb1066-182" data-line-number="182"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-183" data-line-number="183"><span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span></a>
<a class="sourceLine" id="cb1066-184" data-line-number="184"><span class="co">#&gt; =================================================</span></a>
<a class="sourceLine" id="cb1066-185" data-line-number="185"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-186" data-line-number="186"><span class="co">#&gt; Variable Importances: </span></a>
<a class="sourceLine" id="cb1066-187" data-line-number="187"><span class="co">#&gt;                          variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1066-188" data-line-number="188"><span class="co">#&gt; 1 Horizontal_Distance_To_Roadways            1.000000          1.000000</span></a>
<a class="sourceLine" id="cb1066-189" data-line-number="189"><span class="co">#&gt; 2          Wilderness_Area.area_3            0.976070          0.976070</span></a>
<a class="sourceLine" id="cb1066-190" data-line-number="190"><span class="co">#&gt; 3                       Elevation            0.919578          0.919578</span></a>
<a class="sourceLine" id="cb1066-191" data-line-number="191"><span class="co">#&gt; 4          Wilderness_Area.area_1            0.870796          0.870796</span></a>
<a class="sourceLine" id="cb1066-192" data-line-number="192"><span class="co">#&gt; 5          Wilderness_Area.area_0            0.854139          0.854139</span></a>
<a class="sourceLine" id="cb1066-193" data-line-number="193"><span class="co">#&gt;   percentage</span></a>
<a class="sourceLine" id="cb1066-194" data-line-number="194"><span class="co">#&gt; 1   0.036580</span></a>
<a class="sourceLine" id="cb1066-195" data-line-number="195"><span class="co">#&gt; 2   0.035705</span></a>
<a class="sourceLine" id="cb1066-196" data-line-number="196"><span class="co">#&gt; 3   0.033639</span></a>
<a class="sourceLine" id="cb1066-197" data-line-number="197"><span class="co">#&gt; 4   0.031854</span></a>
<a class="sourceLine" id="cb1066-198" data-line-number="198"><span class="co">#&gt; 5   0.031245</span></a>
<a class="sourceLine" id="cb1066-199" data-line-number="199"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-200" data-line-number="200"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1066-201" data-line-number="201"><span class="co">#&gt;                            variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1066-202" data-line-number="202"><span class="co">#&gt; 51 Horizontal_Distance_To_Hydrology            0.307296          0.307296</span></a>
<a class="sourceLine" id="cb1066-203" data-line-number="203"><span class="co">#&gt; 52                Soil_Type.type_14            0.305442          0.305442</span></a>
<a class="sourceLine" id="cb1066-204" data-line-number="204"><span class="co">#&gt; 53                            Slope            0.143808          0.143808</span></a>
<a class="sourceLine" id="cb1066-205" data-line-number="205"><span class="co">#&gt; 54                           Aspect            0.045524          0.045524</span></a>
<a class="sourceLine" id="cb1066-206" data-line-number="206"><span class="co">#&gt; 55            Soil_Type.missing(NA)            0.000000          0.000000</span></a>
<a class="sourceLine" id="cb1066-207" data-line-number="207"><span class="co">#&gt; 56      Wilderness_Area.missing(NA)            0.000000          0.000000</span></a>
<a class="sourceLine" id="cb1066-208" data-line-number="208"><span class="co">#&gt;    percentage</span></a>
<a class="sourceLine" id="cb1066-209" data-line-number="209"><span class="co">#&gt; 51   0.011241</span></a>
<a class="sourceLine" id="cb1066-210" data-line-number="210"><span class="co">#&gt; 52   0.011173</span></a>
<a class="sourceLine" id="cb1066-211" data-line-number="211"><span class="co">#&gt; 53   0.005261</span></a>
<a class="sourceLine" id="cb1066-212" data-line-number="212"><span class="co">#&gt; 54   0.001665</span></a>
<a class="sourceLine" id="cb1066-213" data-line-number="213"><span class="co">#&gt; 55   0.000000</span></a>
<a class="sourceLine" id="cb1066-214" data-line-number="214"><span class="co">#&gt; 56   0.000000</span></a>
<a class="sourceLine" id="cb1066-215" data-line-number="215"><span class="kw">plot</span>(m2)</a></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/dl_ctype_early_stopping-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="adaptive-learning-rate" class="section level3">
<h3>
<span class="header-section-number">46.5.4</span> Adaptive Learning Rate<a class="anchor" aria-label="anchor" href="#adaptive-learning-rate"><i class="fas fa-link"></i></a>
</h3>
<p>By default, H2O Deep Learning uses an adaptive learning rate (ADADELTA) for its stochastic gradient descent optimization. There are only two tuning parameters for this method: rho and epsilon, which balance the global and local search efficiencies. rho is the similarity to prior weight updates (similar to momentum), and epsilon is a parameter that prevents the optimization to get stuck in local optima. Defaults are rho=0.99 and epsilon=1e-8. For cases where convergence speed is very important, it might make sense to perform a few runs to optimize these two parameters (e.g., with rho in c(0.9,0.95,0.99,0.999) and epsilon in c(1e-10,1e-8,1e-6,1e-4)). Of course, as always with grid searches, caution has to be applied when extrapolating grid search results to a different parameter regime (e.g., for more epochs or different layer topologies or activation functions, etc.).</p>
<p>If adaptive_rate is disabled, several manual learning rate parameters become important: rate, rate_annealing, rate_decay, momentum_start, momentum_ramp, momentum_stable and <code>nesterov_accelerated_gradient</code>, the discussion of which we leave to H2O Deep Learning booklet.</p>
</div>
<div id="tuning" class="section level3">
<h3>
<span class="header-section-number">46.5.5</span> Tuning<a class="anchor" aria-label="anchor" href="#tuning"><i class="fas fa-link"></i></a>
</h3>
<p>With some tuning, it is possible to obtain less than 10% test set error rate in about one minute. Error rates of below 5% are possible with larger models. Note that deep tree methods can be more effective for this dataset than Deep Learning, as they directly partition the space into sectors, which seems to be needed here.</p>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1067-1" data-line-number="1">m3 &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(</a>
<a class="sourceLine" id="cb1067-2" data-line-number="2">  <span class="dt">model_id=</span><span class="st">"dl_model_tuned"</span>, </a>
<a class="sourceLine" id="cb1067-3" data-line-number="3">  <span class="dt">training_frame=</span>train, </a>
<a class="sourceLine" id="cb1067-4" data-line-number="4">  <span class="dt">validation_frame=</span>valid, </a>
<a class="sourceLine" id="cb1067-5" data-line-number="5">  <span class="dt">x=</span>predictors, </a>
<a class="sourceLine" id="cb1067-6" data-line-number="6">  <span class="dt">y=</span>response, </a>
<a class="sourceLine" id="cb1067-7" data-line-number="7">  <span class="dt">overwrite_with_best_model=</span>F,    <span class="co">## Return final model after 10 epochs, even if not the best</span></a>
<a class="sourceLine" id="cb1067-8" data-line-number="8">  <span class="dt">hidden=</span><span class="kw">c</span>(<span class="dv">128</span>,<span class="dv">128</span>,<span class="dv">128</span>),          <span class="co">## more hidden layers -&gt; more complex interactions</span></a>
<a class="sourceLine" id="cb1067-9" data-line-number="9">  <span class="dt">epochs=</span><span class="dv">10</span>,                      <span class="co">## to keep it short enough</span></a>
<a class="sourceLine" id="cb1067-10" data-line-number="10">  <span class="dt">score_validation_samples=</span><span class="dv">10000</span>, <span class="co">## downsample validation set for faster scoring</span></a>
<a class="sourceLine" id="cb1067-11" data-line-number="11">  <span class="dt">score_duty_cycle=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span></a>
<a class="sourceLine" id="cb1067-12" data-line-number="12">  <span class="dt">adaptive_rate=</span>F,                <span class="co">## manually tuned learning rate</span></a>
<a class="sourceLine" id="cb1067-13" data-line-number="13">  <span class="dt">rate=</span><span class="fl">0.01</span>, </a>
<a class="sourceLine" id="cb1067-14" data-line-number="14">  <span class="dt">rate_annealing=</span><span class="fl">2e-6</span>,            </a>
<a class="sourceLine" id="cb1067-15" data-line-number="15">  <span class="dt">momentum_start=</span><span class="fl">0.2</span>,             <span class="co">## manually tuned momentum</span></a>
<a class="sourceLine" id="cb1067-16" data-line-number="16">  <span class="dt">momentum_stable=</span><span class="fl">0.4</span>, </a>
<a class="sourceLine" id="cb1067-17" data-line-number="17">  <span class="dt">momentum_ramp=</span><span class="fl">1e7</span>, </a>
<a class="sourceLine" id="cb1067-18" data-line-number="18">  <span class="dt">l1=</span><span class="fl">1e-5</span>,                        <span class="co">## add some L1/L2 regularization</span></a>
<a class="sourceLine" id="cb1067-19" data-line-number="19">  <span class="dt">l2=</span><span class="fl">1e-5</span>,</a>
<a class="sourceLine" id="cb1067-20" data-line-number="20">  <span class="dt">max_w2=</span><span class="dv">10</span>                       <span class="co">## helps stability for Rectifier</span></a>
<a class="sourceLine" id="cb1067-21" data-line-number="21">) </a>
<a class="sourceLine" id="cb1067-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-23" data-line-number="23">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-24" data-line-number="24"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1067-25" data-line-number="25">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-26" data-line-number="26"><span class="st">  </span><span class="er">|==</span><span class="st">                                                                    </span><span class="er">|</span><span class="st">   </span><span class="dv">3</span>%</a>
<a class="sourceLine" id="cb1067-27" data-line-number="27">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-28" data-line-number="28"><span class="st">  </span><span class="er">|====</span><span class="st">                                                                  </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%</a>
<a class="sourceLine" id="cb1067-29" data-line-number="29">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-30" data-line-number="30"><span class="st">  </span><span class="er">|======</span><span class="st">                                                                </span><span class="er">|</span><span class="st">   </span><span class="dv">9</span>%</a>
<a class="sourceLine" id="cb1067-31" data-line-number="31">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-32" data-line-number="32"><span class="st">  </span><span class="er">|========</span><span class="st">                                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%</a>
<a class="sourceLine" id="cb1067-33" data-line-number="33">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-34" data-line-number="34"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb1067-35" data-line-number="35">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-36" data-line-number="36"><span class="st">  </span><span class="er">|============</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">17</span>%</a>
<a class="sourceLine" id="cb1067-37" data-line-number="37">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-38" data-line-number="38"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb1067-39" data-line-number="39">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-40" data-line-number="40"><span class="st">  </span><span class="er">|================</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">23</span>%</a>
<a class="sourceLine" id="cb1067-41" data-line-number="41">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-42" data-line-number="42"><span class="st">  </span><span class="er">|==================</span><span class="st">                                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%</a>
<a class="sourceLine" id="cb1067-43" data-line-number="43">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-44" data-line-number="44"><span class="st">  </span><span class="er">|====================</span><span class="st">                                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb1067-45" data-line-number="45">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-46" data-line-number="46"><span class="st">  </span><span class="er">|======================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%</a>
<a class="sourceLine" id="cb1067-47" data-line-number="47">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-48" data-line-number="48"><span class="st">  </span><span class="er">|========================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">34</span>%</a>
<a class="sourceLine" id="cb1067-49" data-line-number="49">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-50" data-line-number="50"><span class="st">  </span><span class="er">|==========================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%</a>
<a class="sourceLine" id="cb1067-51" data-line-number="51">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-52" data-line-number="52"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb1067-53" data-line-number="53">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-54" data-line-number="54"><span class="st">  </span><span class="er">|==============================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%</a>
<a class="sourceLine" id="cb1067-55" data-line-number="55">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-56" data-line-number="56"><span class="st">  </span><span class="er">|================================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">46</span>%</a>
<a class="sourceLine" id="cb1067-57" data-line-number="57">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-58" data-line-number="58"><span class="st">  </span><span class="er">|==================================</span><span class="st">                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">49</span>%</a>
<a class="sourceLine" id="cb1067-59" data-line-number="59">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-60" data-line-number="60"><span class="st">  </span><span class="er">|====================================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">52</span>%</a>
<a class="sourceLine" id="cb1067-61" data-line-number="61">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-62" data-line-number="62"><span class="st">  </span><span class="er">|======================================</span><span class="st">                                </span><span class="er">|</span><span class="st">  </span><span class="dv">54</span>%</a>
<a class="sourceLine" id="cb1067-63" data-line-number="63">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-64" data-line-number="64"><span class="st">  </span><span class="er">|========================================</span><span class="st">                              </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%</a>
<a class="sourceLine" id="cb1067-65" data-line-number="65">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-66" data-line-number="66"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb1067-67" data-line-number="67">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-68" data-line-number="68"><span class="st">  </span><span class="er">|============================================</span><span class="st">                          </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%</a>
<a class="sourceLine" id="cb1067-69" data-line-number="69">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-70" data-line-number="70"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">66</span>%</a>
<a class="sourceLine" id="cb1067-71" data-line-number="71">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-72" data-line-number="72"><span class="st">  </span><span class="er">|================================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">69</span>%</a>
<a class="sourceLine" id="cb1067-73" data-line-number="73">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-74" data-line-number="74"><span class="st">  </span><span class="er">|==================================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">72</span>%</a>
<a class="sourceLine" id="cb1067-75" data-line-number="75">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-76" data-line-number="76"><span class="st">  </span><span class="er">|====================================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%</a>
<a class="sourceLine" id="cb1067-77" data-line-number="77">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-78" data-line-number="78"><span class="st">  </span><span class="er">|======================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">77</span>%</a>
<a class="sourceLine" id="cb1067-79" data-line-number="79">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-80" data-line-number="80"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb1067-81" data-line-number="81">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-82" data-line-number="82"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">83</span>%</a>
<a class="sourceLine" id="cb1067-83" data-line-number="83">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-84" data-line-number="84"><span class="st">  </span><span class="er">|============================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb1067-85" data-line-number="85">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-86" data-line-number="86"><span class="st">  </span><span class="er">|==============================================================</span><span class="st">        </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%</a>
<a class="sourceLine" id="cb1067-87" data-line-number="87">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-88" data-line-number="88"><span class="st">  </span><span class="er">|================================================================</span><span class="st">      </span><span class="er">|</span><span class="st">  </span><span class="dv">92</span>%</a>
<a class="sourceLine" id="cb1067-89" data-line-number="89">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-90" data-line-number="90"><span class="st">  </span><span class="er">|==================================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%</a>
<a class="sourceLine" id="cb1067-91" data-line-number="91">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-92" data-line-number="92"><span class="st">  </span><span class="er">|====================================================================</span><span class="st">  </span><span class="er">|</span><span class="st">  </span><span class="dv">97</span>%</a>
<a class="sourceLine" id="cb1067-93" data-line-number="93">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-94" data-line-number="94"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1067-95" data-line-number="95"><span class="kw">summary</span>(m3)</a>
<a class="sourceLine" id="cb1067-96" data-line-number="96"><span class="co">#&gt; Model Details:</span></a>
<a class="sourceLine" id="cb1067-97" data-line-number="97"><span class="co">#&gt; ==============</span></a>
<a class="sourceLine" id="cb1067-98" data-line-number="98"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-99" data-line-number="99"><span class="co">#&gt; H2OMultinomialModel: deeplearning</span></a>
<a class="sourceLine" id="cb1067-100" data-line-number="100"><span class="co">#&gt; Model Key:  dl_model_tuned </span></a>
<a class="sourceLine" id="cb1067-101" data-line-number="101"><span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 41,223 weights/biases, 332.9 KB, 3,499,847 training samples, mini-batch size 1</span></a>
<a class="sourceLine" id="cb1067-102" data-line-number="102"><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></a>
<a class="sourceLine" id="cb1067-103" data-line-number="103"><span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span></a>
<a class="sourceLine" id="cb1067-104" data-line-number="104"><span class="co">#&gt; 2     2   128 Rectifier  0.00 % 0.000010 0.000010  0.001250 0.000000 0.269997</span></a>
<a class="sourceLine" id="cb1067-105" data-line-number="105"><span class="co">#&gt; 3     3   128 Rectifier  0.00 % 0.000010 0.000010  0.001250 0.000000 0.269997</span></a>
<a class="sourceLine" id="cb1067-106" data-line-number="106"><span class="co">#&gt; 4     4   128 Rectifier  0.00 % 0.000010 0.000010  0.001250 0.000000 0.269997</span></a>
<a class="sourceLine" id="cb1067-107" data-line-number="107"><span class="co">#&gt; 5     5     7   Softmax      NA 0.000010 0.000010  0.001250 0.000000 0.269997</span></a>
<a class="sourceLine" id="cb1067-108" data-line-number="108"><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></a>
<a class="sourceLine" id="cb1067-109" data-line-number="109"><span class="co">#&gt; 1          NA         NA        NA       NA</span></a>
<a class="sourceLine" id="cb1067-110" data-line-number="110"><span class="co">#&gt; 2   -0.010395   0.316163 -0.004841 0.280280</span></a>
<a class="sourceLine" id="cb1067-111" data-line-number="111"><span class="co">#&gt; 3   -0.054721   0.221230  0.927883 0.359542</span></a>
<a class="sourceLine" id="cb1067-112" data-line-number="112"><span class="co">#&gt; 4   -0.062446   0.213405  0.807113 0.186559</span></a>
<a class="sourceLine" id="cb1067-113" data-line-number="113"><span class="co">#&gt; 5   -0.019938   0.270728 -0.001981 1.060441</span></a>
<a class="sourceLine" id="cb1067-114" data-line-number="114"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-115" data-line-number="115"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1067-116" data-line-number="116"><span class="co">#&gt; ** Reported on training data. **</span></a>
<a class="sourceLine" id="cb1067-117" data-line-number="117"><span class="co">#&gt; ** Metrics reported on temporary training frame with 10060 samples **</span></a>
<a class="sourceLine" id="cb1067-118" data-line-number="118"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-119" data-line-number="119"><span class="co">#&gt; Training Set Metrics: </span></a>
<a class="sourceLine" id="cb1067-120" data-line-number="120"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1067-121" data-line-number="121"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-122" data-line-number="122"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0559</span></a>
<a class="sourceLine" id="cb1067-123" data-line-number="123"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.236</span></a>
<a class="sourceLine" id="cb1067-124" data-line-number="124"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.184</span></a>
<a class="sourceLine" id="cb1067-125" data-line-number="125"><span class="co">#&gt; Mean Per-Class Error: 0.126</span></a>
<a class="sourceLine" id="cb1067-126" data-line-number="126"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span></a>
<a class="sourceLine" id="cb1067-127" data-line-number="127"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1067-128" data-line-number="128"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1067-129" data-line-number="129"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1067-130" data-line-number="130"><span class="co">#&gt; class_1    3225     354       0       0       3       0      16 0.1037</span></a>
<a class="sourceLine" id="cb1067-131" data-line-number="131"><span class="co">#&gt; class_2     169    4808      17       0      17       4       5 0.0422</span></a>
<a class="sourceLine" id="cb1067-132" data-line-number="132"><span class="co">#&gt; class_3       0      11     557       1       2      18       0 0.0543</span></a>
<a class="sourceLine" id="cb1067-133" data-line-number="133"><span class="co">#&gt; class_4       0       0       4      31       0       4       0 0.2051</span></a>
<a class="sourceLine" id="cb1067-134" data-line-number="134"><span class="co">#&gt; class_5       3      32       1       0     112       0       0 0.2432</span></a>
<a class="sourceLine" id="cb1067-135" data-line-number="135"><span class="co">#&gt; class_6       1      10      32       0       0     257       0 0.1433</span></a>
<a class="sourceLine" id="cb1067-136" data-line-number="136"><span class="co">#&gt; class_7      26       6       0       0       0       0     334 0.0874</span></a>
<a class="sourceLine" id="cb1067-137" data-line-number="137"><span class="co">#&gt; Totals     3424    5221     611      32     134     283     355 0.0732</span></a>
<a class="sourceLine" id="cb1067-138" data-line-number="138"><span class="co">#&gt;                   Rate</span></a>
<a class="sourceLine" id="cb1067-139" data-line-number="139"><span class="co">#&gt; class_1 =  373 / 3,598</span></a>
<a class="sourceLine" id="cb1067-140" data-line-number="140"><span class="co">#&gt; class_2 =  212 / 5,020</span></a>
<a class="sourceLine" id="cb1067-141" data-line-number="141"><span class="co">#&gt; class_3 =     32 / 589</span></a>
<a class="sourceLine" id="cb1067-142" data-line-number="142"><span class="co">#&gt; class_4 =       8 / 39</span></a>
<a class="sourceLine" id="cb1067-143" data-line-number="143"><span class="co">#&gt; class_5 =     36 / 148</span></a>
<a class="sourceLine" id="cb1067-144" data-line-number="144"><span class="co">#&gt; class_6 =     43 / 300</span></a>
<a class="sourceLine" id="cb1067-145" data-line-number="145"><span class="co">#&gt; class_7 =     32 / 366</span></a>
<a class="sourceLine" id="cb1067-146" data-line-number="146"><span class="co">#&gt; Totals  = 736 / 10,060</span></a>
<a class="sourceLine" id="cb1067-147" data-line-number="147"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-148" data-line-number="148"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span></a>
<a class="sourceLine" id="cb1067-149" data-line-number="149"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1067-150" data-line-number="150"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1067-151" data-line-number="151"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1067-152" data-line-number="152"><span class="co">#&gt; 1 1  0.926839</span></a>
<a class="sourceLine" id="cb1067-153" data-line-number="153"><span class="co">#&gt; 2 2  0.995527</span></a>
<a class="sourceLine" id="cb1067-154" data-line-number="154"><span class="co">#&gt; 3 3  0.999901</span></a>
<a class="sourceLine" id="cb1067-155" data-line-number="155"><span class="co">#&gt; 4 4  1.000000</span></a>
<a class="sourceLine" id="cb1067-156" data-line-number="156"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1067-157" data-line-number="157"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1067-158" data-line-number="158"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1067-159" data-line-number="159"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-160" data-line-number="160"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-161" data-line-number="161"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1067-162" data-line-number="162"><span class="co">#&gt; ** Reported on validation data. **</span></a>
<a class="sourceLine" id="cb1067-163" data-line-number="163"><span class="co">#&gt; ** Metrics reported on temporary validation frame with 10005 samples **</span></a>
<a class="sourceLine" id="cb1067-164" data-line-number="164"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-165" data-line-number="165"><span class="co">#&gt; Validation Set Metrics: </span></a>
<a class="sourceLine" id="cb1067-166" data-line-number="166"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1067-167" data-line-number="167"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-168" data-line-number="168"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0637</span></a>
<a class="sourceLine" id="cb1067-169" data-line-number="169"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.252</span></a>
<a class="sourceLine" id="cb1067-170" data-line-number="170"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.208</span></a>
<a class="sourceLine" id="cb1067-171" data-line-number="171"><span class="co">#&gt; Mean Per-Class Error: 0.163</span></a>
<a class="sourceLine" id="cb1067-172" data-line-number="172"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span></a>
<a class="sourceLine" id="cb1067-173" data-line-number="173"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1067-174" data-line-number="174"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1067-175" data-line-number="175"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1067-176" data-line-number="176"><span class="co">#&gt; class_1    3277     370       0       0       4       0      23 0.1081</span></a>
<a class="sourceLine" id="cb1067-177" data-line-number="177"><span class="co">#&gt; class_2     176    4616      16       0      20       8       8 0.0471</span></a>
<a class="sourceLine" id="cb1067-178" data-line-number="178"><span class="co">#&gt; class_3       0      16     560       5       1      28       0 0.0820</span></a>
<a class="sourceLine" id="cb1067-179" data-line-number="179"><span class="co">#&gt; class_4       0       1       8      39       0       6       0 0.2778</span></a>
<a class="sourceLine" id="cb1067-180" data-line-number="180"><span class="co">#&gt; class_5       4      48       2       0     108       0       0 0.3333</span></a>
<a class="sourceLine" id="cb1067-181" data-line-number="181"><span class="co">#&gt; class_6       0      22      44       0       0     241       0 0.2150</span></a>
<a class="sourceLine" id="cb1067-182" data-line-number="182"><span class="co">#&gt; class_7      25       3       0       0       0       0     326 0.0791</span></a>
<a class="sourceLine" id="cb1067-183" data-line-number="183"><span class="co">#&gt; Totals     3482    5076     630      44     133     283     357 0.0838</span></a>
<a class="sourceLine" id="cb1067-184" data-line-number="184"><span class="co">#&gt;                   Rate</span></a>
<a class="sourceLine" id="cb1067-185" data-line-number="185"><span class="co">#&gt; class_1 =  397 / 3,674</span></a>
<a class="sourceLine" id="cb1067-186" data-line-number="186"><span class="co">#&gt; class_2 =  228 / 4,844</span></a>
<a class="sourceLine" id="cb1067-187" data-line-number="187"><span class="co">#&gt; class_3 =     50 / 610</span></a>
<a class="sourceLine" id="cb1067-188" data-line-number="188"><span class="co">#&gt; class_4 =      15 / 54</span></a>
<a class="sourceLine" id="cb1067-189" data-line-number="189"><span class="co">#&gt; class_5 =     54 / 162</span></a>
<a class="sourceLine" id="cb1067-190" data-line-number="190"><span class="co">#&gt; class_6 =     66 / 307</span></a>
<a class="sourceLine" id="cb1067-191" data-line-number="191"><span class="co">#&gt; class_7 =     28 / 354</span></a>
<a class="sourceLine" id="cb1067-192" data-line-number="192"><span class="co">#&gt; Totals  = 838 / 10,005</span></a>
<a class="sourceLine" id="cb1067-193" data-line-number="193"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-194" data-line-number="194"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span></a>
<a class="sourceLine" id="cb1067-195" data-line-number="195"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1067-196" data-line-number="196"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1067-197" data-line-number="197"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1067-198" data-line-number="198"><span class="co">#&gt; 1 1  0.916242</span></a>
<a class="sourceLine" id="cb1067-199" data-line-number="199"><span class="co">#&gt; 2 2  0.994403</span></a>
<a class="sourceLine" id="cb1067-200" data-line-number="200"><span class="co">#&gt; 3 3  0.999600</span></a>
<a class="sourceLine" id="cb1067-201" data-line-number="201"><span class="co">#&gt; 4 4  1.000000</span></a>
<a class="sourceLine" id="cb1067-202" data-line-number="202"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1067-203" data-line-number="203"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1067-204" data-line-number="204"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1067-205" data-line-number="205"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-206" data-line-number="206"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-207" data-line-number="207"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-208" data-line-number="208"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-209" data-line-number="209"><span class="co">#&gt; Scoring History: </span></a>
<a class="sourceLine" id="cb1067-210" data-line-number="210"><span class="co">#&gt;              timestamp          duration training_speed   epochs iterations</span></a>
<a class="sourceLine" id="cb1067-211" data-line-number="211"><span class="co">#&gt; 1  2020-11-20 03:26:16         0.000 sec             NA  0.00000          0</span></a>
<a class="sourceLine" id="cb1067-212" data-line-number="212"><span class="co">#&gt; 2  2020-11-20 03:26:23         6.786 sec  15466 obs/sec  0.28676          1</span></a>
<a class="sourceLine" id="cb1067-213" data-line-number="213"><span class="co">#&gt; 3  2020-11-20 03:26:35        18.632 sec  22122 obs/sec  1.14690          4</span></a>
<a class="sourceLine" id="cb1067-214" data-line-number="214"><span class="co">#&gt; 4  2020-11-20 03:26:46        29.836 sec  24066 obs/sec  2.00553          7</span></a>
<a class="sourceLine" id="cb1067-215" data-line-number="215"><span class="co">#&gt; 5  2020-11-20 03:26:57        40.597 sec  25266 obs/sec  2.86748         10</span></a>
<a class="sourceLine" id="cb1067-216" data-line-number="216"><span class="co">#&gt; 6  2020-11-20 03:27:08        51.665 sec  25784 obs/sec  3.72709         13</span></a>
<a class="sourceLine" id="cb1067-217" data-line-number="217"><span class="co">#&gt; 7  2020-11-20 03:27:18  1 min  2.131 sec  26357 obs/sec  4.58514         16</span></a>
<a class="sourceLine" id="cb1067-218" data-line-number="218"><span class="co">#&gt; 8  2020-11-20 03:27:29  1 min 12.694 sec  26737 obs/sec  5.44445         19</span></a>
<a class="sourceLine" id="cb1067-219" data-line-number="219"><span class="co">#&gt; 9  2020-11-20 03:27:39  1 min 23.185 sec  27035 obs/sec  6.30235         22</span></a>
<a class="sourceLine" id="cb1067-220" data-line-number="220"><span class="co">#&gt; 10 2020-11-20 03:27:50  1 min 33.904 sec  27209 obs/sec  7.16167         25</span></a>
<a class="sourceLine" id="cb1067-221" data-line-number="221"><span class="co">#&gt; 11 2020-11-20 03:28:01  1 min 45.092 sec  27221 obs/sec  8.02231         28</span></a>
<a class="sourceLine" id="cb1067-222" data-line-number="222"><span class="co">#&gt; 12 2020-11-20 03:28:12  1 min 55.566 sec  27410 obs/sec  8.88425         31</span></a>
<a class="sourceLine" id="cb1067-223" data-line-number="223"><span class="co">#&gt; 13 2020-11-20 03:28:22  2 min  5.815 sec  27604 obs/sec  9.74215         34</span></a>
<a class="sourceLine" id="cb1067-224" data-line-number="224"><span class="co">#&gt; 14 2020-11-20 03:28:26  2 min  9.524 sec  27631 obs/sec 10.02778         35</span></a>
<a class="sourceLine" id="cb1067-225" data-line-number="225"><span class="co">#&gt;           samples training_rmse training_logloss training_r2</span></a>
<a class="sourceLine" id="cb1067-226" data-line-number="226"><span class="co">#&gt; 1        0.000000            NA               NA          NA</span></a>
<a class="sourceLine" id="cb1067-227" data-line-number="227"><span class="co">#&gt; 2   100084.000000       0.43054          0.57040     0.90484</span></a>
<a class="sourceLine" id="cb1067-228" data-line-number="228"><span class="co">#&gt; 3   400286.000000       0.36238          0.41464     0.93258</span></a>
<a class="sourceLine" id="cb1067-229" data-line-number="229"><span class="co">#&gt; 4   699960.000000       0.32572          0.34221     0.94553</span></a>
<a class="sourceLine" id="cb1067-230" data-line-number="230"><span class="co">#&gt; 5  1000792.000000       0.30290          0.29892     0.95290</span></a>
<a class="sourceLine" id="cb1067-231" data-line-number="231"><span class="co">#&gt; 6  1300810.000000       0.29379          0.28232     0.95569</span></a>
<a class="sourceLine" id="cb1067-232" data-line-number="232"><span class="co">#&gt; 7  1600283.000000       0.27523          0.24840     0.96111</span></a>
<a class="sourceLine" id="cb1067-233" data-line-number="233"><span class="co">#&gt; 8  1900194.000000       0.26909          0.23856     0.96283</span></a>
<a class="sourceLine" id="cb1067-234" data-line-number="234"><span class="co">#&gt; 9  2199614.000000       0.26574          0.23293     0.96375</span></a>
<a class="sourceLine" id="cb1067-235" data-line-number="235"><span class="co">#&gt; 10 2499530.000000       0.25792          0.21815     0.96585</span></a>
<a class="sourceLine" id="cb1067-236" data-line-number="236"><span class="co">#&gt; 11 2799908.000000       0.24960          0.20567     0.96802</span></a>
<a class="sourceLine" id="cb1067-237" data-line-number="237"><span class="co">#&gt; 12 3100736.000000       0.24127          0.19288     0.97012</span></a>
<a class="sourceLine" id="cb1067-238" data-line-number="238"><span class="co">#&gt; 13 3400156.000000       0.23989          0.19054     0.97046</span></a>
<a class="sourceLine" id="cb1067-239" data-line-number="239"><span class="co">#&gt; 14 3499847.000000       0.23634          0.18423     0.97132</span></a>
<a class="sourceLine" id="cb1067-240" data-line-number="240"><span class="co">#&gt;    training_classification_error validation_rmse validation_logloss</span></a>
<a class="sourceLine" id="cb1067-241" data-line-number="241"><span class="co">#&gt; 1                             NA              NA                 NA</span></a>
<a class="sourceLine" id="cb1067-242" data-line-number="242"><span class="co">#&gt; 2                        0.23738         0.43214            0.57193</span></a>
<a class="sourceLine" id="cb1067-243" data-line-number="243"><span class="co">#&gt; 3                        0.17584         0.36707            0.41940</span></a>
<a class="sourceLine" id="cb1067-244" data-line-number="244"><span class="co">#&gt; 4                        0.13817         0.33385            0.35832</span></a>
<a class="sourceLine" id="cb1067-245" data-line-number="245"><span class="co">#&gt; 5                        0.12237         0.31106            0.31207</span></a>
<a class="sourceLine" id="cb1067-246" data-line-number="246"><span class="co">#&gt; 6                        0.11541         0.29951            0.29316</span></a>
<a class="sourceLine" id="cb1067-247" data-line-number="247"><span class="co">#&gt; 7                        0.10000         0.28369            0.26356</span></a>
<a class="sourceLine" id="cb1067-248" data-line-number="248"><span class="co">#&gt; 8                        0.09583         0.27820            0.25226</span></a>
<a class="sourceLine" id="cb1067-249" data-line-number="249"><span class="co">#&gt; 9                        0.09394         0.27289            0.24474</span></a>
<a class="sourceLine" id="cb1067-250" data-line-number="250"><span class="co">#&gt; 10                       0.08877         0.26676            0.23336</span></a>
<a class="sourceLine" id="cb1067-251" data-line-number="251"><span class="co">#&gt; 11                       0.08449         0.26008            0.22383</span></a>
<a class="sourceLine" id="cb1067-252" data-line-number="252"><span class="co">#&gt; 12                       0.07694         0.25782            0.21981</span></a>
<a class="sourceLine" id="cb1067-253" data-line-number="253"><span class="co">#&gt; 13                       0.07594         0.25191            0.21062</span></a>
<a class="sourceLine" id="cb1067-254" data-line-number="254"><span class="co">#&gt; 14                       0.07316         0.25231            0.20847</span></a>
<a class="sourceLine" id="cb1067-255" data-line-number="255"><span class="co">#&gt;    validation_r2 validation_classification_error</span></a>
<a class="sourceLine" id="cb1067-256" data-line-number="256"><span class="co">#&gt; 1             NA                              NA</span></a>
<a class="sourceLine" id="cb1067-257" data-line-number="257"><span class="co">#&gt; 2        0.90512                         0.24438</span></a>
<a class="sourceLine" id="cb1067-258" data-line-number="258"><span class="co">#&gt; 3        0.93154                         0.18391</span></a>
<a class="sourceLine" id="cb1067-259" data-line-number="259"><span class="co">#&gt; 4        0.94337                         0.14583</span></a>
<a class="sourceLine" id="cb1067-260" data-line-number="260"><span class="co">#&gt; 5        0.95084                         0.13173</span></a>
<a class="sourceLine" id="cb1067-261" data-line-number="261"><span class="co">#&gt; 6        0.95442                         0.11874</span></a>
<a class="sourceLine" id="cb1067-262" data-line-number="262"><span class="co">#&gt; 7        0.95911                         0.10675</span></a>
<a class="sourceLine" id="cb1067-263" data-line-number="263"><span class="co">#&gt; 8        0.96068                         0.10155</span></a>
<a class="sourceLine" id="cb1067-264" data-line-number="264"><span class="co">#&gt; 9        0.96217                         0.09865</span></a>
<a class="sourceLine" id="cb1067-265" data-line-number="265"><span class="co">#&gt; 10       0.96384                         0.09455</span></a>
<a class="sourceLine" id="cb1067-266" data-line-number="266"><span class="co">#&gt; 11       0.96563                         0.08876</span></a>
<a class="sourceLine" id="cb1067-267" data-line-number="267"><span class="co">#&gt; 12       0.96623                         0.08796</span></a>
<a class="sourceLine" id="cb1067-268" data-line-number="268"><span class="co">#&gt; 13       0.96776                         0.08426</span></a>
<a class="sourceLine" id="cb1067-269" data-line-number="269"><span class="co">#&gt; 14       0.96766                         0.08376</span></a>
<a class="sourceLine" id="cb1067-270" data-line-number="270"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-271" data-line-number="271"><span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span></a>
<a class="sourceLine" id="cb1067-272" data-line-number="272"><span class="co">#&gt; =================================================</span></a>
<a class="sourceLine" id="cb1067-273" data-line-number="273"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-274" data-line-number="274"><span class="co">#&gt; Variable Importances: </span></a>
<a class="sourceLine" id="cb1067-275" data-line-number="275"><span class="co">#&gt;                             variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1067-276" data-line-number="276"><span class="co">#&gt; 1                          Elevation            1.000000          1.000000</span></a>
<a class="sourceLine" id="cb1067-277" data-line-number="277"><span class="co">#&gt; 2 Horizontal_Distance_To_Fire_Points            0.954387          0.954387</span></a>
<a class="sourceLine" id="cb1067-278" data-line-number="278"><span class="co">#&gt; 3    Horizontal_Distance_To_Roadways            0.893218          0.893218</span></a>
<a class="sourceLine" id="cb1067-279" data-line-number="279"><span class="co">#&gt; 4             Wilderness_Area.area_0            0.751640          0.751640</span></a>
<a class="sourceLine" id="cb1067-280" data-line-number="280"><span class="co">#&gt; 5             Wilderness_Area.area_3            0.613239          0.613239</span></a>
<a class="sourceLine" id="cb1067-281" data-line-number="281"><span class="co">#&gt;   percentage</span></a>
<a class="sourceLine" id="cb1067-282" data-line-number="282"><span class="co">#&gt; 1   0.047677</span></a>
<a class="sourceLine" id="cb1067-283" data-line-number="283"><span class="co">#&gt; 2   0.045503</span></a>
<a class="sourceLine" id="cb1067-284" data-line-number="284"><span class="co">#&gt; 3   0.042586</span></a>
<a class="sourceLine" id="cb1067-285" data-line-number="285"><span class="co">#&gt; 4   0.035836</span></a>
<a class="sourceLine" id="cb1067-286" data-line-number="286"><span class="co">#&gt; 5   0.029238</span></a>
<a class="sourceLine" id="cb1067-287" data-line-number="287"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-288" data-line-number="288"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1067-289" data-line-number="289"><span class="co">#&gt;                       variable relative_importance scaled_importance percentage</span></a>
<a class="sourceLine" id="cb1067-290" data-line-number="290"><span class="co">#&gt; 51           Soil_Type.type_17            0.161714          0.161714   0.007710</span></a>
<a class="sourceLine" id="cb1067-291" data-line-number="291"><span class="co">#&gt; 52            Soil_Type.type_6            0.159901          0.159901   0.007624</span></a>
<a class="sourceLine" id="cb1067-292" data-line-number="292"><span class="co">#&gt; 53           Soil_Type.type_14            0.153352          0.153352   0.007311</span></a>
<a class="sourceLine" id="cb1067-293" data-line-number="293"><span class="co">#&gt; 54           Soil_Type.type_24            0.145064          0.145064   0.006916</span></a>
<a class="sourceLine" id="cb1067-294" data-line-number="294"><span class="co">#&gt; 55       Soil_Type.missing(NA)            0.000000          0.000000   0.000000</span></a>
<a class="sourceLine" id="cb1067-295" data-line-number="295"><span class="co">#&gt; 56 Wilderness_Area.missing(NA)            0.000000          0.000000   0.000000</span></a></code></pre></div>
<p>Let’s compare the training error with the validation and test set errors</p>
<div class="sourceCode" id="cb1068"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, train<span class="op">=</span><span class="cn">T</span><span class="op">)</span>          <span class="co">## sampled training data (from model building)</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on training data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary training frame with 10060 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Training Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0559</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.236</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.184</span>
<span class="co">#&gt; Mean Per-Class Error: 0.126</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3225     354       0       0       3       0      16 0.1037</span>
<span class="co">#&gt; class_2     169    4808      17       0      17       4       5 0.0422</span>
<span class="co">#&gt; class_3       0      11     557       1       2      18       0 0.0543</span>
<span class="co">#&gt; class_4       0       0       4      31       0       4       0 0.2051</span>
<span class="co">#&gt; class_5       3      32       1       0     112       0       0 0.2432</span>
<span class="co">#&gt; class_6       1      10      32       0       0     257       0 0.1433</span>
<span class="co">#&gt; class_7      26       6       0       0       0       0     334 0.0874</span>
<span class="co">#&gt; Totals     3424    5221     611      32     134     283     355 0.0732</span>
<span class="co">#&gt;                   Rate</span>
<span class="co">#&gt; class_1 =  373 / 3,598</span>
<span class="co">#&gt; class_2 =  212 / 5,020</span>
<span class="co">#&gt; class_3 =     32 / 589</span>
<span class="co">#&gt; class_4 =       8 / 39</span>
<span class="co">#&gt; class_5 =     36 / 148</span>
<span class="co">#&gt; class_6 =     43 / 300</span>
<span class="co">#&gt; class_7 =     32 / 366</span>
<span class="co">#&gt; Totals  = 736 / 10,060</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.926839</span>
<span class="co">#&gt; 2 2  0.995527</span>
<span class="co">#&gt; 3 3  0.999901</span>
<span class="co">#&gt; 4 4  1.000000</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span>          <span class="co">## sampled validation data (from model building)</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 10005 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0637</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.252</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.208</span>
<span class="co">#&gt; Mean Per-Class Error: 0.163</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3277     370       0       0       4       0      23 0.1081</span>
<span class="co">#&gt; class_2     176    4616      16       0      20       8       8 0.0471</span>
<span class="co">#&gt; class_3       0      16     560       5       1      28       0 0.0820</span>
<span class="co">#&gt; class_4       0       1       8      39       0       6       0 0.2778</span>
<span class="co">#&gt; class_5       4      48       2       0     108       0       0 0.3333</span>
<span class="co">#&gt; class_6       0      22      44       0       0     241       0 0.2150</span>
<span class="co">#&gt; class_7      25       3       0       0       0       0     326 0.0791</span>
<span class="co">#&gt; Totals     3482    5076     630      44     133     283     357 0.0838</span>
<span class="co">#&gt;                   Rate</span>
<span class="co">#&gt; class_1 =  397 / 3,674</span>
<span class="co">#&gt; class_2 =  228 / 4,844</span>
<span class="co">#&gt; class_3 =     50 / 610</span>
<span class="co">#&gt; class_4 =      15 / 54</span>
<span class="co">#&gt; class_5 =     54 / 162</span>
<span class="co">#&gt; class_6 =     66 / 307</span>
<span class="co">#&gt; class_7 =     28 / 354</span>
<span class="co">#&gt; Totals  = 838 / 10,005</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.916242</span>
<span class="co">#&gt; 2 2  0.994403</span>
<span class="co">#&gt; 3 3  0.999600</span>
<span class="co">#&gt; 4 4  1.000000</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, newdata<span class="op">=</span><span class="va">train</span><span class="op">)</span>    <span class="co">## full training data</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0555</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.236</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.184</span>
<span class="co">#&gt; Mean Per-Class Error: 0.132</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;, &lt;data&gt;)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1  114487   11863       8       0     109      12     641 0.0994</span>
<span class="co">#&gt; class_2    5661  163277     423       0     630     267      84 0.0415</span>
<span class="co">#&gt; class_3       1     402   19734     115      65    1125       0 0.0797</span>
<span class="co">#&gt; class_4       0       1     293    1268       0      96       0 0.2352</span>
<span class="co">#&gt; class_5     113    1094      94       0    4401      18       0 0.2306</span>
<span class="co">#&gt; class_6      31     521    1031      43      10    8797       0 0.1568</span>
<span class="co">#&gt; class_7     835     153       0       0       1       0   11311 0.0804</span>
<span class="co">#&gt; Totals   121128  177311   21583    1426    5216   10315   12036 0.0738</span>
<span class="co">#&gt;                       Rate</span>
<span class="co">#&gt; class_1 = 12,633 / 127,120</span>
<span class="co">#&gt; class_2 =  7,065 / 170,342</span>
<span class="co">#&gt; class_3 =   1,708 / 21,442</span>
<span class="co">#&gt; class_4 =      390 / 1,658</span>
<span class="co">#&gt; class_5 =    1,319 / 5,720</span>
<span class="co">#&gt; class_6 =   1,636 / 10,433</span>
<span class="co">#&gt; class_7 =     989 / 12,300</span>
<span class="co">#&gt; Totals  = 25,740 / 349,015</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;, &lt;data&gt;)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.926250</span>
<span class="co">#&gt; 2 2  0.996496</span>
<span class="co">#&gt; 3 3  0.999716</span>
<span class="co">#&gt; 4 4  0.999977</span>
<span class="co">#&gt; 5 5  0.999997</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, newdata<span class="op">=</span><span class="va">valid</span><span class="op">)</span>    <span class="co">## full validation data</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0623</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.25</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.207</span>
<span class="co">#&gt; Mean Per-Class Error: 0.146</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;, &lt;data&gt;)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1   37823    4392       3       0      41       5     236 0.1100</span>
<span class="co">#&gt; class_2    2154   53692     149       0     251     104      30 0.0477</span>
<span class="co">#&gt; class_3       0     168    6510      49      26     390       0 0.0886</span>
<span class="co">#&gt; class_4       0       1     109     421       0      31       0 0.2509</span>
<span class="co">#&gt; class_5      38     415      44       0    1369       4       0 0.2679</span>
<span class="co">#&gt; class_6      12     205     358      21       3    2865       0 0.1729</span>
<span class="co">#&gt; class_7     308      45       0       0       1       0    3745 0.0864</span>
<span class="co">#&gt; Totals    40335   58918    7173     491    1691    3399    4011 0.0827</span>
<span class="co">#&gt;                      Rate</span>
<span class="co">#&gt; class_1 =  4,677 / 42,500</span>
<span class="co">#&gt; class_2 =  2,688 / 56,380</span>
<span class="co">#&gt; class_3 =     633 / 7,143</span>
<span class="co">#&gt; class_4 =       141 / 562</span>
<span class="co">#&gt; class_5 =     501 / 1,870</span>
<span class="co">#&gt; class_6 =     599 / 3,464</span>
<span class="co">#&gt; class_7 =     354 / 4,099</span>
<span class="co">#&gt; Totals  = 9,593 / 116,018</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;, &lt;data&gt;)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.917315</span>
<span class="co">#&gt; 2 2  0.995475</span>
<span class="co">#&gt; 3 3  0.999543</span>
<span class="co">#&gt; 4 4  0.999948</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, newdata<span class="op">=</span><span class="va">test</span><span class="op">)</span>     <span class="co">## full test data</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0612</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.247</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.203</span>
<span class="co">#&gt; Mean Per-Class Error: 0.137</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;, &lt;data&gt;)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1   37673    4247       1       0      38       2     259 0.1077</span>
<span class="co">#&gt; class_2    2142   53844     165       0     257     127      44 0.0483</span>
<span class="co">#&gt; class_3       0     158    6532      48      19     412       0 0.0889</span>
<span class="co">#&gt; class_4       0       0      80     420       0      27       0 0.2030</span>
<span class="co">#&gt; class_5      41     384      32       0    1437       9       0 0.2449</span>
<span class="co">#&gt; class_6      14     198     376      18       7    2857       0 0.1767</span>
<span class="co">#&gt; class_7     307      48       0       0       0       0    3756 0.0864</span>
<span class="co">#&gt; Totals    40177   58879    7186     486    1758    3434    4059 0.0816</span>
<span class="co">#&gt;                      Rate</span>
<span class="co">#&gt; class_1 =  4,547 / 42,220</span>
<span class="co">#&gt; class_2 =  2,735 / 56,579</span>
<span class="co">#&gt; class_3 =     637 / 7,169</span>
<span class="co">#&gt; class_4 =       107 / 527</span>
<span class="co">#&gt; class_5 =     466 / 1,903</span>
<span class="co">#&gt; class_6 =     613 / 3,470</span>
<span class="co">#&gt; class_7 =     355 / 4,111</span>
<span class="co">#&gt; Totals  = 9,460 / 115,979</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;, &lt;data&gt;)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.918434</span>
<span class="co">#&gt; 2 2  0.995775</span>
<span class="co">#&gt; 3 3  0.999526</span>
<span class="co">#&gt; 4 4  0.999914</span>
<span class="co">#&gt; 5 5  0.999983</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span></code></pre></div>
<p>To confirm that the reported confusion matrix on the validation set (here, the test set) was correct, we make a prediction on the test set and compare the confusion matrices explicitly:</p>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1069-1" data-line-number="1">pred &lt;-<span class="st"> </span><span class="kw">h2o.predict</span>(m3, test)</a>
<a class="sourceLine" id="cb1069-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1069-3" data-line-number="3">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1069-4" data-line-number="4"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1069-5" data-line-number="5">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1069-6" data-line-number="6"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1069-7" data-line-number="7">pred</a>
<a class="sourceLine" id="cb1069-8" data-line-number="8"><span class="co">#&gt;   predict class_1  class_2  class_3  class_4  class_5  class_6  class_7</span></a>
<a class="sourceLine" id="cb1069-9" data-line-number="9"><span class="co">#&gt; 1 class_2 0.03950 0.960471 2.43e-05 1.49e-06 5.43e-08 1.15e-06 3.60e-07</span></a>
<a class="sourceLine" id="cb1069-10" data-line-number="10"><span class="co">#&gt; 2 class_1 0.99794 0.001032 3.35e-04 1.27e-04 1.37e-05 6.56e-05 4.84e-04</span></a>
<a class="sourceLine" id="cb1069-11" data-line-number="11"><span class="co">#&gt; 3 class_1 0.99970 0.000303 6.82e-09 7.40e-10 2.12e-12 1.98e-09 1.27e-06</span></a>
<a class="sourceLine" id="cb1069-12" data-line-number="12"><span class="co">#&gt; 4 class_1 0.99973 0.000273 1.21e-07 4.28e-08 1.43e-09 1.74e-09 2.90e-07</span></a>
<a class="sourceLine" id="cb1069-13" data-line-number="13"><span class="co">#&gt; 5 class_2 0.02622 0.973709 4.23e-07 7.00e-07 4.62e-05 1.98e-05 1.10e-06</span></a>
<a class="sourceLine" id="cb1069-14" data-line-number="14"><span class="co">#&gt; 6 class_5 0.00122 0.304013 4.37e-05 1.27e-05 6.95e-01 1.92e-09 3.06e-10</span></a>
<a class="sourceLine" id="cb1069-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1069-16" data-line-number="16"><span class="co">#&gt; [115979 rows x 8 columns]</span></a>
<a class="sourceLine" id="cb1069-17" data-line-number="17">test<span class="op">$</span>Accuracy &lt;-<span class="st"> </span>pred<span class="op">$</span>predict <span class="op">==</span><span class="st"> </span>test<span class="op">$</span>Cover_Type</a>
<a class="sourceLine" id="cb1069-18" data-line-number="18"><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(test<span class="op">$</span>Accuracy)</a>
<a class="sourceLine" id="cb1069-19" data-line-number="19"><span class="co">#&gt; [1] 0.0816</span></a></code></pre></div>
</div>
<div id="hyper-parameter-tuning-with-grid-search" class="section level3">
<h3>
<span class="header-section-number">46.5.6</span> Hyper-parameter Tuning with Grid Search<a class="anchor" aria-label="anchor" href="#hyper-parameter-tuning-with-grid-search"><i class="fas fa-link"></i></a>
</h3>
<p>Since there are a lot of parameters that can impact model accuracy, hyper-parameter tuning is especially important for Deep Learning:</p>
<p>For speed, we will only train on the first 10,000 rows of the training dataset:</p>
<div class="sourceCode" id="cb1070"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sampled_train</span><span class="op">=</span><span class="va">train</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10000</span>,<span class="op">]</span></code></pre></div>
<p>The simplest hyperparameter search method is a brute-force scan of the full Cartesian product of all combinations specified by a grid search:</p>
<div class="sourceCode" id="cb1071"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1071-1" data-line-number="1">hyper_params &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb1071-2" data-line-number="2">  <span class="dt">hidden=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">32</span>),<span class="kw">c</span>(<span class="dv">64</span>,<span class="dv">64</span>)),</a>
<a class="sourceLine" id="cb1071-3" data-line-number="3">  <span class="dt">input_dropout_ratio=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>),</a>
<a class="sourceLine" id="cb1071-4" data-line-number="4">  <span class="dt">rate=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.02</span>),</a>
<a class="sourceLine" id="cb1071-5" data-line-number="5">  <span class="dt">rate_annealing=</span><span class="kw">c</span>(<span class="fl">1e-8</span>,<span class="fl">1e-7</span>,<span class="fl">1e-6</span>)</a>
<a class="sourceLine" id="cb1071-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb1071-7" data-line-number="7">hyper_params</a>
<a class="sourceLine" id="cb1071-8" data-line-number="8"><span class="co">#&gt; $hidden</span></a>
<a class="sourceLine" id="cb1071-9" data-line-number="9"><span class="co">#&gt; $hidden[[1]]</span></a>
<a class="sourceLine" id="cb1071-10" data-line-number="10"><span class="co">#&gt; [1] 32 32 32</span></a>
<a class="sourceLine" id="cb1071-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-12" data-line-number="12"><span class="co">#&gt; $hidden[[2]]</span></a>
<a class="sourceLine" id="cb1071-13" data-line-number="13"><span class="co">#&gt; [1] 64 64</span></a>
<a class="sourceLine" id="cb1071-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-16" data-line-number="16"><span class="co">#&gt; $input_dropout_ratio</span></a>
<a class="sourceLine" id="cb1071-17" data-line-number="17"><span class="co">#&gt; [1] 0.00 0.05</span></a>
<a class="sourceLine" id="cb1071-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-19" data-line-number="19"><span class="co">#&gt; $rate</span></a>
<a class="sourceLine" id="cb1071-20" data-line-number="20"><span class="co">#&gt; [1] 0.01 0.02</span></a>
<a class="sourceLine" id="cb1071-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-22" data-line-number="22"><span class="co">#&gt; $rate_annealing</span></a>
<a class="sourceLine" id="cb1071-23" data-line-number="23"><span class="co">#&gt; [1] 1e-08 1e-07 1e-06</span></a>
<a class="sourceLine" id="cb1071-24" data-line-number="24">grid &lt;-<span class="st"> </span><span class="kw">h2o.grid</span>(</a>
<a class="sourceLine" id="cb1071-25" data-line-number="25">  <span class="dt">algorithm=</span><span class="st">"deeplearning"</span>,</a>
<a class="sourceLine" id="cb1071-26" data-line-number="26">  <span class="dt">grid_id=</span><span class="st">"dl_grid"</span>, </a>
<a class="sourceLine" id="cb1071-27" data-line-number="27">  <span class="dt">training_frame=</span>sampled_train,</a>
<a class="sourceLine" id="cb1071-28" data-line-number="28">  <span class="dt">validation_frame=</span>valid, </a>
<a class="sourceLine" id="cb1071-29" data-line-number="29">  <span class="dt">x=</span>predictors, </a>
<a class="sourceLine" id="cb1071-30" data-line-number="30">  <span class="dt">y=</span>response,</a>
<a class="sourceLine" id="cb1071-31" data-line-number="31">  <span class="dt">epochs=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1071-32" data-line-number="32">  <span class="dt">stopping_metric=</span><span class="st">"misclassification"</span>,</a>
<a class="sourceLine" id="cb1071-33" data-line-number="33">  <span class="dt">stopping_tolerance=</span><span class="fl">1e-2</span>,        <span class="co">## stop when misclassification does not improve by &gt;=1% for 2 scoring events</span></a>
<a class="sourceLine" id="cb1071-34" data-line-number="34">  <span class="dt">stopping_rounds=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1071-35" data-line-number="35">  <span class="dt">score_validation_samples=</span><span class="dv">10000</span>, <span class="co">## downsample validation set for faster scoring</span></a>
<a class="sourceLine" id="cb1071-36" data-line-number="36">  <span class="dt">score_duty_cycle=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span></a>
<a class="sourceLine" id="cb1071-37" data-line-number="37">  <span class="dt">adaptive_rate=</span>F,                <span class="co">## manually tuned learning rate</span></a>
<a class="sourceLine" id="cb1071-38" data-line-number="38">  <span class="dt">momentum_start=</span><span class="fl">0.5</span>,             <span class="co">## manually tuned momentum</span></a>
<a class="sourceLine" id="cb1071-39" data-line-number="39">  <span class="dt">momentum_stable=</span><span class="fl">0.9</span>, </a>
<a class="sourceLine" id="cb1071-40" data-line-number="40">  <span class="dt">momentum_ramp=</span><span class="fl">1e7</span>, </a>
<a class="sourceLine" id="cb1071-41" data-line-number="41">  <span class="dt">l1=</span><span class="fl">1e-5</span>,</a>
<a class="sourceLine" id="cb1071-42" data-line-number="42">  <span class="dt">l2=</span><span class="fl">1e-5</span>,</a>
<a class="sourceLine" id="cb1071-43" data-line-number="43">  <span class="dt">activation=</span><span class="kw">c</span>(<span class="st">"Rectifier"</span>),</a>
<a class="sourceLine" id="cb1071-44" data-line-number="44">  <span class="dt">max_w2=</span><span class="dv">10</span>,                      <span class="co">## can help improve stability for Rectifier</span></a>
<a class="sourceLine" id="cb1071-45" data-line-number="45">  <span class="dt">hyper_params=</span>hyper_params</a>
<a class="sourceLine" id="cb1071-46" data-line-number="46">)</a>
<a class="sourceLine" id="cb1071-47" data-line-number="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-48" data-line-number="48">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1071-49" data-line-number="49"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1071-50" data-line-number="50">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1071-51" data-line-number="51"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1071-52" data-line-number="52">grid</a>
<a class="sourceLine" id="cb1071-53" data-line-number="53"><span class="co">#&gt; H2O Grid Details</span></a>
<a class="sourceLine" id="cb1071-54" data-line-number="54"><span class="co">#&gt; ================</span></a>
<a class="sourceLine" id="cb1071-55" data-line-number="55"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-56" data-line-number="56"><span class="co">#&gt; Grid ID: dl_grid </span></a>
<a class="sourceLine" id="cb1071-57" data-line-number="57"><span class="co">#&gt; Used hyper parameters: </span></a>
<a class="sourceLine" id="cb1071-58" data-line-number="58"><span class="co">#&gt;   -  hidden </span></a>
<a class="sourceLine" id="cb1071-59" data-line-number="59"><span class="co">#&gt;   -  input_dropout_ratio </span></a>
<a class="sourceLine" id="cb1071-60" data-line-number="60"><span class="co">#&gt;   -  rate </span></a>
<a class="sourceLine" id="cb1071-61" data-line-number="61"><span class="co">#&gt;   -  rate_annealing </span></a>
<a class="sourceLine" id="cb1071-62" data-line-number="62"><span class="co">#&gt; Number of models: 24 </span></a>
<a class="sourceLine" id="cb1071-63" data-line-number="63"><span class="co">#&gt; Number of failed models: 0 </span></a>
<a class="sourceLine" id="cb1071-64" data-line-number="64"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-65" data-line-number="65"><span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing logloss</span></a>
<a class="sourceLine" id="cb1071-66" data-line-number="66"><span class="co">#&gt;     hidden input_dropout_ratio rate rate_annealing        model_ids</span></a>
<a class="sourceLine" id="cb1071-67" data-line-number="67"><span class="co">#&gt; 1 [64, 64]                0.05 0.02         1.0E-6 dl_grid_model_24</span></a>
<a class="sourceLine" id="cb1071-68" data-line-number="68"><span class="co">#&gt; 2 [64, 64]                 0.0 0.01         1.0E-6 dl_grid_model_18</span></a>
<a class="sourceLine" id="cb1071-69" data-line-number="69"><span class="co">#&gt; 3 [64, 64]                 0.0 0.02         1.0E-7 dl_grid_model_14</span></a>
<a class="sourceLine" id="cb1071-70" data-line-number="70"><span class="co">#&gt; 4 [64, 64]                0.05 0.01         1.0E-8  dl_grid_model_4</span></a>
<a class="sourceLine" id="cb1071-71" data-line-number="71"><span class="co">#&gt; 5 [64, 64]                 0.0 0.02         1.0E-6 dl_grid_model_22</span></a>
<a class="sourceLine" id="cb1071-72" data-line-number="72"><span class="co">#&gt;              logloss</span></a>
<a class="sourceLine" id="cb1071-73" data-line-number="73"><span class="co">#&gt; 1 0.5653311098099636</span></a>
<a class="sourceLine" id="cb1071-74" data-line-number="74"><span class="co">#&gt; 2 0.5660312226119422</span></a>
<a class="sourceLine" id="cb1071-75" data-line-number="75"><span class="co">#&gt; 3 0.5711945397917454</span></a>
<a class="sourceLine" id="cb1071-76" data-line-number="76"><span class="co">#&gt; 4 0.5794875616211669</span></a>
<a class="sourceLine" id="cb1071-77" data-line-number="77"><span class="co">#&gt; 5 0.5803665424070287</span></a>
<a class="sourceLine" id="cb1071-78" data-line-number="78"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-79" data-line-number="79"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1071-80" data-line-number="80"><span class="co">#&gt;          hidden input_dropout_ratio rate rate_annealing        model_ids</span></a>
<a class="sourceLine" id="cb1071-81" data-line-number="81"><span class="co">#&gt; 19     [64, 64]                 0.0 0.02         1.0E-8  dl_grid_model_6</span></a>
<a class="sourceLine" id="cb1071-82" data-line-number="82"><span class="co">#&gt; 20 [32, 32, 32]                 0.0 0.02         1.0E-8  dl_grid_model_5</span></a>
<a class="sourceLine" id="cb1071-83" data-line-number="83"><span class="co">#&gt; 21     [64, 64]                 0.0 0.01         1.0E-8  dl_grid_model_2</span></a>
<a class="sourceLine" id="cb1071-84" data-line-number="84"><span class="co">#&gt; 22 [32, 32, 32]                0.05 0.02         1.0E-8  dl_grid_model_7</span></a>
<a class="sourceLine" id="cb1071-85" data-line-number="85"><span class="co">#&gt; 23 [32, 32, 32]                0.05 0.02         1.0E-7 dl_grid_model_15</span></a>
<a class="sourceLine" id="cb1071-86" data-line-number="86"><span class="co">#&gt; 24 [32, 32, 32]                 0.0 0.02         1.0E-7 dl_grid_model_13</span></a>
<a class="sourceLine" id="cb1071-87" data-line-number="87"><span class="co">#&gt;               logloss</span></a>
<a class="sourceLine" id="cb1071-88" data-line-number="88"><span class="co">#&gt; 19   0.63187628812144</span></a>
<a class="sourceLine" id="cb1071-89" data-line-number="89"><span class="co">#&gt; 20 0.6319144770646112</span></a>
<a class="sourceLine" id="cb1071-90" data-line-number="90"><span class="co">#&gt; 21 0.6371643186572534</span></a>
<a class="sourceLine" id="cb1071-91" data-line-number="91"><span class="co">#&gt; 22 0.6389680247906112</span></a>
<a class="sourceLine" id="cb1071-92" data-line-number="92"><span class="co">#&gt; 23 0.6514794473621144</span></a>
<a class="sourceLine" id="cb1071-93" data-line-number="93"><span class="co">#&gt; 24 0.6607289594973879</span></a></code></pre></div>
<p>Let’s see which model had the lowest validation error:</p>
<div class="sourceCode" id="cb1072"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid"</span>,sort_by<span class="op">=</span><span class="st">"err"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">grid</span>
<span class="co">#&gt; H2O Grid Details</span>
<span class="co">#&gt; ================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Grid ID: dl_grid </span>
<span class="co">#&gt; Used hyper parameters: </span>
<span class="co">#&gt;   -  hidden </span>
<span class="co">#&gt;   -  input_dropout_ratio </span>
<span class="co">#&gt;   -  rate </span>
<span class="co">#&gt;   -  rate_annealing </span>
<span class="co">#&gt; Number of models: 24 </span>
<span class="co">#&gt; Number of failed models: 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing err</span>
<span class="co">#&gt;         hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 1     [64, 64]                 0.0 0.01         1.0E-6 dl_grid_model_18</span>
<span class="co">#&gt; 2     [64, 64]                0.05 0.02         1.0E-6 dl_grid_model_24</span>
<span class="co">#&gt; 3     [64, 64]                 0.0 0.02         1.0E-7 dl_grid_model_14</span>
<span class="co">#&gt; 4 [32, 32, 32]                 0.0 0.01         1.0E-8  dl_grid_model_1</span>
<span class="co">#&gt; 5     [64, 64]                0.05 0.01         1.0E-8  dl_grid_model_4</span>
<span class="co">#&gt;                   err</span>
<span class="co">#&gt; 1  0.2380003983270265</span>
<span class="co">#&gt; 2 0.24264485888102125</span>
<span class="co">#&gt; 3  0.2466067864271457</span>
<span class="co">#&gt; 4  0.2502484595507851</span>
<span class="co">#&gt; 5  0.2507450824557918</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;          hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 19 [32, 32, 32]                 0.0 0.02         1.0E-8  dl_grid_model_5</span>
<span class="co">#&gt; 20 [32, 32, 32]                0.05 0.01         1.0E-6 dl_grid_model_19</span>
<span class="co">#&gt; 21 [32, 32, 32]                0.05 0.02         1.0E-8  dl_grid_model_7</span>
<span class="co">#&gt; 22 [32, 32, 32]                0.05 0.01         1.0E-7 dl_grid_model_11</span>
<span class="co">#&gt; 23 [32, 32, 32]                 0.0 0.02         1.0E-7 dl_grid_model_13</span>
<span class="co">#&gt; 24 [32, 32, 32]                0.05 0.02         1.0E-7 dl_grid_model_15</span>
<span class="co">#&gt;                    err</span>
<span class="co">#&gt; 19  0.2712696662992284</span>
<span class="co">#&gt; 20  0.2732702837232454</span>
<span class="co">#&gt; 21  0.2745569240012016</span>
<span class="co">#&gt; 22 0.27541049662536515</span>
<span class="co">#&gt; 23 0.28618884638614855</span>
<span class="co">#&gt; 24  0.2910365548322484</span>

<span class="co">## To see what other "sort_by" criteria are allowed</span>
<span class="co">#grid &lt;- h2o.getGrid("dl_grid",sort_by="wrong_thing",decreasing=FALSE)</span>

<span class="co">## Sort by logloss</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid"</span>,sort_by<span class="op">=</span><span class="st">"logloss"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; H2O Grid Details</span>
<span class="co">#&gt; ================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Grid ID: dl_grid </span>
<span class="co">#&gt; Used hyper parameters: </span>
<span class="co">#&gt;   -  hidden </span>
<span class="co">#&gt;   -  input_dropout_ratio </span>
<span class="co">#&gt;   -  rate </span>
<span class="co">#&gt;   -  rate_annealing </span>
<span class="co">#&gt; Number of models: 24 </span>
<span class="co">#&gt; Number of failed models: 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing logloss</span>
<span class="co">#&gt;     hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 1 [64, 64]                0.05 0.02         1.0E-6 dl_grid_model_24</span>
<span class="co">#&gt; 2 [64, 64]                 0.0 0.01         1.0E-6 dl_grid_model_18</span>
<span class="co">#&gt; 3 [64, 64]                 0.0 0.02         1.0E-7 dl_grid_model_14</span>
<span class="co">#&gt; 4 [64, 64]                0.05 0.01         1.0E-8  dl_grid_model_4</span>
<span class="co">#&gt; 5 [64, 64]                 0.0 0.02         1.0E-6 dl_grid_model_22</span>
<span class="co">#&gt;              logloss</span>
<span class="co">#&gt; 1 0.5653311098099636</span>
<span class="co">#&gt; 2 0.5660312226119422</span>
<span class="co">#&gt; 3 0.5711945397917454</span>
<span class="co">#&gt; 4 0.5794875616211669</span>
<span class="co">#&gt; 5 0.5803665424070287</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;          hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 19     [64, 64]                 0.0 0.02         1.0E-8  dl_grid_model_6</span>
<span class="co">#&gt; 20 [32, 32, 32]                 0.0 0.02         1.0E-8  dl_grid_model_5</span>
<span class="co">#&gt; 21     [64, 64]                 0.0 0.01         1.0E-8  dl_grid_model_2</span>
<span class="co">#&gt; 22 [32, 32, 32]                0.05 0.02         1.0E-8  dl_grid_model_7</span>
<span class="co">#&gt; 23 [32, 32, 32]                0.05 0.02         1.0E-7 dl_grid_model_15</span>
<span class="co">#&gt; 24 [32, 32, 32]                 0.0 0.02         1.0E-7 dl_grid_model_13</span>
<span class="co">#&gt;               logloss</span>
<span class="co">#&gt; 19   0.63187628812144</span>
<span class="co">#&gt; 20 0.6319144770646112</span>
<span class="co">#&gt; 21 0.6371643186572534</span>
<span class="co">#&gt; 22 0.6389680247906112</span>
<span class="co">#&gt; 23 0.6514794473621144</span>
<span class="co">#&gt; 24 0.6607289594973879</span>

<span class="co">## Find the best model and its full set of parameters</span>
<span class="va">grid</span><span class="op">@</span><span class="va">summary_table</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>
<span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing err</span>
<span class="co">#&gt;     hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 1 [64, 64]                 0.0 0.01         1.0E-6 dl_grid_model_18</span>
<span class="co">#&gt;                  err</span>
<span class="co">#&gt; 1 0.2380003983270265</span>
<span class="va">best_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getModel.html">h2o.getModel</a></span><span class="op">(</span><span class="va">grid</span><span class="op">@</span><span class="va">model_ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">best_model</span>
<span class="co">#&gt; Model Details:</span>
<span class="co">#&gt; ==============</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialModel: deeplearning</span>
<span class="co">#&gt; Model ID:  dl_grid_model_18 </span>
<span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 8,263 weights/biases, 72.2 KB, 100,000 training samples, mini-batch size 1</span>
<span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span>
<span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span>
<span class="co">#&gt; 2     2    64 Rectifier  0.00 % 0.000010 0.000010  0.009091 0.000000 0.504000</span>
<span class="co">#&gt; 3     3    64 Rectifier  0.00 % 0.000010 0.000010  0.009091 0.000000 0.504000</span>
<span class="co">#&gt; 4     4     7   Softmax      NA 0.000010 0.000010  0.009091 0.000000 0.504000</span>
<span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span>
<span class="co">#&gt; 1          NA         NA        NA       NA</span>
<span class="co">#&gt; 2   -0.007389   0.210256  0.208580 0.159783</span>
<span class="co">#&gt; 3   -0.059410   0.187647  0.881156 0.121903</span>
<span class="co">#&gt; 4   -0.016843   0.393353  0.014311 0.532353</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on training data. **</span>
<span class="co">#&gt; ** Metrics reported on full training frame **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Training Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Extract training frame with `h2o.getFrame("RTMP_sid_af9c_9")`</span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.163</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.403</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.507</span>
<span class="co">#&gt; Mean Per-Class Error: 0.47</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2672     951       1       0       0       1      63 0.2755</span>
<span class="co">#&gt; class_2     564    4219      42       0       1       4       5 0.1274</span>
<span class="co">#&gt; class_3       0      63     565       1       0       1       0 0.1032</span>
<span class="co">#&gt; class_4       0       0      34      10       0       0       0 0.7727</span>
<span class="co">#&gt; class_5      10     126       3       0      17       0       0 0.8910</span>
<span class="co">#&gt; class_6       0      90     177       0       0      42       0 0.8641</span>
<span class="co">#&gt; class_7      85       2       0       0       0       0     251 0.2574</span>
<span class="co">#&gt; Totals     3331    5451     822      11      18      48     319 0.2224</span>
<span class="co">#&gt;                     Rate</span>
<span class="co">#&gt; class_1 =  1,016 / 3,688</span>
<span class="co">#&gt; class_2 =    616 / 4,835</span>
<span class="co">#&gt; class_3 =       65 / 630</span>
<span class="co">#&gt; class_4 =        34 / 44</span>
<span class="co">#&gt; class_5 =      139 / 156</span>
<span class="co">#&gt; class_6 =      267 / 309</span>
<span class="co">#&gt; class_7 =       87 / 338</span>
<span class="co">#&gt; Totals  = 2,224 / 10,000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.777600</span>
<span class="co">#&gt; 2 2  0.980100</span>
<span class="co">#&gt; 3 3  0.997700</span>
<span class="co">#&gt; 4 4  0.999400</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 10042 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.178</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.422</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.566</span>
<span class="co">#&gt; Mean Per-Class Error: 0.506</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2549    1003       0       0       0       1      67 0.2959</span>
<span class="co">#&gt; class_2     621    4240      45       0       2      12       7 0.1394</span>
<span class="co">#&gt; class_3       0      75     544       2       0       5       0 0.1310</span>
<span class="co">#&gt; class_4       0       1      49       7       0       0       0 0.8772</span>
<span class="co">#&gt; class_5       6     122       3       0      13       0       0 0.9097</span>
<span class="co">#&gt; class_6       0      89     189       0       0      16       0 0.9456</span>
<span class="co">#&gt; class_7      89       2       0       0       0       0     283 0.2433</span>
<span class="co">#&gt; Totals     3265    5532     830       9      15      34     357 0.2380</span>
<span class="co">#&gt;                     Rate</span>
<span class="co">#&gt; class_1 =  1,071 / 3,620</span>
<span class="co">#&gt; class_2 =    687 / 4,927</span>
<span class="co">#&gt; class_3 =       82 / 626</span>
<span class="co">#&gt; class_4 =        50 / 57</span>
<span class="co">#&gt; class_5 =      131 / 144</span>
<span class="co">#&gt; class_6 =      278 / 294</span>
<span class="co">#&gt; class_7 =       91 / 374</span>
<span class="co">#&gt; Totals  = 2,390 / 10,042</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.762000</span>
<span class="co">#&gt; 2 2  0.973013</span>
<span class="co">#&gt; 3 3  0.994921</span>
<span class="co">#&gt; 4 4  0.998805</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>

<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">best_model</span><span class="op">@</span><span class="va">allparameters</span><span class="op">)</span>
<span class="co">#&gt; $model_id</span>
<span class="co">#&gt; [1] "dl_grid_model_18"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $training_frame</span>
<span class="co">#&gt; [1] "RTMP_sid_af9c_9"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $validation_frame</span>
<span class="co">#&gt; [1] "valid.hex"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nfolds</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $keep_cross_validation_models</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $keep_cross_validation_predictions</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $keep_cross_validation_fold_assignment</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fold_assignment</span>
<span class="co">#&gt; [1] "AUTO"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ignore_const_cols</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_each_iteration</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $balance_classes</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_after_balance_size</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_confusion_matrix_size</span>
<span class="co">#&gt; [1] 20</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_hit_ratio_k</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $overwrite_with_best_model</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $use_all_factor_levels</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $standardize</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $activation</span>
<span class="co">#&gt; [1] "Rectifier"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $hidden</span>
<span class="co">#&gt; [1] 64 64</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $epochs</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $train_samples_per_iteration</span>
<span class="co">#&gt; [1] -2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $target_ratio_comm_to_comp</span>
<span class="co">#&gt; [1] 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $seed</span>
<span class="co">#&gt; [1] "3141284810210899683"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $adaptive_rate</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rho</span>
<span class="co">#&gt; [1] 0.99</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $epsilon</span>
<span class="co">#&gt; [1] 1e-08</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rate</span>
<span class="co">#&gt; [1] 0.01</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rate_annealing</span>
<span class="co">#&gt; [1] 1e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rate_decay</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $momentum_start</span>
<span class="co">#&gt; [1] 0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $momentum_ramp</span>
<span class="co">#&gt; [1] 1e+07</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $momentum_stable</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nesterov_accelerated_gradient</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $input_dropout_ratio</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $l1</span>
<span class="co">#&gt; [1] 1e-05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $l2</span>
<span class="co">#&gt; [1] 1e-05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_w2</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $initial_weight_distribution</span>
<span class="co">#&gt; [1] "UniformAdaptive"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $initial_weight_scale</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $loss</span>
<span class="co">#&gt; [1] "Automatic"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $distribution</span>
<span class="co">#&gt; [1] "AUTO"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $quantile_alpha</span>
<span class="co">#&gt; [1] 0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tweedie_power</span>
<span class="co">#&gt; [1] 1.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $huber_alpha</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_interval</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_training_samples</span>
<span class="co">#&gt; [1] 10000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_validation_samples</span>
<span class="co">#&gt; [1] 10000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_duty_cycle</span>
<span class="co">#&gt; [1] 0.025</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $classification_stop</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $regression_stop</span>
<span class="co">#&gt; [1] 1e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stopping_rounds</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stopping_metric</span>
<span class="co">#&gt; [1] "misclassification"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stopping_tolerance</span>
<span class="co">#&gt; [1] 0.01</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_runtime_secs</span>
<span class="co">#&gt; [1] 1.8e+308</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_validation_sampling</span>
<span class="co">#&gt; [1] "Uniform"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $diagnostics</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fast_mode</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $force_load_balance</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $variable_importances</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $replicate_training_data</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $single_node_mode</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $shuffle_training_data</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $missing_values_handling</span>
<span class="co">#&gt; [1] "MeanImputation"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $quiet_mode</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $autoencoder</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sparse</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $col_major</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $average_activation</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sparsity_beta</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_categorical_features</span>
<span class="co">#&gt; [1] 2147483647</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $reproducible</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $export_weights_and_biases</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mini_batch_size</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $categorical_encoding</span>
<span class="co">#&gt; [1] "AUTO"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $elastic_averaging</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $elastic_averaging_moving_rate</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $elastic_averaging_regularization</span>
<span class="co">#&gt; [1] 0.001</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt;  [1] "Soil_Type"                          "Wilderness_Area"                   </span>
<span class="co">#&gt;  [3] "Elevation"                          "Aspect"                            </span>
<span class="co">#&gt;  [5] "Slope"                              "Horizontal_Distance_To_Hydrology"  </span>
<span class="co">#&gt;  [7] "Vertical_Distance_To_Hydrology"     "Horizontal_Distance_To_Roadways"   </span>
<span class="co">#&gt;  [9] "Hillshade_9am"                      "Hillshade_Noon"                    </span>
<span class="co">#&gt; [11] "Hillshade_3pm"                      "Horizontal_Distance_To_Fire_Points"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $y</span>
<span class="co">#&gt; [1] "Cover_Type"</span>
<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">best_model</span>, valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 10042 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.178</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.422</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.566</span>
<span class="co">#&gt; Mean Per-Class Error: 0.506</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2549    1003       0       0       0       1      67 0.2959</span>
<span class="co">#&gt; class_2     621    4240      45       0       2      12       7 0.1394</span>
<span class="co">#&gt; class_3       0      75     544       2       0       5       0 0.1310</span>
<span class="co">#&gt; class_4       0       1      49       7       0       0       0 0.8772</span>
<span class="co">#&gt; class_5       6     122       3       0      13       0       0 0.9097</span>
<span class="co">#&gt; class_6       0      89     189       0       0      16       0 0.9456</span>
<span class="co">#&gt; class_7      89       2       0       0       0       0     283 0.2433</span>
<span class="co">#&gt; Totals     3265    5532     830       9      15      34     357 0.2380</span>
<span class="co">#&gt;                     Rate</span>
<span class="co">#&gt; class_1 =  1,071 / 3,620</span>
<span class="co">#&gt; class_2 =    687 / 4,927</span>
<span class="co">#&gt; class_3 =       82 / 626</span>
<span class="co">#&gt; class_4 =        50 / 57</span>
<span class="co">#&gt; class_5 =      131 / 144</span>
<span class="co">#&gt; class_6 =      278 / 294</span>
<span class="co">#&gt; class_7 =       91 / 374</span>
<span class="co">#&gt; Totals  = 2,390 / 10,042</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.762000</span>
<span class="co">#&gt; 2 2  0.973013</span>
<span class="co">#&gt; 3 3  0.994921</span>
<span class="co">#&gt; 4 4  0.998805</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.logloss.html">h2o.logloss</a></span><span class="op">(</span><span class="va">best_model</span>, valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.566</span></code></pre></div>
</div>
<div id="random-hyper-parameter-search" class="section level3">
<h3>
<span class="header-section-number">46.5.7</span> Random Hyper-Parameter Search<a class="anchor" aria-label="anchor" href="#random-hyper-parameter-search"><i class="fas fa-link"></i></a>
</h3>
<p>Often, hyper-parameter search for more than 4 parameters can be done more efficiently with random parameter search than with grid search. Basically, chances are good to find one of many good models in less time than performing an exhaustive grid search. We simply build up to max_models models with parameters drawn randomly from user-specified distributions (here, uniform). For this example, we use the adaptive learning rate and focus on tuning the network architecture and the regularization parameters. We also let the grid search stop automatically once the performance at the top of the leaderboard doesn’t change much anymore, i.e., once the search has converged.</p>
<div class="sourceCode" id="cb1073"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hyper_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  activation<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rectifier"</span>,<span class="st">"Tanh"</span>,<span class="st">"Maxout"</span>,<span class="st">"RectifierWithDropout"</span>,<span class="st">"TanhWithDropout"</span>,<span class="st">"MaxoutWithDropout"</span><span class="op">)</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">50</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">30</span>,<span class="fl">30</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span><span class="op">)</span><span class="op">)</span>,
  input_dropout_ratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.05</span><span class="op">)</span>,
  l1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-4</span>,<span class="fl">1e-6</span><span class="op">)</span>,
  l2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-4</span>,<span class="fl">1e-6</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">hyper_params</span>

<span class="co">## Stop once the top 5 models are within 1% of each other (i.e., the windowed average varies less than 1%)</span>
<span class="va">search_criteria</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>strategy <span class="op">=</span> <span class="st">"RandomDiscrete"</span>, max_runtime_secs <span class="op">=</span> <span class="fl">360</span>, max_models <span class="op">=</span> <span class="fl">100</span>, seed<span class="op">=</span><span class="fl">1234567</span>, stopping_rounds<span class="op">=</span><span class="fl">5</span>, stopping_tolerance<span class="op">=</span><span class="fl">1e-2</span><span class="op">)</span>
<span class="va">dl_random_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.grid.html">h2o.grid</a></span><span class="op">(</span>
  algorithm<span class="op">=</span><span class="st">"deeplearning"</span>,
  grid_id <span class="op">=</span> <span class="st">"dl_grid_random"</span>,
  training_frame<span class="op">=</span><span class="va">sampled_train</span>,
  validation_frame<span class="op">=</span><span class="va">valid</span>, 
  x<span class="op">=</span><span class="va">predictors</span>, 
  y<span class="op">=</span><span class="va">response</span>,
  epochs<span class="op">=</span><span class="fl">1</span>,
  stopping_metric<span class="op">=</span><span class="st">"logloss"</span>,
  stopping_tolerance<span class="op">=</span><span class="fl">1e-2</span>,        <span class="co">## stop when logloss does not improve by &gt;=1% for 2 scoring events</span>
  stopping_rounds<span class="op">=</span><span class="fl">2</span>,
  score_validation_samples<span class="op">=</span><span class="fl">10000</span>, <span class="co">## downsample validation set for faster scoring</span>
  score_duty_cycle<span class="op">=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span>
  max_w2<span class="op">=</span><span class="fl">10</span>,                      <span class="co">## can help improve stability for Rectifier</span>
  hyper_params <span class="op">=</span> <span class="va">hyper_params</span>,
  search_criteria <span class="op">=</span> <span class="va">search_criteria</span>
<span class="op">)</span>                                
<span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid_random"</span>,sort_by<span class="op">=</span><span class="st">"logloss"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">grid</span>

<span class="va">grid</span><span class="op">@</span><span class="va">summary_table</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>
<span class="va">best_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getModel.html">h2o.getModel</a></span><span class="op">(</span><span class="va">grid</span><span class="op">@</span><span class="va">model_ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">## model with lowest logloss</span>
<span class="va">best_model</span></code></pre></div>
<p>Let’s look at the model with the lowest validation misclassification rate:</p>
<div class="sourceCode" id="cb1074"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid"</span>,sort_by<span class="op">=</span><span class="st">"err"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">best_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getModel.html">h2o.getModel</a></span><span class="op">(</span><span class="va">grid</span><span class="op">@</span><span class="va">model_ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">## model with lowest classification error (on validation, since it was available during training)</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.confusionMatrix.html">h2o.confusionMatrix</a></span><span class="op">(</span><span class="va">best_model</span>,valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2549    1003       0       0       0       1      67 0.2959</span>
<span class="co">#&gt; class_2     621    4240      45       0       2      12       7 0.1394</span>
<span class="co">#&gt; class_3       0      75     544       2       0       5       0 0.1310</span>
<span class="co">#&gt; class_4       0       1      49       7       0       0       0 0.8772</span>
<span class="co">#&gt; class_5       6     122       3       0      13       0       0 0.9097</span>
<span class="co">#&gt; class_6       0      89     189       0       0      16       0 0.9456</span>
<span class="co">#&gt; class_7      89       2       0       0       0       0     283 0.2433</span>
<span class="co">#&gt; Totals     3265    5532     830       9      15      34     357 0.2380</span>
<span class="co">#&gt;                     Rate</span>
<span class="co">#&gt; class_1 =  1,071 / 3,620</span>
<span class="co">#&gt; class_2 =    687 / 4,927</span>
<span class="co">#&gt; class_3 =       82 / 626</span>
<span class="co">#&gt; class_4 =        50 / 57</span>
<span class="co">#&gt; class_5 =      131 / 144</span>
<span class="co">#&gt; class_6 =      278 / 294</span>
<span class="co">#&gt; class_7 =       91 / 374</span>
<span class="co">#&gt; Totals  = 2,390 / 10,042</span>
<span class="va">best_params</span> <span class="op">&lt;-</span> <span class="va">best_model</span><span class="op">@</span><span class="va">allparameters</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">activation</span>
<span class="co">#&gt; [1] "Rectifier"</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">hidden</span>
<span class="co">#&gt; [1] 64 64</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">input_dropout_ratio</span>
<span class="co">#&gt; [1] 0</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">l1</span>
<span class="co">#&gt; [1] 1e-05</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">l2</span>
<span class="co">#&gt; [1] 1e-05</span></code></pre></div>
</div>
<div id="checkpointing" class="section level3">
<h3>
<span class="header-section-number">46.5.8</span> Checkpointing<a class="anchor" aria-label="anchor" href="#checkpointing"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s continue training the manually tuned model from before, for 2 more epochs. Note that since many important parameters such as epochs, l1, l2, max_w2, score_interval, train_samples_per_iteration, input_dropout_ratio, hidden_dropout_ratios, score_duty_cycle, classification_stop, regression_stop, variable_importances, force_load_balance can be modified between checkpoint restarts, it is best to specify as many parameters as possible explicitly.</p>
<div class="sourceCode" id="cb1075"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">max_epochs</span> <span class="op">&lt;-</span> <span class="fl">12</span> <span class="co">## Add two more epochs</span>
<span class="va">m_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  model_id<span class="op">=</span><span class="st">"dl_model_tuned_continued"</span>, 
  checkpoint<span class="op">=</span><span class="st">"dl_model_tuned"</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>, 
  validation_frame<span class="op">=</span><span class="va">valid</span>, 
  x<span class="op">=</span><span class="va">predictors</span>, 
  y<span class="op">=</span><span class="va">response</span>, 
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">128</span>,<span class="fl">128</span>,<span class="fl">128</span><span class="op">)</span>,          <span class="co">## more hidden layers -&gt; more complex interactions</span>
  epochs<span class="op">=</span><span class="va">max_epochs</span>,              <span class="co">## hopefully long enough to converge (otherwise restart again)</span>
  stopping_metric<span class="op">=</span><span class="st">"logloss"</span>,      <span class="co">## logloss is directly optimized by Deep Learning</span>
  stopping_tolerance<span class="op">=</span><span class="fl">1e-2</span>,        <span class="co">## stop when validation logloss does not improve by &gt;=1% for 2 scoring events</span>
  stopping_rounds<span class="op">=</span><span class="fl">2</span>,
  score_validation_samples<span class="op">=</span><span class="fl">10000</span>, <span class="co">## downsample validation set for faster scoring</span>
  score_duty_cycle<span class="op">=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span>
  adaptive_rate<span class="op">=</span><span class="cn">F</span>,                <span class="co">## manually tuned learning rate</span>
  rate<span class="op">=</span><span class="fl">0.01</span>, 
  rate_annealing<span class="op">=</span><span class="fl">2e-6</span>,            
  momentum_start<span class="op">=</span><span class="fl">0.2</span>,             <span class="co">## manually tuned momentum</span>
  momentum_stable<span class="op">=</span><span class="fl">0.4</span>, 
  momentum_ramp<span class="op">=</span><span class="fl">1e7</span>, 
  l1<span class="op">=</span><span class="fl">1e-5</span>,                        <span class="co">## add some L1/L2 regularization</span>
  l2<span class="op">=</span><span class="fl">1e-5</span>,
  max_w2<span class="op">=</span><span class="fl">10</span>                       <span class="co">## helps stability for Rectifier</span>
<span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m_cont</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">m_cont</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/checpointing-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Once we are satisfied with the results, we can save the model to disk (on the cluster). In this example, we store the model in a directory called <code>mybest_deeplearning_covtype_model</code>, which will be created for us since force=TRUE.</p>
<div class="sourceCode" id="cb1076"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.saveModel.html">h2o.saveModel</a></span><span class="op">(</span><span class="va">m_cont</span>, 
          path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"mybest_deeplearning_covtype_model"</span><span class="op">)</span>, force<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>It can be loaded later with the following command:</p>
<div class="sourceCode" id="cb1077"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>
<span class="co">#&gt; [1] "/home/rstudio/all/output/data/mybest_deeplearning_covtype_model/dl_model_tuned_continued"</span>
<span class="va">m_loaded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.loadModel.html">h2o.loadModel</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m_loaded</span><span class="op">)</span>
<span class="co">#&gt; Model Details:</span>
<span class="co">#&gt; ==============</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialModel: deeplearning</span>
<span class="co">#&gt; Model Key:  dl_model_tuned_continued </span>
<span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 41,223 weights/biases, 333.0 KB, 4,200,713 training samples, mini-batch size 1</span>
<span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span>
<span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span>
<span class="co">#&gt; 2     2   128 Rectifier  0.00 % 0.000010 0.000010  0.001064 0.000000 0.284014</span>
<span class="co">#&gt; 3     3   128 Rectifier  0.00 % 0.000010 0.000010  0.001064 0.000000 0.284014</span>
<span class="co">#&gt; 4     4   128 Rectifier  0.00 % 0.000010 0.000010  0.001064 0.000000 0.284014</span>
<span class="co">#&gt; 5     5     7   Softmax      NA 0.000010 0.000010  0.001064 0.000000 0.284014</span>
<span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span>
<span class="co">#&gt; 1          NA         NA        NA       NA</span>
<span class="co">#&gt; 2   -0.010689   0.325116 -0.009821 0.289280</span>
<span class="co">#&gt; 3   -0.054759   0.226153  0.933718 0.372898</span>
<span class="co">#&gt; 4   -0.063011   0.217923  0.805753 0.189808</span>
<span class="co">#&gt; 5   -0.020857   0.270380 -0.000980 1.062795</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on training data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary training frame with 9866 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Training Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0535</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.231</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.178</span>
<span class="co">#&gt; Mean Per-Class Error: 0.133</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3321     254       0       0       2       0      17 0.0760</span>
<span class="co">#&gt; class_2     225    4565       8       0      10      13       3 0.0537</span>
<span class="co">#&gt; class_3       0      23     546       4       2      37       0 0.1078</span>
<span class="co">#&gt; class_4       0       0       8      42       0       4       0 0.2222</span>
<span class="co">#&gt; class_5       5      32       1       0     108       3       0 0.2752</span>
<span class="co">#&gt; class_6       0       8      24       1       0     253       0 0.1154</span>
<span class="co">#&gt; class_7      27       0       0       0       0       0     320 0.0778</span>
<span class="co">#&gt; Totals     3578    4882     587      47     122     310     340 0.0721</span>
<span class="co">#&gt;                  Rate</span>
<span class="co">#&gt; class_1 = 273 / 3,594</span>
<span class="co">#&gt; class_2 = 259 / 4,824</span>
<span class="co">#&gt; class_3 =    66 / 612</span>
<span class="co">#&gt; class_4 =     12 / 54</span>
<span class="co">#&gt; class_5 =    41 / 149</span>
<span class="co">#&gt; class_6 =    33 / 286</span>
<span class="co">#&gt; class_7 =    27 / 347</span>
<span class="co">#&gt; Totals  = 711 / 9,866</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.927934</span>
<span class="co">#&gt; 2 2  0.997567</span>
<span class="co">#&gt; 3 3  0.999595</span>
<span class="co">#&gt; 4 4  1.000000</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 9997 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0588</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.243</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.194</span>
<span class="co">#&gt; Mean Per-Class Error: 0.133</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3310     302       0       0       1       0      14 0.0874</span>
<span class="co">#&gt; class_2     246    4637       6       0      15      13       3 0.0575</span>
<span class="co">#&gt; class_3       0      17     554       2       1      43       0 0.1021</span>
<span class="co">#&gt; class_4       0       0       3      39       0       3       0 0.1333</span>
<span class="co">#&gt; class_5       5      43       4       0     103       0       0 0.3355</span>
<span class="co">#&gt; class_6       1      12      22       4       0     259       0 0.1309</span>
<span class="co">#&gt; class_7      26       2       0       0       0       0     307 0.0836</span>
<span class="co">#&gt; Totals     3588    5013     589      45     120     318     324 0.0788</span>
<span class="co">#&gt;                  Rate</span>
<span class="co">#&gt; class_1 = 317 / 3,627</span>
<span class="co">#&gt; class_2 = 283 / 4,920</span>
<span class="co">#&gt; class_3 =    63 / 617</span>
<span class="co">#&gt; class_4 =      6 / 45</span>
<span class="co">#&gt; class_5 =    52 / 155</span>
<span class="co">#&gt; class_6 =    39 / 298</span>
<span class="co">#&gt; class_7 =    28 / 335</span>
<span class="co">#&gt; Totals  = 788 / 9,997</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.921176</span>
<span class="co">#&gt; 2 2  0.995699</span>
<span class="co">#&gt; 3 3  0.999400</span>
<span class="co">#&gt; 4 4  0.999900</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Scoring History: </span>
<span class="co">#&gt;              timestamp          duration training_speed   epochs iterations</span>
<span class="co">#&gt; 1  2020-11-20 03:26:16         0.000 sec             NA  0.00000          0</span>
<span class="co">#&gt; 2  2020-11-20 03:26:23         6.786 sec  15466 obs/sec  0.28676          1</span>
<span class="co">#&gt; 3  2020-11-20 03:26:35        18.632 sec  22122 obs/sec  1.14690          4</span>
<span class="co">#&gt; 4  2020-11-20 03:26:46        29.836 sec  24066 obs/sec  2.00553          7</span>
<span class="co">#&gt; 5  2020-11-20 03:26:57        40.597 sec  25266 obs/sec  2.86748         10</span>
<span class="co">#&gt; 6  2020-11-20 03:27:08        51.665 sec  25784 obs/sec  3.72709         13</span>
<span class="co">#&gt; 7  2020-11-20 03:27:18  1 min  2.131 sec  26357 obs/sec  4.58514         16</span>
<span class="co">#&gt; 8  2020-11-20 03:27:29  1 min 12.694 sec  26737 obs/sec  5.44445         19</span>
<span class="co">#&gt; 9  2020-11-20 03:27:39  1 min 23.185 sec  27035 obs/sec  6.30235         22</span>
<span class="co">#&gt; 10 2020-11-20 03:27:50  1 min 33.904 sec  27209 obs/sec  7.16167         25</span>
<span class="co">#&gt; 11 2020-11-20 03:28:01  1 min 45.092 sec  27221 obs/sec  8.02231         28</span>
<span class="co">#&gt; 12 2020-11-20 03:28:12  1 min 55.566 sec  27410 obs/sec  8.88425         31</span>
<span class="co">#&gt; 13 2020-11-20 03:28:22  2 min  5.815 sec  27604 obs/sec  9.74215         34</span>
<span class="co">#&gt; 14 2020-11-20 03:28:26  2 min  9.524 sec  27631 obs/sec 10.02778         35</span>
<span class="co">#&gt; 15 2020-11-20 03:29:34  2 min 13.240 sec  27662 obs/sec 10.31546         36</span>
<span class="co">#&gt; 16 2020-11-20 03:29:42  2 min 21.230 sec  27553 obs/sec 10.89011         38</span>
<span class="co">#&gt; 17 2020-11-20 03:29:53  2 min 32.027 sec  27608 obs/sec 11.75131         41</span>
<span class="co">#&gt; 18 2020-11-20 03:29:57  2 min 35.687 sec  27633 obs/sec 12.03591         42</span>
<span class="co">#&gt;           samples training_rmse training_logloss training_r2</span>
<span class="co">#&gt; 1        0.000000            NA               NA          NA</span>
<span class="co">#&gt; 2   100084.000000       0.43054          0.57040     0.90484</span>
<span class="co">#&gt; 3   400286.000000       0.36238          0.41464     0.93258</span>
<span class="co">#&gt; 4   699960.000000       0.32572          0.34221     0.94553</span>
<span class="co">#&gt; 5  1000792.000000       0.30290          0.29892     0.95290</span>
<span class="co">#&gt; 6  1300810.000000       0.29379          0.28232     0.95569</span>
<span class="co">#&gt; 7  1600283.000000       0.27523          0.24840     0.96111</span>
<span class="co">#&gt; 8  1900194.000000       0.26909          0.23856     0.96283</span>
<span class="co">#&gt; 9  2199614.000000       0.26574          0.23293     0.96375</span>
<span class="co">#&gt; 10 2499530.000000       0.25792          0.21815     0.96585</span>
<span class="co">#&gt; 11 2799908.000000       0.24960          0.20567     0.96802</span>
<span class="co">#&gt; 12 3100736.000000       0.24127          0.19288     0.97012</span>
<span class="co">#&gt; 13 3400156.000000       0.23989          0.19054     0.97046</span>
<span class="co">#&gt; 14 3499847.000000       0.23634          0.18423     0.97132</span>
<span class="co">#&gt; 15 3600249.000000       0.23974          0.18952     0.97014</span>
<span class="co">#&gt; 16 3800813.000000       0.23554          0.18496     0.97118</span>
<span class="co">#&gt; 17 4101382.000000       0.22893          0.17532     0.97278</span>
<span class="co">#&gt; 18 4200713.000000       0.23129          0.17767     0.97221</span>
<span class="co">#&gt;    training_classification_error validation_rmse validation_logloss</span>
<span class="co">#&gt; 1                             NA              NA                 NA</span>
<span class="co">#&gt; 2                        0.23738         0.43214            0.57193</span>
<span class="co">#&gt; 3                        0.17584         0.36707            0.41940</span>
<span class="co">#&gt; 4                        0.13817         0.33385            0.35832</span>
<span class="co">#&gt; 5                        0.12237         0.31106            0.31207</span>
<span class="co">#&gt; 6                        0.11541         0.29951            0.29316</span>
<span class="co">#&gt; 7                        0.10000         0.28369            0.26356</span>
<span class="co">#&gt; 8                        0.09583         0.27820            0.25226</span>
<span class="co">#&gt; 9                        0.09394         0.27289            0.24474</span>
<span class="co">#&gt; 10                       0.08877         0.26676            0.23336</span>
<span class="co">#&gt; 11                       0.08449         0.26008            0.22383</span>
<span class="co">#&gt; 12                       0.07694         0.25782            0.21981</span>
<span class="co">#&gt; 13                       0.07594         0.25191            0.21062</span>
<span class="co">#&gt; 14                       0.07316         0.25231            0.20847</span>
<span class="co">#&gt; 15                       0.07653         0.25506            0.21307</span>
<span class="co">#&gt; 16                       0.07176         0.24595            0.19942</span>
<span class="co">#&gt; 17                       0.06902         0.24357            0.19463</span>
<span class="co">#&gt; 18                       0.07207         0.24256            0.19427</span>
<span class="co">#&gt;    validation_r2 validation_classification_error</span>
<span class="co">#&gt; 1             NA                              NA</span>
<span class="co">#&gt; 2        0.90512                         0.24438</span>
<span class="co">#&gt; 3        0.93154                         0.18391</span>
<span class="co">#&gt; 4        0.94337                         0.14583</span>
<span class="co">#&gt; 5        0.95084                         0.13173</span>
<span class="co">#&gt; 6        0.95442                         0.11874</span>
<span class="co">#&gt; 7        0.95911                         0.10675</span>
<span class="co">#&gt; 8        0.96068                         0.10155</span>
<span class="co">#&gt; 9        0.96217                         0.09865</span>
<span class="co">#&gt; 10       0.96384                         0.09455</span>
<span class="co">#&gt; 11       0.96563                         0.08876</span>
<span class="co">#&gt; 12       0.96623                         0.08796</span>
<span class="co">#&gt; 13       0.96776                         0.08426</span>
<span class="co">#&gt; 14       0.96766                         0.08376</span>
<span class="co">#&gt; 15       0.96567                         0.08693</span>
<span class="co">#&gt; 16       0.96808                         0.08182</span>
<span class="co">#&gt; 17       0.96869                         0.07752</span>
<span class="co">#&gt; 18       0.96895                         0.07882</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span>
<span class="co">#&gt; =================================================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variable Importances: </span>
<span class="co">#&gt;                             variable relative_importance scaled_importance</span>
<span class="co">#&gt; 1                          Elevation            1.000000          1.000000</span>
<span class="co">#&gt; 2 Horizontal_Distance_To_Fire_Points            0.956722          0.956722</span>
<span class="co">#&gt; 3    Horizontal_Distance_To_Roadways            0.889055          0.889055</span>
<span class="co">#&gt; 4             Wilderness_Area.area_0            0.740660          0.740660</span>
<span class="co">#&gt; 5             Wilderness_Area.area_3            0.607293          0.607293</span>
<span class="co">#&gt;   percentage</span>
<span class="co">#&gt; 1   0.048252</span>
<span class="co">#&gt; 2   0.046164</span>
<span class="co">#&gt; 3   0.042899</span>
<span class="co">#&gt; 4   0.035738</span>
<span class="co">#&gt; 5   0.029303</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;                       variable relative_importance scaled_importance percentage</span>
<span class="co">#&gt; 51           Soil_Type.type_17            0.157231          0.157231   0.007587</span>
<span class="co">#&gt; 52            Soil_Type.type_6            0.154352          0.154352   0.007448</span>
<span class="co">#&gt; 53           Soil_Type.type_14            0.147832          0.147832   0.007133</span>
<span class="co">#&gt; 54           Soil_Type.type_24            0.140650          0.140650   0.006787</span>
<span class="co">#&gt; 55       Soil_Type.missing(NA)            0.000000          0.000000   0.000000</span>
<span class="co">#&gt; 56 Wilderness_Area.missing(NA)            0.000000          0.000000   0.000000</span></code></pre></div>
<p>This model is fully functional and can be inspected, restarted, or used to score a dataset, etc. Note that binary compatibility between H2O versions is currently not guaranteed.</p>
</div>
<div id="cross-validation" class="section level3">
<h3>
<span class="header-section-number">46.5.9</span> Cross-Validation<a class="anchor" aria-label="anchor" href="#cross-validation"><i class="fas fa-link"></i></a>
</h3>
<p>For N-fold cross-validation, specify <code>nfolds&gt;1</code> instead of (or in addition to) a validation frame, and <code>N+1</code> models will be built: 1 model on the full training data, and N models with each 1/N-th of the data held out (there are different holdout strategies). Those N models then score on the held out data, and their combined predictions on the full training data are scored to get the cross-validation metrics.</p>
<div class="sourceCode" id="cb1078"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dlmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  x<span class="op">=</span><span class="va">predictors</span>,
  y<span class="op">=</span><span class="va">response</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
  epochs<span class="op">=</span><span class="fl">1</span>,
  nfolds<span class="op">=</span><span class="fl">5</span>,
  fold_assignment<span class="op">=</span><span class="st">"Modulo"</span> <span class="co"># can be "AUTO", "Modulo", "Random" or "Stratified"</span>
  <span class="op">)</span>
<span class="va">dlmodel</span></code></pre></div>
<p>N-fold cross-validation is especially useful with early stopping, as the main model will pick the ideal number of epochs from the convergence behavior of the cross-validation models.</p>
</div>
</div>
<div id="regression-and-binary-classification" class="section level2">
<h2>
<span class="header-section-number">46.6</span> Regression and Binary Classification<a class="anchor" aria-label="anchor" href="#regression-and-binary-classification"><i class="fas fa-link"></i></a>
</h2>
<p>Assume we want to turn the multi-class problem above into a binary classification problem. We create a binary response as follows:</p>
<div class="sourceCode" id="cb1079"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train</span><span class="op">$</span><span class="va">bin_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">train</span><span class="op">[</span>,<span class="va">response</span><span class="op">]</span> <span class="op">==</span> <span class="st">"class_1"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Let’s build a quick model and inspect the model:</p>
<div class="sourceCode" id="cb1080"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dlmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  x<span class="op">=</span><span class="va">predictors</span>,
  y<span class="op">=</span><span class="st">"bin_response"</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
  epochs<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dlmodel</span><span class="op">)</span></code></pre></div>
<p>Instead of a binary classification model, we find a regression model (H2ORegressionModel) that contains only 1 output neuron (instead of 2). The reason is that the response was a numerical feature (ordinal numbers 0 and 1), and H2O Deep Learning was run with distribution=AUTO, which defaulted to a Gaussian regression problem for a real-valued response. H2O Deep Learning supports regression for distributions other than Gaussian such as Poisson, Gamma, Tweedie, Laplace. It also supports Huber loss and per-row offsets specified via an offset_column. We refer to our H2O Deep Learning regression code examples for more information.</p>
<p>To perform classification, the response must first be turned into a categorical (factor) feature:</p>
<div class="sourceCode" id="cb1081"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train</span><span class="op">$</span><span class="va">bin_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/as.factor.html">as.factor</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">bin_response</span><span class="op">)</span> <span class="co">##make categorical</span>
<span class="va">dlmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  x<span class="op">=</span><span class="va">predictors</span>,
  y<span class="op">=</span><span class="st">"bin_response"</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
  epochs<span class="op">=</span><span class="fl">0.1</span>
  <span class="co">#balance_classes=T    ## enable this for high class imbalance</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dlmodel</span><span class="op">)</span> <span class="co">## Now the model metrics contain AUC for binary classification</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">dlmodel</span><span class="op">)</span><span class="op">)</span> <span class="co">## display ROC curve</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/bin_class_as_factor-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Now the model performs (binary) classification, and has multiple (2) output neurons.</p>
</div>
<div id="unsupervised-anomaly-detection" class="section level2">
<h2>
<span class="header-section-number">46.7</span> Unsupervised Anomaly detection<a class="anchor" aria-label="anchor" href="#unsupervised-anomaly-detection"><i class="fas fa-link"></i></a>
</h2>
<p>For instructions on how to build unsupervised models with H2O Deep Learning, we refer to our previous Tutorial on Anomaly Detection with H2O Deep Learning and our MNIST Anomaly detection code example, as well as our Stacked AutoEncoder R code example and another one for Unsupervised Pretraining with an AutoEncoder R code example.</p>
</div>
<div id="h2o-deep-learning-tips-tricks" class="section level2">
<h2>
<span class="header-section-number">46.8</span> H2O Deep Learning Tips &amp; Tricks<a class="anchor" aria-label="anchor" href="#h2o-deep-learning-tips-tricks"><i class="fas fa-link"></i></a>
</h2>
<div id="performance-tuning" class="section level3">
<h3>
<span class="header-section-number">46.8.1</span> Performance Tuning<a class="anchor" aria-label="anchor" href="#performance-tuning"><i class="fas fa-link"></i></a>
</h3>
<p>The Definitive H2O Deep Learning Performance Tuning blog post covers many of the following points that affect the computational efficiency, so it’s highly recommended.</p>
</div>
<div id="activation-functions" class="section level3">
<h3>
<span class="header-section-number">46.8.2</span> Activation Functions<a class="anchor" aria-label="anchor" href="#activation-functions"><i class="fas fa-link"></i></a>
</h3>
<p>While sigmoids have been used historically for neural networks, H2O Deep Learning implements Tanh, a scaled and shifted variant of the sigmoid which is symmetric around 0. Since its output values are bounded by -1..1, the stability of the neural network is rarely endangered. However, the derivative of the tanh function is always non-zero and back-propagation (training) of the weights is more computationally expensive than for rectified linear units, or Rectifier, which is max(0,x) and has vanishing gradient for x&lt;=0, leading to much faster training speed for large networks and is often the fastest path to accuracy on larger problems. In case you encounter instabilities with the Rectifier (in which case model building is automatically aborted), try a limited value to re-scale the weights: max_w2=10. The Maxout activation function is computationally more expensive, but can lead to higher accuracy. It is a generalized version of the Rectifier with two non-zero channels. In practice, the Rectifier (and RectifierWithDropout, see below) is the most versatile and performant option for most problems.</p>
</div>
<div id="generalization-techniques" class="section level3">
<h3>
<span class="header-section-number">46.8.3</span> Generalization Techniques<a class="anchor" aria-label="anchor" href="#generalization-techniques"><i class="fas fa-link"></i></a>
</h3>
<p>L1 and L2 penalties can be applied by specifying the l1 and l2 parameters. Intuition: L1 lets only strong weights survive (constant pulling force towards zero), while L2 prevents any single weight from getting too big. Dropout has recently been introduced as a powerful generalization technique, and is available as a parameter per layer, including the input layer. <code>input_dropout_ratio</code> controls the amount of input layer neurons that are randomly dropped (set to zero), while <code>hidden_dropout_ratios</code> are specified for each hidden layer. The former controls overfitting with respect to the input data (useful for high-dimensional noisy data), while the latter controls overfitting of the learned features. Note that <code>hidden_dropout_ratios</code> require the activation function to end with …WithDropout.</p>
</div>
<div id="early-stopping-and-optimizing-for-lowest-validation-error" class="section level3">
<h3>
<span class="header-section-number">46.8.4</span> Early stopping and optimizing for lowest validation error<a class="anchor" aria-label="anchor" href="#early-stopping-and-optimizing-for-lowest-validation-error"><i class="fas fa-link"></i></a>
</h3>
<p>By default, Deep Learning training stops when the stopping_metric does not improve by at least stopping_tolerance (0.01 means 1% improvement) for stopping_rounds consecutive scoring events on the training (or validation) data. By default, <code>overwrite_with_best_model</code> is enabled and the model returned after training for the specified number of epochs (or after stopping early due to convergence) is the model that has the best training set error (according to the metric specified by stopping_metric), or, if a validation set is provided, the lowest validation set error. Note that the training or validation set errors can be based on a subset of the training or validation data, depending on the values for <code>score_validation_samples</code> or <code>score_training_samples</code>, see below. For early stopping on a predefined error rate on the training data (accuracy for classification or MSE for regression), specify <code>classification_stop</code> or <code>regression_stop.</code></p>
</div>
<div id="training-samples-per-mapreduce-iteration" class="section level3">
<h3>
<span class="header-section-number">46.8.5</span> Training Samples per MapReduce Iteration<a class="anchor" aria-label="anchor" href="#training-samples-per-mapreduce-iteration"><i class="fas fa-link"></i></a>
</h3>
<p>The parameter <code>train_samples_per_iteration</code> matters especially in multi-node operation. It controls the number of rows trained on for each <code>MapReduce</code> iteration. Depending on the value selected, one MapReduce pass can sample observations, and multiple such passes are needed to train for one epoch. All H2O compute nodes then communicate to agree on the best model coefficients (weights/biases) so far, and the model may then be scored (controlled by other parameters below). The default value of -2 indicates auto-tuning, which attemps to keep the communication overhead at 5% of the total runtime. The parameter <code>target_ratio_comm_to_comp</code> controls this ratio. This parameter is explained in more detail in the H2O Deep Learning booklet,</p>
</div>
<div id="categorical-data" class="section level3">
<h3>
<span class="header-section-number">46.8.6</span> Categorical Data<a class="anchor" aria-label="anchor" href="#categorical-data"><i class="fas fa-link"></i></a>
</h3>
<p>For categorical data, a feature with K factor levels is automatically one-hot encoded (horizontalized) into <code>K-1</code> input neurons. Hence, the input neuron layer can grow substantially for datasets with high factor counts. In these cases, it might make sense to reduce the number of hidden neurons in the first hidden layer, such that large numbers of factor levels can be handled. In the limit of 1 neuron in the first hidden layer, the resulting model is similar to logistic regression with stochastic gradient descent, except that for classification problems, there’s still a softmax output layer, and that the activation function is not necessarily a sigmoid (Tanh). If variable importances are computed, it is recommended to turn on <code>use_all_factor_levels</code> (K input neurons for K levels). The experimental option max_categorical_features uses feature hashing to reduce the number of input neurons via the hash trick at the expense of hash collisions and reduced accuracy. Another way to reduce the dimensionality of the (categorical) features is to use <code><a href="https://rdrr.io/pkg/h2o/man/h2o.glrm.html">h2o.glrm()</a></code>, we refer to the GLRM tutorial for more details.</p>
</div>
<div id="sparse-data" class="section level3">
<h3>
<span class="header-section-number">46.8.7</span> Sparse Data<a class="anchor" aria-label="anchor" href="#sparse-data"><i class="fas fa-link"></i></a>
</h3>
<p>If the input data is sparse (many zeros), then it might make sense to enable the sparse option. This will result in the input not being standardized (0 mean, 1 variance), but only de-scaled (1 variance) and 0 values remain 0, leading to more efficient back-propagation. Sparsity is also a reason why CPU implementations can be faster than GPU implementations, because they can take advantage of if/else statements more effectively.</p>
</div>
<div id="missing-values" class="section level3">
<h3>
<span class="header-section-number">46.8.8</span> Missing Values<a class="anchor" aria-label="anchor" href="#missing-values"><i class="fas fa-link"></i></a>
</h3>
<p>H2O Deep Learning automatically does mean imputation for missing values during training (leaving the input layer activation at 0 after standardizing the values). For testing, missing test set values are also treated the same way by default. See the <code>h2o.impute</code> function to do your own mean imputation.</p>
</div>
<div id="loss-functions-distributions-offsets-observation-weights" class="section level3">
<h3>
<span class="header-section-number">46.8.9</span> Loss functions, Distributions, Offsets, Observation Weights<a class="anchor" aria-label="anchor" href="#loss-functions-distributions-offsets-observation-weights"><i class="fas fa-link"></i></a>
</h3>
<p>H2O Deep Learning supports advanced statistical features such as multiple loss functions, non-Gaussian distributions, per-row offsets and observation weights. In addition to Gaussian distributions and Squared loss, H2O Deep Learning supports Poisson, Gamma, Tweedie and Laplace distributions. It also supports Absolute and Huber loss and per-row offsets specified via an <code>offset_column.</code> Observation weights are supported via a user-specified weights_column.</p>
<p>We refer to our H2O Deep Learning R test code examples for more information.</p>
</div>
<div id="exporting-weights-and-biases" class="section level3">
<h3>
<span class="header-section-number">46.8.10</span> Exporting Weights and Biases<a class="anchor" aria-label="anchor" href="#exporting-weights-and-biases"><i class="fas fa-link"></i></a>
</h3>
<p>The model parameters (weights connecting two adjacent layers and per-neuron bias terms) can be stored as H2O Frames (like a dataset) by enabling <code>export_weights_and_biases</code>, and they can be accessed as follows:</p>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1082-1" data-line-number="1">iris_dl &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">5</span>,<span class="kw">as.h2o</span>(iris),</a>
<a class="sourceLine" id="cb1082-2" data-line-number="2">             <span class="dt">export_weights_and_biases=</span>T)</a>
<a class="sourceLine" id="cb1082-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-4" data-line-number="4">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1082-5" data-line-number="5"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1082-6" data-line-number="6">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1082-7" data-line-number="7"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1082-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-9" data-line-number="9">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1082-10" data-line-number="10"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1082-11" data-line-number="11">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1082-12" data-line-number="12"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb1082-13" data-line-number="13">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1082-14" data-line-number="14"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1082-15" data-line-number="15"><span class="kw">h2o.weights</span>(iris_dl, <span class="dt">matrix_id=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1082-16" data-line-number="16"><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></a>
<a class="sourceLine" id="cb1082-17" data-line-number="17"><span class="co">#&gt; 1      0.00796      0.0524     -0.08179     -0.0547</span></a>
<a class="sourceLine" id="cb1082-18" data-line-number="18"><span class="co">#&gt; 2      0.03736      0.1534      0.13268      0.1454</span></a>
<a class="sourceLine" id="cb1082-19" data-line-number="19"><span class="co">#&gt; 3     -0.01872      0.1114     -0.18782     -0.1408</span></a>
<a class="sourceLine" id="cb1082-20" data-line-number="20"><span class="co">#&gt; 4     -0.11893     -0.0144      0.06212      0.1130</span></a>
<a class="sourceLine" id="cb1082-21" data-line-number="21"><span class="co">#&gt; 5     -0.00984      0.1280     -0.15188      0.1385</span></a>
<a class="sourceLine" id="cb1082-22" data-line-number="22"><span class="co">#&gt; 6     -0.05972      0.0916      0.00419     -0.1071</span></a>
<a class="sourceLine" id="cb1082-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-24" data-line-number="24"><span class="co">#&gt; [200 rows x 4 columns]</span></a>
<a class="sourceLine" id="cb1082-25" data-line-number="25"><span class="kw">h2o.weights</span>(iris_dl, <span class="dt">matrix_id=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1082-26" data-line-number="26"><span class="co">#&gt;        C1      C2      C3       C4      C5      C6      C7       C8      C9</span></a>
<a class="sourceLine" id="cb1082-27" data-line-number="27"><span class="co">#&gt; 1  0.0465 -0.1095  0.0436  0.07882  0.0711 -0.0186 -0.0820 -0.09476 -0.0133</span></a>
<a class="sourceLine" id="cb1082-28" data-line-number="28"><span class="co">#&gt; 2 -0.0310  0.0407 -0.0462  0.00213 -0.0241 -0.0179  0.0104 -0.09055  0.0741</span></a>
<a class="sourceLine" id="cb1082-29" data-line-number="29"><span class="co">#&gt; 3 -0.0995 -0.0281 -0.1295  0.03595 -0.1058  0.0261  0.0455 -0.09053  0.0415</span></a>
<a class="sourceLine" id="cb1082-30" data-line-number="30"><span class="co">#&gt; 4  0.0814  0.0774  0.0520  0.03100  0.1085  0.0889 -0.0411  0.00283 -0.0949</span></a>
<a class="sourceLine" id="cb1082-31" data-line-number="31"><span class="co">#&gt; 5  0.0999  0.0817 -0.0449 -0.02073 -0.0957 -0.0999 -0.0264  0.05706 -0.0543</span></a>
<a class="sourceLine" id="cb1082-32" data-line-number="32"><span class="co">#&gt; 6 -0.1114  0.1008 -0.1016 -0.11798  0.0561  0.0789 -0.0798  0.05676 -0.0738</span></a>
<a class="sourceLine" id="cb1082-33" data-line-number="33"><span class="co">#&gt;        C10     C11      C12      C13     C14     C15     C16     C17      C18</span></a>
<a class="sourceLine" id="cb1082-34" data-line-number="34"><span class="co">#&gt; 1  0.00517  0.0498 -0.01020  0.02896 -0.0122 -0.1116  0.0756 -0.1171  0.06473</span></a>
<a class="sourceLine" id="cb1082-35" data-line-number="35"><span class="co">#&gt; 2  0.10793  0.0213  0.04943  0.00473 -0.0684 -0.0210  0.1328 -0.0723 -0.08566</span></a>
<a class="sourceLine" id="cb1082-36" data-line-number="36"><span class="co">#&gt; 3 -0.07389 -0.0101  0.00656 -0.01021 -0.0897  0.0994  0.0871  0.0611  0.00803</span></a>
<a class="sourceLine" id="cb1082-37" data-line-number="37"><span class="co">#&gt; 4  0.07844 -0.0675 -0.02354  0.07888  0.0178 -0.1056  0.0146 -0.0238  0.11052</span></a>
<a class="sourceLine" id="cb1082-38" data-line-number="38"><span class="co">#&gt; 5 -0.01753  0.0389  0.09626 -0.07570 -0.0258 -0.0967 -0.0850  0.0606 -0.10822</span></a>
<a class="sourceLine" id="cb1082-39" data-line-number="39"><span class="co">#&gt; 6  0.00324  0.0222 -0.05676 -0.09071 -0.0873  0.0659 -0.1169  0.1081  0.07081</span></a>
<a class="sourceLine" id="cb1082-40" data-line-number="40"><span class="co">#&gt;       C19     C20     C21     C22      C23      C24      C25      C26      C27</span></a>
<a class="sourceLine" id="cb1082-41" data-line-number="41"><span class="co">#&gt; 1 -0.1046 -0.0166 -0.1213 -0.0996 -0.02018 -0.09506  0.00439  0.03220  0.00958</span></a>
<a class="sourceLine" id="cb1082-42" data-line-number="42"><span class="co">#&gt; 2  0.1030 -0.1301 -0.0886  0.0432 -0.06524 -0.00245  0.05370  0.01215  0.06714</span></a>
<a class="sourceLine" id="cb1082-43" data-line-number="43"><span class="co">#&gt; 3  0.0395 -0.0842 -0.0827 -0.0423 -0.09799  0.09814  0.02524 -0.01772 -0.00768</span></a>
<a class="sourceLine" id="cb1082-44" data-line-number="44"><span class="co">#&gt; 4 -0.0485 -0.1591  0.0494 -0.0646 -0.06662 -0.07631  0.08138  0.04345  0.05303</span></a>
<a class="sourceLine" id="cb1082-45" data-line-number="45"><span class="co">#&gt; 5 -0.0906 -0.0616 -0.0837  0.1135  0.00207 -0.02798 -0.09369 -0.00993 -0.05584</span></a>
<a class="sourceLine" id="cb1082-46" data-line-number="46"><span class="co">#&gt; 6 -0.0400  0.0872 -0.0220 -0.0977 -0.07580 -0.07600 -0.00641  0.02352 -0.05926</span></a>
<a class="sourceLine" id="cb1082-47" data-line-number="47"><span class="co">#&gt;       C28     C29      C30     C31     C32     C33      C34       C35      C36</span></a>
<a class="sourceLine" id="cb1082-48" data-line-number="48"><span class="co">#&gt; 1  0.0272 -0.0195 -0.00218 -0.0816  0.0920  0.0891 -0.07083 -0.074438 -0.06834</span></a>
<a class="sourceLine" id="cb1082-49" data-line-number="49"><span class="co">#&gt; 2 -0.0491 -0.0777 -0.04750  0.0163 -0.0841 -0.0158 -0.03827  0.039149 -0.06379</span></a>
<a class="sourceLine" id="cb1082-50" data-line-number="50"><span class="co">#&gt; 3  0.1053  0.0530 -0.03415 -0.0539  0.0542  0.0918 -0.03704  0.000316  0.02297</span></a>
<a class="sourceLine" id="cb1082-51" data-line-number="51"><span class="co">#&gt; 4 -0.0296 -0.0215 -0.05852 -0.0147  0.1126  0.0757 -0.10917 -0.104685  0.00504</span></a>
<a class="sourceLine" id="cb1082-52" data-line-number="52"><span class="co">#&gt; 5  0.0111 -0.0246 -0.07814  0.1209 -0.1105  0.0497 -0.00612  0.034458 -0.05902</span></a>
<a class="sourceLine" id="cb1082-53" data-line-number="53"><span class="co">#&gt; 6 -0.0795  0.1106  0.07811  0.1262  0.0821  0.0399  0.07686  0.112702  0.03121</span></a>
<a class="sourceLine" id="cb1082-54" data-line-number="54"><span class="co">#&gt;        C37     C38      C39     C40     C41      C42     C43     C44     C45</span></a>
<a class="sourceLine" id="cb1082-55" data-line-number="55"><span class="co">#&gt; 1 -0.05408  0.0225 -0.00842 -0.1187  0.0739  0.00635 -0.0805  0.0921  0.0235</span></a>
<a class="sourceLine" id="cb1082-56" data-line-number="56"><span class="co">#&gt; 2  0.04124  0.0915 -0.12458 -0.0487 -0.0163 -0.12214  0.0778 -0.1051  0.0916</span></a>
<a class="sourceLine" id="cb1082-57" data-line-number="57"><span class="co">#&gt; 3 -0.00215 -0.0228 -0.01176  0.0196  0.0910  0.09060 -0.0803  0.0592  0.0652</span></a>
<a class="sourceLine" id="cb1082-58" data-line-number="58"><span class="co">#&gt; 4  0.10315 -0.0233  0.01607  0.0319  0.0656 -0.10637  0.1208 -0.1292  0.0777</span></a>
<a class="sourceLine" id="cb1082-59" data-line-number="59"><span class="co">#&gt; 5 -0.03806  0.1265 -0.02216  0.1261 -0.0040 -0.12519  0.0231 -0.0469  0.1046</span></a>
<a class="sourceLine" id="cb1082-60" data-line-number="60"><span class="co">#&gt; 6  0.03472  0.1054 -0.02221  0.1120  0.0304 -0.01493 -0.0504  0.0788 -0.0763</span></a>
<a class="sourceLine" id="cb1082-61" data-line-number="61"><span class="co">#&gt;        C46     C47     C48     C49     C50      C51      C52     C53      C54</span></a>
<a class="sourceLine" id="cb1082-62" data-line-number="62"><span class="co">#&gt; 1 -0.07186 -0.0450  0.0366 -0.0193 -0.0283 -0.00323  0.00888  0.0441  0.06183</span></a>
<a class="sourceLine" id="cb1082-63" data-line-number="63"><span class="co">#&gt; 2  0.03675  0.1078  0.0522  0.0988  0.0592 -0.03600 -0.02050  0.0546 -0.06854</span></a>
<a class="sourceLine" id="cb1082-64" data-line-number="64"><span class="co">#&gt; 3 -0.03591 -0.0993  0.1261 -0.1079  0.0892  0.07524 -0.00341 -0.0794 -0.08465</span></a>
<a class="sourceLine" id="cb1082-65" data-line-number="65"><span class="co">#&gt; 4  0.13047 -0.0820 -0.1394  0.1091 -0.1071 -0.08141  0.00751 -0.0196  0.09403</span></a>
<a class="sourceLine" id="cb1082-66" data-line-number="66"><span class="co">#&gt; 5  0.11292 -0.0134  0.0835 -0.0728 -0.1032  0.03095  0.05855  0.0795  0.04242</span></a>
<a class="sourceLine" id="cb1082-67" data-line-number="67"><span class="co">#&gt; 6 -0.00516  0.0723 -0.0913 -0.0119 -0.0520 -0.06228  0.03579  0.0205 -0.00257</span></a>
<a class="sourceLine" id="cb1082-68" data-line-number="68"><span class="co">#&gt;       C55      C56      C57     C58     C59     C60     C61     C62       C63</span></a>
<a class="sourceLine" id="cb1082-69" data-line-number="69"><span class="co">#&gt; 1 -0.0419  0.06653 -0.02064 -0.0873 -0.0496 -0.0519  0.0893 -0.0551  0.090068</span></a>
<a class="sourceLine" id="cb1082-70" data-line-number="70"><span class="co">#&gt; 2 -0.0934 -0.03070  0.03025  0.0153 -0.0473 -0.0450 -0.0658 -0.0875 -0.081945</span></a>
<a class="sourceLine" id="cb1082-71" data-line-number="71"><span class="co">#&gt; 3 -0.0664 -0.09085 -0.00822  0.0295 -0.0800  0.0102  0.0199  0.0525 -0.093481</span></a>
<a class="sourceLine" id="cb1082-72" data-line-number="72"><span class="co">#&gt; 4  0.0550  0.00429 -0.11825 -0.0882  0.0268 -0.1007 -0.0972 -0.0905 -0.000336</span></a>
<a class="sourceLine" id="cb1082-73" data-line-number="73"><span class="co">#&gt; 5  0.0223  0.03773 -0.11006  0.0874  0.0416 -0.0476 -0.0492  0.1090  0.131046</span></a>
<a class="sourceLine" id="cb1082-74" data-line-number="74"><span class="co">#&gt; 6  0.0262 -0.01780 -0.02332 -0.0656 -0.0041 -0.0937 -0.0325 -0.0546  0.021579</span></a>
<a class="sourceLine" id="cb1082-75" data-line-number="75"><span class="co">#&gt;       C64     C65     C66      C67     C68     C69     C70      C71       C72</span></a>
<a class="sourceLine" id="cb1082-76" data-line-number="76"><span class="co">#&gt; 1 -0.0281 -0.1037  0.0510 -0.02837  0.0544 -0.0402 -0.0550  0.03376 -0.047851</span></a>
<a class="sourceLine" id="cb1082-77" data-line-number="77"><span class="co">#&gt; 2 -0.0581 -0.0906 -0.0513  0.01167  0.0580  0.1065  0.1368  0.06565  0.016624</span></a>
<a class="sourceLine" id="cb1082-78" data-line-number="78"><span class="co">#&gt; 3  0.0678 -0.0770  0.0310  0.10816 -0.0307  0.0457 -0.0242 -0.01571  0.059846</span></a>
<a class="sourceLine" id="cb1082-79" data-line-number="79"><span class="co">#&gt; 4  0.0214  0.0834 -0.0556  0.01432 -0.1186 -0.0546 -0.0487 -0.07035 -0.102846</span></a>
<a class="sourceLine" id="cb1082-80" data-line-number="80"><span class="co">#&gt; 5 -0.0970  0.0571 -0.0952  0.04021  0.0132  0.0987  0.0636  0.00649 -0.083315</span></a>
<a class="sourceLine" id="cb1082-81" data-line-number="81"><span class="co">#&gt; 6 -0.0225  0.0755 -0.0641  0.00621  0.0047  0.0728 -0.1122  0.03780 -0.000375</span></a>
<a class="sourceLine" id="cb1082-82" data-line-number="82"><span class="co">#&gt;        C73      C74     C75     C76      C77      C78    C79     C80       C81</span></a>
<a class="sourceLine" id="cb1082-83" data-line-number="83"><span class="co">#&gt; 1 -0.11732  0.07100 -0.0903  0.0508  0.03185  0.02267 0.1123  0.0742 -3.55e-02</span></a>
<a class="sourceLine" id="cb1082-84" data-line-number="84"><span class="co">#&gt; 2 -0.00512 -0.04240 -0.1177  0.1109  0.04258 -0.11612 0.0312  0.0826 -2.71e-02</span></a>
<a class="sourceLine" id="cb1082-85" data-line-number="85"><span class="co">#&gt; 3  0.06567  0.00884  0.0633  0.0131 -0.04068 -0.02366 0.1199 -0.0867 -1.93e-02</span></a>
<a class="sourceLine" id="cb1082-86" data-line-number="86"><span class="co">#&gt; 4  0.01926  0.00886 -0.0544 -0.0276  0.11046  0.06483 0.0512 -0.1099 -1.47e-02</span></a>
<a class="sourceLine" id="cb1082-87" data-line-number="87"><span class="co">#&gt; 5  0.05164  0.04142  0.0368 -0.0952 -0.07763  0.00915 0.0467  0.0303 -2.72e-05</span></a>
<a class="sourceLine" id="cb1082-88" data-line-number="88"><span class="co">#&gt; 6  0.12767  0.07201 -0.0630 -0.0597  0.00775  0.06622 0.0284 -0.0867  2.95e-02</span></a>
<a class="sourceLine" id="cb1082-89" data-line-number="89"><span class="co">#&gt;       C82     C83     C84      C85     C86      C87     C88     C89     C90</span></a>
<a class="sourceLine" id="cb1082-90" data-line-number="90"><span class="co">#&gt; 1  0.1248 -0.0298  0.0245 -0.07174 -0.0527 -0.10474 -0.0419  0.0957  0.1277</span></a>
<a class="sourceLine" id="cb1082-91" data-line-number="91"><span class="co">#&gt; 2  0.0863 -0.0643 -0.0791  0.08628  0.0242  0.04843 -0.0679  0.0524  0.1303</span></a>
<a class="sourceLine" id="cb1082-92" data-line-number="92"><span class="co">#&gt; 3 -0.1135 -0.0415 -0.0607  0.08333  0.0310 -0.00957 -0.0295  0.1271 -0.0662</span></a>
<a class="sourceLine" id="cb1082-93" data-line-number="93"><span class="co">#&gt; 4  0.0342 -0.0952 -0.0394  0.00664  0.0428 -0.03103 -0.1223  0.0160 -0.0318</span></a>
<a class="sourceLine" id="cb1082-94" data-line-number="94"><span class="co">#&gt; 5  0.0178  0.1108 -0.0236  0.02130 -0.0846 -0.06329  0.0636 -0.1057  0.0753</span></a>
<a class="sourceLine" id="cb1082-95" data-line-number="95"><span class="co">#&gt; 6  0.0103  0.0630  0.0766 -0.09502  0.1178  0.08095  0.0758 -0.1083  0.0612</span></a>
<a class="sourceLine" id="cb1082-96" data-line-number="96"><span class="co">#&gt;       C91      C92     C93     C94     C95     C96     C97     C98     C99</span></a>
<a class="sourceLine" id="cb1082-97" data-line-number="97"><span class="co">#&gt; 1  0.0462  0.08691  0.0897 -0.0143  0.0264 -0.0654  0.0377  0.0306 -0.0429</span></a>
<a class="sourceLine" id="cb1082-98" data-line-number="98"><span class="co">#&gt; 2 -0.0987  0.02555 -0.0787 -0.0641  0.0939  0.1071  0.0400  0.0848 -0.1121</span></a>
<a class="sourceLine" id="cb1082-99" data-line-number="99"><span class="co">#&gt; 3 -0.0185  0.10440  0.0594  0.0850  0.0807  0.0742 -0.0145  0.1164  0.0532</span></a>
<a class="sourceLine" id="cb1082-100" data-line-number="100"><span class="co">#&gt; 4  0.0228  0.00242  0.0576  0.0192 -0.0641 -0.0679 -0.0734 -0.0834 -0.0216</span></a>
<a class="sourceLine" id="cb1082-101" data-line-number="101"><span class="co">#&gt; 5 -0.0327 -0.11211 -0.0312  0.0335 -0.0525 -0.1217  0.0437 -0.1403 -0.1242</span></a>
<a class="sourceLine" id="cb1082-102" data-line-number="102"><span class="co">#&gt; 6  0.1193 -0.04983  0.0755  0.1163 -0.0436 -0.0276  0.0767 -0.0139 -0.0653</span></a>
<a class="sourceLine" id="cb1082-103" data-line-number="103"><span class="co">#&gt;      C100    C101     C102    C103    C104    C105    C106    C107    C108</span></a>
<a class="sourceLine" id="cb1082-104" data-line-number="104"><span class="co">#&gt; 1 -0.1141  0.1261 -0.03210 -0.0938 -0.1061  0.1139 -0.0498  0.0689 -0.0565</span></a>
<a class="sourceLine" id="cb1082-105" data-line-number="105"><span class="co">#&gt; 2 -0.0964  0.0423 -0.00512 -0.0652  0.1264  0.0327  0.1129  0.0532  0.0294</span></a>
<a class="sourceLine" id="cb1082-106" data-line-number="106"><span class="co">#&gt; 3  0.1193  0.0665 -0.01009 -0.0185 -0.0286 -0.1081  0.0831 -0.0191 -0.0270</span></a>
<a class="sourceLine" id="cb1082-107" data-line-number="107"><span class="co">#&gt; 4  0.1139 -0.0714 -0.11221  0.0196  0.0303 -0.0001 -0.0345 -0.1524 -0.0512</span></a>
<a class="sourceLine" id="cb1082-108" data-line-number="108"><span class="co">#&gt; 5  0.0412 -0.0120  0.01501  0.0491  0.0882 -0.0535  0.0785 -0.0754 -0.0429</span></a>
<a class="sourceLine" id="cb1082-109" data-line-number="109"><span class="co">#&gt; 6 -0.0862  0.0671  0.09162 -0.0248  0.0439  0.0380 -0.0200 -0.1123 -0.0396</span></a>
<a class="sourceLine" id="cb1082-110" data-line-number="110"><span class="co">#&gt;       C109     C110    C111     C112     C113    C114    C115    C116    C117</span></a>
<a class="sourceLine" id="cb1082-111" data-line-number="111"><span class="co">#&gt; 1  0.11503  0.07412 -0.0420 -0.02711  0.09977  0.0823  0.0378  0.0866  0.0492</span></a>
<a class="sourceLine" id="cb1082-112" data-line-number="112"><span class="co">#&gt; 2 -0.02634 -0.00723 -0.0667  0.02429 -0.00372  0.1116 -0.0156  0.0911 -0.0560</span></a>
<a class="sourceLine" id="cb1082-113" data-line-number="113"><span class="co">#&gt; 3 -0.08935 -0.04766  0.0465 -0.06340  0.06570 -0.1124 -0.1201  0.0514 -0.0405</span></a>
<a class="sourceLine" id="cb1082-114" data-line-number="114"><span class="co">#&gt; 4 -0.04889  0.04083  0.0783 -0.00769 -0.01486  0.0330  0.0806 -0.0637 -0.0688</span></a>
<a class="sourceLine" id="cb1082-115" data-line-number="115"><span class="co">#&gt; 5  0.05483  0.04193 -0.0643  0.06601  0.04655 -0.0204  0.0687  0.0510 -0.0692</span></a>
<a class="sourceLine" id="cb1082-116" data-line-number="116"><span class="co">#&gt; 6 -0.00251 -0.00414 -0.0899 -0.08483 -0.04445  0.0646  0.0675 -0.0982 -0.0887</span></a>
<a class="sourceLine" id="cb1082-117" data-line-number="117"><span class="co">#&gt;      C118     C119    C120    C121     C122    C123    C124     C125    C126</span></a>
<a class="sourceLine" id="cb1082-118" data-line-number="118"><span class="co">#&gt; 1  0.0612 -0.00107 0.02497  0.1162 -0.01583 -0.0657 -0.0411  0.12093  0.0158</span></a>
<a class="sourceLine" id="cb1082-119" data-line-number="119"><span class="co">#&gt; 2  0.0978  0.07340 0.11923 -0.0618 -0.04678  0.0762  0.0218 -0.05517  0.0891</span></a>
<a class="sourceLine" id="cb1082-120" data-line-number="120"><span class="co">#&gt; 3  0.0797  0.13426 0.00742  0.0315  0.00669  0.0824 -0.0559 -0.05673 -0.1109</span></a>
<a class="sourceLine" id="cb1082-121" data-line-number="121"><span class="co">#&gt; 4 -0.0748 -0.05128 0.06179 -0.0902  0.12589  0.0503  0.1347  0.02471 -0.0566</span></a>
<a class="sourceLine" id="cb1082-122" data-line-number="122"><span class="co">#&gt; 5  0.1263  0.07567 0.00516 -0.0951  0.00320  0.0454  0.0953  0.00395 -0.0845</span></a>
<a class="sourceLine" id="cb1082-123" data-line-number="123"><span class="co">#&gt; 6 -0.0282 -0.02412 0.00310 -0.0938  0.10188  0.0992 -0.0060  0.00587 -0.1206</span></a>
<a class="sourceLine" id="cb1082-124" data-line-number="124"><span class="co">#&gt;        C127     C128    C129    C130    C131     C132     C133    C134    C135</span></a>
<a class="sourceLine" id="cb1082-125" data-line-number="125"><span class="co">#&gt; 1  0.090928  0.00486  0.0566  0.0684  0.1093  0.00677  0.02756  0.0338 -0.0832</span></a>
<a class="sourceLine" id="cb1082-126" data-line-number="126"><span class="co">#&gt; 2  0.076693 -0.04962  0.0812 -0.1009  0.0712 -0.03638  0.00412 -0.1111 -0.0922</span></a>
<a class="sourceLine" id="cb1082-127" data-line-number="127"><span class="co">#&gt; 3 -0.010088  0.05781 -0.0644  0.0339 -0.0777 -0.07366  0.02398  0.0985 -0.1089</span></a>
<a class="sourceLine" id="cb1082-128" data-line-number="128"><span class="co">#&gt; 4  0.043642  0.05265  0.0978  0.0568 -0.0676 -0.03234  0.11928 -0.1029 -0.0591</span></a>
<a class="sourceLine" id="cb1082-129" data-line-number="129"><span class="co">#&gt; 5  0.000126 -0.09309 -0.0997  0.0732 -0.0101  0.11830 -0.05768  0.0431  0.0622</span></a>
<a class="sourceLine" id="cb1082-130" data-line-number="130"><span class="co">#&gt; 6  0.040048  0.00438 -0.0514  0.0863 -0.1153  0.09065  0.11514 -0.0477  0.0641</span></a>
<a class="sourceLine" id="cb1082-131" data-line-number="131"><span class="co">#&gt;       C136    C137     C138     C139     C140    C141     C142     C143    C144</span></a>
<a class="sourceLine" id="cb1082-132" data-line-number="132"><span class="co">#&gt; 1  0.04905  0.0669 -0.00892 -0.01743 -0.01033 -0.0976  0.00747  0.04476 -0.0289</span></a>
<a class="sourceLine" id="cb1082-133" data-line-number="133"><span class="co">#&gt; 2 -0.00962 -0.0806  0.12274 -0.09662 -0.02635  0.0168  0.06538  0.01851 -0.1096</span></a>
<a class="sourceLine" id="cb1082-134" data-line-number="134"><span class="co">#&gt; 3 -0.06242 -0.0884 -0.03374 -0.08997 -0.08453 -0.0102  0.01346 -0.01596  0.0645</span></a>
<a class="sourceLine" id="cb1082-135" data-line-number="135"><span class="co">#&gt; 4 -0.10898  0.0791  0.05837  0.00861  0.10179 -0.0655 -0.07928  0.02056  0.0247</span></a>
<a class="sourceLine" id="cb1082-136" data-line-number="136"><span class="co">#&gt; 5 -0.05495  0.1125 -0.05631 -0.04248  0.00896  0.1147 -0.10580  0.00887 -0.0151</span></a>
<a class="sourceLine" id="cb1082-137" data-line-number="137"><span class="co">#&gt; 6  0.03876  0.1222  0.07789 -0.03381 -0.03409 -0.0238  0.04382 -0.06370 -0.0674</span></a>
<a class="sourceLine" id="cb1082-138" data-line-number="138"><span class="co">#&gt;       C145     C146     C147      C148    C149     C150     C151    C152</span></a>
<a class="sourceLine" id="cb1082-139" data-line-number="139"><span class="co">#&gt; 1  0.00721  0.05120 -0.07245 -0.000306 -0.1053  0.00926 -0.09905  0.1209</span></a>
<a class="sourceLine" id="cb1082-140" data-line-number="140"><span class="co">#&gt; 2 -0.07532  0.00276 -0.09409  0.119070  0.0914 -0.03677 -0.03606 -0.1187</span></a>
<a class="sourceLine" id="cb1082-141" data-line-number="141"><span class="co">#&gt; 3  0.08570  0.04919 -0.00791 -0.044381  0.0467  0.01959 -0.05031  0.1196</span></a>
<a class="sourceLine" id="cb1082-142" data-line-number="142"><span class="co">#&gt; 4  0.09734 -0.00110 -0.09585 -0.011292  0.0698  0.12555  0.02274 -0.0403</span></a>
<a class="sourceLine" id="cb1082-143" data-line-number="143"><span class="co">#&gt; 5  0.04589 -0.01145  0.01207 -0.027290  0.0164  0.12170 -0.00585  0.0282</span></a>
<a class="sourceLine" id="cb1082-144" data-line-number="144"><span class="co">#&gt; 6 -0.01175  0.05045  0.10169 -0.015577 -0.0949  0.05535  0.10587 -0.1389</span></a>
<a class="sourceLine" id="cb1082-145" data-line-number="145"><span class="co">#&gt;       C153    C154     C155    C156     C157    C158    C159    C160    C161</span></a>
<a class="sourceLine" id="cb1082-146" data-line-number="146"><span class="co">#&gt; 1  0.06538 -0.1007  0.09324  0.1187  0.01293  0.1047  0.0440  0.0274  0.0448</span></a>
<a class="sourceLine" id="cb1082-147" data-line-number="147"><span class="co">#&gt; 2 -0.07462  0.0524 -0.00618  0.0859  0.06160 -0.0167 -0.0573 -0.0696  0.0993</span></a>
<a class="sourceLine" id="cb1082-148" data-line-number="148"><span class="co">#&gt; 3 -0.13834 -0.0229  0.00823 -0.0927  0.10409  0.0734  0.0310 -0.1217  0.1021</span></a>
<a class="sourceLine" id="cb1082-149" data-line-number="149"><span class="co">#&gt; 4  0.01341 -0.0104 -0.09765 -0.0901 -0.00982  0.0769 -0.0882  0.0116 -0.1180</span></a>
<a class="sourceLine" id="cb1082-150" data-line-number="150"><span class="co">#&gt; 5  0.00774 -0.0809 -0.09593 -0.0516 -0.11520 -0.1044 -0.0909  0.1006 -0.0803</span></a>
<a class="sourceLine" id="cb1082-151" data-line-number="151"><span class="co">#&gt; 6 -0.09055 -0.0722 -0.00549 -0.1079  0.02840  0.0503  0.0305 -0.1056 -0.0325</span></a>
<a class="sourceLine" id="cb1082-152" data-line-number="152"><span class="co">#&gt;      C162    C163     C164    C165     C166    C167    C168     C169    C170</span></a>
<a class="sourceLine" id="cb1082-153" data-line-number="153"><span class="co">#&gt; 1 -0.0770  0.0211  0.00251  0.0452 -0.03784  0.0553 -0.0809 -0.00343  0.0834</span></a>
<a class="sourceLine" id="cb1082-154" data-line-number="154"><span class="co">#&gt; 2  0.0926 -0.0689 -0.01158  0.0478 -0.11060  0.0441 -0.1129  0.00859 -0.0722</span></a>
<a class="sourceLine" id="cb1082-155" data-line-number="155"><span class="co">#&gt; 3 -0.0860  0.0686  0.02537 -0.1053  0.03189 -0.1133 -0.0378  0.09477 -0.0352</span></a>
<a class="sourceLine" id="cb1082-156" data-line-number="156"><span class="co">#&gt; 4 -0.1149 -0.0860 -0.06355 -0.0608  0.05246 -0.0377  0.0293  0.02084  0.0146</span></a>
<a class="sourceLine" id="cb1082-157" data-line-number="157"><span class="co">#&gt; 5  0.0149 -0.0477  0.08182  0.0323 -0.09866  0.0210  0.0790 -0.01953 -0.1253</span></a>
<a class="sourceLine" id="cb1082-158" data-line-number="158"><span class="co">#&gt; 6 -0.0303 -0.0820 -0.04820  0.0786  0.00416  0.1112  0.0430  0.05029 -0.1441</span></a>
<a class="sourceLine" id="cb1082-159" data-line-number="159"><span class="co">#&gt;       C171    C172    C173    C174    C175    C176    C177    C178    C179</span></a>
<a class="sourceLine" id="cb1082-160" data-line-number="160"><span class="co">#&gt; 1  0.02757 -0.1148  0.0550 -0.0101 -0.1003  0.0601  0.0225 -0.1106 -0.0915</span></a>
<a class="sourceLine" id="cb1082-161" data-line-number="161"><span class="co">#&gt; 2  0.11150 -0.0123 -0.0961 -0.0216 -0.0568  0.0739  0.0120  0.0270 -0.0339</span></a>
<a class="sourceLine" id="cb1082-162" data-line-number="162"><span class="co">#&gt; 3  0.01311  0.1147  0.0564  0.0476 -0.0756  0.0366 -0.0735  0.0399  0.0590</span></a>
<a class="sourceLine" id="cb1082-163" data-line-number="163"><span class="co">#&gt; 4 -0.00972 -0.0937  0.0616  0.0321 -0.1145 -0.0110 -0.0814  0.0361  0.0210</span></a>
<a class="sourceLine" id="cb1082-164" data-line-number="164"><span class="co">#&gt; 5  0.01359 -0.0153  0.0134 -0.0889  0.0517 -0.0464  0.0347 -0.0651  0.0264</span></a>
<a class="sourceLine" id="cb1082-165" data-line-number="165"><span class="co">#&gt; 6 -0.06683  0.0158  0.0779 -0.1010 -0.1170  0.0351 -0.0258  0.0400 -0.0693</span></a>
<a class="sourceLine" id="cb1082-166" data-line-number="166"><span class="co">#&gt;      C180    C181      C182    C183    C184    C185     C186    C187    C188</span></a>
<a class="sourceLine" id="cb1082-167" data-line-number="167"><span class="co">#&gt; 1  0.0831 -0.0834  7.87e-02 -0.0755  0.0130  0.0636  0.08468  0.0054  0.0922</span></a>
<a class="sourceLine" id="cb1082-168" data-line-number="168"><span class="co">#&gt; 2  0.0783 -0.0530 -3.80e-02  0.0036  0.0551 -0.0108  0.00275  0.0831  0.0460</span></a>
<a class="sourceLine" id="cb1082-169" data-line-number="169"><span class="co">#&gt; 3  0.0700 -0.0340 -7.55e-02 -0.0936  0.0830 -0.0450 -0.00995  0.0102  0.0350</span></a>
<a class="sourceLine" id="cb1082-170" data-line-number="170"><span class="co">#&gt; 4  0.1263 -0.1112  1.25e-01  0.0600 -0.1234  0.0765 -0.09840  0.0446  0.0729</span></a>
<a class="sourceLine" id="cb1082-171" data-line-number="171"><span class="co">#&gt; 5 -0.0348  0.0740  3.77e-05 -0.0960  0.0827  0.1147  0.04449 -0.1361  0.0728</span></a>
<a class="sourceLine" id="cb1082-172" data-line-number="172"><span class="co">#&gt; 6 -0.1145 -0.0543  2.08e-02  0.0466  0.0363  0.0107 -0.10155 -0.0485 -0.0543</span></a>
<a class="sourceLine" id="cb1082-173" data-line-number="173"><span class="co">#&gt;      C189     C190    C191    C192    C193     C194     C195    C196    C197</span></a>
<a class="sourceLine" id="cb1082-174" data-line-number="174"><span class="co">#&gt; 1 -0.0702  0.09825  0.1152  0.0161  0.1129  0.07579  0.06587  0.0933  0.0639</span></a>
<a class="sourceLine" id="cb1082-175" data-line-number="175"><span class="co">#&gt; 2 -0.1122  0.06139  0.1182 -0.0117  0.1116  0.11156  0.02069 -0.1009 -0.0872</span></a>
<a class="sourceLine" id="cb1082-176" data-line-number="176"><span class="co">#&gt; 3  0.0876  0.05208 -0.0576  0.1145 -0.0487  0.01280 -0.09603 -0.1153  0.0385</span></a>
<a class="sourceLine" id="cb1082-177" data-line-number="177"><span class="co">#&gt; 4  0.0698 -0.06449  0.0967  0.0691 -0.0197 -0.01377  0.04898  0.1180 -0.0629</span></a>
<a class="sourceLine" id="cb1082-178" data-line-number="178"><span class="co">#&gt; 5 -0.0849 -0.09553 -0.0951  0.0223  0.0948 -0.05589  0.01636  0.0302 -0.1344</span></a>
<a class="sourceLine" id="cb1082-179" data-line-number="179"><span class="co">#&gt; 6  0.0142 -0.00847 -0.0389 -0.0752 -0.0502  0.00129  0.00672  0.1169  0.0258</span></a>
<a class="sourceLine" id="cb1082-180" data-line-number="180"><span class="co">#&gt;      C198     C199    C200</span></a>
<a class="sourceLine" id="cb1082-181" data-line-number="181"><span class="co">#&gt; 1  0.0364  0.07103  0.0803</span></a>
<a class="sourceLine" id="cb1082-182" data-line-number="182"><span class="co">#&gt; 2  0.0022  0.10607 -0.1129</span></a>
<a class="sourceLine" id="cb1082-183" data-line-number="183"><span class="co">#&gt; 3  0.0956  0.00358  0.1221</span></a>
<a class="sourceLine" id="cb1082-184" data-line-number="184"><span class="co">#&gt; 4  0.0554 -0.06344 -0.0148</span></a>
<a class="sourceLine" id="cb1082-185" data-line-number="185"><span class="co">#&gt; 5 -0.0633  0.08324  0.0842</span></a>
<a class="sourceLine" id="cb1082-186" data-line-number="186"><span class="co">#&gt; 6  0.0515  0.02187  0.0790</span></a>
<a class="sourceLine" id="cb1082-187" data-line-number="187"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-188" data-line-number="188"><span class="co">#&gt; [200 rows x 200 columns]</span></a>
<a class="sourceLine" id="cb1082-189" data-line-number="189"><span class="kw">h2o.weights</span>(iris_dl, <span class="dt">matrix_id=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1082-190" data-line-number="190"><span class="co">#&gt;       C1     C2      C3     C4     C5      C6      C7    C8      C9    C10</span></a>
<a class="sourceLine" id="cb1082-191" data-line-number="191"><span class="co">#&gt; 1 -0.600 -0.034  0.0648  0.518  0.137  0.2003  0.3685 0.241 -0.1409 0.1230</span></a>
<a class="sourceLine" id="cb1082-192" data-line-number="192"><span class="co">#&gt; 2  0.434  0.121 -0.1345 -0.360 -0.469 -0.1170 -0.5432 0.670 -0.3621 0.5953</span></a>
<a class="sourceLine" id="cb1082-193" data-line-number="193"><span class="co">#&gt; 3 -0.390 -0.457  0.6642 -0.507 -0.393 -0.0759 -0.0357 0.236 -0.0787 0.0134</span></a>
<a class="sourceLine" id="cb1082-194" data-line-number="194"><span class="co">#&gt;      C11     C12    C13    C14     C15    C16   C17    C18    C19    C20    C21</span></a>
<a class="sourceLine" id="cb1082-195" data-line-number="195"><span class="co">#&gt; 1  0.135  0.0166 0.0547 -0.585 -0.1309  0.251 0.596  0.479  0.284 -0.232  0.415</span></a>
<a class="sourceLine" id="cb1082-196" data-line-number="196"><span class="co">#&gt; 2 -0.446 -0.2548 0.2520 -0.579 -0.2655  0.216 0.313 -0.399  0.442  0.622  0.514</span></a>
<a class="sourceLine" id="cb1082-197" data-line-number="197"><span class="co">#&gt; 3 -0.544  0.2491 0.5121 -0.106 -0.0109 -0.422 0.421  0.282 -0.190 -0.320 -0.589</span></a>
<a class="sourceLine" id="cb1082-198" data-line-number="198"><span class="co">#&gt;      C22    C23    C24    C25    C26    C27     C28     C29     C30    C31</span></a>
<a class="sourceLine" id="cb1082-199" data-line-number="199"><span class="co">#&gt; 1  0.352 -0.669  0.291 0.0416  0.046 -0.354  0.1140 -0.2854 -0.0985 -0.510</span></a>
<a class="sourceLine" id="cb1082-200" data-line-number="200"><span class="co">#&gt; 2 -0.389 -0.574 -0.338 0.6237 -0.456  0.497 -0.0339 -0.0538  0.4771  0.493</span></a>
<a class="sourceLine" id="cb1082-201" data-line-number="201"><span class="co">#&gt; 3 -0.198 -0.326 -0.106 0.3211 -0.582 -0.111  0.5719  0.6656  0.3636 -0.683</span></a>
<a class="sourceLine" id="cb1082-202" data-line-number="202"><span class="co">#&gt;       C32    C33    C34    C35    C36     C37    C38    C39     C40    C41</span></a>
<a class="sourceLine" id="cb1082-203" data-line-number="203"><span class="co">#&gt; 1 -0.5764 0.0976  0.293  0.278 -0.475  0.5719  0.681 -0.490  0.0105 -0.442</span></a>
<a class="sourceLine" id="cb1082-204" data-line-number="204"><span class="co">#&gt; 2 -0.0646 0.2823  0.637 -0.397 -0.265 -0.0489  0.400 -0.515 -0.3607  0.374</span></a>
<a class="sourceLine" id="cb1082-205" data-line-number="205"><span class="co">#&gt; 3  0.4944 0.3393 -0.566 -0.550  0.480  0.1938 -0.524 -0.659 -0.1355 -0.621</span></a>
<a class="sourceLine" id="cb1082-206" data-line-number="206"><span class="co">#&gt;       C42     C43    C44    C45    C46    C47     C48    C49    C50    C51</span></a>
<a class="sourceLine" id="cb1082-207" data-line-number="207"><span class="co">#&gt; 1 -0.6330  0.5466  0.492 0.4509 -0.202  0.612  0.0583  0.615 -0.029 -0.213</span></a>
<a class="sourceLine" id="cb1082-208" data-line-number="208"><span class="co">#&gt; 2  0.0197  0.0797  0.126 0.4147  0.194 -0.650  0.2747 -0.208 -0.407 -0.221</span></a>
<a class="sourceLine" id="cb1082-209" data-line-number="209"><span class="co">#&gt; 3  0.4438 -0.0380 -0.389 0.0871  0.285 -0.127 -0.5634  0.182 -0.441 -0.140</span></a>
<a class="sourceLine" id="cb1082-210" data-line-number="210"><span class="co">#&gt;      C52    C53     C54     C55   C56     C57     C58    C59    C60    C61</span></a>
<a class="sourceLine" id="cb1082-211" data-line-number="211"><span class="co">#&gt; 1 -0.600 -0.460  0.5427 -0.3430 0.315 -0.1174 -0.0588 -0.395 -0.513 -0.531</span></a>
<a class="sourceLine" id="cb1082-212" data-line-number="212"><span class="co">#&gt; 2 -0.130 -0.300 -0.2125  0.3765 0.170 -0.0142  0.2672 -0.543 -0.247 -0.320</span></a>
<a class="sourceLine" id="cb1082-213" data-line-number="213"><span class="co">#&gt; 3 -0.538  0.287 -0.0514 -0.0737 0.583 -0.3330 -0.5998 -0.583  0.325 -0.253</span></a>
<a class="sourceLine" id="cb1082-214" data-line-number="214"><span class="co">#&gt;      C62     C63     C64    C65    C66    C67   C68    C69   C70   C71    C72</span></a>
<a class="sourceLine" id="cb1082-215" data-line-number="215"><span class="co">#&gt; 1 -0.191  0.3235  0.4566 -0.333  0.575 0.3329 0.296 -0.600 0.591 0.437 -0.549</span></a>
<a class="sourceLine" id="cb1082-216" data-line-number="216"><span class="co">#&gt; 2 -0.677 -0.0967  0.5469  0.527  0.224 0.0949 0.630 -0.637 0.619 0.054  0.331</span></a>
<a class="sourceLine" id="cb1082-217" data-line-number="217"><span class="co">#&gt; 3  0.105 -0.5705 -0.0725 -0.268 -0.104 0.0777 0.109  0.085 0.293 0.584 -0.555</span></a>
<a class="sourceLine" id="cb1082-218" data-line-number="218"><span class="co">#&gt;       C73     C74    C75    C76    C77    C78    C79    C80    C81   C82    C83</span></a>
<a class="sourceLine" id="cb1082-219" data-line-number="219"><span class="co">#&gt; 1  0.6522 -0.3810 -0.600 -0.539  0.351 -0.287 -0.594  0.396 -0.430 0.328  0.353</span></a>
<a class="sourceLine" id="cb1082-220" data-line-number="220"><span class="co">#&gt; 2 -0.1306  0.5129 -0.497  0.483 -0.234 -0.473  0.152 -0.431 -0.307 0.363  0.206</span></a>
<a class="sourceLine" id="cb1082-221" data-line-number="221"><span class="co">#&gt; 3  0.0844 -0.0782 -0.306  0.280  0.649  0.665 -0.485  0.572 -0.559 0.240 -0.161</span></a>
<a class="sourceLine" id="cb1082-222" data-line-number="222"><span class="co">#&gt;         C84    C85     C86     C87    C88    C89    C90    C91    C92    C93</span></a>
<a class="sourceLine" id="cb1082-223" data-line-number="223"><span class="co">#&gt; 1  0.226810  0.282 -0.5522  0.2455 -0.407  0.452 -0.215  0.449 -0.106 -0.250</span></a>
<a class="sourceLine" id="cb1082-224" data-line-number="224"><span class="co">#&gt; 2 -0.000313 -0.355 -0.4411  0.2810  0.651 -0.372  0.254 -0.301  0.479  0.426</span></a>
<a class="sourceLine" id="cb1082-225" data-line-number="225"><span class="co">#&gt; 3  0.115621 -0.264 -0.0365 -0.0629  0.312 -0.273  0.164  0.251 -0.493  0.266</span></a>
<a class="sourceLine" id="cb1082-226" data-line-number="226"><span class="co">#&gt;     C94    C95    C96   C97     C98     C99   C100    C101    C102   C103</span></a>
<a class="sourceLine" id="cb1082-227" data-line-number="227"><span class="co">#&gt; 1 0.400  0.413  0.252 0.230 -0.5025 -0.1547 -0.446 -0.0758 -0.0717  0.334</span></a>
<a class="sourceLine" id="cb1082-228" data-line-number="228"><span class="co">#&gt; 2 0.384 -0.412  0.118 0.255 -0.1173 -0.0825  0.465  0.1318 -0.4162  0.613</span></a>
<a class="sourceLine" id="cb1082-229" data-line-number="229"><span class="co">#&gt; 3 0.024  0.504 -0.143 0.551 -0.0818  0.0203 -0.576 -0.4444  0.5721 -0.108</span></a>
<a class="sourceLine" id="cb1082-230" data-line-number="230"><span class="co">#&gt;     C104    C105    C106    C107    C108   C109    C110   C111    C112   C113</span></a>
<a class="sourceLine" id="cb1082-231" data-line-number="231"><span class="co">#&gt; 1 -0.284 -0.6307 -0.0368 -0.0389 -0.6355  0.594 -0.2257  0.555 -0.6732  0.470</span></a>
<a class="sourceLine" id="cb1082-232" data-line-number="232"><span class="co">#&gt; 2  0.432 -0.0855 -0.6143  0.6428  0.2378 -0.357  0.5485  0.523 -0.0368 -0.578</span></a>
<a class="sourceLine" id="cb1082-233" data-line-number="233"><span class="co">#&gt; 3  0.660 -0.4420  0.4393  0.4980 -0.0359  0.462 -0.0291 -0.358 -0.2280  0.221</span></a>
<a class="sourceLine" id="cb1082-234" data-line-number="234"><span class="co">#&gt;     C114    C115   C116    C117   C118   C119    C120   C121  C122    C123</span></a>
<a class="sourceLine" id="cb1082-235" data-line-number="235"><span class="co">#&gt; 1 -0.252  0.0362 -0.502 -0.0704 -0.484 0.0002 -0.0313 -0.613 0.302 -0.0131</span></a>
<a class="sourceLine" id="cb1082-236" data-line-number="236"><span class="co">#&gt; 2  0.493 -0.2665 -0.631  0.0762 -0.553 0.6201  0.2895  0.606 0.173 -0.3939</span></a>
<a class="sourceLine" id="cb1082-237" data-line-number="237"><span class="co">#&gt; 3 -0.471  0.1518 -0.218 -0.3191  0.251 0.1345 -0.6085 -0.153 0.109 -0.3652</span></a>
<a class="sourceLine" id="cb1082-238" data-line-number="238"><span class="co">#&gt;    C124   C125   C126   C127  C128   C129   C130   C131    C132    C133    C134</span></a>
<a class="sourceLine" id="cb1082-239" data-line-number="239"><span class="co">#&gt; 1 0.365 -0.671  0.471 -0.260 0.329 -0.126 -0.485 -0.186 -0.6058 -0.0641 -0.2790</span></a>
<a class="sourceLine" id="cb1082-240" data-line-number="240"><span class="co">#&gt; 2 0.443  0.596  0.485  0.293 0.503 -0.133  0.309 -0.673  0.0117  0.6763 -0.0673</span></a>
<a class="sourceLine" id="cb1082-241" data-line-number="241"><span class="co">#&gt; 3 0.509  0.557 -0.526  0.646 0.293  0.525 -0.673  0.393 -0.2555  0.1266 -0.4196</span></a>
<a class="sourceLine" id="cb1082-242" data-line-number="242"><span class="co">#&gt;     C135    C136   C137    C138   C139    C140    C141   C142   C143   C144</span></a>
<a class="sourceLine" id="cb1082-243" data-line-number="243"><span class="co">#&gt; 1 -0.405 -0.1379 -0.500 -0.1522 -0.140  0.0101 0.09004 -0.422  0.343  0.465</span></a>
<a class="sourceLine" id="cb1082-244" data-line-number="244"><span class="co">#&gt; 2  0.285 -0.4502  0.267  0.0704  0.489 -0.6379 0.39523 -0.334  0.186 -0.273</span></a>
<a class="sourceLine" id="cb1082-245" data-line-number="245"><span class="co">#&gt; 3  0.648  0.0613  0.419 -0.0347 -0.414 -0.0820 0.00975  0.261 -0.681 -0.169</span></a>
<a class="sourceLine" id="cb1082-246" data-line-number="246"><span class="co">#&gt;     C145    C146   C147    C148   C149   C150    C151   C152    C153   C154</span></a>
<a class="sourceLine" id="cb1082-247" data-line-number="247"><span class="co">#&gt; 1 -0.193 -0.1779 -0.221  0.5112 -0.378  0.607  0.2944 -0.544 -0.2129  0.333</span></a>
<a class="sourceLine" id="cb1082-248" data-line-number="248"><span class="co">#&gt; 2 -0.296 -0.1473  0.380  0.0468  0.267 -0.289 -0.5452 -0.324 -0.0456  0.594</span></a>
<a class="sourceLine" id="cb1082-249" data-line-number="249"><span class="co">#&gt; 3 -0.446 -0.0256 -0.657 -0.4119 -0.549  0.617  0.0981  0.428  0.3343 -0.529</span></a>
<a class="sourceLine" id="cb1082-250" data-line-number="250"><span class="co">#&gt;     C155   C156    C157     C158   C159   C160   C161   C162   C163   C164</span></a>
<a class="sourceLine" id="cb1082-251" data-line-number="251"><span class="co">#&gt; 1 0.3730 -0.255 -0.0904  0.33481 -0.459  0.208 -0.498  0.541  0.321  0.389</span></a>
<a class="sourceLine" id="cb1082-252" data-line-number="252"><span class="co">#&gt; 2 0.2748 -0.349  0.4207  0.00871 -0.363 -0.176 -0.594 -0.157  0.388 -0.024</span></a>
<a class="sourceLine" id="cb1082-253" data-line-number="253"><span class="co">#&gt; 3 0.0638 -0.246 -0.3141 -0.10845 -0.358 -0.354  0.202  0.672 -0.639  0.627</span></a>
<a class="sourceLine" id="cb1082-254" data-line-number="254"><span class="co">#&gt;     C165   C166  C167   C168    C169    C170  C171     C172     C173    C174</span></a>
<a class="sourceLine" id="cb1082-255" data-line-number="255"><span class="co">#&gt; 1  0.117 -0.228 0.503  0.457  0.2055  0.6260 0.687  0.16732  0.22204  0.1521</span></a>
<a class="sourceLine" id="cb1082-256" data-line-number="256"><span class="co">#&gt; 2  0.104 -0.566 0.471 -0.435  0.4983  0.0754 0.518 -0.54281  0.37667  0.0134</span></a>
<a class="sourceLine" id="cb1082-257" data-line-number="257"><span class="co">#&gt; 3 -0.142  0.597 0.489  0.040 -0.0596 -0.5953 0.186 -0.00423 -0.00865 -0.1778</span></a>
<a class="sourceLine" id="cb1082-258" data-line-number="258"><span class="co">#&gt;      C175   C176   C177   C178   C179   C180    C181   C182   C183    C184</span></a>
<a class="sourceLine" id="cb1082-259" data-line-number="259"><span class="co">#&gt; 1  0.1172  0.438 -0.227 -0.452  0.367 -0.693  0.5106  0.439 -0.580  0.0815</span></a>
<a class="sourceLine" id="cb1082-260" data-line-number="260"><span class="co">#&gt; 2  0.0544 -0.195 -0.231  0.131 -0.571 -0.637 -0.1254 -0.354  0.564 -0.1983</span></a>
<a class="sourceLine" id="cb1082-261" data-line-number="261"><span class="co">#&gt; 3 -0.2982 -0.584  0.309 -0.155 -0.274  0.640 -0.0663  0.424 -0.282  0.5671</span></a>
<a class="sourceLine" id="cb1082-262" data-line-number="262"><span class="co">#&gt;     C185   C186   C187   C188   C189    C190   C191   C192   C193   C194   C195</span></a>
<a class="sourceLine" id="cb1082-263" data-line-number="263"><span class="co">#&gt; 1 0.3890 -0.182  0.350  0.554  0.271 -0.4645  0.528 -0.246  0.656 -0.355 -0.594</span></a>
<a class="sourceLine" id="cb1082-264" data-line-number="264"><span class="co">#&gt; 2 0.6534 -0.232 -0.244 -0.545  0.110 -0.5231  0.291 -0.330 -0.120 -0.420 -0.664</span></a>
<a class="sourceLine" id="cb1082-265" data-line-number="265"><span class="co">#&gt; 3 0.0729  0.458 -0.249  0.463 -0.301  0.0937 -0.336  0.364  0.243  0.329  0.678</span></a>
<a class="sourceLine" id="cb1082-266" data-line-number="266"><span class="co">#&gt;    C196   C197   C198    C199   C200</span></a>
<a class="sourceLine" id="cb1082-267" data-line-number="267"><span class="co">#&gt; 1 0.151 -0.563 -0.399 -0.2783 0.3663</span></a>
<a class="sourceLine" id="cb1082-268" data-line-number="268"><span class="co">#&gt; 2 0.459 -0.343  0.378 -0.0525 0.2024</span></a>
<a class="sourceLine" id="cb1082-269" data-line-number="269"><span class="co">#&gt; 3 0.457  0.153 -0.024  0.3552 0.0864</span></a>
<a class="sourceLine" id="cb1082-270" data-line-number="270"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-271" data-line-number="271"><span class="co">#&gt; [3 rows x 200 columns]</span></a>
<a class="sourceLine" id="cb1082-272" data-line-number="272"><span class="kw">h2o.biases</span>(iris_dl,  <span class="dt">vector_id=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1082-273" data-line-number="273"><span class="co">#&gt;      C1</span></a>
<a class="sourceLine" id="cb1082-274" data-line-number="274"><span class="co">#&gt; 1 0.455</span></a>
<a class="sourceLine" id="cb1082-275" data-line-number="275"><span class="co">#&gt; 2 0.450</span></a>
<a class="sourceLine" id="cb1082-276" data-line-number="276"><span class="co">#&gt; 3 0.506</span></a>
<a class="sourceLine" id="cb1082-277" data-line-number="277"><span class="co">#&gt; 4 0.470</span></a>
<a class="sourceLine" id="cb1082-278" data-line-number="278"><span class="co">#&gt; 5 0.450</span></a>
<a class="sourceLine" id="cb1082-279" data-line-number="279"><span class="co">#&gt; 6 0.507</span></a>
<a class="sourceLine" id="cb1082-280" data-line-number="280"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-281" data-line-number="281"><span class="co">#&gt; [200 rows x 1 column]</span></a>
<a class="sourceLine" id="cb1082-282" data-line-number="282"><span class="kw">h2o.biases</span>(iris_dl,  <span class="dt">vector_id=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1082-283" data-line-number="283"><span class="co">#&gt;      C1</span></a>
<a class="sourceLine" id="cb1082-284" data-line-number="284"><span class="co">#&gt; 1 1.000</span></a>
<a class="sourceLine" id="cb1082-285" data-line-number="285"><span class="co">#&gt; 2 1.003</span></a>
<a class="sourceLine" id="cb1082-286" data-line-number="286"><span class="co">#&gt; 3 0.996</span></a>
<a class="sourceLine" id="cb1082-287" data-line-number="287"><span class="co">#&gt; 4 1.002</span></a>
<a class="sourceLine" id="cb1082-288" data-line-number="288"><span class="co">#&gt; 5 0.999</span></a>
<a class="sourceLine" id="cb1082-289" data-line-number="289"><span class="co">#&gt; 6 0.997</span></a>
<a class="sourceLine" id="cb1082-290" data-line-number="290"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-291" data-line-number="291"><span class="co">#&gt; [200 rows x 1 column]</span></a>
<a class="sourceLine" id="cb1082-292" data-line-number="292"><span class="kw">h2o.biases</span>(iris_dl,  <span class="dt">vector_id=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1082-293" data-line-number="293"><span class="co">#&gt;          C1</span></a>
<a class="sourceLine" id="cb1082-294" data-line-number="294"><span class="co">#&gt; 1 -0.000702</span></a>
<a class="sourceLine" id="cb1082-295" data-line-number="295"><span class="co">#&gt; 2  0.000292</span></a>
<a class="sourceLine" id="cb1082-296" data-line-number="296"><span class="co">#&gt; 3 -0.002267</span></a>
<a class="sourceLine" id="cb1082-297" data-line-number="297"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-298" data-line-number="298"><span class="co">#&gt; [3 rows x 1 column]</span></a>
<a class="sourceLine" id="cb1082-299" data-line-number="299"><span class="co">#plot weights connecting `Sepal.Length` to first hidden neurons</span></a>
<a class="sourceLine" id="cb1082-300" data-line-number="300"><span class="kw">plot</span>(<span class="kw">as.data.frame</span>(<span class="kw">h2o.weights</span>(iris_dl,  <span class="dt">matrix_id=</span><span class="dv">1</span>))[,<span class="dv">1</span>])</a></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/export_weight_biases-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="reproducibility" class="section level3">
<h3>
<span class="header-section-number">46.8.11</span> Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"><i class="fas fa-link"></i></a>
</h3>
<p>Every run of DeepLearning results in different results since multithreading is done via Hogwild! that benefits from intentional lock-free race conditions between threads. To get reproducible results for small datasets and testing purposes, set <code>reproducible=T</code> and set <code>seed=1337</code> (pick any integer). This will not work for big data for technical reasons, and is probably also not desired because of the significant slowdown (runs on 1 core only).</p>
</div>
<div id="scoring-on-trainingvalidation-sets-during-training" class="section level3">
<h3>
<span class="header-section-number">46.8.12</span> Scoring on Training/Validation Sets During Training<a class="anchor" aria-label="anchor" href="#scoring-on-trainingvalidation-sets-during-training"><i class="fas fa-link"></i></a>
</h3>
<p>The training and/or validation set errors can be based on a subset of the training or validation data, depending on the values for <code>score_validation_samples</code> (defaults to 0: all) or <code>score_training_samples</code> (defaults to 10,000 rows, since the training error is only used for early stopping and monitoring). For large datasets, Deep Learning can automatically sample the validation set to avoid spending too much time in scoring during training, especially since scoring results are not currently displayed in the model returned to R.</p>
<p>Note that the default value of <code>score_duty_cycle=0.1</code> limits the amount of time spent in scoring to 10%, so a large number of scoring samples won’t slow down overall training progress too much, but it will always score once after the first MapReduce iteration, and once at the end of training.</p>
<p>Stratified sampling of the validation dataset can help with scoring on datasets with class imbalance. Note that this option also requires <code>balance_classes</code> to be enabled (used to over/under-sample the training dataset, based on the max. relative size of the resulting training dataset, max_after_balance_size):</p>
<p>More information can be found in the H2O Deep Learning booklet, in our H2O SlideShare Presentations, our H2O YouTube channel, as well as on our H2O Github Repository, especially in our H2O Deep Learning R tests, and H2O Deep Learning Python tests.</p>
</div>
</div>
<div id="all-done-shutdown-h2o" class="section level2">
<h2>
<span class="header-section-number">46.9</span> All done, shutdown H2O<a class="anchor" aria-label="anchor" href="#all-done-shutdown-h2o"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb1083"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.shutdown.html">h2o.shutdown</a></span><span class="op">(</span>prompt<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">45</span> Tuning Hyperparameters in a Neural Network</a></div>
<div class="next"><a href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#deep-learning-tips-for-classification-and-regression"><span class="header-section-number">46</span> Deep Learning tips for Classification and Regression</a></li>
<li><a class="nav-link" href="#introduction-26"><span class="header-section-number">46.1</span> Introduction</a></li>
<li><a class="nav-link" href="#h2o-r-package"><span class="header-section-number">46.2</span> H2O R Package</a></li>
<li><a class="nav-link" href="#start-h2o"><span class="header-section-number">46.3</span> Start H2O</a></li>
<li><a class="nav-link" href="#lets-have-some-fun-first-decision-boundaries"><span class="header-section-number">46.4</span> Let’s have some fun first: Decision Boundaries</a></li>
<li>
<a class="nav-link" href="#cover-type-dataset"><span class="header-section-number">46.5</span> Cover Type Dataset</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#first-run-of-h2o-deep-learning"><span class="header-section-number">46.5.1</span> First Run of H2O Deep Learning</a></li>
<li><a class="nav-link" href="#variable-importances"><span class="header-section-number">46.5.2</span> Variable Importances</a></li>
<li><a class="nav-link" href="#early-stopping"><span class="header-section-number">46.5.3</span> Early Stopping</a></li>
<li><a class="nav-link" href="#adaptive-learning-rate"><span class="header-section-number">46.5.4</span> Adaptive Learning Rate</a></li>
<li><a class="nav-link" href="#tuning"><span class="header-section-number">46.5.5</span> Tuning</a></li>
<li><a class="nav-link" href="#hyper-parameter-tuning-with-grid-search"><span class="header-section-number">46.5.6</span> Hyper-parameter Tuning with Grid Search</a></li>
<li><a class="nav-link" href="#random-hyper-parameter-search"><span class="header-section-number">46.5.7</span> Random Hyper-Parameter Search</a></li>
<li><a class="nav-link" href="#checkpointing"><span class="header-section-number">46.5.8</span> Checkpointing</a></li>
<li><a class="nav-link" href="#cross-validation"><span class="header-section-number">46.5.9</span> Cross-Validation</a></li>
</ul>
</li>
<li><a class="nav-link" href="#regression-and-binary-classification"><span class="header-section-number">46.6</span> Regression and Binary Classification</a></li>
<li><a class="nav-link" href="#unsupervised-anomaly-detection"><span class="header-section-number">46.7</span> Unsupervised Anomaly detection</a></li>
<li>
<a class="nav-link" href="#h2o-deep-learning-tips-tricks"><span class="header-section-number">46.8</span> H2O Deep Learning Tips &amp; Tricks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#performance-tuning"><span class="header-section-number">46.8.1</span> Performance Tuning</a></li>
<li><a class="nav-link" href="#activation-functions"><span class="header-section-number">46.8.2</span> Activation Functions</a></li>
<li><a class="nav-link" href="#generalization-techniques"><span class="header-section-number">46.8.3</span> Generalization Techniques</a></li>
<li><a class="nav-link" href="#early-stopping-and-optimizing-for-lowest-validation-error"><span class="header-section-number">46.8.4</span> Early stopping and optimizing for lowest validation error</a></li>
<li><a class="nav-link" href="#training-samples-per-mapreduce-iteration"><span class="header-section-number">46.8.5</span> Training Samples per MapReduce Iteration</a></li>
<li><a class="nav-link" href="#categorical-data"><span class="header-section-number">46.8.6</span> Categorical Data</a></li>
<li><a class="nav-link" href="#sparse-data"><span class="header-section-number">46.8.7</span> Sparse Data</a></li>
<li><a class="nav-link" href="#missing-values"><span class="header-section-number">46.8.8</span> Missing Values</a></li>
<li><a class="nav-link" href="#loss-functions-distributions-offsets-observation-weights"><span class="header-section-number">46.8.9</span> Loss functions, Distributions, Offsets, Observation Weights</a></li>
<li><a class="nav-link" href="#exporting-weights-and-biases"><span class="header-section-number">46.8.10</span> Exporting Weights and Biases</a></li>
<li><a class="nav-link" href="#reproducibility"><span class="header-section-number">46.8.11</span> Reproducibility</a></li>
<li><a class="nav-link" href="#scoring-on-trainingvalidation-sets-during-training"><span class="header-section-number">46.8.12</span> Scoring on Training/Validation Sets During Training</a></li>
</ul>
</li>
<li><a class="nav-link" href="#all-done-shutdown-h2o"><span class="header-section-number">46.9</span> All done, shutdown H2O</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/f0nzie/machine_learning_compilation/blob/master/604-nn-comparison-deep_learning_tips.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/f0nzie/machine_learning_compilation/edit/master/604-nn-comparison-deep_learning_tips.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Machine Learning Compilation</strong>" was written by Several authors. Compiled by Alfonso R. Reyes. It was last built on 2020-11-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
