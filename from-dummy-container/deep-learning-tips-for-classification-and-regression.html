<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 46 Deep Learning tips for Classification and Regression | A Machine Learning Compilation</title>
<meta name="author" content="Several authors. Compiled by Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Machine Learning Compilation</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li class="book-part">The Basics of Machine Learning</li>
<li><a class="" href="introduction-to-pca.html"><span class="header-section-number">2</span> Introduction to PCA</a></li>
<li><a class="" href="comparison-of-two-pca-packages.html"><span class="header-section-number">3</span> Comparison of two PCA packages</a></li>
<li><a class="" href="detailed-study-of-principal-component-analysis.html"><span class="header-section-number">4</span> Detailed study of Principal Component Analysis</a></li>
<li><a class="" href="detection-of-diabetes-using-logistic-regression.html"><span class="header-section-number">5</span> Detection of diabetes using Logistic Regression</a></li>
<li><a class="" href="sensitivity-analysis-for-a-neural-network.html"><span class="header-section-number">6</span> Sensitivity analysis for a neural network</a></li>
<li><a class="" href="data-visualization-for-ml-models.html"><span class="header-section-number">7</span> Data Visualization for ML models</a></li>
<li class="book-part">Feature Engineering</li>
<li><a class="" href="ten-methods-to-assess-variable-importance.html"><span class="header-section-number">8</span> Ten methods to assess Variable Importance</a></li>
<li><a class="" href="employee-attrition-using-feature-importance.html"><span class="header-section-number">9</span> Employee Attrition using Feature Importance</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="a-gentle-introduction-to-support-vector-machines.html"><span class="header-section-number">10</span> A gentle introduction to Support Vector Machines</a></li>
<li><a class="" href="broad-view-of-svm.html"><span class="header-section-number">11</span> Broad view of SVM</a></li>
<li><a class="" href="feature-selection-to-enhance-cancer-detection.html"><span class="header-section-number">12</span> Feature Selection to enhance cancer detection</a></li>
<li><a class="" href="dealing-with-unbalanced-data.html"><span class="header-section-number">13</span> Dealing with unbalanced data</a></li>
<li><a class="" href="imputting-missing-values-with-random-forest.html"><span class="header-section-number">14</span> Imputting missing values with Random Forest</a></li>
<li><a class="" href="tuning-of-support-vector-machine-prediction.html"><span class="header-section-number">15</span> Tuning of Support Vector Machine prediction</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="introduction-to-algorithms-for-classification.html"><span class="header-section-number">16</span> Introduction to algorithms for Classification</a></li>
<li><a class="" href="comparing-classification-algorithms.html"><span class="header-section-number">17</span> Comparing Classification algorithms</a></li>
<li><a class="" href="who-buys-social-network-ads.html"><span class="header-section-number">18</span> Who buys Social Network ads</a></li>
<li><a class="" href="predicting-ozone-levels.html"><span class="header-section-number">19</span> Predicting Ozone levels</a></li>
<li><a class="" href="building-a-naive-bayes-classifier.html"><span class="header-section-number">20</span> Building a Naive Bayes Classifier</a></li>
<li><a class="" href="linear-and-non-linear-algorithms-for-classification.html"><span class="header-section-number">21</span> Linear and Non-Linear Algorithms for Classification</a></li>
<li><a class="" href="detect-mines-vs-rocks-with-random-forest.html"><span class="header-section-number">22</span> Detect mines vs rocks with Random Forest</a></li>
<li><a class="" href="predicting-the-type-of-glass.html"><span class="header-section-number">23</span> Predicting the type of glass</a></li>
<li><a class="" href="naive-bayes-for-sms-spam.html"><span class="header-section-number">24</span> Naive Bayes for SMS spam</a></li>
<li><a class="" href="vehicles-classiification-with-decision-trees.html"><span class="header-section-number">25</span> Vehicles classiification with Decision Trees</a></li>
<li><a class="" href="applying-naive-bayes-on-the-titanic-case.html"><span class="header-section-number">26</span> Applying Naive-Bayes on the Titanic case</a></li>
<li><a class="" href="classification-on-bad-loans.html"><span class="header-section-number">27</span> Classification on bad loans</a></li>
<li><a class="" href="predicting-flu-outcome-comparing-eight-classification-algorithms.html"><span class="header-section-number">28</span> Predicting Flu outcome comparing eight classification algorithms</a></li>
<li><a class="" href="a-detailed-study-of-bike-sharing-demand.html"><span class="header-section-number">29</span> A detailed study of bike sharing demand</a></li>
<li><a class="" href="prediction-of-arrhythmia-with-deep-neural-nets.html"><span class="header-section-number">30</span> Prediction of arrhythmia with deep neural nets</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression-with-islr.html"><span class="header-section-number">31</span> Linear Regression with ISLR</a></li>
<li><a class="" href="evaluation-of-three-linear-regression-models.html"><span class="header-section-number">32</span> Evaluation of three linear regression models</a></li>
<li><a class="" href="comparison-of-six-linear-regression-algorithms.html"><span class="header-section-number">33</span> Comparison of six Linear Regression algorithms</a></li>
<li><a class="" href="comparing-regression-models.html"><span class="header-section-number">34</span> Comparing regression models</a></li>
<li><a class="" href="finding-the-factors-of-happiness.html"><span class="header-section-number">35</span> Finding the factors of happiness</a></li>
<li><a class="" href="regression-with-a-neural-network.html"><span class="header-section-number">36</span> Regression with a neural network</a></li>
<li><a class="" href="comparing-multiple-regression-vs-a-neural-network.html"><span class="header-section-number">37</span> Comparing Multiple Regression vs a Neural Network</a></li>
<li><a class="" href="temperature-modeling-using-nested-dataframes.html"><span class="header-section-number">38</span> Temperature modeling using nested dataframes</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="credit-scoring-with-neuralnet.html"><span class="header-section-number">39</span> Credit Scoring with neuralnet</a></li>
<li><a class="" href="wine-classification-with-neuralnet.html"><span class="header-section-number">40</span> Wine classification with neuralnet</a></li>
<li><a class="" href="predicting-the-rating-of-cereals.html"><span class="header-section-number">41</span> Predicting the rating of cereals</a></li>
<li><a class="" href="fitting-a-linear-model-with-neural-networks.html"><span class="header-section-number">42</span> Fitting a linear model with neural networks</a></li>
<li><a class="" href="visualization-of-neural-networks.html"><span class="header-section-number">43</span> Visualization of neural networks</a></li>
<li><a class="" href="build-a-fully-connected-r-neural-network-from-scratch.html"><span class="header-section-number">44</span> Build a fully connected R neural network from scratch</a></li>
<li><a class="" href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">45</span> Tuning Hyperparameters in a Neural Network</a></li>
<li><a class="active" href="deep-learning-tips-for-classification-and-regression.html"><span class="header-section-number">46</span> Deep Learning tips for Classification and Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></li>
<li><a class="" href="q-q-normal-to-compare-data-to-distributions.html"><span class="header-section-number">B</span> Q-Q normal to compare data to distributions</a></li>
<li><a class="" href="qq-and-pp-plots.html"><span class="header-section-number">C</span> QQ and PP Plots</a></li>
<li><a class="" href="visualizing-residuals.html"><span class="header-section-number">D</span> Visualizing residuals</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hadley/r-pkgs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="deep-learning-tips-for-classification-and-regression" class="section level1">
<h1>
<span class="header-section-number">46</span> Deep Learning tips for Classification and Regression<a class="anchor" aria-label="anchor" href="#deep-learning-tips-for-classification-and-regression"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li>Datasets: <code>spiral.csv</code>, <code>grid.csv</code>, <code>covtype.full.csv</code>
</li>
<li>Algorithms:
<ul>
<li>Deep Learning with <code>h2o</code>
</li>
</ul>
</li>
<li>Techniques:
<ul>
<li>Decision Boundaries</li>
<li>Hyper-parameter Tuning with Grid Search</li>
<li>Checkpointing</li>
<li>Cross-Validation</li>
</ul>
</li>
</ul>
<div id="introduction-26" class="section level2">
<h2>
<span class="header-section-number">46.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-26"><i class="fas fa-link"></i></a>
</h2>
<p>Source: <a href="http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html" class="uri">http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html</a></p>
<p>Repo: <a href="https://github.com/h2oai/h2o-tutorials" class="uri">https://github.com/h2oai/h2o-tutorials</a></p>
<p>This tutorial shows how a H2O Deep Learning model can be used to do supervised classification and regression. A great tutorial about Deep Learning is given by Quoc Le here and here. This tutorial covers usage of H2O from R. A python version of this tutorial will be available as well in a separate document. This file is available in plain R, R markdown and regular markdown formats, and the plots are available as PDF files. All documents are available on Github.</p>
<p>If run from plain R, execute R in the directory of this script. If run from RStudio, be sure to setwd() to the location of this script.<code><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html">h2o.init()</a></code> starts H2O in R’s current working directory. <code><a href="https://rdrr.io/pkg/h2o/man/h2o.importFile.html">h2o.importFile()</a></code> looks for files from the perspective of where H2O was started.</p>
<p>More examples and explanations can be found in our H2O Deep Learning booklet and on our H2O Github Repository. The PDF slide deck can be found on Github.</p>
</div>
<div id="h2o-r-package" class="section level2">
<h2>
<span class="header-section-number">46.2</span> H2O R Package<a class="anchor" aria-label="anchor" href="#h2o-r-package"><i class="fas fa-link"></i></a>
</h2>
<p>Load the H2O R package:</p>
<p>Source: <a href="http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html" class="uri">http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html</a></p>
<div class="sourceCode" id="cb1051"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## R installation instructions are at http://h2o.ai/download</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/h2oai/h2o-3">h2o</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ----------------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Your next step is to start H2O:</span>
<span class="co">#&gt;     &gt; h2o.init()</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For H2O package documentation, ask for help:</span>
<span class="co">#&gt;     &gt; ??h2o</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; After starting H2O, you can use the Web UI at http://localhost:54321</span>
<span class="co">#&gt; For more information visit http://docs.h2o.ai</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ----------------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'h2o'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     cor, sd, var</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     &amp;&amp;, %*%, %in%, ||, apply, as.factor, as.numeric, colnames,</span>
<span class="co">#&gt;     colnames&lt;-, ifelse, is.character, is.factor, is.numeric, log,</span>
<span class="co">#&gt;     log10, log1p, log2, round, signif, trunc</span></code></pre></div>
</div>
<div id="start-h2o" class="section level2">
<h2>
<span class="header-section-number">46.3</span> Start H2O<a class="anchor" aria-label="anchor" href="#start-h2o"><i class="fas fa-link"></i></a>
</h2>
<p>Start up a 1-node H2O server on your local machine, and allow it to use all CPU cores and up to 2GB of memory:</p>
<div class="sourceCode" id="cb1052"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html">h2o.init</a></span><span class="op">(</span>nthreads<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, max_mem_size<span class="op">=</span><span class="st">"2G"</span><span class="op">)</span>
<span class="co">#&gt;  Connection successful!</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; R is connected to the H2O cluster: </span>
<span class="co">#&gt;     H2O cluster uptime:         37 minutes 21 seconds </span>
<span class="co">#&gt;     H2O cluster timezone:       Etc/UTC </span>
<span class="co">#&gt;     H2O data parsing timezone:  UTC </span>
<span class="co">#&gt;     H2O cluster version:        3.30.0.1 </span>
<span class="co">#&gt;     H2O cluster version age:    7 months and 15 days !!! </span>
<span class="co">#&gt;     H2O cluster name:           H2O_started_from_R_root_mwl453 </span>
<span class="co">#&gt;     H2O cluster total nodes:    1 </span>
<span class="co">#&gt;     H2O cluster total memory:   6.93 GB </span>
<span class="co">#&gt;     H2O cluster total cores:    8 </span>
<span class="co">#&gt;     H2O cluster allowed cores:  8 </span>
<span class="co">#&gt;     H2O cluster healthy:        TRUE </span>
<span class="co">#&gt;     H2O Connection ip:          localhost </span>
<span class="co">#&gt;     H2O Connection port:        54321 </span>
<span class="co">#&gt;     H2O Connection proxy:       NA </span>
<span class="co">#&gt;     H2O Internal Security:      FALSE </span>
<span class="co">#&gt;     H2O API Extensions:         Amazon S3, XGBoost, Algos, AutoML, Core V3, TargetEncoder, Core V4 </span>
<span class="co">#&gt;     R Version:                  R version 3.6.3 (2020-02-29)</span>
<span class="co">#&gt; Warning in h2o.clusterInfo(): </span>
<span class="co">#&gt; Your H2O cluster version is too old (7 months and 15 days)!</span>
<span class="co">#&gt; Please download and install the latest version from http://h2o.ai/download/</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.removeAll.html">h2o.removeAll</a></span><span class="op">(</span><span class="op">)</span> <span class="co">## clean slate - just in case the cluster was already running</span></code></pre></div>
<p>The <code>h2o.deeplearning</code> function fits H2O’s Deep Learning models from within R. We can run the example from the man page using the example function, or run a longer demonstration from the h2o package using the demo function::</p>
<div class="sourceCode" id="cb1053"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/args.html">args</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>
<span class="co">#&gt; function (x, y, training_frame, model_id = NULL, validation_frame = NULL, </span>
<span class="co">#&gt;     nfolds = 0, keep_cross_validation_models = TRUE, keep_cross_validation_predictions = FALSE, </span>
<span class="co">#&gt;     keep_cross_validation_fold_assignment = FALSE, fold_assignment = c("AUTO", </span>
<span class="co">#&gt;         "Random", "Modulo", "Stratified"), fold_column = NULL, </span>
<span class="co">#&gt;     ignore_const_cols = TRUE, score_each_iteration = FALSE, weights_column = NULL, </span>
<span class="co">#&gt;     offset_column = NULL, balance_classes = FALSE, class_sampling_factors = NULL, </span>
<span class="co">#&gt;     max_after_balance_size = 5, max_hit_ratio_k = 0, checkpoint = NULL, </span>
<span class="co">#&gt;     pretrained_autoencoder = NULL, overwrite_with_best_model = TRUE, </span>
<span class="co">#&gt;     use_all_factor_levels = TRUE, standardize = TRUE, activation = c("Tanh", </span>
<span class="co">#&gt;         "TanhWithDropout", "Rectifier", "RectifierWithDropout", </span>
<span class="co">#&gt;         "Maxout", "MaxoutWithDropout"), hidden = c(200, 200), </span>
<span class="co">#&gt;     epochs = 10, train_samples_per_iteration = -2, target_ratio_comm_to_comp = 0.05, </span>
<span class="co">#&gt;     seed = -1, adaptive_rate = TRUE, rho = 0.99, epsilon = 1e-08, </span>
<span class="co">#&gt;     rate = 0.005, rate_annealing = 1e-06, rate_decay = 1, momentum_start = 0, </span>
<span class="co">#&gt;     momentum_ramp = 1e+06, momentum_stable = 0, nesterov_accelerated_gradient = TRUE, </span>
<span class="co">#&gt;     input_dropout_ratio = 0, hidden_dropout_ratios = NULL, l1 = 0, </span>
<span class="co">#&gt;     l2 = 0, max_w2 = 3.4028235e+38, initial_weight_distribution = c("UniformAdaptive", </span>
<span class="co">#&gt;         "Uniform", "Normal"), initial_weight_scale = 1, initial_weights = NULL, </span>
<span class="co">#&gt;     initial_biases = NULL, loss = c("Automatic", "CrossEntropy", </span>
<span class="co">#&gt;         "Quadratic", "Huber", "Absolute", "Quantile"), distribution = c("AUTO", </span>
<span class="co">#&gt;         "bernoulli", "multinomial", "gaussian", "poisson", "gamma", </span>
<span class="co">#&gt;         "tweedie", "laplace", "quantile", "huber"), quantile_alpha = 0.5, </span>
<span class="co">#&gt;     tweedie_power = 1.5, huber_alpha = 0.9, score_interval = 5, </span>
<span class="co">#&gt;     score_training_samples = 10000, score_validation_samples = 0, </span>
<span class="co">#&gt;     score_duty_cycle = 0.1, classification_stop = 0, regression_stop = 1e-06, </span>
<span class="co">#&gt;     stopping_rounds = 5, stopping_metric = c("AUTO", "deviance", </span>
<span class="co">#&gt;         "logloss", "MSE", "RMSE", "MAE", "RMSLE", "AUC", "AUCPR", </span>
<span class="co">#&gt;         "lift_top_group", "misclassification", "mean_per_class_error", </span>
<span class="co">#&gt;         "custom", "custom_increasing"), stopping_tolerance = 0, </span>
<span class="co">#&gt;     max_runtime_secs = 0, score_validation_sampling = c("Uniform", </span>
<span class="co">#&gt;         "Stratified"), diagnostics = TRUE, fast_mode = TRUE, </span>
<span class="co">#&gt;     force_load_balance = TRUE, variable_importances = TRUE, replicate_training_data = TRUE, </span>
<span class="co">#&gt;     single_node_mode = FALSE, shuffle_training_data = FALSE, </span>
<span class="co">#&gt;     missing_values_handling = c("MeanImputation", "Skip"), quiet_mode = FALSE, </span>
<span class="co">#&gt;     autoencoder = FALSE, sparse = FALSE, col_major = FALSE, average_activation = 0, </span>
<span class="co">#&gt;     sparsity_beta = 0, max_categorical_features = 2147483647, </span>
<span class="co">#&gt;     reproducible = FALSE, export_weights_and_biases = FALSE, </span>
<span class="co">#&gt;     mini_batch_size = 1, categorical_encoding = c("AUTO", "Enum", </span>
<span class="co">#&gt;         "OneHotInternal", "OneHotExplicit", "Binary", "Eigen", </span>
<span class="co">#&gt;         "LabelEncoder", "SortByResponse", "EnumLimited"), elastic_averaging = FALSE, </span>
<span class="co">#&gt;     elastic_averaging_moving_rate = 0.9, elastic_averaging_regularization = 0.001, </span>
<span class="co">#&gt;     export_checkpoints_dir = NULL, verbose = FALSE) </span>
<span class="co">#&gt; NULL</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/example.html">example</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; h2.dpl&gt; ## Not run: </span>
<span class="co">#&gt; h2.dpl&gt; ##D library(h2o)</span>
<span class="co">#&gt; h2.dpl&gt; ##D h2o.init()</span>
<span class="co">#&gt; h2.dpl&gt; ##D iris_hf &lt;- as.h2o(iris)</span>
<span class="co">#&gt; h2.dpl&gt; ##D iris_dl &lt;- h2o.deeplearning(x = 1:4, y = 5, training_frame = iris_hf, seed=123456)</span>
<span class="co">#&gt; h2.dpl&gt; ##D </span>
<span class="co">#&gt; h2.dpl&gt; ##D # now make a prediction</span>
<span class="co">#&gt; h2.dpl&gt; ##D predictions &lt;- h2o.predict(iris_dl, iris_hf)</span>
<span class="co">#&gt; h2.dpl&gt; ## End(Not run)</span>
<span class="co">#&gt; h2.dpl&gt; </span>
<span class="co">#&gt; h2.dpl&gt; </span>
<span class="co">#&gt; h2.dpl&gt;</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/demo.html">demo</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>  <span class="co">#requires user interaction</span></code></pre></div>
<p>While <strong>H2O Deep Learning</strong> has many parameters, it was designed to be just as easy to use as the other supervised training methods in H2O. Early stopping, automatic data standardization and handling of categorical variables and missing values and adaptive learning rates (per weight) reduce the amount of parameters the user has to specify. Often, it’s just the number and sizes of hidden layers, the number of epochs and the activation function and maybe some regularization techniques.</p>
</div>
<div id="lets-have-some-fun-first-decision-boundaries" class="section level2">
<h2>
<span class="header-section-number">46.4</span> Let’s have some fun first: Decision Boundaries<a class="anchor" aria-label="anchor" href="#lets-have-some-fun-first-decision-boundaries"><i class="fas fa-link"></i></a>
</h2>
<p>We start with a small dataset representing red and black dots on a plane, arranged in the shape of two nested spirals. Then we task H2O’s machine learning methods to separate the red and black dots, i.e., recognize each spiral as such by assigning each point in the plane to one of the two spirals.</p>
<p>We visualize the nature of H2O Deep Learning (DL), H2O’s tree methods (GBM/DRF) and H2O’s generalized linear modeling (GLM) by plotting the decision boundary between the red and black spirals:</p>
<div class="sourceCode" id="cb1054"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1054-1" data-line-number="1"><span class="co"># setwd("~/h2o-tutorials/tutorials/deeplearning") ##For RStudio</span></a>
<a class="sourceLine" id="cb1054-2" data-line-number="2">spiral &lt;-<span class="st"> </span><span class="kw">h2o.importFile</span>(<span class="dt">path =</span> <span class="kw">normalizePath</span>(<span class="kw">file.path</span>(data_raw_dir, <span class="st">"spiral.csv"</span>)))</a>
<a class="sourceLine" id="cb1054-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1054-4" data-line-number="4">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1054-5" data-line-number="5"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1054-6" data-line-number="6">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1054-7" data-line-number="7"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1054-8" data-line-number="8">grid   &lt;-<span class="st"> </span><span class="kw">h2o.importFile</span>(<span class="dt">path =</span> <span class="kw">normalizePath</span>(<span class="kw">file.path</span>(data_raw_dir, <span class="st">"grid.csv"</span>)))</a>
<a class="sourceLine" id="cb1054-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1054-10" data-line-number="10">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1054-11" data-line-number="11"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1054-12" data-line-number="12">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1054-13" data-line-number="13"><span class="st">  </span><span class="er">|==================================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">94</span>%</a>
<a class="sourceLine" id="cb1054-14" data-line-number="14">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1054-15" data-line-number="15"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1054-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1054-17" data-line-number="17"><span class="co"># Define helper to plot contours</span></a>
<a class="sourceLine" id="cb1054-18" data-line-number="18">plotC &lt;-<span class="st"> </span><span class="cf">function</span>(name, model, <span class="dt">data=</span>spiral, <span class="dt">g=</span>grid) {</a>
<a class="sourceLine" id="cb1054-19" data-line-number="19">  data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(data) <span class="co">#get data from into R</span></a>
<a class="sourceLine" id="cb1054-20" data-line-number="20">  pred &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">h2o.predict</span>(model, g))</a>
<a class="sourceLine" id="cb1054-21" data-line-number="21">  n=<span class="fl">0.5</span><span class="op">*</span>(<span class="kw">sqrt</span>(<span class="kw">nrow</span>(g))<span class="op">-</span><span class="dv">1</span>); d &lt;-<span class="st"> </span><span class="fl">1.5</span>; h &lt;-<span class="st"> </span>d<span class="op">*</span>(<span class="op">-</span>n<span class="op">:</span>n)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb1054-22" data-line-number="22">  <span class="kw">plot</span>(data[,<span class="op">-</span><span class="dv">3</span>],<span class="dt">pch=</span><span class="dv">19</span>,<span class="dt">col=</span>data[,<span class="dv">3</span>],<span class="dt">cex=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb1054-23" data-line-number="23">       <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>d,d),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>d,d),<span class="dt">main=</span>name)</a>
<a class="sourceLine" id="cb1054-24" data-line-number="24">  <span class="kw">contour</span>(h,h,<span class="dt">z=</span><span class="kw">array</span>(<span class="kw">ifelse</span>(pred[,<span class="dv">1</span>]<span class="op">==</span><span class="st">"Red"</span>,<span class="dv">0</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1054-25" data-line-number="25">          <span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span>n<span class="op">+</span><span class="dv">1</span>,<span class="dv">2</span><span class="op">*</span>n<span class="op">+</span><span class="dv">1</span>)),<span class="dt">col=</span><span class="st">"blue"</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">add=</span>T)</a>
<a class="sourceLine" id="cb1054-26" data-line-number="26">}</a></code></pre></div>
<p>We build a few different models:</p>
<div class="sourceCode" id="cb1055"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>
<span class="fu">plotC</span><span class="op">(</span> <span class="st">"DL"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="fl">1e3</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="st">"GBM"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.gbm.html">h2o.gbm</a></span>         <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="st">"DRF"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.randomForest.html">h2o.randomForest</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="st">"GLM"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.glm.html">h2o.glm</a></span>         <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="604-nn-comparison-deep_learning_tips_files/figure-html/deeplearning_gbm_drf_glm-1.png" width="70%" style="display: block; margin: auto;">
Let’s investigate some more Deep Learning models. First, we explore the evolution over training time (number of passes over the data), and we use checkpointing to continue training the same model:</div>
<div class="sourceCode" id="cb1056"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>
<span class="va">ep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">250</span>,<span class="fl">500</span>,<span class="fl">750</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
                              model_id<span class="op">=</span><span class="st">"dl_1"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
            checkpoint<span class="op">=</span><span class="st">"dl_1"</span>,model_id<span class="op">=</span><span class="st">"dl_2"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,
            checkpoint<span class="op">=</span><span class="st">"dl_2"</span>,model_id<span class="op">=</span><span class="st">"dl_3"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,
            checkpoint<span class="op">=</span><span class="st">"dl_3"</span>,model_id<span class="op">=</span><span class="st">"dl_4"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/deeplearning_evolution_training_time-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>You can see how the network learns the structure of the spirals with enough training time. We explore different network architectures next:</p>
<div class="sourceCode" id="cb1057"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">hidden</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">13</span>,<span class="fl">17</span>,<span class="fl">19</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">42</span>,<span class="fl">42</span>,<span class="fl">42</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">200</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL hidden="</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">hidden</span>, collapse<span class="op">=</span><span class="st">"x"</span><span class="op">)</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span> ,<span class="va">spiral</span>, hidden<span class="op">=</span><span class="va">hidden</span>, epochs<span class="op">=</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/deeplearning_for_loop_hidden-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>It is clear that different configurations can achieve similar performance, and that tuning will be required for optimal performance. Next, we compare between different activation functions, including one with 50% dropout regularization in the hidden layers:</p>
<div class="sourceCode" id="cb1058"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">act</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tanh"</span>, <span class="st">"Maxout"</span>, <span class="st">"Rectifier"</span>, <span class="st">"RectifierWithDropout"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">act</span>,<span class="st">" activation"</span><span class="op">)</span>, 
        <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>, <span class="va">spiral</span>,
              activation <span class="op">=</span> <span class="va">act</span>, 
              hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>, 
              epochs <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/compare_activation_functions-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Clearly, the dropout rate was too high or the number of epochs was too low for the last configuration, which often ends up performing the best on larger datasets where generalization is important.</p>
<p>More information about the parameters can be found in the H2O Deep Learning booklet.</p>
</div>
<div id="cover-type-dataset" class="section level2">
<h2>
<span class="header-section-number">46.5</span> Cover Type Dataset<a class="anchor" aria-label="anchor" href="#cover-type-dataset"><i class="fas fa-link"></i></a>
</h2>
<p>We important the full cover type dataset (581k rows, 13 columns, 10 numerical, 3 categorical). We also split the data 3 ways: 60% for training, 20% for validation (hyper parameter tuning) and 20% for final testing.</p>
<div class="sourceCode" id="cb1059"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1059-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">h2o.importFile</span>(<span class="dt">path =</span> <span class="kw">normalizePath</span>(<span class="kw">file.path</span>(data_raw_dir, <span class="st">"covtype.full.csv"</span>)))</a>
<a class="sourceLine" id="cb1059-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1059-3" data-line-number="3">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1059-4" data-line-number="4"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1059-5" data-line-number="5">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1059-6" data-line-number="6"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1059-7" data-line-number="7"><span class="kw">dim</span>(df)</a>
<a class="sourceLine" id="cb1059-8" data-line-number="8"><span class="co">#&gt; [1] 581012     13</span></a>
<a class="sourceLine" id="cb1059-9" data-line-number="9">df</a>
<a class="sourceLine" id="cb1059-10" data-line-number="10"><span class="co">#&gt;   Elevation Aspect Slope Horizontal_Distance_To_Hydrology</span></a>
<a class="sourceLine" id="cb1059-11" data-line-number="11"><span class="co">#&gt; 1      3066    124     5                                0</span></a>
<a class="sourceLine" id="cb1059-12" data-line-number="12"><span class="co">#&gt; 2      3136     32    20                              450</span></a>
<a class="sourceLine" id="cb1059-13" data-line-number="13"><span class="co">#&gt; 3      2655     28    14                               42</span></a>
<a class="sourceLine" id="cb1059-14" data-line-number="14"><span class="co">#&gt; 4      3191     45    19                              323</span></a>
<a class="sourceLine" id="cb1059-15" data-line-number="15"><span class="co">#&gt; 5      3217     80    13                               30</span></a>
<a class="sourceLine" id="cb1059-16" data-line-number="16"><span class="co">#&gt; 6      3119    293    13                               30</span></a>
<a class="sourceLine" id="cb1059-17" data-line-number="17"><span class="co">#&gt;   Vertical_Distance_To_Hydrology Horizontal_Distance_To_Roadways Hillshade_9am</span></a>
<a class="sourceLine" id="cb1059-18" data-line-number="18"><span class="co">#&gt; 1                              0                            1533           229</span></a>
<a class="sourceLine" id="cb1059-19" data-line-number="19"><span class="co">#&gt; 2                            -38                            1290           211</span></a>
<a class="sourceLine" id="cb1059-20" data-line-number="20"><span class="co">#&gt; 3                              8                            1890           214</span></a>
<a class="sourceLine" id="cb1059-21" data-line-number="21"><span class="co">#&gt; 4                             88                            3932           221</span></a>
<a class="sourceLine" id="cb1059-22" data-line-number="22"><span class="co">#&gt; 5                              1                            3901           237</span></a>
<a class="sourceLine" id="cb1059-23" data-line-number="23"><span class="co">#&gt; 6                             10                            4810           182</span></a>
<a class="sourceLine" id="cb1059-24" data-line-number="24"><span class="co">#&gt;   Hillshade_Noon Hillshade_3pm Horizontal_Distance_To_Fire_Points</span></a>
<a class="sourceLine" id="cb1059-25" data-line-number="25"><span class="co">#&gt; 1            236           141                                459</span></a>
<a class="sourceLine" id="cb1059-26" data-line-number="26"><span class="co">#&gt; 2            193           111                               1112</span></a>
<a class="sourceLine" id="cb1059-27" data-line-number="27"><span class="co">#&gt; 3            209           128                               1001</span></a>
<a class="sourceLine" id="cb1059-28" data-line-number="28"><span class="co">#&gt; 4            195           100                               2919</span></a>
<a class="sourceLine" id="cb1059-29" data-line-number="29"><span class="co">#&gt; 5            217           109                               2859</span></a>
<a class="sourceLine" id="cb1059-30" data-line-number="30"><span class="co">#&gt; 6            237           194                               1200</span></a>
<a class="sourceLine" id="cb1059-31" data-line-number="31"><span class="co">#&gt;   Wilderness_Area Soil_Type Cover_Type</span></a>
<a class="sourceLine" id="cb1059-32" data-line-number="32"><span class="co">#&gt; 1          area_0   type_22    class_1</span></a>
<a class="sourceLine" id="cb1059-33" data-line-number="33"><span class="co">#&gt; 2          area_0   type_28    class_1</span></a>
<a class="sourceLine" id="cb1059-34" data-line-number="34"><span class="co">#&gt; 3          area_2    type_9    class_2</span></a>
<a class="sourceLine" id="cb1059-35" data-line-number="35"><span class="co">#&gt; 4          area_0   type_39    class_2</span></a>
<a class="sourceLine" id="cb1059-36" data-line-number="36"><span class="co">#&gt; 5          area_0   type_22    class_7</span></a>
<a class="sourceLine" id="cb1059-37" data-line-number="37"><span class="co">#&gt; 6          area_0   type_21    class_1</span></a>
<a class="sourceLine" id="cb1059-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1059-39" data-line-number="39"><span class="co">#&gt; [581012 rows x 13 columns]</span></a>
<a class="sourceLine" id="cb1059-40" data-line-number="40">splits &lt;-<span class="st"> </span><span class="kw">h2o.splitFrame</span>(df, <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>), <span class="dt">seed=</span><span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb1059-41" data-line-number="41">train  &lt;-<span class="st"> </span><span class="kw">h2o.assign</span>(splits[[<span class="dv">1</span>]], <span class="st">"train.hex"</span>) <span class="co"># 60%</span></a>
<a class="sourceLine" id="cb1059-42" data-line-number="42">valid  &lt;-<span class="st"> </span><span class="kw">h2o.assign</span>(splits[[<span class="dv">2</span>]], <span class="st">"valid.hex"</span>) <span class="co"># 20%</span></a>
<a class="sourceLine" id="cb1059-43" data-line-number="43">test   &lt;-<span class="st"> </span><span class="kw">h2o.assign</span>(splits[[<span class="dv">3</span>]], <span class="st">"test.hex"</span>)  <span class="co"># 20%</span></a></code></pre></div>
<p>Here’s a scalable way to do scatter plots via binning (works for categorical and numeric columns) to get more familiar with the dataset.</p>
<div class="sourceCode" id="cb1060"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># reset canvas</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Elevation"</span>,                       <span class="st">"Cover_Type"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Horizontal_Distance_To_Roadways"</span>, <span class="st">"Cover_Type"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Soil_Type"</span>,                       <span class="st">"Cover_Type"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Horizontal_Distance_To_Roadways"</span>, <span class="st">"Elevation"</span> <span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-1.png" width="70%" style="display: block; margin: auto;"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-2.png" width="70%" style="display: block; margin: auto;"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-3.png" width="70%" style="display: block; margin: auto;"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-4.png" width="70%" style="display: block; margin: auto;"></p>
<div id="first-run-of-h2o-deep-learning" class="section level3">
<h3>
<span class="header-section-number">46.5.1</span> First Run of H2O Deep Learning<a class="anchor" aria-label="anchor" href="#first-run-of-h2o-deep-learning"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s run our first Deep Learning model on the covtype dataset. We want to predict the <code>Cover_Type</code> column, a categorical feature with 7 levels, and the Deep Learning model will be tasked to perform (multi-class) classification. It uses the other 12 predictors of the dataset, of which 10 are numerical, and 2 are categorical with a total of 44 levels. We can expect the Deep Learning model to have 56 input neurons (after automatic one-hot encoding).</p>
<div class="sourceCode" id="cb1061"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">response</span> <span class="op">&lt;-</span> <span class="st">"Cover_Type"</span>
<span class="va">predictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/setops.html">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="va">response</span><span class="op">)</span>
<span class="va">predictors</span>
<span class="co">#&gt;  [1] "Elevation"                          "Aspect"                            </span>
<span class="co">#&gt;  [3] "Slope"                              "Horizontal_Distance_To_Hydrology"  </span>
<span class="co">#&gt;  [5] "Vertical_Distance_To_Hydrology"     "Horizontal_Distance_To_Roadways"   </span>
<span class="co">#&gt;  [7] "Hillshade_9am"                      "Hillshade_Noon"                    </span>
<span class="co">#&gt;  [9] "Hillshade_3pm"                      "Horizontal_Distance_To_Fire_Points"</span>
<span class="co">#&gt; [11] "Wilderness_Area"                    "Soil_Type"</span></code></pre></div>
<div class="sourceCode" id="cb1062"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">train_df</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    349015 obs. of  13 variables:</span>
<span class="co">#&gt;  $ Elevation                         : int  3136 3217 3119 2679 3261 2885 3227 2843 2853 2883 ...</span>
<span class="co">#&gt;  $ Aspect                            : int  32 80 293 48 322 26 32 12 124 177 ...</span>
<span class="co">#&gt;  $ Slope                             : int  20 13 13 7 13 9 6 18 12 9 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Hydrology  : int  450 30 30 150 30 192 108 335 30 426 ...</span>
<span class="co">#&gt;  $ Vertical_Distance_To_Hydrology    : int  -38 1 10 24 5 38 13 50 -5 126 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Roadways   : int  1290 3901 4810 1588 5701 3271 5542 2642 1485 2139 ...</span>
<span class="co">#&gt;  $ Hillshade_9am                     : int  211 237 182 223 186 216 219 199 240 225 ...</span>
<span class="co">#&gt;  $ Hillshade_Noon                    : int  193 217 237 224 226 220 227 201 231 246 ...</span>
<span class="co">#&gt;  $ Hillshade_3pm                     : int  111 109 194 136 180 140 145 135 119 153 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Fire_Points: int  1112 2859 1200 6265 769 2643 765 1719 2497 713 ...</span>
<span class="co">#&gt;  $ Wilderness_Area                   : Factor w/ 4 levels "area_0","area_1",..: 1 1 1 1 1 1 1 3 3 3 ...</span>
<span class="co">#&gt;  $ Soil_Type                         : Factor w/ 40 levels "type_0","type_1",..: 22 16 15 4 15 22 15 27 12 25 ...</span>
<span class="co">#&gt;  $ Cover_Type                        : Factor w/ 7 levels "class_1","class_2",..: 1 7 1 2 1 2 1 2 1 2 ...</span></code></pre></div>
<div class="sourceCode" id="cb1063"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">valid_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">valid</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">valid_df</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    116018 obs. of  13 variables:</span>
<span class="co">#&gt;  $ Elevation                         : int  3066 2655 2902 2994 2697 2990 3237 2884 2972 2696 ...</span>
<span class="co">#&gt;  $ Aspect                            : int  124 28 304 61 93 59 135 71 100 169 ...</span>
<span class="co">#&gt;  $ Slope                             : int  5 14 22 9 9 12 14 9 4 10 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Hydrology  : int  0 42 511 391 306 108 240 459 175 323 ...</span>
<span class="co">#&gt;  $ Vertical_Distance_To_Hydrology    : int  0 8 18 57 -2 10 -11 141 13 149 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Roadways   : int  1533 1890 1273 4286 553 2190 1189 1214 5031 2452 ...</span>
<span class="co">#&gt;  $ Hillshade_9am                     : int  229 214 155 227 234 229 241 231 227 228 ...</span>
<span class="co">#&gt;  $ Hillshade_Noon                    : int  236 209 223 222 227 215 233 222 234 244 ...</span>
<span class="co">#&gt;  $ Hillshade_3pm                     : int  141 128 206 128 125 117 118 124 142 148 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Fire_Points: int  459 1001 1347 1928 1716 1048 2748 1355 6198 1044 ...</span>
<span class="co">#&gt;  $ Wilderness_Area                   : Factor w/ 4 levels "area_0","area_1",..: 1 3 3 1 1 3 1 3 1 3 ...</span>
<span class="co">#&gt;  $ Soil_Type                         : Factor w/ 39 levels "type_0","type_1",..: 15 39 25 4 4 25 14 25 11 23 ...</span>
<span class="co">#&gt;  $ Cover_Type                        : Factor w/ 7 levels "class_1","class_2",..: 1 2 2 2 2 2 1 2 1 3 ...</span></code></pre></div>
<p>To keep it fast, we only run for one epoch (one pass over the training data).</p>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1064-1" data-line-number="1">m1 &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(</a>
<a class="sourceLine" id="cb1064-2" data-line-number="2">  <span class="dt">model_id=</span><span class="st">"dl_model_first"</span>, </a>
<a class="sourceLine" id="cb1064-3" data-line-number="3">  <span class="dt">training_frame =</span> train, </a>
<a class="sourceLine" id="cb1064-4" data-line-number="4">  <span class="dt">validation_frame =</span> valid,   <span class="co">## validation dataset: used for scoring and early stopping</span></a>
<a class="sourceLine" id="cb1064-5" data-line-number="5">  <span class="dt">x =</span> predictors,</a>
<a class="sourceLine" id="cb1064-6" data-line-number="6">  <span class="dt">y =</span> response,</a>
<a class="sourceLine" id="cb1064-7" data-line-number="7">  <span class="co">#activation="Rectifier",  ## default</span></a>
<a class="sourceLine" id="cb1064-8" data-line-number="8">  <span class="co">#hidden=c(200,200),       ## default: 2 hidden layers with 200 neurons each</span></a>
<a class="sourceLine" id="cb1064-9" data-line-number="9">  <span class="dt">epochs =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1064-10" data-line-number="10">  <span class="dt">variable_importances=</span>T    <span class="co">## not enabled by default</span></a>
<a class="sourceLine" id="cb1064-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb1064-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-13" data-line-number="13">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-14" data-line-number="14"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1064-15" data-line-number="15">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-16" data-line-number="16"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb1064-17" data-line-number="17">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-18" data-line-number="18"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb1064-19" data-line-number="19">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-20" data-line-number="20"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb1064-21" data-line-number="21">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-22" data-line-number="22"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb1064-23" data-line-number="23">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-24" data-line-number="24"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb1064-25" data-line-number="25">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-26" data-line-number="26"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb1064-27" data-line-number="27">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-28" data-line-number="28"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb1064-29" data-line-number="29">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-30" data-line-number="30"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb1064-31" data-line-number="31">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-32" data-line-number="32"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb1064-33" data-line-number="33">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1064-34" data-line-number="34"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1064-35" data-line-number="35"><span class="kw">summary</span>(m1)</a>
<a class="sourceLine" id="cb1064-36" data-line-number="36"><span class="co">#&gt; Model Details:</span></a>
<a class="sourceLine" id="cb1064-37" data-line-number="37"><span class="co">#&gt; ==============</span></a>
<a class="sourceLine" id="cb1064-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-39" data-line-number="39"><span class="co">#&gt; H2OMultinomialModel: deeplearning</span></a>
<a class="sourceLine" id="cb1064-40" data-line-number="40"><span class="co">#&gt; Model Key:  dl_model_first </span></a>
<a class="sourceLine" id="cb1064-41" data-line-number="41"><span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 53,007 weights/biases, 633.2 KB, 383,388 training samples, mini-batch size 1</span></a>
<a class="sourceLine" id="cb1064-42" data-line-number="42"><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></a>
<a class="sourceLine" id="cb1064-43" data-line-number="43"><span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span></a>
<a class="sourceLine" id="cb1064-44" data-line-number="44"><span class="co">#&gt; 2     2   200 Rectifier  0.00 % 0.000000 0.000000  0.052658 0.215717 0.000000</span></a>
<a class="sourceLine" id="cb1064-45" data-line-number="45"><span class="co">#&gt; 3     3   200 Rectifier  0.00 % 0.000000 0.000000  0.009425 0.008603 0.000000</span></a>
<a class="sourceLine" id="cb1064-46" data-line-number="46"><span class="co">#&gt; 4     4     7   Softmax      NA 0.000000 0.000000  0.122534 0.296567 0.000000</span></a>
<a class="sourceLine" id="cb1064-47" data-line-number="47"><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></a>
<a class="sourceLine" id="cb1064-48" data-line-number="48"><span class="co">#&gt; 1          NA         NA        NA       NA</span></a>
<a class="sourceLine" id="cb1064-49" data-line-number="49"><span class="co">#&gt; 2   -0.010819   0.120404  0.041893 0.130165</span></a>
<a class="sourceLine" id="cb1064-50" data-line-number="50"><span class="co">#&gt; 3   -0.027807   0.118948  0.714695 0.371489</span></a>
<a class="sourceLine" id="cb1064-51" data-line-number="51"><span class="co">#&gt; 4   -0.370677   0.507791 -0.584955 0.182773</span></a>
<a class="sourceLine" id="cb1064-52" data-line-number="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-53" data-line-number="53"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1064-54" data-line-number="54"><span class="co">#&gt; ** Reported on training data. **</span></a>
<a class="sourceLine" id="cb1064-55" data-line-number="55"><span class="co">#&gt; ** Metrics reported on temporary training frame with 9977 samples **</span></a>
<a class="sourceLine" id="cb1064-56" data-line-number="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-57" data-line-number="57"><span class="co">#&gt; Training Set Metrics: </span></a>
<a class="sourceLine" id="cb1064-58" data-line-number="58"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1064-59" data-line-number="59"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-60" data-line-number="60"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.134</span></a>
<a class="sourceLine" id="cb1064-61" data-line-number="61"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.366</span></a>
<a class="sourceLine" id="cb1064-62" data-line-number="62"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.428</span></a>
<a class="sourceLine" id="cb1064-63" data-line-number="63"><span class="co">#&gt; Mean Per-Class Error: 0.333</span></a>
<a class="sourceLine" id="cb1064-64" data-line-number="64"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span></a>
<a class="sourceLine" id="cb1064-65" data-line-number="65"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1064-66" data-line-number="66"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1064-67" data-line-number="67"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1064-68" data-line-number="68"><span class="co">#&gt; class_1    2774     831       1       0       3       5      36 0.2400</span></a>
<a class="sourceLine" id="cb1064-69" data-line-number="69"><span class="co">#&gt; class_2     350    4415      28       0      15      68       6 0.0957</span></a>
<a class="sourceLine" id="cb1064-70" data-line-number="70"><span class="co">#&gt; class_3       2      31     470       6       2      97       0 0.2270</span></a>
<a class="sourceLine" id="cb1064-71" data-line-number="71"><span class="co">#&gt; class_4       0       0      21      23       0       6       0 0.5400</span></a>
<a class="sourceLine" id="cb1064-72" data-line-number="72"><span class="co">#&gt; class_5      12      69       3       0      52       6       0 0.6338</span></a>
<a class="sourceLine" id="cb1064-73" data-line-number="73"><span class="co">#&gt; class_6       0      22      95       0       0     172       0 0.4048</span></a>
<a class="sourceLine" id="cb1064-74" data-line-number="74"><span class="co">#&gt; class_7      62       6       0       0       0       0     288 0.1910</span></a>
<a class="sourceLine" id="cb1064-75" data-line-number="75"><span class="co">#&gt; Totals     3200    5374     618      29      72     354     330 0.1787</span></a>
<a class="sourceLine" id="cb1064-76" data-line-number="76"><span class="co">#&gt;                    Rate</span></a>
<a class="sourceLine" id="cb1064-77" data-line-number="77"><span class="co">#&gt; class_1 =   876 / 3,650</span></a>
<a class="sourceLine" id="cb1064-78" data-line-number="78"><span class="co">#&gt; class_2 =   467 / 4,882</span></a>
<a class="sourceLine" id="cb1064-79" data-line-number="79"><span class="co">#&gt; class_3 =     138 / 608</span></a>
<a class="sourceLine" id="cb1064-80" data-line-number="80"><span class="co">#&gt; class_4 =       27 / 50</span></a>
<a class="sourceLine" id="cb1064-81" data-line-number="81"><span class="co">#&gt; class_5 =      90 / 142</span></a>
<a class="sourceLine" id="cb1064-82" data-line-number="82"><span class="co">#&gt; class_6 =     117 / 289</span></a>
<a class="sourceLine" id="cb1064-83" data-line-number="83"><span class="co">#&gt; class_7 =      68 / 356</span></a>
<a class="sourceLine" id="cb1064-84" data-line-number="84"><span class="co">#&gt; Totals  = 1,783 / 9,977</span></a>
<a class="sourceLine" id="cb1064-85" data-line-number="85"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-86" data-line-number="86"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span></a>
<a class="sourceLine" id="cb1064-87" data-line-number="87"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1064-88" data-line-number="88"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1064-89" data-line-number="89"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1064-90" data-line-number="90"><span class="co">#&gt; 1 1  0.821289</span></a>
<a class="sourceLine" id="cb1064-91" data-line-number="91"><span class="co">#&gt; 2 2  0.984464</span></a>
<a class="sourceLine" id="cb1064-92" data-line-number="92"><span class="co">#&gt; 3 3  0.997895</span></a>
<a class="sourceLine" id="cb1064-93" data-line-number="93"><span class="co">#&gt; 4 4  0.999599</span></a>
<a class="sourceLine" id="cb1064-94" data-line-number="94"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1064-95" data-line-number="95"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1064-96" data-line-number="96"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1064-97" data-line-number="97"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-98" data-line-number="98"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-99" data-line-number="99"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1064-100" data-line-number="100"><span class="co">#&gt; ** Reported on validation data. **</span></a>
<a class="sourceLine" id="cb1064-101" data-line-number="101"><span class="co">#&gt; ** Metrics reported on full validation frame **</span></a>
<a class="sourceLine" id="cb1064-102" data-line-number="102"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-103" data-line-number="103"><span class="co">#&gt; Validation Set Metrics: </span></a>
<a class="sourceLine" id="cb1064-104" data-line-number="104"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1064-105" data-line-number="105"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-106" data-line-number="106"><span class="co">#&gt; Extract validation frame with `h2o.getFrame("valid.hex")`</span></a>
<a class="sourceLine" id="cb1064-107" data-line-number="107"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.135</span></a>
<a class="sourceLine" id="cb1064-108" data-line-number="108"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.368</span></a>
<a class="sourceLine" id="cb1064-109" data-line-number="109"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.435</span></a>
<a class="sourceLine" id="cb1064-110" data-line-number="110"><span class="co">#&gt; Mean Per-Class Error: 0.322</span></a>
<a class="sourceLine" id="cb1064-111" data-line-number="111"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span></a>
<a class="sourceLine" id="cb1064-112" data-line-number="112"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1064-113" data-line-number="113"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1064-114" data-line-number="114"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1064-115" data-line-number="115"><span class="co">#&gt; class_1   32164    9801       0       0      12      50     473 0.2432</span></a>
<a class="sourceLine" id="cb1064-116" data-line-number="116"><span class="co">#&gt; class_2    4212   50677     413       2     202     816      58 0.1012</span></a>
<a class="sourceLine" id="cb1064-117" data-line-number="117"><span class="co">#&gt; class_3       0     433    5521      36       8    1145       0 0.2271</span></a>
<a class="sourceLine" id="cb1064-118" data-line-number="118"><span class="co">#&gt; class_4       0       0     233     262       0      67       0 0.5338</span></a>
<a class="sourceLine" id="cb1064-119" data-line-number="119"><span class="co">#&gt; class_5     147     959      65       0     652      47       0 0.6513</span></a>
<a class="sourceLine" id="cb1064-120" data-line-number="120"><span class="co">#&gt; class_6      10     283     793      10       0    2368       0 0.3164</span></a>
<a class="sourceLine" id="cb1064-121" data-line-number="121"><span class="co">#&gt; class_7     701      40       0       0       0       0    3358 0.1808</span></a>
<a class="sourceLine" id="cb1064-122" data-line-number="122"><span class="co">#&gt; Totals    37234   62193    7025     310     874    4493    3889 0.1811</span></a>
<a class="sourceLine" id="cb1064-123" data-line-number="123"><span class="co">#&gt;                       Rate</span></a>
<a class="sourceLine" id="cb1064-124" data-line-number="124"><span class="co">#&gt; class_1 =  10,336 / 42,500</span></a>
<a class="sourceLine" id="cb1064-125" data-line-number="125"><span class="co">#&gt; class_2 =   5,703 / 56,380</span></a>
<a class="sourceLine" id="cb1064-126" data-line-number="126"><span class="co">#&gt; class_3 =    1,622 / 7,143</span></a>
<a class="sourceLine" id="cb1064-127" data-line-number="127"><span class="co">#&gt; class_4 =        300 / 562</span></a>
<a class="sourceLine" id="cb1064-128" data-line-number="128"><span class="co">#&gt; class_5 =    1,218 / 1,870</span></a>
<a class="sourceLine" id="cb1064-129" data-line-number="129"><span class="co">#&gt; class_6 =    1,096 / 3,464</span></a>
<a class="sourceLine" id="cb1064-130" data-line-number="130"><span class="co">#&gt; class_7 =      741 / 4,099</span></a>
<a class="sourceLine" id="cb1064-131" data-line-number="131"><span class="co">#&gt; Totals  = 21,016 / 116,018</span></a>
<a class="sourceLine" id="cb1064-132" data-line-number="132"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-133" data-line-number="133"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span></a>
<a class="sourceLine" id="cb1064-134" data-line-number="134"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1064-135" data-line-number="135"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1064-136" data-line-number="136"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1064-137" data-line-number="137"><span class="co">#&gt; 1 1  0.818856</span></a>
<a class="sourceLine" id="cb1064-138" data-line-number="138"><span class="co">#&gt; 2 2  0.983675</span></a>
<a class="sourceLine" id="cb1064-139" data-line-number="139"><span class="co">#&gt; 3 3  0.997828</span></a>
<a class="sourceLine" id="cb1064-140" data-line-number="140"><span class="co">#&gt; 4 4  0.999690</span></a>
<a class="sourceLine" id="cb1064-141" data-line-number="141"><span class="co">#&gt; 5 5  0.999991</span></a>
<a class="sourceLine" id="cb1064-142" data-line-number="142"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1064-143" data-line-number="143"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1064-144" data-line-number="144"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-145" data-line-number="145"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-146" data-line-number="146"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-147" data-line-number="147"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-148" data-line-number="148"><span class="co">#&gt; Scoring History: </span></a>
<a class="sourceLine" id="cb1064-149" data-line-number="149"><span class="co">#&gt;             timestamp   duration training_speed  epochs iterations</span></a>
<a class="sourceLine" id="cb1064-150" data-line-number="150"><span class="co">#&gt; 1 2020-11-19 17:01:09  0.000 sec             NA 0.00000          0</span></a>
<a class="sourceLine" id="cb1064-151" data-line-number="151"><span class="co">#&gt; 2 2020-11-19 17:01:13  6.368 sec   7555 obs/sec 0.09965          1</span></a>
<a class="sourceLine" id="cb1064-152" data-line-number="152"><span class="co">#&gt; 3 2020-11-19 17:01:32 25.382 sec  11101 obs/sec 0.69840          7</span></a>
<a class="sourceLine" id="cb1064-153" data-line-number="153"><span class="co">#&gt; 4 2020-11-19 17:01:46 39.543 sec  11201 obs/sec 1.09849         11</span></a>
<a class="sourceLine" id="cb1064-154" data-line-number="154"><span class="co">#&gt;         samples training_rmse training_logloss training_r2</span></a>
<a class="sourceLine" id="cb1064-155" data-line-number="155"><span class="co">#&gt; 1      0.000000            NA               NA          NA</span></a>
<a class="sourceLine" id="cb1064-156" data-line-number="156"><span class="co">#&gt; 2  34780.000000       0.44480          0.63300     0.89742</span></a>
<a class="sourceLine" id="cb1064-157" data-line-number="157"><span class="co">#&gt; 3 243753.000000       0.38543          0.46697     0.92298</span></a>
<a class="sourceLine" id="cb1064-158" data-line-number="158"><span class="co">#&gt; 4 383388.000000       0.36554          0.42776     0.93072</span></a>
<a class="sourceLine" id="cb1064-159" data-line-number="159"><span class="co">#&gt;   training_classification_error validation_rmse validation_logloss</span></a>
<a class="sourceLine" id="cb1064-160" data-line-number="160"><span class="co">#&gt; 1                            NA              NA                 NA</span></a>
<a class="sourceLine" id="cb1064-161" data-line-number="161"><span class="co">#&gt; 2                       0.26411         0.44867            0.64680</span></a>
<a class="sourceLine" id="cb1064-162" data-line-number="162"><span class="co">#&gt; 3                       0.20267         0.38507            0.46877</span></a>
<a class="sourceLine" id="cb1064-163" data-line-number="163"><span class="co">#&gt; 4                       0.17871         0.36755            0.43488</span></a>
<a class="sourceLine" id="cb1064-164" data-line-number="164"><span class="co">#&gt;   validation_r2 validation_classification_error</span></a>
<a class="sourceLine" id="cb1064-165" data-line-number="165"><span class="co">#&gt; 1            NA                              NA</span></a>
<a class="sourceLine" id="cb1064-166" data-line-number="166"><span class="co">#&gt; 2       0.89681                         0.26592</span></a>
<a class="sourceLine" id="cb1064-167" data-line-number="167"><span class="co">#&gt; 3       0.92399                         0.19963</span></a>
<a class="sourceLine" id="cb1064-168" data-line-number="168"><span class="co">#&gt; 4       0.93075                         0.18114</span></a>
<a class="sourceLine" id="cb1064-169" data-line-number="169"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-170" data-line-number="170"><span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span></a>
<a class="sourceLine" id="cb1064-171" data-line-number="171"><span class="co">#&gt; =================================================</span></a>
<a class="sourceLine" id="cb1064-172" data-line-number="172"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-173" data-line-number="173"><span class="co">#&gt; Variable Importances: </span></a>
<a class="sourceLine" id="cb1064-174" data-line-number="174"><span class="co">#&gt;                             variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1064-175" data-line-number="175"><span class="co">#&gt; 1             Wilderness_Area.area_0            1.000000          1.000000</span></a>
<a class="sourceLine" id="cb1064-176" data-line-number="176"><span class="co">#&gt; 2    Horizontal_Distance_To_Roadways            0.940270          0.940270</span></a>
<a class="sourceLine" id="cb1064-177" data-line-number="177"><span class="co">#&gt; 3                          Elevation            0.897750          0.897750</span></a>
<a class="sourceLine" id="cb1064-178" data-line-number="178"><span class="co">#&gt; 4 Horizontal_Distance_To_Fire_Points            0.835260          0.835260</span></a>
<a class="sourceLine" id="cb1064-179" data-line-number="179"><span class="co">#&gt; 5             Wilderness_Area.area_2            0.754339          0.754339</span></a>
<a class="sourceLine" id="cb1064-180" data-line-number="180"><span class="co">#&gt;   percentage</span></a>
<a class="sourceLine" id="cb1064-181" data-line-number="181"><span class="co">#&gt; 1   0.033535</span></a>
<a class="sourceLine" id="cb1064-182" data-line-number="182"><span class="co">#&gt; 2   0.031532</span></a>
<a class="sourceLine" id="cb1064-183" data-line-number="183"><span class="co">#&gt; 3   0.030106</span></a>
<a class="sourceLine" id="cb1064-184" data-line-number="184"><span class="co">#&gt; 4   0.028010</span></a>
<a class="sourceLine" id="cb1064-185" data-line-number="185"><span class="co">#&gt; 5   0.025297</span></a>
<a class="sourceLine" id="cb1064-186" data-line-number="186"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1064-187" data-line-number="187"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1064-188" data-line-number="188"><span class="co">#&gt;                       variable relative_importance scaled_importance percentage</span></a>
<a class="sourceLine" id="cb1064-189" data-line-number="189"><span class="co">#&gt; 51               Hillshade_9am            0.411591          0.411591   0.013803</span></a>
<a class="sourceLine" id="cb1064-190" data-line-number="190"><span class="co">#&gt; 52                       Slope            0.397292          0.397292   0.013323</span></a>
<a class="sourceLine" id="cb1064-191" data-line-number="191"><span class="co">#&gt; 53               Hillshade_3pm            0.384723          0.384723   0.012902</span></a>
<a class="sourceLine" id="cb1064-192" data-line-number="192"><span class="co">#&gt; 54                      Aspect            0.266706          0.266706   0.008944</span></a>
<a class="sourceLine" id="cb1064-193" data-line-number="193"><span class="co">#&gt; 55       Soil_Type.missing(NA)            0.000000          0.000000   0.000000</span></a>
<a class="sourceLine" id="cb1064-194" data-line-number="194"><span class="co">#&gt; 56 Wilderness_Area.missing(NA)            0.000000          0.000000   0.000000</span></a></code></pre></div>
<p>Inspect the model in Flow for more information about model building etc. by issuing a cell with the content getModel “dl_model_first”, and pressing Ctrl-Enter.</p>
</div>
<div id="variable-importances" class="section level3">
<h3>
<span class="header-section-number">46.5.2</span> Variable Importances<a class="anchor" aria-label="anchor" href="#variable-importances"><i class="fas fa-link"></i></a>
</h3>
<p>Variable importances for Neural Network models are notoriously difficult to compute, and there are many pitfalls. H2O Deep Learning has implemented the method of Gedeon, and returns relative variable importances in descending order of importance.</p>
<div class="sourceCode" id="cb1065"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.varimp.html">h2o.varimp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                             variable relative_importance scaled_importance</span>
<span class="co">#&gt; 1             Wilderness_Area.area_0               1.000             1.000</span>
<span class="co">#&gt; 2    Horizontal_Distance_To_Roadways               0.940             0.940</span>
<span class="co">#&gt; 3                          Elevation               0.898             0.898</span>
<span class="co">#&gt; 4 Horizontal_Distance_To_Fire_Points               0.835             0.835</span>
<span class="co">#&gt; 5             Wilderness_Area.area_2               0.754             0.754</span>
<span class="co">#&gt; 6             Wilderness_Area.area_1               0.754             0.754</span>
<span class="co">#&gt;   percentage</span>
<span class="co">#&gt; 1     0.0335</span>
<span class="co">#&gt; 2     0.0315</span>
<span class="co">#&gt; 3     0.0301</span>
<span class="co">#&gt; 4     0.0280</span>
<span class="co">#&gt; 5     0.0253</span>
<span class="co">#&gt; 6     0.0253</span></code></pre></div>
</div>
<div id="early-stopping" class="section level3">
<h3>
<span class="header-section-number">46.5.3</span> Early Stopping<a class="anchor" aria-label="anchor" href="#early-stopping"><i class="fas fa-link"></i></a>
</h3>
<p>Now we run another, smaller network, and we let it stop automatically once the misclassification rate converges (specifically, if the moving average of length 2 does not improve by at least 1% for 2 consecutive scoring events). We also sample the validation set to 10,000 rows for faster scoring.</p>
<div class="sourceCode" id="cb1066"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1066-1" data-line-number="1">m2 &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(</a>
<a class="sourceLine" id="cb1066-2" data-line-number="2">  <span class="dt">model_id=</span><span class="st">"dl_model_faster"</span>, </a>
<a class="sourceLine" id="cb1066-3" data-line-number="3">  <span class="dt">training_frame=</span>train, </a>
<a class="sourceLine" id="cb1066-4" data-line-number="4">  <span class="dt">validation_frame=</span>valid,</a>
<a class="sourceLine" id="cb1066-5" data-line-number="5">  <span class="dt">x=</span>predictors,</a>
<a class="sourceLine" id="cb1066-6" data-line-number="6">  <span class="dt">y=</span>response,</a>
<a class="sourceLine" id="cb1066-7" data-line-number="7">  <span class="dt">hidden=</span><span class="kw">c</span>(<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">32</span>),                  <span class="co">## small network, runs faster</span></a>
<a class="sourceLine" id="cb1066-8" data-line-number="8">  <span class="dt">epochs=</span><span class="dv">1000000</span>,                      <span class="co">## hopefully converges earlier...</span></a>
<a class="sourceLine" id="cb1066-9" data-line-number="9">  <span class="dt">score_validation_samples=</span><span class="dv">10000</span>,      <span class="co">## sample the validation dataset (faster)</span></a>
<a class="sourceLine" id="cb1066-10" data-line-number="10">  <span class="dt">stopping_rounds=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1066-11" data-line-number="11">  <span class="dt">stopping_metric=</span><span class="st">"misclassification"</span>, <span class="co">## could be "MSE","logloss","r2"</span></a>
<a class="sourceLine" id="cb1066-12" data-line-number="12">  <span class="dt">stopping_tolerance=</span><span class="fl">0.01</span></a>
<a class="sourceLine" id="cb1066-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb1066-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-15" data-line-number="15">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1066-16" data-line-number="16"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1066-17" data-line-number="17">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1066-18" data-line-number="18"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1066-19" data-line-number="19"><span class="kw">summary</span>(m2)</a>
<a class="sourceLine" id="cb1066-20" data-line-number="20"><span class="co">#&gt; Model Details:</span></a>
<a class="sourceLine" id="cb1066-21" data-line-number="21"><span class="co">#&gt; ==============</span></a>
<a class="sourceLine" id="cb1066-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-23" data-line-number="23"><span class="co">#&gt; H2OMultinomialModel: deeplearning</span></a>
<a class="sourceLine" id="cb1066-24" data-line-number="24"><span class="co">#&gt; Model Key:  dl_model_faster </span></a>
<a class="sourceLine" id="cb1066-25" data-line-number="25"><span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 4,167 weights/biases, 57.9 KB, 7,599,489 training samples, mini-batch size 1</span></a>
<a class="sourceLine" id="cb1066-26" data-line-number="26"><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></a>
<a class="sourceLine" id="cb1066-27" data-line-number="27"><span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span></a>
<a class="sourceLine" id="cb1066-28" data-line-number="28"><span class="co">#&gt; 2     2    32 Rectifier  0.00 % 0.000000 0.000000  0.047492 0.210334 0.000000</span></a>
<a class="sourceLine" id="cb1066-29" data-line-number="29"><span class="co">#&gt; 3     3    32 Rectifier  0.00 % 0.000000 0.000000  0.000285 0.000158 0.000000</span></a>
<a class="sourceLine" id="cb1066-30" data-line-number="30"><span class="co">#&gt; 4     4    32 Rectifier  0.00 % 0.000000 0.000000  0.000585 0.000485 0.000000</span></a>
<a class="sourceLine" id="cb1066-31" data-line-number="31"><span class="co">#&gt; 5     5     7   Softmax      NA 0.000000 0.000000  0.130060 0.322010 0.000000</span></a>
<a class="sourceLine" id="cb1066-32" data-line-number="32"><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></a>
<a class="sourceLine" id="cb1066-33" data-line-number="33"><span class="co">#&gt; 1          NA         NA        NA       NA</span></a>
<a class="sourceLine" id="cb1066-34" data-line-number="34"><span class="co">#&gt; 2   -0.013682   0.310562  0.298837 0.333052</span></a>
<a class="sourceLine" id="cb1066-35" data-line-number="35"><span class="co">#&gt; 3   -0.067957   0.388180  0.684273 0.840598</span></a>
<a class="sourceLine" id="cb1066-36" data-line-number="36"><span class="co">#&gt; 4    0.005756   0.516670  0.267690 1.023919</span></a>
<a class="sourceLine" id="cb1066-37" data-line-number="37"><span class="co">#&gt; 5   -4.656668   3.913377 -5.014381 1.614360</span></a>
<a class="sourceLine" id="cb1066-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-39" data-line-number="39"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1066-40" data-line-number="40"><span class="co">#&gt; ** Reported on training data. **</span></a>
<a class="sourceLine" id="cb1066-41" data-line-number="41"><span class="co">#&gt; ** Metrics reported on temporary training frame with 10016 samples **</span></a>
<a class="sourceLine" id="cb1066-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-43" data-line-number="43"><span class="co">#&gt; Training Set Metrics: </span></a>
<a class="sourceLine" id="cb1066-44" data-line-number="44"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1066-45" data-line-number="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-46" data-line-number="46"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.112</span></a>
<a class="sourceLine" id="cb1066-47" data-line-number="47"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.334</span></a>
<a class="sourceLine" id="cb1066-48" data-line-number="48"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.376</span></a>
<a class="sourceLine" id="cb1066-49" data-line-number="49"><span class="co">#&gt; Mean Per-Class Error: 0.238</span></a>
<a class="sourceLine" id="cb1066-50" data-line-number="50"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span></a>
<a class="sourceLine" id="cb1066-51" data-line-number="51"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1066-52" data-line-number="52"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1066-53" data-line-number="53"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1066-54" data-line-number="54"><span class="co">#&gt; class_1    3108     559       0       0       5       0      37 0.1620</span></a>
<a class="sourceLine" id="cb1066-55" data-line-number="55"><span class="co">#&gt; class_2     402    4274      33       0      40      42       5 0.1088</span></a>
<a class="sourceLine" id="cb1066-56" data-line-number="56"><span class="co">#&gt; class_3       0      42     471       5       1     108       0 0.2488</span></a>
<a class="sourceLine" id="cb1066-57" data-line-number="57"><span class="co">#&gt; class_4       0       0      11      33       0       1       0 0.2667</span></a>
<a class="sourceLine" id="cb1066-58" data-line-number="58"><span class="co">#&gt; class_5       5      66       2       0      96       1       0 0.4353</span></a>
<a class="sourceLine" id="cb1066-59" data-line-number="59"><span class="co">#&gt; class_6       0      40      53       4       1     214       0 0.3141</span></a>
<a class="sourceLine" id="cb1066-60" data-line-number="60"><span class="co">#&gt; class_7      46       0       0       0       0       0     311 0.1289</span></a>
<a class="sourceLine" id="cb1066-61" data-line-number="61"><span class="co">#&gt; Totals     3561    4981     570      42     143     366     353 0.1507</span></a>
<a class="sourceLine" id="cb1066-62" data-line-number="62"><span class="co">#&gt;                     Rate</span></a>
<a class="sourceLine" id="cb1066-63" data-line-number="63"><span class="co">#&gt; class_1 =    601 / 3,709</span></a>
<a class="sourceLine" id="cb1066-64" data-line-number="64"><span class="co">#&gt; class_2 =    522 / 4,796</span></a>
<a class="sourceLine" id="cb1066-65" data-line-number="65"><span class="co">#&gt; class_3 =      156 / 627</span></a>
<a class="sourceLine" id="cb1066-66" data-line-number="66"><span class="co">#&gt; class_4 =        12 / 45</span></a>
<a class="sourceLine" id="cb1066-67" data-line-number="67"><span class="co">#&gt; class_5 =       74 / 170</span></a>
<a class="sourceLine" id="cb1066-68" data-line-number="68"><span class="co">#&gt; class_6 =       98 / 312</span></a>
<a class="sourceLine" id="cb1066-69" data-line-number="69"><span class="co">#&gt; class_7 =       46 / 357</span></a>
<a class="sourceLine" id="cb1066-70" data-line-number="70"><span class="co">#&gt; Totals  = 1,509 / 10,016</span></a>
<a class="sourceLine" id="cb1066-71" data-line-number="71"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-72" data-line-number="72"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span></a>
<a class="sourceLine" id="cb1066-73" data-line-number="73"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1066-74" data-line-number="74"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1066-75" data-line-number="75"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1066-76" data-line-number="76"><span class="co">#&gt; 1 1  0.849341</span></a>
<a class="sourceLine" id="cb1066-77" data-line-number="77"><span class="co">#&gt; 2 2  0.987220</span></a>
<a class="sourceLine" id="cb1066-78" data-line-number="78"><span class="co">#&gt; 3 3  0.997803</span></a>
<a class="sourceLine" id="cb1066-79" data-line-number="79"><span class="co">#&gt; 4 4  0.999800</span></a>
<a class="sourceLine" id="cb1066-80" data-line-number="80"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1066-81" data-line-number="81"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1066-82" data-line-number="82"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1066-83" data-line-number="83"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-84" data-line-number="84"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-85" data-line-number="85"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1066-86" data-line-number="86"><span class="co">#&gt; ** Reported on validation data. **</span></a>
<a class="sourceLine" id="cb1066-87" data-line-number="87"><span class="co">#&gt; ** Metrics reported on temporary validation frame with 10014 samples **</span></a>
<a class="sourceLine" id="cb1066-88" data-line-number="88"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-89" data-line-number="89"><span class="co">#&gt; Validation Set Metrics: </span></a>
<a class="sourceLine" id="cb1066-90" data-line-number="90"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1066-91" data-line-number="91"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-92" data-line-number="92"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.113</span></a>
<a class="sourceLine" id="cb1066-93" data-line-number="93"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.336</span></a>
<a class="sourceLine" id="cb1066-94" data-line-number="94"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.39</span></a>
<a class="sourceLine" id="cb1066-95" data-line-number="95"><span class="co">#&gt; Mean Per-Class Error: 0.242</span></a>
<a class="sourceLine" id="cb1066-96" data-line-number="96"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span></a>
<a class="sourceLine" id="cb1066-97" data-line-number="97"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1066-98" data-line-number="98"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1066-99" data-line-number="99"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1066-100" data-line-number="100"><span class="co">#&gt; class_1    3057     544       0       0       9       1      41 0.1629</span></a>
<a class="sourceLine" id="cb1066-101" data-line-number="101"><span class="co">#&gt; class_2     405    4342      27       1      29      42       6 0.1051</span></a>
<a class="sourceLine" id="cb1066-102" data-line-number="102"><span class="co">#&gt; class_3       0      29     486      10       2     101       0 0.2261</span></a>
<a class="sourceLine" id="cb1066-103" data-line-number="103"><span class="co">#&gt; class_4       0       0       6      32       0       5       0 0.2558</span></a>
<a class="sourceLine" id="cb1066-104" data-line-number="104"><span class="co">#&gt; class_5       7      69       5       0      77       3       0 0.5217</span></a>
<a class="sourceLine" id="cb1066-105" data-line-number="105"><span class="co">#&gt; class_6       3      29      53       2       0     234       0 0.2710</span></a>
<a class="sourceLine" id="cb1066-106" data-line-number="106"><span class="co">#&gt; class_7      46       6       0       0       1       0     304 0.1485</span></a>
<a class="sourceLine" id="cb1066-107" data-line-number="107"><span class="co">#&gt; Totals     3518    5019     577      45     118     386     351 0.1480</span></a>
<a class="sourceLine" id="cb1066-108" data-line-number="108"><span class="co">#&gt;                     Rate</span></a>
<a class="sourceLine" id="cb1066-109" data-line-number="109"><span class="co">#&gt; class_1 =    595 / 3,652</span></a>
<a class="sourceLine" id="cb1066-110" data-line-number="110"><span class="co">#&gt; class_2 =    510 / 4,852</span></a>
<a class="sourceLine" id="cb1066-111" data-line-number="111"><span class="co">#&gt; class_3 =      142 / 628</span></a>
<a class="sourceLine" id="cb1066-112" data-line-number="112"><span class="co">#&gt; class_4 =        11 / 43</span></a>
<a class="sourceLine" id="cb1066-113" data-line-number="113"><span class="co">#&gt; class_5 =       84 / 161</span></a>
<a class="sourceLine" id="cb1066-114" data-line-number="114"><span class="co">#&gt; class_6 =       87 / 321</span></a>
<a class="sourceLine" id="cb1066-115" data-line-number="115"><span class="co">#&gt; class_7 =       53 / 357</span></a>
<a class="sourceLine" id="cb1066-116" data-line-number="116"><span class="co">#&gt; Totals  = 1,482 / 10,014</span></a>
<a class="sourceLine" id="cb1066-117" data-line-number="117"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-118" data-line-number="118"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span></a>
<a class="sourceLine" id="cb1066-119" data-line-number="119"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1066-120" data-line-number="120"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1066-121" data-line-number="121"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1066-122" data-line-number="122"><span class="co">#&gt; 1 1  0.852007</span></a>
<a class="sourceLine" id="cb1066-123" data-line-number="123"><span class="co">#&gt; 2 2  0.985321</span></a>
<a class="sourceLine" id="cb1066-124" data-line-number="124"><span class="co">#&gt; 3 3  0.997603</span></a>
<a class="sourceLine" id="cb1066-125" data-line-number="125"><span class="co">#&gt; 4 4  0.999501</span></a>
<a class="sourceLine" id="cb1066-126" data-line-number="126"><span class="co">#&gt; 5 5  0.999800</span></a>
<a class="sourceLine" id="cb1066-127" data-line-number="127"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1066-128" data-line-number="128"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1066-129" data-line-number="129"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-130" data-line-number="130"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-131" data-line-number="131"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-132" data-line-number="132"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-133" data-line-number="133"><span class="co">#&gt; Scoring History: </span></a>
<a class="sourceLine" id="cb1066-134" data-line-number="134"><span class="co">#&gt;              timestamp          duration training_speed   epochs iterations</span></a>
<a class="sourceLine" id="cb1066-135" data-line-number="135"><span class="co">#&gt; 1  2020-11-19 17:01:49         0.000 sec             NA  0.00000          0</span></a>
<a class="sourceLine" id="cb1066-136" data-line-number="136"><span class="co">#&gt; 2  2020-11-19 17:01:50         1.189 sec  88537 obs/sec  0.28716          1</span></a>
<a class="sourceLine" id="cb1066-137" data-line-number="137"><span class="co">#&gt; 3  2020-11-19 17:01:56         6.991 sec 101644 obs/sec  2.00747          7</span></a>
<a class="sourceLine" id="cb1066-138" data-line-number="138"><span class="co">#&gt; 4  2020-11-19 17:02:01        12.188 sec 107787 obs/sec  3.72422         13</span></a>
<a class="sourceLine" id="cb1066-139" data-line-number="139"><span class="co">#&gt; 5  2020-11-19 17:02:07        17.958 sec 112390 obs/sec  5.73168         20</span></a>
<a class="sourceLine" id="cb1066-140" data-line-number="140"><span class="co">#&gt; 6  2020-11-19 17:02:12        23.734 sec 114655 obs/sec  7.73450         27</span></a>
<a class="sourceLine" id="cb1066-141" data-line-number="141"><span class="co">#&gt; 7  2020-11-19 17:02:18        29.253 sec 117073 obs/sec  9.73849         34</span></a>
<a class="sourceLine" id="cb1066-142" data-line-number="142"><span class="co">#&gt; 8  2020-11-19 17:02:23        34.552 sec 119499 obs/sec 11.74405         41</span></a>
<a class="sourceLine" id="cb1066-143" data-line-number="143"><span class="co">#&gt; 9  2020-11-19 17:02:29        39.776 sec 121543 obs/sec 13.75260         48</span></a>
<a class="sourceLine" id="cb1066-144" data-line-number="144"><span class="co">#&gt; 10 2020-11-19 17:02:34        44.990 sec 123094 obs/sec 15.75574         55</span></a>
<a class="sourceLine" id="cb1066-145" data-line-number="145"><span class="co">#&gt; 11 2020-11-19 17:02:39        50.246 sec 124220 obs/sec 17.75991         62</span></a>
<a class="sourceLine" id="cb1066-146" data-line-number="146"><span class="co">#&gt; 12 2020-11-19 17:02:44        55.518 sec 125127 obs/sec 19.76686         69</span></a>
<a class="sourceLine" id="cb1066-147" data-line-number="147"><span class="co">#&gt; 13 2020-11-19 17:02:50  1 min  0.791 sec 125867 obs/sec 21.77410         76</span></a>
<a class="sourceLine" id="cb1066-148" data-line-number="148"><span class="co">#&gt; 14 2020-11-19 17:02:50  1 min  0.823 sec 125863 obs/sec 21.77410         76</span></a>
<a class="sourceLine" id="cb1066-149" data-line-number="149"><span class="co">#&gt;           samples training_rmse training_logloss training_r2</span></a>
<a class="sourceLine" id="cb1066-150" data-line-number="150"><span class="co">#&gt; 1        0.000000            NA               NA          NA</span></a>
<a class="sourceLine" id="cb1066-151" data-line-number="151"><span class="co">#&gt; 2   100224.000000       0.44268          0.60390     0.90153</span></a>
<a class="sourceLine" id="cb1066-152" data-line-number="152"><span class="co">#&gt; 3   700637.000000       0.39422          0.48509     0.92191</span></a>
<a class="sourceLine" id="cb1066-153" data-line-number="153"><span class="co">#&gt; 4  1299808.000000       0.37110          0.44073     0.93080</span></a>
<a class="sourceLine" id="cb1066-154" data-line-number="154"><span class="co">#&gt; 5  2000444.000000       0.35818          0.41691     0.93554</span></a>
<a class="sourceLine" id="cb1066-155" data-line-number="155"><span class="co">#&gt; 6  2699458.000000       0.34945          0.40166     0.93864</span></a>
<a class="sourceLine" id="cb1066-156" data-line-number="156"><span class="co">#&gt; 7  3398878.000000       0.35014          0.40504     0.93840</span></a>
<a class="sourceLine" id="cb1066-157" data-line-number="157"><span class="co">#&gt; 8  4098849.000000       0.34498          0.40096     0.94020</span></a>
<a class="sourceLine" id="cb1066-158" data-line-number="158"><span class="co">#&gt; 9  4799862.000000       0.34758          0.39933     0.93929</span></a>
<a class="sourceLine" id="cb1066-159" data-line-number="159"><span class="co">#&gt; 10 5498988.000000       0.33438          0.37412     0.94382</span></a>
<a class="sourceLine" id="cb1066-160" data-line-number="160"><span class="co">#&gt; 11 6198474.000000       0.33424          0.37557     0.94386</span></a>
<a class="sourceLine" id="cb1066-161" data-line-number="161"><span class="co">#&gt; 12 6898930.000000       0.33194          0.37267     0.94464</span></a>
<a class="sourceLine" id="cb1066-162" data-line-number="162"><span class="co">#&gt; 13 7599489.000000       0.34059          0.39607     0.94171</span></a>
<a class="sourceLine" id="cb1066-163" data-line-number="163"><span class="co">#&gt; 14 7599489.000000       0.33424          0.37557     0.94386</span></a>
<a class="sourceLine" id="cb1066-164" data-line-number="164"><span class="co">#&gt;    training_classification_error validation_rmse validation_logloss</span></a>
<a class="sourceLine" id="cb1066-165" data-line-number="165"><span class="co">#&gt; 1                             NA              NA                 NA</span></a>
<a class="sourceLine" id="cb1066-166" data-line-number="166"><span class="co">#&gt; 2                        0.25699         0.44077            0.59745</span></a>
<a class="sourceLine" id="cb1066-167" data-line-number="167"><span class="co">#&gt; 3                        0.20897         0.39503            0.48861</span></a>
<a class="sourceLine" id="cb1066-168" data-line-number="168"><span class="co">#&gt; 4                        0.18700         0.37374            0.44972</span></a>
<a class="sourceLine" id="cb1066-169" data-line-number="169"><span class="co">#&gt; 5                        0.17272         0.35972            0.42611</span></a>
<a class="sourceLine" id="cb1066-170" data-line-number="170"><span class="co">#&gt; 6                        0.16334         0.35390            0.41359</span></a>
<a class="sourceLine" id="cb1066-171" data-line-number="171"><span class="co">#&gt; 7                        0.16364         0.35017            0.41519</span></a>
<a class="sourceLine" id="cb1066-172" data-line-number="172"><span class="co">#&gt; 8                        0.16094         0.34166            0.40425</span></a>
<a class="sourceLine" id="cb1066-173" data-line-number="173"><span class="co">#&gt; 9                        0.15725         0.34710            0.40707</span></a>
<a class="sourceLine" id="cb1066-174" data-line-number="174"><span class="co">#&gt; 10                       0.14796         0.33386            0.38619</span></a>
<a class="sourceLine" id="cb1066-175" data-line-number="175"><span class="co">#&gt; 11                       0.15066         0.33559            0.38976</span></a>
<a class="sourceLine" id="cb1066-176" data-line-number="176"><span class="co">#&gt; 12                       0.14397         0.33380            0.38047</span></a>
<a class="sourceLine" id="cb1066-177" data-line-number="177"><span class="co">#&gt; 13                       0.15276         0.33726            0.39514</span></a>
<a class="sourceLine" id="cb1066-178" data-line-number="178"><span class="co">#&gt; 14                       0.15066         0.33559            0.38976</span></a>
<a class="sourceLine" id="cb1066-179" data-line-number="179"><span class="co">#&gt;    validation_r2 validation_classification_error</span></a>
<a class="sourceLine" id="cb1066-180" data-line-number="180"><span class="co">#&gt; 1             NA                              NA</span></a>
<a class="sourceLine" id="cb1066-181" data-line-number="181"><span class="co">#&gt; 2        0.90236                         0.25444</span></a>
<a class="sourceLine" id="cb1066-182" data-line-number="182"><span class="co">#&gt; 3        0.92157                         0.20831</span></a>
<a class="sourceLine" id="cb1066-183" data-line-number="183"><span class="co">#&gt; 4        0.92979                         0.18774</span></a>
<a class="sourceLine" id="cb1066-184" data-line-number="184"><span class="co">#&gt; 5        0.93496                         0.17386</span></a>
<a class="sourceLine" id="cb1066-185" data-line-number="185"><span class="co">#&gt; 6        0.93705                         0.16687</span></a>
<a class="sourceLine" id="cb1066-186" data-line-number="186"><span class="co">#&gt; 7        0.93837                         0.16317</span></a>
<a class="sourceLine" id="cb1066-187" data-line-number="187"><span class="co">#&gt; 8        0.94133                         0.15598</span></a>
<a class="sourceLine" id="cb1066-188" data-line-number="188"><span class="co">#&gt; 9        0.93945                         0.15578</span></a>
<a class="sourceLine" id="cb1066-189" data-line-number="189"><span class="co">#&gt; 10       0.94398                         0.14919</span></a>
<a class="sourceLine" id="cb1066-190" data-line-number="190"><span class="co">#&gt; 11       0.94340                         0.14799</span></a>
<a class="sourceLine" id="cb1066-191" data-line-number="191"><span class="co">#&gt; 12       0.94400                         0.14839</span></a>
<a class="sourceLine" id="cb1066-192" data-line-number="192"><span class="co">#&gt; 13       0.94283                         0.15109</span></a>
<a class="sourceLine" id="cb1066-193" data-line-number="193"><span class="co">#&gt; 14       0.94340                         0.14799</span></a>
<a class="sourceLine" id="cb1066-194" data-line-number="194"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-195" data-line-number="195"><span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span></a>
<a class="sourceLine" id="cb1066-196" data-line-number="196"><span class="co">#&gt; =================================================</span></a>
<a class="sourceLine" id="cb1066-197" data-line-number="197"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-198" data-line-number="198"><span class="co">#&gt; Variable Importances: </span></a>
<a class="sourceLine" id="cb1066-199" data-line-number="199"><span class="co">#&gt;                             variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1066-200" data-line-number="200"><span class="co">#&gt; 1             Wilderness_Area.area_3            1.000000          1.000000</span></a>
<a class="sourceLine" id="cb1066-201" data-line-number="201"><span class="co">#&gt; 2 Horizontal_Distance_To_Fire_Points            0.874251          0.874251</span></a>
<a class="sourceLine" id="cb1066-202" data-line-number="202"><span class="co">#&gt; 3             Wilderness_Area.area_1            0.851468          0.851468</span></a>
<a class="sourceLine" id="cb1066-203" data-line-number="203"><span class="co">#&gt; 4    Horizontal_Distance_To_Roadways            0.776976          0.776976</span></a>
<a class="sourceLine" id="cb1066-204" data-line-number="204"><span class="co">#&gt; 5             Wilderness_Area.area_0            0.771380          0.771380</span></a>
<a class="sourceLine" id="cb1066-205" data-line-number="205"><span class="co">#&gt;   percentage</span></a>
<a class="sourceLine" id="cb1066-206" data-line-number="206"><span class="co">#&gt; 1   0.035152</span></a>
<a class="sourceLine" id="cb1066-207" data-line-number="207"><span class="co">#&gt; 2   0.030732</span></a>
<a class="sourceLine" id="cb1066-208" data-line-number="208"><span class="co">#&gt; 3   0.029931</span></a>
<a class="sourceLine" id="cb1066-209" data-line-number="209"><span class="co">#&gt; 4   0.027312</span></a>
<a class="sourceLine" id="cb1066-210" data-line-number="210"><span class="co">#&gt; 5   0.027116</span></a>
<a class="sourceLine" id="cb1066-211" data-line-number="211"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1066-212" data-line-number="212"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1066-213" data-line-number="213"><span class="co">#&gt;                            variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1066-214" data-line-number="214"><span class="co">#&gt; 51 Horizontal_Distance_To_Hydrology            0.268715          0.268715</span></a>
<a class="sourceLine" id="cb1066-215" data-line-number="215"><span class="co">#&gt; 52   Vertical_Distance_To_Hydrology            0.224822          0.224822</span></a>
<a class="sourceLine" id="cb1066-216" data-line-number="216"><span class="co">#&gt; 53                            Slope            0.157384          0.157384</span></a>
<a class="sourceLine" id="cb1066-217" data-line-number="217"><span class="co">#&gt; 54                           Aspect            0.055925          0.055925</span></a>
<a class="sourceLine" id="cb1066-218" data-line-number="218"><span class="co">#&gt; 55            Soil_Type.missing(NA)            0.000000          0.000000</span></a>
<a class="sourceLine" id="cb1066-219" data-line-number="219"><span class="co">#&gt; 56      Wilderness_Area.missing(NA)            0.000000          0.000000</span></a>
<a class="sourceLine" id="cb1066-220" data-line-number="220"><span class="co">#&gt;    percentage</span></a>
<a class="sourceLine" id="cb1066-221" data-line-number="221"><span class="co">#&gt; 51   0.009446</span></a>
<a class="sourceLine" id="cb1066-222" data-line-number="222"><span class="co">#&gt; 52   0.007903</span></a>
<a class="sourceLine" id="cb1066-223" data-line-number="223"><span class="co">#&gt; 53   0.005532</span></a>
<a class="sourceLine" id="cb1066-224" data-line-number="224"><span class="co">#&gt; 54   0.001966</span></a>
<a class="sourceLine" id="cb1066-225" data-line-number="225"><span class="co">#&gt; 55   0.000000</span></a>
<a class="sourceLine" id="cb1066-226" data-line-number="226"><span class="co">#&gt; 56   0.000000</span></a>
<a class="sourceLine" id="cb1066-227" data-line-number="227"><span class="kw">plot</span>(m2)</a></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/dl_ctype_early_stopping-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="adaptive-learning-rate" class="section level3">
<h3>
<span class="header-section-number">46.5.4</span> Adaptive Learning Rate<a class="anchor" aria-label="anchor" href="#adaptive-learning-rate"><i class="fas fa-link"></i></a>
</h3>
<p>By default, H2O Deep Learning uses an adaptive learning rate (ADADELTA) for its stochastic gradient descent optimization. There are only two tuning parameters for this method: rho and epsilon, which balance the global and local search efficiencies. rho is the similarity to prior weight updates (similar to momentum), and epsilon is a parameter that prevents the optimization to get stuck in local optima. Defaults are rho=0.99 and epsilon=1e-8. For cases where convergence speed is very important, it might make sense to perform a few runs to optimize these two parameters (e.g., with rho in c(0.9,0.95,0.99,0.999) and epsilon in c(1e-10,1e-8,1e-6,1e-4)). Of course, as always with grid searches, caution has to be applied when extrapolating grid search results to a different parameter regime (e.g., for more epochs or different layer topologies or activation functions, etc.).</p>
<p>If adaptive_rate is disabled, several manual learning rate parameters become important: rate, rate_annealing, rate_decay, momentum_start, momentum_ramp, momentum_stable and <code>nesterov_accelerated_gradient</code>, the discussion of which we leave to H2O Deep Learning booklet.</p>
</div>
<div id="tuning" class="section level3">
<h3>
<span class="header-section-number">46.5.5</span> Tuning<a class="anchor" aria-label="anchor" href="#tuning"><i class="fas fa-link"></i></a>
</h3>
<p>With some tuning, it is possible to obtain less than 10% test set error rate in about one minute. Error rates of below 5% are possible with larger models. Note that deep tree methods can be more effective for this dataset than Deep Learning, as they directly partition the space into sectors, which seems to be needed here.</p>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1067-1" data-line-number="1">m3 &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(</a>
<a class="sourceLine" id="cb1067-2" data-line-number="2">  <span class="dt">model_id=</span><span class="st">"dl_model_tuned"</span>, </a>
<a class="sourceLine" id="cb1067-3" data-line-number="3">  <span class="dt">training_frame=</span>train, </a>
<a class="sourceLine" id="cb1067-4" data-line-number="4">  <span class="dt">validation_frame=</span>valid, </a>
<a class="sourceLine" id="cb1067-5" data-line-number="5">  <span class="dt">x=</span>predictors, </a>
<a class="sourceLine" id="cb1067-6" data-line-number="6">  <span class="dt">y=</span>response, </a>
<a class="sourceLine" id="cb1067-7" data-line-number="7">  <span class="dt">overwrite_with_best_model=</span>F,    <span class="co">## Return final model after 10 epochs, even if not the best</span></a>
<a class="sourceLine" id="cb1067-8" data-line-number="8">  <span class="dt">hidden=</span><span class="kw">c</span>(<span class="dv">128</span>,<span class="dv">128</span>,<span class="dv">128</span>),          <span class="co">## more hidden layers -&gt; more complex interactions</span></a>
<a class="sourceLine" id="cb1067-9" data-line-number="9">  <span class="dt">epochs=</span><span class="dv">10</span>,                      <span class="co">## to keep it short enough</span></a>
<a class="sourceLine" id="cb1067-10" data-line-number="10">  <span class="dt">score_validation_samples=</span><span class="dv">10000</span>, <span class="co">## downsample validation set for faster scoring</span></a>
<a class="sourceLine" id="cb1067-11" data-line-number="11">  <span class="dt">score_duty_cycle=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span></a>
<a class="sourceLine" id="cb1067-12" data-line-number="12">  <span class="dt">adaptive_rate=</span>F,                <span class="co">## manually tuned learning rate</span></a>
<a class="sourceLine" id="cb1067-13" data-line-number="13">  <span class="dt">rate=</span><span class="fl">0.01</span>, </a>
<a class="sourceLine" id="cb1067-14" data-line-number="14">  <span class="dt">rate_annealing=</span><span class="fl">2e-6</span>,            </a>
<a class="sourceLine" id="cb1067-15" data-line-number="15">  <span class="dt">momentum_start=</span><span class="fl">0.2</span>,             <span class="co">## manually tuned momentum</span></a>
<a class="sourceLine" id="cb1067-16" data-line-number="16">  <span class="dt">momentum_stable=</span><span class="fl">0.4</span>, </a>
<a class="sourceLine" id="cb1067-17" data-line-number="17">  <span class="dt">momentum_ramp=</span><span class="fl">1e7</span>, </a>
<a class="sourceLine" id="cb1067-18" data-line-number="18">  <span class="dt">l1=</span><span class="fl">1e-5</span>,                        <span class="co">## add some L1/L2 regularization</span></a>
<a class="sourceLine" id="cb1067-19" data-line-number="19">  <span class="dt">l2=</span><span class="fl">1e-5</span>,</a>
<a class="sourceLine" id="cb1067-20" data-line-number="20">  <span class="dt">max_w2=</span><span class="dv">10</span>                       <span class="co">## helps stability for Rectifier</span></a>
<a class="sourceLine" id="cb1067-21" data-line-number="21">) </a>
<a class="sourceLine" id="cb1067-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-23" data-line-number="23">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-24" data-line-number="24"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1067-25" data-line-number="25">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-26" data-line-number="26"><span class="st">  </span><span class="er">|==</span><span class="st">                                                                    </span><span class="er">|</span><span class="st">   </span><span class="dv">3</span>%</a>
<a class="sourceLine" id="cb1067-27" data-line-number="27">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-28" data-line-number="28"><span class="st">  </span><span class="er">|====</span><span class="st">                                                                  </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%</a>
<a class="sourceLine" id="cb1067-29" data-line-number="29">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-30" data-line-number="30"><span class="st">  </span><span class="er">|======</span><span class="st">                                                                </span><span class="er">|</span><span class="st">   </span><span class="dv">9</span>%</a>
<a class="sourceLine" id="cb1067-31" data-line-number="31">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-32" data-line-number="32"><span class="st">  </span><span class="er">|========</span><span class="st">                                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%</a>
<a class="sourceLine" id="cb1067-33" data-line-number="33">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-34" data-line-number="34"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb1067-35" data-line-number="35">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-36" data-line-number="36"><span class="st">  </span><span class="er">|============</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">17</span>%</a>
<a class="sourceLine" id="cb1067-37" data-line-number="37">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-38" data-line-number="38"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb1067-39" data-line-number="39">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-40" data-line-number="40"><span class="st">  </span><span class="er">|================</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">23</span>%</a>
<a class="sourceLine" id="cb1067-41" data-line-number="41">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-42" data-line-number="42"><span class="st">  </span><span class="er">|==================</span><span class="st">                                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%</a>
<a class="sourceLine" id="cb1067-43" data-line-number="43">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-44" data-line-number="44"><span class="st">  </span><span class="er">|====================</span><span class="st">                                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb1067-45" data-line-number="45">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-46" data-line-number="46"><span class="st">  </span><span class="er">|======================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%</a>
<a class="sourceLine" id="cb1067-47" data-line-number="47">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-48" data-line-number="48"><span class="st">  </span><span class="er">|========================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">34</span>%</a>
<a class="sourceLine" id="cb1067-49" data-line-number="49">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-50" data-line-number="50"><span class="st">  </span><span class="er">|==========================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%</a>
<a class="sourceLine" id="cb1067-51" data-line-number="51">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-52" data-line-number="52"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb1067-53" data-line-number="53">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-54" data-line-number="54"><span class="st">  </span><span class="er">|==============================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%</a>
<a class="sourceLine" id="cb1067-55" data-line-number="55">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-56" data-line-number="56"><span class="st">  </span><span class="er">|================================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">46</span>%</a>
<a class="sourceLine" id="cb1067-57" data-line-number="57">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-58" data-line-number="58"><span class="st">  </span><span class="er">|==================================</span><span class="st">                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">49</span>%</a>
<a class="sourceLine" id="cb1067-59" data-line-number="59">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-60" data-line-number="60"><span class="st">  </span><span class="er">|====================================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">52</span>%</a>
<a class="sourceLine" id="cb1067-61" data-line-number="61">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-62" data-line-number="62"><span class="st">  </span><span class="er">|======================================</span><span class="st">                                </span><span class="er">|</span><span class="st">  </span><span class="dv">54</span>%</a>
<a class="sourceLine" id="cb1067-63" data-line-number="63">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-64" data-line-number="64"><span class="st">  </span><span class="er">|========================================</span><span class="st">                              </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%</a>
<a class="sourceLine" id="cb1067-65" data-line-number="65">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-66" data-line-number="66"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb1067-67" data-line-number="67">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-68" data-line-number="68"><span class="st">  </span><span class="er">|============================================</span><span class="st">                          </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%</a>
<a class="sourceLine" id="cb1067-69" data-line-number="69">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-70" data-line-number="70"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">66</span>%</a>
<a class="sourceLine" id="cb1067-71" data-line-number="71">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-72" data-line-number="72"><span class="st">  </span><span class="er">|================================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">69</span>%</a>
<a class="sourceLine" id="cb1067-73" data-line-number="73">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-74" data-line-number="74"><span class="st">  </span><span class="er">|==================================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">72</span>%</a>
<a class="sourceLine" id="cb1067-75" data-line-number="75">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-76" data-line-number="76"><span class="st">  </span><span class="er">|====================================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%</a>
<a class="sourceLine" id="cb1067-77" data-line-number="77">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-78" data-line-number="78"><span class="st">  </span><span class="er">|======================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">77</span>%</a>
<a class="sourceLine" id="cb1067-79" data-line-number="79">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-80" data-line-number="80"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb1067-81" data-line-number="81">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-82" data-line-number="82"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">83</span>%</a>
<a class="sourceLine" id="cb1067-83" data-line-number="83">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-84" data-line-number="84"><span class="st">  </span><span class="er">|============================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb1067-85" data-line-number="85">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-86" data-line-number="86"><span class="st">  </span><span class="er">|==============================================================</span><span class="st">        </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%</a>
<a class="sourceLine" id="cb1067-87" data-line-number="87">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-88" data-line-number="88"><span class="st">  </span><span class="er">|================================================================</span><span class="st">      </span><span class="er">|</span><span class="st">  </span><span class="dv">92</span>%</a>
<a class="sourceLine" id="cb1067-89" data-line-number="89">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-90" data-line-number="90"><span class="st">  </span><span class="er">|==================================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%</a>
<a class="sourceLine" id="cb1067-91" data-line-number="91">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-92" data-line-number="92"><span class="st">  </span><span class="er">|====================================================================</span><span class="st">  </span><span class="er">|</span><span class="st">  </span><span class="dv">97</span>%</a>
<a class="sourceLine" id="cb1067-93" data-line-number="93">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1067-94" data-line-number="94"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1067-95" data-line-number="95"><span class="kw">summary</span>(m3)</a>
<a class="sourceLine" id="cb1067-96" data-line-number="96"><span class="co">#&gt; Model Details:</span></a>
<a class="sourceLine" id="cb1067-97" data-line-number="97"><span class="co">#&gt; ==============</span></a>
<a class="sourceLine" id="cb1067-98" data-line-number="98"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-99" data-line-number="99"><span class="co">#&gt; H2OMultinomialModel: deeplearning</span></a>
<a class="sourceLine" id="cb1067-100" data-line-number="100"><span class="co">#&gt; Model Key:  dl_model_tuned </span></a>
<a class="sourceLine" id="cb1067-101" data-line-number="101"><span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 41,223 weights/biases, 332.9 KB, 3,501,423 training samples, mini-batch size 1</span></a>
<a class="sourceLine" id="cb1067-102" data-line-number="102"><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></a>
<a class="sourceLine" id="cb1067-103" data-line-number="103"><span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span></a>
<a class="sourceLine" id="cb1067-104" data-line-number="104"><span class="co">#&gt; 2     2   128 Rectifier  0.00 % 0.000010 0.000010  0.001250 0.000000 0.270028</span></a>
<a class="sourceLine" id="cb1067-105" data-line-number="105"><span class="co">#&gt; 3     3   128 Rectifier  0.00 % 0.000010 0.000010  0.001250 0.000000 0.270028</span></a>
<a class="sourceLine" id="cb1067-106" data-line-number="106"><span class="co">#&gt; 4     4   128 Rectifier  0.00 % 0.000010 0.000010  0.001250 0.000000 0.270028</span></a>
<a class="sourceLine" id="cb1067-107" data-line-number="107"><span class="co">#&gt; 5     5     7   Softmax      NA 0.000010 0.000010  0.001250 0.000000 0.270028</span></a>
<a class="sourceLine" id="cb1067-108" data-line-number="108"><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></a>
<a class="sourceLine" id="cb1067-109" data-line-number="109"><span class="co">#&gt; 1          NA         NA        NA       NA</span></a>
<a class="sourceLine" id="cb1067-110" data-line-number="110"><span class="co">#&gt; 2   -0.014029   0.313943 -0.010079 0.305512</span></a>
<a class="sourceLine" id="cb1067-111" data-line-number="111"><span class="co">#&gt; 3   -0.052288   0.222216  0.899687 0.369371</span></a>
<a class="sourceLine" id="cb1067-112" data-line-number="112"><span class="co">#&gt; 4   -0.061405   0.215619  0.835836 0.181308</span></a>
<a class="sourceLine" id="cb1067-113" data-line-number="113"><span class="co">#&gt; 5   -0.020967   0.270920  0.011389 0.976154</span></a>
<a class="sourceLine" id="cb1067-114" data-line-number="114"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-115" data-line-number="115"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1067-116" data-line-number="116"><span class="co">#&gt; ** Reported on training data. **</span></a>
<a class="sourceLine" id="cb1067-117" data-line-number="117"><span class="co">#&gt; ** Metrics reported on temporary training frame with 10046 samples **</span></a>
<a class="sourceLine" id="cb1067-118" data-line-number="118"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-119" data-line-number="119"><span class="co">#&gt; Training Set Metrics: </span></a>
<a class="sourceLine" id="cb1067-120" data-line-number="120"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1067-121" data-line-number="121"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-122" data-line-number="122"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.058</span></a>
<a class="sourceLine" id="cb1067-123" data-line-number="123"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.241</span></a>
<a class="sourceLine" id="cb1067-124" data-line-number="124"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.192</span></a>
<a class="sourceLine" id="cb1067-125" data-line-number="125"><span class="co">#&gt; Mean Per-Class Error: 0.138</span></a>
<a class="sourceLine" id="cb1067-126" data-line-number="126"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span></a>
<a class="sourceLine" id="cb1067-127" data-line-number="127"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1067-128" data-line-number="128"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1067-129" data-line-number="129"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1067-130" data-line-number="130"><span class="co">#&gt; class_1    3242     388       0       0       4       0      19 0.1125</span></a>
<a class="sourceLine" id="cb1067-131" data-line-number="131"><span class="co">#&gt; class_2     153    4719       7       0      11      15       2 0.0383</span></a>
<a class="sourceLine" id="cb1067-132" data-line-number="132"><span class="co">#&gt; class_3       0      16     582       2       3      33       0 0.0849</span></a>
<a class="sourceLine" id="cb1067-133" data-line-number="133"><span class="co">#&gt; class_4       0       0      10      44       0       4       0 0.2414</span></a>
<a class="sourceLine" id="cb1067-134" data-line-number="134"><span class="co">#&gt; class_5       3      38       1       0     117       1       0 0.2687</span></a>
<a class="sourceLine" id="cb1067-135" data-line-number="135"><span class="co">#&gt; class_6       2       9      29       1       0     264       0 0.1344</span></a>
<a class="sourceLine" id="cb1067-136" data-line-number="136"><span class="co">#&gt; class_7      21       6       0       0       0       0     300 0.0826</span></a>
<a class="sourceLine" id="cb1067-137" data-line-number="137"><span class="co">#&gt; Totals     3421    5176     629      47     135     317     321 0.0774</span></a>
<a class="sourceLine" id="cb1067-138" data-line-number="138"><span class="co">#&gt;                   Rate</span></a>
<a class="sourceLine" id="cb1067-139" data-line-number="139"><span class="co">#&gt; class_1 =  411 / 3,653</span></a>
<a class="sourceLine" id="cb1067-140" data-line-number="140"><span class="co">#&gt; class_2 =  188 / 4,907</span></a>
<a class="sourceLine" id="cb1067-141" data-line-number="141"><span class="co">#&gt; class_3 =     54 / 636</span></a>
<a class="sourceLine" id="cb1067-142" data-line-number="142"><span class="co">#&gt; class_4 =      14 / 58</span></a>
<a class="sourceLine" id="cb1067-143" data-line-number="143"><span class="co">#&gt; class_5 =     43 / 160</span></a>
<a class="sourceLine" id="cb1067-144" data-line-number="144"><span class="co">#&gt; class_6 =     41 / 305</span></a>
<a class="sourceLine" id="cb1067-145" data-line-number="145"><span class="co">#&gt; class_7 =     27 / 327</span></a>
<a class="sourceLine" id="cb1067-146" data-line-number="146"><span class="co">#&gt; Totals  = 778 / 10,046</span></a>
<a class="sourceLine" id="cb1067-147" data-line-number="147"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-148" data-line-number="148"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span></a>
<a class="sourceLine" id="cb1067-149" data-line-number="149"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1067-150" data-line-number="150"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1067-151" data-line-number="151"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1067-152" data-line-number="152"><span class="co">#&gt; 1 1  0.922556</span></a>
<a class="sourceLine" id="cb1067-153" data-line-number="153"><span class="co">#&gt; 2 2  0.996416</span></a>
<a class="sourceLine" id="cb1067-154" data-line-number="154"><span class="co">#&gt; 3 3  0.999801</span></a>
<a class="sourceLine" id="cb1067-155" data-line-number="155"><span class="co">#&gt; 4 4  1.000000</span></a>
<a class="sourceLine" id="cb1067-156" data-line-number="156"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1067-157" data-line-number="157"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1067-158" data-line-number="158"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1067-159" data-line-number="159"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-160" data-line-number="160"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-161" data-line-number="161"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1067-162" data-line-number="162"><span class="co">#&gt; ** Reported on validation data. **</span></a>
<a class="sourceLine" id="cb1067-163" data-line-number="163"><span class="co">#&gt; ** Metrics reported on temporary validation frame with 9987 samples **</span></a>
<a class="sourceLine" id="cb1067-164" data-line-number="164"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-165" data-line-number="165"><span class="co">#&gt; Validation Set Metrics: </span></a>
<a class="sourceLine" id="cb1067-166" data-line-number="166"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1067-167" data-line-number="167"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-168" data-line-number="168"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0613</span></a>
<a class="sourceLine" id="cb1067-169" data-line-number="169"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.248</span></a>
<a class="sourceLine" id="cb1067-170" data-line-number="170"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.204</span></a>
<a class="sourceLine" id="cb1067-171" data-line-number="171"><span class="co">#&gt; Mean Per-Class Error: 0.13</span></a>
<a class="sourceLine" id="cb1067-172" data-line-number="172"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span></a>
<a class="sourceLine" id="cb1067-173" data-line-number="173"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1067-174" data-line-number="174"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1067-175" data-line-number="175"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1067-176" data-line-number="176"><span class="co">#&gt; class_1    3252     367       0       0       1       1      21 0.1071</span></a>
<a class="sourceLine" id="cb1067-177" data-line-number="177"><span class="co">#&gt; class_2     186    4668      13       0      21      14       1 0.0479</span></a>
<a class="sourceLine" id="cb1067-178" data-line-number="178"><span class="co">#&gt; class_3       0      23     534       3       1      38       0 0.1085</span></a>
<a class="sourceLine" id="cb1067-179" data-line-number="179"><span class="co">#&gt; class_4       0       0       4      42       0       0       0 0.0870</span></a>
<a class="sourceLine" id="cb1067-180" data-line-number="180"><span class="co">#&gt; class_5       1      50       1       0     106       2       0 0.3375</span></a>
<a class="sourceLine" id="cb1067-181" data-line-number="181"><span class="co">#&gt; class_6       0      11      27       2       1     259       0 0.1367</span></a>
<a class="sourceLine" id="cb1067-182" data-line-number="182"><span class="co">#&gt; class_7      26       2       0       0       0       0     309 0.0831</span></a>
<a class="sourceLine" id="cb1067-183" data-line-number="183"><span class="co">#&gt; Totals     3465    5121     579      47     130     314     331 0.0818</span></a>
<a class="sourceLine" id="cb1067-184" data-line-number="184"><span class="co">#&gt;                  Rate</span></a>
<a class="sourceLine" id="cb1067-185" data-line-number="185"><span class="co">#&gt; class_1 = 390 / 3,642</span></a>
<a class="sourceLine" id="cb1067-186" data-line-number="186"><span class="co">#&gt; class_2 = 235 / 4,903</span></a>
<a class="sourceLine" id="cb1067-187" data-line-number="187"><span class="co">#&gt; class_3 =    65 / 599</span></a>
<a class="sourceLine" id="cb1067-188" data-line-number="188"><span class="co">#&gt; class_4 =      4 / 46</span></a>
<a class="sourceLine" id="cb1067-189" data-line-number="189"><span class="co">#&gt; class_5 =    54 / 160</span></a>
<a class="sourceLine" id="cb1067-190" data-line-number="190"><span class="co">#&gt; class_6 =    41 / 300</span></a>
<a class="sourceLine" id="cb1067-191" data-line-number="191"><span class="co">#&gt; class_7 =    28 / 337</span></a>
<a class="sourceLine" id="cb1067-192" data-line-number="192"><span class="co">#&gt; Totals  = 817 / 9,987</span></a>
<a class="sourceLine" id="cb1067-193" data-line-number="193"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-194" data-line-number="194"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span></a>
<a class="sourceLine" id="cb1067-195" data-line-number="195"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1067-196" data-line-number="196"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1067-197" data-line-number="197"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1067-198" data-line-number="198"><span class="co">#&gt; 1 1  0.918194</span></a>
<a class="sourceLine" id="cb1067-199" data-line-number="199"><span class="co">#&gt; 2 2  0.996295</span></a>
<a class="sourceLine" id="cb1067-200" data-line-number="200"><span class="co">#&gt; 3 3  0.999700</span></a>
<a class="sourceLine" id="cb1067-201" data-line-number="201"><span class="co">#&gt; 4 4  1.000000</span></a>
<a class="sourceLine" id="cb1067-202" data-line-number="202"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1067-203" data-line-number="203"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1067-204" data-line-number="204"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1067-205" data-line-number="205"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-206" data-line-number="206"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-207" data-line-number="207"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-208" data-line-number="208"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-209" data-line-number="209"><span class="co">#&gt; Scoring History: </span></a>
<a class="sourceLine" id="cb1067-210" data-line-number="210"><span class="co">#&gt;              timestamp          duration training_speed   epochs iterations</span></a>
<a class="sourceLine" id="cb1067-211" data-line-number="211"><span class="co">#&gt; 1  2020-11-19 17:02:50         0.000 sec             NA  0.00000          0</span></a>
<a class="sourceLine" id="cb1067-212" data-line-number="212"><span class="co">#&gt; 2  2020-11-19 17:02:57         6.509 sec  16362 obs/sec  0.28725          1</span></a>
<a class="sourceLine" id="cb1067-213" data-line-number="213"><span class="co">#&gt; 3  2020-11-19 17:03:14        24.109 sec  21320 obs/sec  1.43173          5</span></a>
<a class="sourceLine" id="cb1067-214" data-line-number="214"><span class="co">#&gt; 4  2020-11-19 17:03:27        36.456 sec  22491 obs/sec  2.29147          8</span></a>
<a class="sourceLine" id="cb1067-215" data-line-number="215"><span class="co">#&gt; 5  2020-11-19 17:03:38        47.583 sec  23658 obs/sec  3.14973         11</span></a>
<a class="sourceLine" id="cb1067-216" data-line-number="216"><span class="co">#&gt; 6  2020-11-19 17:03:49        58.366 sec  24533 obs/sec  4.00855         14</span></a>
<a class="sourceLine" id="cb1067-217" data-line-number="217"><span class="co">#&gt; 7  2020-11-19 17:04:00  1 min  9.468 sec  25024 obs/sec  4.86845         17</span></a>
<a class="sourceLine" id="cb1067-218" data-line-number="218"><span class="co">#&gt; 8  2020-11-19 17:04:11  1 min 20.401 sec  25438 obs/sec  5.72897         20</span></a>
<a class="sourceLine" id="cb1067-219" data-line-number="219"><span class="co">#&gt; 9  2020-11-19 17:04:22  1 min 31.340 sec  25750 obs/sec  6.58890         23</span></a>
<a class="sourceLine" id="cb1067-220" data-line-number="220"><span class="co">#&gt; 10 2020-11-19 17:04:33  1 min 42.349 sec  25977 obs/sec  7.45041         26</span></a>
<a class="sourceLine" id="cb1067-221" data-line-number="221"><span class="co">#&gt; 11 2020-11-19 17:04:43  1 min 53.011 sec  26242 obs/sec  8.31112         29</span></a>
<a class="sourceLine" id="cb1067-222" data-line-number="222"><span class="co">#&gt; 12 2020-11-19 17:04:54  2 min  3.814 sec  26430 obs/sec  9.17147         32</span></a>
<a class="sourceLine" id="cb1067-223" data-line-number="223"><span class="co">#&gt; 13 2020-11-19 17:05:04  2 min 14.215 sec  26668 obs/sec 10.03230         35</span></a>
<a class="sourceLine" id="cb1067-224" data-line-number="224"><span class="co">#&gt;           samples training_rmse training_logloss training_r2</span></a>
<a class="sourceLine" id="cb1067-225" data-line-number="225"><span class="co">#&gt; 1        0.000000            NA               NA          NA</span></a>
<a class="sourceLine" id="cb1067-226" data-line-number="226"><span class="co">#&gt; 2   100253.000000       0.42198          0.55542     0.90583</span></a>
<a class="sourceLine" id="cb1067-227" data-line-number="227"><span class="co">#&gt; 3   499696.000000       0.34690          0.38095     0.93636</span></a>
<a class="sourceLine" id="cb1067-228" data-line-number="228"><span class="co">#&gt; 4   799758.000000       0.31864          0.32765     0.94631</span></a>
<a class="sourceLine" id="cb1067-229" data-line-number="229"><span class="co">#&gt; 5  1099303.000000       0.30723          0.30516     0.95008</span></a>
<a class="sourceLine" id="cb1067-230" data-line-number="230"><span class="co">#&gt; 6  1399045.000000       0.28647          0.26619     0.95660</span></a>
<a class="sourceLine" id="cb1067-231" data-line-number="231"><span class="co">#&gt; 7  1699163.000000       0.27851          0.25551     0.95898</span></a>
<a class="sourceLine" id="cb1067-232" data-line-number="232"><span class="co">#&gt; 8  1999495.000000       0.27166          0.23917     0.96097</span></a>
<a class="sourceLine" id="cb1067-233" data-line-number="233"><span class="co">#&gt; 9  2299625.000000       0.26491          0.22980     0.96289</span></a>
<a class="sourceLine" id="cb1067-234" data-line-number="234"><span class="co">#&gt; 10 2600306.000000       0.25753          0.21728     0.96493</span></a>
<a class="sourceLine" id="cb1067-235" data-line-number="235"><span class="co">#&gt; 11 2900706.000000       0.24528          0.19854     0.96819</span></a>
<a class="sourceLine" id="cb1067-236" data-line-number="236"><span class="co">#&gt; 12 3200980.000000       0.24490          0.19669     0.96828</span></a>
<a class="sourceLine" id="cb1067-237" data-line-number="237"><span class="co">#&gt; 13 3501423.000000       0.24083          0.19187     0.96933</span></a>
<a class="sourceLine" id="cb1067-238" data-line-number="238"><span class="co">#&gt;    training_classification_error validation_rmse validation_logloss</span></a>
<a class="sourceLine" id="cb1067-239" data-line-number="239"><span class="co">#&gt; 1                             NA              NA                 NA</span></a>
<a class="sourceLine" id="cb1067-240" data-line-number="240"><span class="co">#&gt; 2                        0.23651         0.42378            0.55630</span></a>
<a class="sourceLine" id="cb1067-241" data-line-number="241"><span class="co">#&gt; 3                        0.16006         0.34660            0.38253</span></a>
<a class="sourceLine" id="cb1067-242" data-line-number="242"><span class="co">#&gt; 4                        0.13438         0.31398            0.31967</span></a>
<a class="sourceLine" id="cb1067-243" data-line-number="243"><span class="co">#&gt; 5                        0.12632         0.31084            0.31282</span></a>
<a class="sourceLine" id="cb1067-244" data-line-number="244"><span class="co">#&gt; 6                        0.11009         0.28738            0.27033</span></a>
<a class="sourceLine" id="cb1067-245" data-line-number="245"><span class="co">#&gt; 7                        0.10143         0.28019            0.25914</span></a>
<a class="sourceLine" id="cb1067-246" data-line-number="246"><span class="co">#&gt; 8                        0.09964         0.27393            0.24381</span></a>
<a class="sourceLine" id="cb1067-247" data-line-number="247"><span class="co">#&gt; 9                        0.09307         0.26910            0.23797</span></a>
<a class="sourceLine" id="cb1067-248" data-line-number="248"><span class="co">#&gt; 10                       0.08979         0.25613            0.21806</span></a>
<a class="sourceLine" id="cb1067-249" data-line-number="249"><span class="co">#&gt; 11                       0.08133         0.25531            0.21445</span></a>
<a class="sourceLine" id="cb1067-250" data-line-number="250"><span class="co">#&gt; 12                       0.07983         0.24977            0.20772</span></a>
<a class="sourceLine" id="cb1067-251" data-line-number="251"><span class="co">#&gt; 13                       0.07744         0.24760            0.20380</span></a>
<a class="sourceLine" id="cb1067-252" data-line-number="252"><span class="co">#&gt;    validation_r2 validation_classification_error</span></a>
<a class="sourceLine" id="cb1067-253" data-line-number="253"><span class="co">#&gt; 1             NA                              NA</span></a>
<a class="sourceLine" id="cb1067-254" data-line-number="254"><span class="co">#&gt; 2        0.90596                         0.24091</span></a>
<a class="sourceLine" id="cb1067-255" data-line-number="255"><span class="co">#&gt; 3        0.93710                         0.15791</span></a>
<a class="sourceLine" id="cb1067-256" data-line-number="256"><span class="co">#&gt; 4        0.94838                         0.13027</span></a>
<a class="sourceLine" id="cb1067-257" data-line-number="257"><span class="co">#&gt; 5        0.94941                         0.12957</span></a>
<a class="sourceLine" id="cb1067-258" data-line-number="258"><span class="co">#&gt; 6        0.95676                         0.10754</span></a>
<a class="sourceLine" id="cb1067-259" data-line-number="259"><span class="co">#&gt; 7        0.95889                         0.10414</span></a>
<a class="sourceLine" id="cb1067-260" data-line-number="260"><span class="co">#&gt; 8        0.96071                         0.10103</span></a>
<a class="sourceLine" id="cb1067-261" data-line-number="261"><span class="co">#&gt; 9        0.96208                         0.09602</span></a>
<a class="sourceLine" id="cb1067-262" data-line-number="262"><span class="co">#&gt; 10       0.96565                         0.08691</span></a>
<a class="sourceLine" id="cb1067-263" data-line-number="263"><span class="co">#&gt; 11       0.96587                         0.08771</span></a>
<a class="sourceLine" id="cb1067-264" data-line-number="264"><span class="co">#&gt; 12       0.96733                         0.08251</span></a>
<a class="sourceLine" id="cb1067-265" data-line-number="265"><span class="co">#&gt; 13       0.96790                         0.08181</span></a>
<a class="sourceLine" id="cb1067-266" data-line-number="266"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-267" data-line-number="267"><span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span></a>
<a class="sourceLine" id="cb1067-268" data-line-number="268"><span class="co">#&gt; =================================================</span></a>
<a class="sourceLine" id="cb1067-269" data-line-number="269"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-270" data-line-number="270"><span class="co">#&gt; Variable Importances: </span></a>
<a class="sourceLine" id="cb1067-271" data-line-number="271"><span class="co">#&gt;                             variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1067-272" data-line-number="272"><span class="co">#&gt; 1 Horizontal_Distance_To_Fire_Points            1.000000          1.000000</span></a>
<a class="sourceLine" id="cb1067-273" data-line-number="273"><span class="co">#&gt; 2                          Elevation            0.998384          0.998384</span></a>
<a class="sourceLine" id="cb1067-274" data-line-number="274"><span class="co">#&gt; 3    Horizontal_Distance_To_Roadways            0.950599          0.950599</span></a>
<a class="sourceLine" id="cb1067-275" data-line-number="275"><span class="co">#&gt; 4             Wilderness_Area.area_0            0.704720          0.704720</span></a>
<a class="sourceLine" id="cb1067-276" data-line-number="276"><span class="co">#&gt; 5             Wilderness_Area.area_2            0.631129          0.631129</span></a>
<a class="sourceLine" id="cb1067-277" data-line-number="277"><span class="co">#&gt;   percentage</span></a>
<a class="sourceLine" id="cb1067-278" data-line-number="278"><span class="co">#&gt; 1   0.047038</span></a>
<a class="sourceLine" id="cb1067-279" data-line-number="279"><span class="co">#&gt; 2   0.046962</span></a>
<a class="sourceLine" id="cb1067-280" data-line-number="280"><span class="co">#&gt; 3   0.044714</span></a>
<a class="sourceLine" id="cb1067-281" data-line-number="281"><span class="co">#&gt; 4   0.033149</span></a>
<a class="sourceLine" id="cb1067-282" data-line-number="282"><span class="co">#&gt; 5   0.029687</span></a>
<a class="sourceLine" id="cb1067-283" data-line-number="283"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1067-284" data-line-number="284"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1067-285" data-line-number="285"><span class="co">#&gt;                       variable relative_importance scaled_importance percentage</span></a>
<a class="sourceLine" id="cb1067-286" data-line-number="286"><span class="co">#&gt; 51           Soil_Type.type_35            0.170274          0.170274   0.008009</span></a>
<a class="sourceLine" id="cb1067-287" data-line-number="287"><span class="co">#&gt; 52            Soil_Type.type_6            0.166735          0.166735   0.007843</span></a>
<a class="sourceLine" id="cb1067-288" data-line-number="288"><span class="co">#&gt; 53            Soil_Type.type_7            0.166344          0.166344   0.007824</span></a>
<a class="sourceLine" id="cb1067-289" data-line-number="289"><span class="co">#&gt; 54           Soil_Type.type_14            0.153097          0.153097   0.007201</span></a>
<a class="sourceLine" id="cb1067-290" data-line-number="290"><span class="co">#&gt; 55       Soil_Type.missing(NA)            0.000000          0.000000   0.000000</span></a>
<a class="sourceLine" id="cb1067-291" data-line-number="291"><span class="co">#&gt; 56 Wilderness_Area.missing(NA)            0.000000          0.000000   0.000000</span></a></code></pre></div>
<p>Let’s compare the training error with the validation and test set errors</p>
<div class="sourceCode" id="cb1068"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, train<span class="op">=</span><span class="cn">T</span><span class="op">)</span>          <span class="co">## sampled training data (from model building)</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on training data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary training frame with 10046 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Training Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.058</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.241</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.192</span>
<span class="co">#&gt; Mean Per-Class Error: 0.138</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3242     388       0       0       4       0      19 0.1125</span>
<span class="co">#&gt; class_2     153    4719       7       0      11      15       2 0.0383</span>
<span class="co">#&gt; class_3       0      16     582       2       3      33       0 0.0849</span>
<span class="co">#&gt; class_4       0       0      10      44       0       4       0 0.2414</span>
<span class="co">#&gt; class_5       3      38       1       0     117       1       0 0.2687</span>
<span class="co">#&gt; class_6       2       9      29       1       0     264       0 0.1344</span>
<span class="co">#&gt; class_7      21       6       0       0       0       0     300 0.0826</span>
<span class="co">#&gt; Totals     3421    5176     629      47     135     317     321 0.0774</span>
<span class="co">#&gt;                   Rate</span>
<span class="co">#&gt; class_1 =  411 / 3,653</span>
<span class="co">#&gt; class_2 =  188 / 4,907</span>
<span class="co">#&gt; class_3 =     54 / 636</span>
<span class="co">#&gt; class_4 =      14 / 58</span>
<span class="co">#&gt; class_5 =     43 / 160</span>
<span class="co">#&gt; class_6 =     41 / 305</span>
<span class="co">#&gt; class_7 =     27 / 327</span>
<span class="co">#&gt; Totals  = 778 / 10,046</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.922556</span>
<span class="co">#&gt; 2 2  0.996416</span>
<span class="co">#&gt; 3 3  0.999801</span>
<span class="co">#&gt; 4 4  1.000000</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span>          <span class="co">## sampled validation data (from model building)</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 9987 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0613</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.248</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.204</span>
<span class="co">#&gt; Mean Per-Class Error: 0.13</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3252     367       0       0       1       1      21 0.1071</span>
<span class="co">#&gt; class_2     186    4668      13       0      21      14       1 0.0479</span>
<span class="co">#&gt; class_3       0      23     534       3       1      38       0 0.1085</span>
<span class="co">#&gt; class_4       0       0       4      42       0       0       0 0.0870</span>
<span class="co">#&gt; class_5       1      50       1       0     106       2       0 0.3375</span>
<span class="co">#&gt; class_6       0      11      27       2       1     259       0 0.1367</span>
<span class="co">#&gt; class_7      26       2       0       0       0       0     309 0.0831</span>
<span class="co">#&gt; Totals     3465    5121     579      47     130     314     331 0.0818</span>
<span class="co">#&gt;                  Rate</span>
<span class="co">#&gt; class_1 = 390 / 3,642</span>
<span class="co">#&gt; class_2 = 235 / 4,903</span>
<span class="co">#&gt; class_3 =    65 / 599</span>
<span class="co">#&gt; class_4 =      4 / 46</span>
<span class="co">#&gt; class_5 =    54 / 160</span>
<span class="co">#&gt; class_6 =    41 / 300</span>
<span class="co">#&gt; class_7 =    28 / 337</span>
<span class="co">#&gt; Totals  = 817 / 9,987</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.918194</span>
<span class="co">#&gt; 2 2  0.996295</span>
<span class="co">#&gt; 3 3  0.999700</span>
<span class="co">#&gt; 4 4  1.000000</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, newdata<span class="op">=</span><span class="va">train</span><span class="op">)</span>    <span class="co">## full training data</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0558</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.236</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.184</span>
<span class="co">#&gt; Mean Per-Class Error: 0.133</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;, &lt;data&gt;)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1  114056   12279       0       0      81      19     685 0.1028</span>
<span class="co">#&gt; class_2    5766  163330     254       1     493     443      55 0.0412</span>
<span class="co">#&gt; class_3       2     502   19648     103      87    1100       0 0.0837</span>
<span class="co">#&gt; class_4       0       2     291    1283       0      82       0 0.2262</span>
<span class="co">#&gt; class_5      81    1377      73       0    4161      28       0 0.2726</span>
<span class="co">#&gt; class_6      29     280     912      43      12    9157       0 0.1223</span>
<span class="co">#&gt; class_7     846     207       0       0       2       0   11245 0.0858</span>
<span class="co">#&gt; Totals   120780  177977   21178    1430    4836   10829   11985 0.0749</span>
<span class="co">#&gt;                       Rate</span>
<span class="co">#&gt; class_1 = 13,064 / 127,120</span>
<span class="co">#&gt; class_2 =  7,012 / 170,342</span>
<span class="co">#&gt; class_3 =   1,794 / 21,442</span>
<span class="co">#&gt; class_4 =      375 / 1,658</span>
<span class="co">#&gt; class_5 =    1,559 / 5,720</span>
<span class="co">#&gt; class_6 =   1,276 / 10,433</span>
<span class="co">#&gt; class_7 =   1,055 / 12,300</span>
<span class="co">#&gt; Totals  = 26,135 / 349,015</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;, &lt;data&gt;)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.925118</span>
<span class="co">#&gt; 2 2  0.997023</span>
<span class="co">#&gt; 3 3  0.999791</span>
<span class="co">#&gt; 4 4  0.999966</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, newdata<span class="op">=</span><span class="va">valid</span><span class="op">)</span>    <span class="co">## full validation data</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.062</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.249</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.206</span>
<span class="co">#&gt; Mean Per-Class Error: 0.148</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;, &lt;data&gt;)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1   37803    4425       0       0      21       8     243 0.1105</span>
<span class="co">#&gt; class_2    2253   53632     101       0     196     176      22 0.0487</span>
<span class="co">#&gt; class_3       4     187    6482      47      27     396       0 0.0925</span>
<span class="co">#&gt; class_4       0       1     103     424       0      34       0 0.2456</span>
<span class="co">#&gt; class_5      36     500      32       0    1291      11       0 0.3096</span>
<span class="co">#&gt; class_6      14     124     313      21      10    2982       0 0.1391</span>
<span class="co">#&gt; class_7     303      62       0       0       1       0    3733 0.0893</span>
<span class="co">#&gt; Totals    40413   58931    7031     492    1546    3607    3998 0.0834</span>
<span class="co">#&gt;                      Rate</span>
<span class="co">#&gt; class_1 =  4,697 / 42,500</span>
<span class="co">#&gt; class_2 =  2,748 / 56,380</span>
<span class="co">#&gt; class_3 =     661 / 7,143</span>
<span class="co">#&gt; class_4 =       138 / 562</span>
<span class="co">#&gt; class_5 =     579 / 1,870</span>
<span class="co">#&gt; class_6 =     482 / 3,464</span>
<span class="co">#&gt; class_7 =     366 / 4,099</span>
<span class="co">#&gt; Totals  = 9,671 / 116,018</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;, &lt;data&gt;)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.916642</span>
<span class="co">#&gt; 2 2  0.996018</span>
<span class="co">#&gt; 3 3  0.999655</span>
<span class="co">#&gt; 4 4  0.999966</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, newdata<span class="op">=</span><span class="va">test</span><span class="op">)</span>     <span class="co">## full test data</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0614</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.248</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.204</span>
<span class="co">#&gt; Mean Per-Class Error: 0.142</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;, &lt;data&gt;)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1   37707    4237       0       0      33       1     242 0.1069</span>
<span class="co">#&gt; class_2    2201   53848     109       1     196     195      29 0.0483</span>
<span class="co">#&gt; class_3       3     221    6483      45      24     393       0 0.0957</span>
<span class="co">#&gt; class_4       0       2      83     420       0      22       0 0.2030</span>
<span class="co">#&gt; class_5      35     498      23       0    1334      13       0 0.2990</span>
<span class="co">#&gt; class_6      18     117     325      19       9    2982       0 0.1406</span>
<span class="co">#&gt; class_7     342      68       0       0       0       0    3701 0.0997</span>
<span class="co">#&gt; Totals    40306   58991    7023     485    1596    3606    3972 0.0819</span>
<span class="co">#&gt;                      Rate</span>
<span class="co">#&gt; class_1 =  4,513 / 42,220</span>
<span class="co">#&gt; class_2 =  2,731 / 56,579</span>
<span class="co">#&gt; class_3 =     686 / 7,169</span>
<span class="co">#&gt; class_4 =       107 / 527</span>
<span class="co">#&gt; class_5 =     569 / 1,903</span>
<span class="co">#&gt; class_6 =     488 / 3,470</span>
<span class="co">#&gt; class_7 =     410 / 4,111</span>
<span class="co">#&gt; Totals  = 9,504 / 115,979</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;, &lt;data&gt;)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.918054</span>
<span class="co">#&gt; 2 2  0.995904</span>
<span class="co">#&gt; 3 3  0.999646</span>
<span class="co">#&gt; 4 4  0.999957</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span></code></pre></div>
<p>To confirm that the reported confusion matrix on the validation set (here, the test set) was correct, we make a prediction on the test set and compare the confusion matrices explicitly:</p>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1069-1" data-line-number="1">pred &lt;-<span class="st"> </span><span class="kw">h2o.predict</span>(m3, test)</a>
<a class="sourceLine" id="cb1069-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1069-3" data-line-number="3">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1069-4" data-line-number="4"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1069-5" data-line-number="5">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1069-6" data-line-number="6"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1069-7" data-line-number="7">pred</a>
<a class="sourceLine" id="cb1069-8" data-line-number="8"><span class="co">#&gt;   predict  class_1  class_2  class_3  class_4  class_5  class_6  class_7</span></a>
<a class="sourceLine" id="cb1069-9" data-line-number="9"><span class="co">#&gt; 1 class_2 7.27e-03 9.93e-01 2.33e-05 8.08e-07 2.11e-09 6.57e-08 1.05e-06</span></a>
<a class="sourceLine" id="cb1069-10" data-line-number="10"><span class="co">#&gt; 2 class_1 9.88e-01 1.17e-02 4.88e-04 8.67e-06 1.53e-06 6.37e-08 1.48e-05</span></a>
<a class="sourceLine" id="cb1069-11" data-line-number="11"><span class="co">#&gt; 3 class_1 1.00e+00 2.26e-06 2.42e-08 3.94e-11 1.75e-12 1.03e-15 2.09e-09</span></a>
<a class="sourceLine" id="cb1069-12" data-line-number="12"><span class="co">#&gt; 4 class_1 9.99e-01 9.29e-04 2.83e-07 2.47e-09 2.68e-10 1.50e-07 2.48e-05</span></a>
<a class="sourceLine" id="cb1069-13" data-line-number="13"><span class="co">#&gt; 5 class_2 9.22e-03 9.90e-01 5.27e-07 3.11e-05 3.57e-04 2.46e-06 2.54e-06</span></a>
<a class="sourceLine" id="cb1069-14" data-line-number="14"><span class="co">#&gt; 6 class_5 1.08e-05 2.45e-01 2.93e-07 4.84e-12 7.55e-01 7.15e-08 9.65e-11</span></a>
<a class="sourceLine" id="cb1069-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1069-16" data-line-number="16"><span class="co">#&gt; [115979 rows x 8 columns]</span></a>
<a class="sourceLine" id="cb1069-17" data-line-number="17">test<span class="op">$</span>Accuracy &lt;-<span class="st"> </span>pred<span class="op">$</span>predict <span class="op">==</span><span class="st"> </span>test<span class="op">$</span>Cover_Type</a>
<a class="sourceLine" id="cb1069-18" data-line-number="18"><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(test<span class="op">$</span>Accuracy)</a>
<a class="sourceLine" id="cb1069-19" data-line-number="19"><span class="co">#&gt; [1] 0.0819</span></a></code></pre></div>
</div>
<div id="hyper-parameter-tuning-with-grid-search" class="section level3">
<h3>
<span class="header-section-number">46.5.6</span> Hyper-parameter Tuning with Grid Search<a class="anchor" aria-label="anchor" href="#hyper-parameter-tuning-with-grid-search"><i class="fas fa-link"></i></a>
</h3>
<p>Since there are a lot of parameters that can impact model accuracy, hyper-parameter tuning is especially important for Deep Learning:</p>
<p>For speed, we will only train on the first 10,000 rows of the training dataset:</p>
<div class="sourceCode" id="cb1070"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sampled_train</span><span class="op">=</span><span class="va">train</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10000</span>,<span class="op">]</span></code></pre></div>
<p>The simplest hyperparameter search method is a brute-force scan of the full Cartesian product of all combinations specified by a grid search:</p>
<div class="sourceCode" id="cb1071"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1071-1" data-line-number="1">hyper_params &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb1071-2" data-line-number="2">  <span class="dt">hidden=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">32</span>),<span class="kw">c</span>(<span class="dv">64</span>,<span class="dv">64</span>)),</a>
<a class="sourceLine" id="cb1071-3" data-line-number="3">  <span class="dt">input_dropout_ratio=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>),</a>
<a class="sourceLine" id="cb1071-4" data-line-number="4">  <span class="dt">rate=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.02</span>),</a>
<a class="sourceLine" id="cb1071-5" data-line-number="5">  <span class="dt">rate_annealing=</span><span class="kw">c</span>(<span class="fl">1e-8</span>,<span class="fl">1e-7</span>,<span class="fl">1e-6</span>)</a>
<a class="sourceLine" id="cb1071-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb1071-7" data-line-number="7">hyper_params</a>
<a class="sourceLine" id="cb1071-8" data-line-number="8"><span class="co">#&gt; $hidden</span></a>
<a class="sourceLine" id="cb1071-9" data-line-number="9"><span class="co">#&gt; $hidden[[1]]</span></a>
<a class="sourceLine" id="cb1071-10" data-line-number="10"><span class="co">#&gt; [1] 32 32 32</span></a>
<a class="sourceLine" id="cb1071-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-12" data-line-number="12"><span class="co">#&gt; $hidden[[2]]</span></a>
<a class="sourceLine" id="cb1071-13" data-line-number="13"><span class="co">#&gt; [1] 64 64</span></a>
<a class="sourceLine" id="cb1071-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-16" data-line-number="16"><span class="co">#&gt; $input_dropout_ratio</span></a>
<a class="sourceLine" id="cb1071-17" data-line-number="17"><span class="co">#&gt; [1] 0.00 0.05</span></a>
<a class="sourceLine" id="cb1071-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-19" data-line-number="19"><span class="co">#&gt; $rate</span></a>
<a class="sourceLine" id="cb1071-20" data-line-number="20"><span class="co">#&gt; [1] 0.01 0.02</span></a>
<a class="sourceLine" id="cb1071-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-22" data-line-number="22"><span class="co">#&gt; $rate_annealing</span></a>
<a class="sourceLine" id="cb1071-23" data-line-number="23"><span class="co">#&gt; [1] 1e-08 1e-07 1e-06</span></a>
<a class="sourceLine" id="cb1071-24" data-line-number="24">grid &lt;-<span class="st"> </span><span class="kw">h2o.grid</span>(</a>
<a class="sourceLine" id="cb1071-25" data-line-number="25">  <span class="dt">algorithm=</span><span class="st">"deeplearning"</span>,</a>
<a class="sourceLine" id="cb1071-26" data-line-number="26">  <span class="dt">grid_id=</span><span class="st">"dl_grid"</span>, </a>
<a class="sourceLine" id="cb1071-27" data-line-number="27">  <span class="dt">training_frame=</span>sampled_train,</a>
<a class="sourceLine" id="cb1071-28" data-line-number="28">  <span class="dt">validation_frame=</span>valid, </a>
<a class="sourceLine" id="cb1071-29" data-line-number="29">  <span class="dt">x=</span>predictors, </a>
<a class="sourceLine" id="cb1071-30" data-line-number="30">  <span class="dt">y=</span>response,</a>
<a class="sourceLine" id="cb1071-31" data-line-number="31">  <span class="dt">epochs=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1071-32" data-line-number="32">  <span class="dt">stopping_metric=</span><span class="st">"misclassification"</span>,</a>
<a class="sourceLine" id="cb1071-33" data-line-number="33">  <span class="dt">stopping_tolerance=</span><span class="fl">1e-2</span>,        <span class="co">## stop when misclassification does not improve by &gt;=1% for 2 scoring events</span></a>
<a class="sourceLine" id="cb1071-34" data-line-number="34">  <span class="dt">stopping_rounds=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1071-35" data-line-number="35">  <span class="dt">score_validation_samples=</span><span class="dv">10000</span>, <span class="co">## downsample validation set for faster scoring</span></a>
<a class="sourceLine" id="cb1071-36" data-line-number="36">  <span class="dt">score_duty_cycle=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span></a>
<a class="sourceLine" id="cb1071-37" data-line-number="37">  <span class="dt">adaptive_rate=</span>F,                <span class="co">## manually tuned learning rate</span></a>
<a class="sourceLine" id="cb1071-38" data-line-number="38">  <span class="dt">momentum_start=</span><span class="fl">0.5</span>,             <span class="co">## manually tuned momentum</span></a>
<a class="sourceLine" id="cb1071-39" data-line-number="39">  <span class="dt">momentum_stable=</span><span class="fl">0.9</span>, </a>
<a class="sourceLine" id="cb1071-40" data-line-number="40">  <span class="dt">momentum_ramp=</span><span class="fl">1e7</span>, </a>
<a class="sourceLine" id="cb1071-41" data-line-number="41">  <span class="dt">l1=</span><span class="fl">1e-5</span>,</a>
<a class="sourceLine" id="cb1071-42" data-line-number="42">  <span class="dt">l2=</span><span class="fl">1e-5</span>,</a>
<a class="sourceLine" id="cb1071-43" data-line-number="43">  <span class="dt">activation=</span><span class="kw">c</span>(<span class="st">"Rectifier"</span>),</a>
<a class="sourceLine" id="cb1071-44" data-line-number="44">  <span class="dt">max_w2=</span><span class="dv">10</span>,                      <span class="co">## can help improve stability for Rectifier</span></a>
<a class="sourceLine" id="cb1071-45" data-line-number="45">  <span class="dt">hyper_params=</span>hyper_params</a>
<a class="sourceLine" id="cb1071-46" data-line-number="46">)</a>
<a class="sourceLine" id="cb1071-47" data-line-number="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-48" data-line-number="48">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1071-49" data-line-number="49"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1071-50" data-line-number="50">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1071-51" data-line-number="51"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1071-52" data-line-number="52">grid</a>
<a class="sourceLine" id="cb1071-53" data-line-number="53"><span class="co">#&gt; H2O Grid Details</span></a>
<a class="sourceLine" id="cb1071-54" data-line-number="54"><span class="co">#&gt; ================</span></a>
<a class="sourceLine" id="cb1071-55" data-line-number="55"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-56" data-line-number="56"><span class="co">#&gt; Grid ID: dl_grid </span></a>
<a class="sourceLine" id="cb1071-57" data-line-number="57"><span class="co">#&gt; Used hyper parameters: </span></a>
<a class="sourceLine" id="cb1071-58" data-line-number="58"><span class="co">#&gt;   -  hidden </span></a>
<a class="sourceLine" id="cb1071-59" data-line-number="59"><span class="co">#&gt;   -  input_dropout_ratio </span></a>
<a class="sourceLine" id="cb1071-60" data-line-number="60"><span class="co">#&gt;   -  rate </span></a>
<a class="sourceLine" id="cb1071-61" data-line-number="61"><span class="co">#&gt;   -  rate_annealing </span></a>
<a class="sourceLine" id="cb1071-62" data-line-number="62"><span class="co">#&gt; Number of models: 24 </span></a>
<a class="sourceLine" id="cb1071-63" data-line-number="63"><span class="co">#&gt; Number of failed models: 0 </span></a>
<a class="sourceLine" id="cb1071-64" data-line-number="64"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-65" data-line-number="65"><span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing logloss</span></a>
<a class="sourceLine" id="cb1071-66" data-line-number="66"><span class="co">#&gt;     hidden input_dropout_ratio rate rate_annealing        model_ids</span></a>
<a class="sourceLine" id="cb1071-67" data-line-number="67"><span class="co">#&gt; 1 [64, 64]                 0.0 0.01         1.0E-6 dl_grid_model_18</span></a>
<a class="sourceLine" id="cb1071-68" data-line-number="68"><span class="co">#&gt; 2 [64, 64]                 0.0 0.02         1.0E-7 dl_grid_model_14</span></a>
<a class="sourceLine" id="cb1071-69" data-line-number="69"><span class="co">#&gt; 3 [64, 64]                0.05 0.02         1.0E-8  dl_grid_model_8</span></a>
<a class="sourceLine" id="cb1071-70" data-line-number="70"><span class="co">#&gt; 4 [64, 64]                 0.0 0.01         1.0E-8  dl_grid_model_2</span></a>
<a class="sourceLine" id="cb1071-71" data-line-number="71"><span class="co">#&gt; 5 [64, 64]                 0.0 0.01         1.0E-7 dl_grid_model_10</span></a>
<a class="sourceLine" id="cb1071-72" data-line-number="72"><span class="co">#&gt;              logloss</span></a>
<a class="sourceLine" id="cb1071-73" data-line-number="73"><span class="co">#&gt; 1 0.5752616014450749</span></a>
<a class="sourceLine" id="cb1071-74" data-line-number="74"><span class="co">#&gt; 2 0.5822385673335893</span></a>
<a class="sourceLine" id="cb1071-75" data-line-number="75"><span class="co">#&gt; 3 0.5865198619025026</span></a>
<a class="sourceLine" id="cb1071-76" data-line-number="76"><span class="co">#&gt; 4  0.587039374219784</span></a>
<a class="sourceLine" id="cb1071-77" data-line-number="77"><span class="co">#&gt; 5 0.5893683990958317</span></a>
<a class="sourceLine" id="cb1071-78" data-line-number="78"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1071-79" data-line-number="79"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1071-80" data-line-number="80"><span class="co">#&gt;          hidden input_dropout_ratio rate rate_annealing        model_ids</span></a>
<a class="sourceLine" id="cb1071-81" data-line-number="81"><span class="co">#&gt; 19 [32, 32, 32]                0.05 0.01         1.0E-8  dl_grid_model_3</span></a>
<a class="sourceLine" id="cb1071-82" data-line-number="82"><span class="co">#&gt; 20 [32, 32, 32]                0.05 0.02         1.0E-8  dl_grid_model_7</span></a>
<a class="sourceLine" id="cb1071-83" data-line-number="83"><span class="co">#&gt; 21     [64, 64]                0.05 0.02         1.0E-7 dl_grid_model_16</span></a>
<a class="sourceLine" id="cb1071-84" data-line-number="84"><span class="co">#&gt; 22 [32, 32, 32]                 0.0 0.01         1.0E-8  dl_grid_model_1</span></a>
<a class="sourceLine" id="cb1071-85" data-line-number="85"><span class="co">#&gt; 23     [64, 64]                 0.0 0.02         1.0E-6 dl_grid_model_22</span></a>
<a class="sourceLine" id="cb1071-86" data-line-number="86"><span class="co">#&gt; 24 [32, 32, 32]                 0.0 0.02         1.0E-8  dl_grid_model_5</span></a>
<a class="sourceLine" id="cb1071-87" data-line-number="87"><span class="co">#&gt;               logloss</span></a>
<a class="sourceLine" id="cb1071-88" data-line-number="88"><span class="co">#&gt; 19 0.6226862967924188</span></a>
<a class="sourceLine" id="cb1071-89" data-line-number="89"><span class="co">#&gt; 20 0.6367414787844445</span></a>
<a class="sourceLine" id="cb1071-90" data-line-number="90"><span class="co">#&gt; 21  0.640207068426954</span></a>
<a class="sourceLine" id="cb1071-91" data-line-number="91"><span class="co">#&gt; 22 0.6454103117486254</span></a>
<a class="sourceLine" id="cb1071-92" data-line-number="92"><span class="co">#&gt; 23 0.6474635129176143</span></a>
<a class="sourceLine" id="cb1071-93" data-line-number="93"><span class="co">#&gt; 24 0.6964901055866498</span></a></code></pre></div>
<p>Let’s see which model had the lowest validation error:</p>
<div class="sourceCode" id="cb1072"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid"</span>,sort_by<span class="op">=</span><span class="st">"err"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">grid</span>
<span class="co">#&gt; H2O Grid Details</span>
<span class="co">#&gt; ================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Grid ID: dl_grid </span>
<span class="co">#&gt; Used hyper parameters: </span>
<span class="co">#&gt;   -  hidden </span>
<span class="co">#&gt;   -  input_dropout_ratio </span>
<span class="co">#&gt;   -  rate </span>
<span class="co">#&gt;   -  rate_annealing </span>
<span class="co">#&gt; Number of models: 24 </span>
<span class="co">#&gt; Number of failed models: 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing err</span>
<span class="co">#&gt;     hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 1 [64, 64]                 0.0 0.02         1.0E-7 dl_grid_model_14</span>
<span class="co">#&gt; 2 [64, 64]                 0.0 0.01         1.0E-6 dl_grid_model_18</span>
<span class="co">#&gt; 3 [64, 64]                0.05 0.02         1.0E-8  dl_grid_model_8</span>
<span class="co">#&gt; 4 [64, 64]                0.05 0.01         1.0E-6 dl_grid_model_20</span>
<span class="co">#&gt; 5 [64, 64]                0.05 0.01         1.0E-7 dl_grid_model_12</span>
<span class="co">#&gt;                   err</span>
<span class="co">#&gt; 1 0.24599622003382074</span>
<span class="co">#&gt; 2   0.251044776119403</span>
<span class="co">#&gt; 3 0.25198034693672916</span>
<span class="co">#&gt; 4  0.2523719165085389</span>
<span class="co">#&gt; 5  0.2527450588939908</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;          hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 19 [32, 32, 32]                 0.0 0.01         1.0E-8  dl_grid_model_1</span>
<span class="co">#&gt; 20 [32, 32, 32]                0.05 0.01         1.0E-8  dl_grid_model_3</span>
<span class="co">#&gt; 21 [32, 32, 32]                 0.0 0.01         1.0E-7  dl_grid_model_9</span>
<span class="co">#&gt; 22     [64, 64]                0.05 0.02         1.0E-7 dl_grid_model_16</span>
<span class="co">#&gt; 23 [32, 32, 32]                 0.0 0.02         1.0E-8  dl_grid_model_5</span>
<span class="co">#&gt; 24     [64, 64]                 0.0 0.02         1.0E-6 dl_grid_model_22</span>
<span class="co">#&gt;                    err</span>
<span class="co">#&gt; 19  0.2688580277750025</span>
<span class="co">#&gt; 20  0.2723160434258142</span>
<span class="co">#&gt; 21  0.2741464397220264</span>
<span class="co">#&gt; 22  0.2770331552957775</span>
<span class="co">#&gt; 23  0.2811588371391208</span>
<span class="co">#&gt; 24 0.28602728811871325</span>

<span class="co">## To see what other "sort_by" criteria are allowed</span>
<span class="co">#grid &lt;- h2o.getGrid("dl_grid",sort_by="wrong_thing",decreasing=FALSE)</span>

<span class="co">## Sort by logloss</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid"</span>,sort_by<span class="op">=</span><span class="st">"logloss"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; H2O Grid Details</span>
<span class="co">#&gt; ================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Grid ID: dl_grid </span>
<span class="co">#&gt; Used hyper parameters: </span>
<span class="co">#&gt;   -  hidden </span>
<span class="co">#&gt;   -  input_dropout_ratio </span>
<span class="co">#&gt;   -  rate </span>
<span class="co">#&gt;   -  rate_annealing </span>
<span class="co">#&gt; Number of models: 24 </span>
<span class="co">#&gt; Number of failed models: 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing logloss</span>
<span class="co">#&gt;     hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 1 [64, 64]                 0.0 0.01         1.0E-6 dl_grid_model_18</span>
<span class="co">#&gt; 2 [64, 64]                 0.0 0.02         1.0E-7 dl_grid_model_14</span>
<span class="co">#&gt; 3 [64, 64]                0.05 0.02         1.0E-8  dl_grid_model_8</span>
<span class="co">#&gt; 4 [64, 64]                 0.0 0.01         1.0E-8  dl_grid_model_2</span>
<span class="co">#&gt; 5 [64, 64]                 0.0 0.01         1.0E-7 dl_grid_model_10</span>
<span class="co">#&gt;              logloss</span>
<span class="co">#&gt; 1 0.5752616014450749</span>
<span class="co">#&gt; 2 0.5822385673335893</span>
<span class="co">#&gt; 3 0.5865198619025026</span>
<span class="co">#&gt; 4  0.587039374219784</span>
<span class="co">#&gt; 5 0.5893683990958317</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;          hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 19 [32, 32, 32]                0.05 0.01         1.0E-8  dl_grid_model_3</span>
<span class="co">#&gt; 20 [32, 32, 32]                0.05 0.02         1.0E-8  dl_grid_model_7</span>
<span class="co">#&gt; 21     [64, 64]                0.05 0.02         1.0E-7 dl_grid_model_16</span>
<span class="co">#&gt; 22 [32, 32, 32]                 0.0 0.01         1.0E-8  dl_grid_model_1</span>
<span class="co">#&gt; 23     [64, 64]                 0.0 0.02         1.0E-6 dl_grid_model_22</span>
<span class="co">#&gt; 24 [32, 32, 32]                 0.0 0.02         1.0E-8  dl_grid_model_5</span>
<span class="co">#&gt;               logloss</span>
<span class="co">#&gt; 19 0.6226862967924188</span>
<span class="co">#&gt; 20 0.6367414787844445</span>
<span class="co">#&gt; 21  0.640207068426954</span>
<span class="co">#&gt; 22 0.6454103117486254</span>
<span class="co">#&gt; 23 0.6474635129176143</span>
<span class="co">#&gt; 24 0.6964901055866498</span>

<span class="co">## Find the best model and its full set of parameters</span>
<span class="va">grid</span><span class="op">@</span><span class="va">summary_table</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>
<span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing err</span>
<span class="co">#&gt;     hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 1 [64, 64]                 0.0 0.02         1.0E-7 dl_grid_model_14</span>
<span class="co">#&gt;                   err</span>
<span class="co">#&gt; 1 0.24599622003382074</span>
<span class="va">best_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getModel.html">h2o.getModel</a></span><span class="op">(</span><span class="va">grid</span><span class="op">@</span><span class="va">model_ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">best_model</span>
<span class="co">#&gt; Model Details:</span>
<span class="co">#&gt; ==============</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialModel: deeplearning</span>
<span class="co">#&gt; Model ID:  dl_grid_model_14 </span>
<span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 8,263 weights/biases, 72.2 KB, 100,000 training samples, mini-batch size 1</span>
<span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span>
<span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span>
<span class="co">#&gt; 2     2    64 Rectifier  0.00 % 0.000010 0.000010  0.019802 0.000000 0.504000</span>
<span class="co">#&gt; 3     3    64 Rectifier  0.00 % 0.000010 0.000010  0.019802 0.000000 0.504000</span>
<span class="co">#&gt; 4     4     7   Softmax      NA 0.000010 0.000010  0.019802 0.000000 0.504000</span>
<span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span>
<span class="co">#&gt; 1          NA         NA        NA       NA</span>
<span class="co">#&gt; 2   -0.022691   0.283640 -0.127061 0.223853</span>
<span class="co">#&gt; 3   -0.098396   0.225294  0.687686 0.247513</span>
<span class="co">#&gt; 4   -0.020195   0.389496  0.019155 1.234079</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on training data. **</span>
<span class="co">#&gt; ** Metrics reported on full training frame **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Training Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Extract training frame with `h2o.getFrame("RTMP_sid_a2b5_9")`</span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.165</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.407</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.512</span>
<span class="co">#&gt; Mean Per-Class Error: 0.473</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2632     975       1       0       0       3      77 0.2863</span>
<span class="co">#&gt; class_2     457    4273      74       0      19       5       7 0.1162</span>
<span class="co">#&gt; class_3       0      39     586       0       1       4       0 0.0698</span>
<span class="co">#&gt; class_4       0       1      43       0       0       0       0 1.0000</span>
<span class="co">#&gt; class_5      18      93       6       0      38       1       0 0.7564</span>
<span class="co">#&gt; class_6       0      95     171       0       0      43       0 0.8608</span>
<span class="co">#&gt; class_7      70       3       0       0       1       0     264 0.2189</span>
<span class="co">#&gt; Totals     3177    5479     881       0      59      56     348 0.2164</span>
<span class="co">#&gt;                     Rate</span>
<span class="co">#&gt; class_1 =  1,056 / 3,688</span>
<span class="co">#&gt; class_2 =    562 / 4,835</span>
<span class="co">#&gt; class_3 =       44 / 630</span>
<span class="co">#&gt; class_4 =        44 / 44</span>
<span class="co">#&gt; class_5 =      118 / 156</span>
<span class="co">#&gt; class_6 =      266 / 309</span>
<span class="co">#&gt; class_7 =       74 / 338</span>
<span class="co">#&gt; Totals  = 2,164 / 10,000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.783600</span>
<span class="co">#&gt; 2 2  0.977300</span>
<span class="co">#&gt; 3 3  0.997300</span>
<span class="co">#&gt; 4 4  0.999400</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 10053 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.185</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.43</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.582</span>
<span class="co">#&gt; Mean Per-Class Error: 0.521</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2505    1119       0       0       0       0      87 0.3250</span>
<span class="co">#&gt; class_2     529    4251      83       0      23      14       5 0.1333</span>
<span class="co">#&gt; class_3       0      61     524       0       0       2       0 0.1073</span>
<span class="co">#&gt; class_4       0       0      52       1       0       0       0 0.9811</span>
<span class="co">#&gt; class_5      15     116       6       0      16       1       0 0.8961</span>
<span class="co">#&gt; class_6       0      88     170       0       0      20       0 0.9281</span>
<span class="co">#&gt; class_7      98       4       0       0       0       0     263 0.2795</span>
<span class="co">#&gt; Totals     3147    5639     835       1      39      37     355 0.2460</span>
<span class="co">#&gt;                     Rate</span>
<span class="co">#&gt; class_1 =  1,206 / 3,711</span>
<span class="co">#&gt; class_2 =    654 / 4,905</span>
<span class="co">#&gt; class_3 =       63 / 587</span>
<span class="co">#&gt; class_4 =        52 / 53</span>
<span class="co">#&gt; class_5 =      138 / 154</span>
<span class="co">#&gt; class_6 =      258 / 278</span>
<span class="co">#&gt; class_7 =      102 / 365</span>
<span class="co">#&gt; Totals  = 2,473 / 10,053</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.754004</span>
<span class="co">#&gt; 2 2  0.969661</span>
<span class="co">#&gt; 3 3  0.994927</span>
<span class="co">#&gt; 4 4  0.998906</span>
<span class="co">#&gt; 5 5  0.999702</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>

<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">best_model</span><span class="op">@</span><span class="va">allparameters</span><span class="op">)</span>
<span class="co">#&gt; $model_id</span>
<span class="co">#&gt; [1] "dl_grid_model_14"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $training_frame</span>
<span class="co">#&gt; [1] "RTMP_sid_a2b5_9"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $validation_frame</span>
<span class="co">#&gt; [1] "valid.hex"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nfolds</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $keep_cross_validation_models</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $keep_cross_validation_predictions</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $keep_cross_validation_fold_assignment</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fold_assignment</span>
<span class="co">#&gt; [1] "AUTO"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ignore_const_cols</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_each_iteration</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $balance_classes</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_after_balance_size</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_confusion_matrix_size</span>
<span class="co">#&gt; [1] 20</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_hit_ratio_k</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $overwrite_with_best_model</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $use_all_factor_levels</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $standardize</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $activation</span>
<span class="co">#&gt; [1] "Rectifier"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $hidden</span>
<span class="co">#&gt; [1] 64 64</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $epochs</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $train_samples_per_iteration</span>
<span class="co">#&gt; [1] -2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $target_ratio_comm_to_comp</span>
<span class="co">#&gt; [1] 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $seed</span>
<span class="co">#&gt; [1] "6706057352732606115"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $adaptive_rate</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rho</span>
<span class="co">#&gt; [1] 0.99</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $epsilon</span>
<span class="co">#&gt; [1] 1e-08</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rate</span>
<span class="co">#&gt; [1] 0.02</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rate_annealing</span>
<span class="co">#&gt; [1] 1e-07</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rate_decay</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $momentum_start</span>
<span class="co">#&gt; [1] 0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $momentum_ramp</span>
<span class="co">#&gt; [1] 1e+07</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $momentum_stable</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nesterov_accelerated_gradient</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $input_dropout_ratio</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $l1</span>
<span class="co">#&gt; [1] 1e-05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $l2</span>
<span class="co">#&gt; [1] 1e-05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_w2</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $initial_weight_distribution</span>
<span class="co">#&gt; [1] "UniformAdaptive"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $initial_weight_scale</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $loss</span>
<span class="co">#&gt; [1] "Automatic"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $distribution</span>
<span class="co">#&gt; [1] "AUTO"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $quantile_alpha</span>
<span class="co">#&gt; [1] 0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tweedie_power</span>
<span class="co">#&gt; [1] 1.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $huber_alpha</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_interval</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_training_samples</span>
<span class="co">#&gt; [1] 10000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_validation_samples</span>
<span class="co">#&gt; [1] 10000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_duty_cycle</span>
<span class="co">#&gt; [1] 0.025</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $classification_stop</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $regression_stop</span>
<span class="co">#&gt; [1] 1e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stopping_rounds</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stopping_metric</span>
<span class="co">#&gt; [1] "misclassification"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stopping_tolerance</span>
<span class="co">#&gt; [1] 0.01</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_runtime_secs</span>
<span class="co">#&gt; [1] 1.8e+308</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_validation_sampling</span>
<span class="co">#&gt; [1] "Uniform"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $diagnostics</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fast_mode</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $force_load_balance</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $variable_importances</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $replicate_training_data</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $single_node_mode</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $shuffle_training_data</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $missing_values_handling</span>
<span class="co">#&gt; [1] "MeanImputation"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $quiet_mode</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $autoencoder</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sparse</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $col_major</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $average_activation</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sparsity_beta</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_categorical_features</span>
<span class="co">#&gt; [1] 2147483647</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $reproducible</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $export_weights_and_biases</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mini_batch_size</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $categorical_encoding</span>
<span class="co">#&gt; [1] "AUTO"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $elastic_averaging</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $elastic_averaging_moving_rate</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $elastic_averaging_regularization</span>
<span class="co">#&gt; [1] 0.001</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt;  [1] "Soil_Type"                          "Wilderness_Area"                   </span>
<span class="co">#&gt;  [3] "Elevation"                          "Aspect"                            </span>
<span class="co">#&gt;  [5] "Slope"                              "Horizontal_Distance_To_Hydrology"  </span>
<span class="co">#&gt;  [7] "Vertical_Distance_To_Hydrology"     "Horizontal_Distance_To_Roadways"   </span>
<span class="co">#&gt;  [9] "Hillshade_9am"                      "Hillshade_Noon"                    </span>
<span class="co">#&gt; [11] "Hillshade_3pm"                      "Horizontal_Distance_To_Fire_Points"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $y</span>
<span class="co">#&gt; [1] "Cover_Type"</span>
<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">best_model</span>, valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 10053 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.185</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.43</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.582</span>
<span class="co">#&gt; Mean Per-Class Error: 0.521</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2505    1119       0       0       0       0      87 0.3250</span>
<span class="co">#&gt; class_2     529    4251      83       0      23      14       5 0.1333</span>
<span class="co">#&gt; class_3       0      61     524       0       0       2       0 0.1073</span>
<span class="co">#&gt; class_4       0       0      52       1       0       0       0 0.9811</span>
<span class="co">#&gt; class_5      15     116       6       0      16       1       0 0.8961</span>
<span class="co">#&gt; class_6       0      88     170       0       0      20       0 0.9281</span>
<span class="co">#&gt; class_7      98       4       0       0       0       0     263 0.2795</span>
<span class="co">#&gt; Totals     3147    5639     835       1      39      37     355 0.2460</span>
<span class="co">#&gt;                     Rate</span>
<span class="co">#&gt; class_1 =  1,206 / 3,711</span>
<span class="co">#&gt; class_2 =    654 / 4,905</span>
<span class="co">#&gt; class_3 =       63 / 587</span>
<span class="co">#&gt; class_4 =        52 / 53</span>
<span class="co">#&gt; class_5 =      138 / 154</span>
<span class="co">#&gt; class_6 =      258 / 278</span>
<span class="co">#&gt; class_7 =      102 / 365</span>
<span class="co">#&gt; Totals  = 2,473 / 10,053</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.754004</span>
<span class="co">#&gt; 2 2  0.969661</span>
<span class="co">#&gt; 3 3  0.994927</span>
<span class="co">#&gt; 4 4  0.998906</span>
<span class="co">#&gt; 5 5  0.999702</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.logloss.html">h2o.logloss</a></span><span class="op">(</span><span class="va">best_model</span>, valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.582</span></code></pre></div>
</div>
<div id="random-hyper-parameter-search" class="section level3">
<h3>
<span class="header-section-number">46.5.7</span> Random Hyper-Parameter Search<a class="anchor" aria-label="anchor" href="#random-hyper-parameter-search"><i class="fas fa-link"></i></a>
</h3>
<p>Often, hyper-parameter search for more than 4 parameters can be done more efficiently with random parameter search than with grid search. Basically, chances are good to find one of many good models in less time than performing an exhaustive grid search. We simply build up to max_models models with parameters drawn randomly from user-specified distributions (here, uniform). For this example, we use the adaptive learning rate and focus on tuning the network architecture and the regularization parameters. We also let the grid search stop automatically once the performance at the top of the leaderboard doesn’t change much anymore, i.e., once the search has converged.</p>
<div class="sourceCode" id="cb1073"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hyper_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  activation<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rectifier"</span>,<span class="st">"Tanh"</span>,<span class="st">"Maxout"</span>,<span class="st">"RectifierWithDropout"</span>,<span class="st">"TanhWithDropout"</span>,<span class="st">"MaxoutWithDropout"</span><span class="op">)</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">50</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">30</span>,<span class="fl">30</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span><span class="op">)</span><span class="op">)</span>,
  input_dropout_ratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.05</span><span class="op">)</span>,
  l1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-4</span>,<span class="fl">1e-6</span><span class="op">)</span>,
  l2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-4</span>,<span class="fl">1e-6</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">hyper_params</span>

<span class="co">## Stop once the top 5 models are within 1% of each other (i.e., the windowed average varies less than 1%)</span>
<span class="va">search_criteria</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>strategy <span class="op">=</span> <span class="st">"RandomDiscrete"</span>, max_runtime_secs <span class="op">=</span> <span class="fl">360</span>, max_models <span class="op">=</span> <span class="fl">100</span>, seed<span class="op">=</span><span class="fl">1234567</span>, stopping_rounds<span class="op">=</span><span class="fl">5</span>, stopping_tolerance<span class="op">=</span><span class="fl">1e-2</span><span class="op">)</span>
<span class="va">dl_random_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.grid.html">h2o.grid</a></span><span class="op">(</span>
  algorithm<span class="op">=</span><span class="st">"deeplearning"</span>,
  grid_id <span class="op">=</span> <span class="st">"dl_grid_random"</span>,
  training_frame<span class="op">=</span><span class="va">sampled_train</span>,
  validation_frame<span class="op">=</span><span class="va">valid</span>, 
  x<span class="op">=</span><span class="va">predictors</span>, 
  y<span class="op">=</span><span class="va">response</span>,
  epochs<span class="op">=</span><span class="fl">1</span>,
  stopping_metric<span class="op">=</span><span class="st">"logloss"</span>,
  stopping_tolerance<span class="op">=</span><span class="fl">1e-2</span>,        <span class="co">## stop when logloss does not improve by &gt;=1% for 2 scoring events</span>
  stopping_rounds<span class="op">=</span><span class="fl">2</span>,
  score_validation_samples<span class="op">=</span><span class="fl">10000</span>, <span class="co">## downsample validation set for faster scoring</span>
  score_duty_cycle<span class="op">=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span>
  max_w2<span class="op">=</span><span class="fl">10</span>,                      <span class="co">## can help improve stability for Rectifier</span>
  hyper_params <span class="op">=</span> <span class="va">hyper_params</span>,
  search_criteria <span class="op">=</span> <span class="va">search_criteria</span>
<span class="op">)</span>                                
<span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid_random"</span>,sort_by<span class="op">=</span><span class="st">"logloss"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">grid</span>

<span class="va">grid</span><span class="op">@</span><span class="va">summary_table</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>
<span class="va">best_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getModel.html">h2o.getModel</a></span><span class="op">(</span><span class="va">grid</span><span class="op">@</span><span class="va">model_ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">## model with lowest logloss</span>
<span class="va">best_model</span></code></pre></div>
<p>Let’s look at the model with the lowest validation misclassification rate:</p>
<div class="sourceCode" id="cb1074"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid"</span>,sort_by<span class="op">=</span><span class="st">"err"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">best_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getModel.html">h2o.getModel</a></span><span class="op">(</span><span class="va">grid</span><span class="op">@</span><span class="va">model_ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">## model with lowest classification error (on validation, since it was available during training)</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.confusionMatrix.html">h2o.confusionMatrix</a></span><span class="op">(</span><span class="va">best_model</span>,valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2505    1119       0       0       0       0      87 0.3250</span>
<span class="co">#&gt; class_2     529    4251      83       0      23      14       5 0.1333</span>
<span class="co">#&gt; class_3       0      61     524       0       0       2       0 0.1073</span>
<span class="co">#&gt; class_4       0       0      52       1       0       0       0 0.9811</span>
<span class="co">#&gt; class_5      15     116       6       0      16       1       0 0.8961</span>
<span class="co">#&gt; class_6       0      88     170       0       0      20       0 0.9281</span>
<span class="co">#&gt; class_7      98       4       0       0       0       0     263 0.2795</span>
<span class="co">#&gt; Totals     3147    5639     835       1      39      37     355 0.2460</span>
<span class="co">#&gt;                     Rate</span>
<span class="co">#&gt; class_1 =  1,206 / 3,711</span>
<span class="co">#&gt; class_2 =    654 / 4,905</span>
<span class="co">#&gt; class_3 =       63 / 587</span>
<span class="co">#&gt; class_4 =        52 / 53</span>
<span class="co">#&gt; class_5 =      138 / 154</span>
<span class="co">#&gt; class_6 =      258 / 278</span>
<span class="co">#&gt; class_7 =      102 / 365</span>
<span class="co">#&gt; Totals  = 2,473 / 10,053</span>
<span class="va">best_params</span> <span class="op">&lt;-</span> <span class="va">best_model</span><span class="op">@</span><span class="va">allparameters</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">activation</span>
<span class="co">#&gt; [1] "Rectifier"</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">hidden</span>
<span class="co">#&gt; [1] 64 64</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">input_dropout_ratio</span>
<span class="co">#&gt; [1] 0</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">l1</span>
<span class="co">#&gt; [1] 1e-05</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">l2</span>
<span class="co">#&gt; [1] 1e-05</span></code></pre></div>
</div>
<div id="checkpointing" class="section level3">
<h3>
<span class="header-section-number">46.5.8</span> Checkpointing<a class="anchor" aria-label="anchor" href="#checkpointing"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s continue training the manually tuned model from before, for 2 more epochs. Note that since many important parameters such as epochs, l1, l2, max_w2, score_interval, train_samples_per_iteration, input_dropout_ratio, hidden_dropout_ratios, score_duty_cycle, classification_stop, regression_stop, variable_importances, force_load_balance can be modified between checkpoint restarts, it is best to specify as many parameters as possible explicitly.</p>
<div class="sourceCode" id="cb1075"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">max_epochs</span> <span class="op">&lt;-</span> <span class="fl">12</span> <span class="co">## Add two more epochs</span>
<span class="va">m_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  model_id<span class="op">=</span><span class="st">"dl_model_tuned_continued"</span>, 
  checkpoint<span class="op">=</span><span class="st">"dl_model_tuned"</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>, 
  validation_frame<span class="op">=</span><span class="va">valid</span>, 
  x<span class="op">=</span><span class="va">predictors</span>, 
  y<span class="op">=</span><span class="va">response</span>, 
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">128</span>,<span class="fl">128</span>,<span class="fl">128</span><span class="op">)</span>,          <span class="co">## more hidden layers -&gt; more complex interactions</span>
  epochs<span class="op">=</span><span class="va">max_epochs</span>,              <span class="co">## hopefully long enough to converge (otherwise restart again)</span>
  stopping_metric<span class="op">=</span><span class="st">"logloss"</span>,      <span class="co">## logloss is directly optimized by Deep Learning</span>
  stopping_tolerance<span class="op">=</span><span class="fl">1e-2</span>,        <span class="co">## stop when validation logloss does not improve by &gt;=1% for 2 scoring events</span>
  stopping_rounds<span class="op">=</span><span class="fl">2</span>,
  score_validation_samples<span class="op">=</span><span class="fl">10000</span>, <span class="co">## downsample validation set for faster scoring</span>
  score_duty_cycle<span class="op">=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span>
  adaptive_rate<span class="op">=</span><span class="cn">F</span>,                <span class="co">## manually tuned learning rate</span>
  rate<span class="op">=</span><span class="fl">0.01</span>, 
  rate_annealing<span class="op">=</span><span class="fl">2e-6</span>,            
  momentum_start<span class="op">=</span><span class="fl">0.2</span>,             <span class="co">## manually tuned momentum</span>
  momentum_stable<span class="op">=</span><span class="fl">0.4</span>, 
  momentum_ramp<span class="op">=</span><span class="fl">1e7</span>, 
  l1<span class="op">=</span><span class="fl">1e-5</span>,                        <span class="co">## add some L1/L2 regularization</span>
  l2<span class="op">=</span><span class="fl">1e-5</span>,
  max_w2<span class="op">=</span><span class="fl">10</span>                       <span class="co">## helps stability for Rectifier</span>
<span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m_cont</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">m_cont</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/checpointing-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Once we are satisfied with the results, we can save the model to disk (on the cluster). In this example, we store the model in a directory called <code>mybest_deeplearning_covtype_model</code>, which will be created for us since force=TRUE.</p>
<div class="sourceCode" id="cb1076"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.saveModel.html">h2o.saveModel</a></span><span class="op">(</span><span class="va">m_cont</span>, 
          path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"mybest_deeplearning_covtype_model"</span><span class="op">)</span>, force<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>It can be loaded later with the following command:</p>
<div class="sourceCode" id="cb1077"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>
<span class="co">#&gt; [1] "/home/rstudio/all/output/data/mybest_deeplearning_covtype_model/dl_model_tuned_continued"</span>
<span class="va">m_loaded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.loadModel.html">h2o.loadModel</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m_loaded</span><span class="op">)</span>
<span class="co">#&gt; Model Details:</span>
<span class="co">#&gt; ==============</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialModel: deeplearning</span>
<span class="co">#&gt; Model Key:  dl_model_tuned_continued </span>
<span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 41,223 weights/biases, 333.0 KB, 4,201,157 training samples, mini-batch size 1</span>
<span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span>
<span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span>
<span class="co">#&gt; 2     2   128 Rectifier  0.00 % 0.000010 0.000010  0.001064 0.000000 0.284023</span>
<span class="co">#&gt; 3     3   128 Rectifier  0.00 % 0.000010 0.000010  0.001064 0.000000 0.284023</span>
<span class="co">#&gt; 4     4   128 Rectifier  0.00 % 0.000010 0.000010  0.001064 0.000000 0.284023</span>
<span class="co">#&gt; 5     5     7   Softmax      NA 0.000010 0.000010  0.001064 0.000000 0.284023</span>
<span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span>
<span class="co">#&gt; 1          NA         NA        NA       NA</span>
<span class="co">#&gt; 2   -0.013889   0.322819 -0.013367 0.317160</span>
<span class="co">#&gt; 3   -0.052496   0.227175  0.901665 0.377626</span>
<span class="co">#&gt; 4   -0.061822   0.220802  0.837100 0.185829</span>
<span class="co">#&gt; 5   -0.020984   0.270745  0.010907 0.982486</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on training data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary training frame with 9850 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Training Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0516</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.227</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.171</span>
<span class="co">#&gt; Mean Per-Class Error: 0.108</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3296     278       0       0       4       1       8 0.0811</span>
<span class="co">#&gt; class_2     190    4631      14       0      17      16       2 0.0491</span>
<span class="co">#&gt; class_3       0       7     502       5       3      29       0 0.0806</span>
<span class="co">#&gt; class_4       0       0       6      44       0       0       0 0.1200</span>
<span class="co">#&gt; class_5       2      24       3       0     113       1       0 0.2098</span>
<span class="co">#&gt; class_6       0      10      29       4       1     270       0 0.1401</span>
<span class="co">#&gt; class_7      25       1       0       0       0       0     314 0.0765</span>
<span class="co">#&gt; Totals     3513    4951     554      53     138     317     324 0.0690</span>
<span class="co">#&gt;                  Rate</span>
<span class="co">#&gt; class_1 = 291 / 3,587</span>
<span class="co">#&gt; class_2 = 239 / 4,870</span>
<span class="co">#&gt; class_3 =    44 / 546</span>
<span class="co">#&gt; class_4 =      6 / 50</span>
<span class="co">#&gt; class_5 =    30 / 143</span>
<span class="co">#&gt; class_6 =    44 / 314</span>
<span class="co">#&gt; class_7 =    26 / 340</span>
<span class="co">#&gt; Totals  = 680 / 9,850</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.930964</span>
<span class="co">#&gt; 2 2  0.997462</span>
<span class="co">#&gt; 3 3  0.999695</span>
<span class="co">#&gt; 4 4  0.999899</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 9914 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0571</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.239</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.191</span>
<span class="co">#&gt; Mean Per-Class Error: 0.12</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3198     316       0       0       5       1      11 0.0943</span>
<span class="co">#&gt; class_2     199    4630       9       0      29      18       1 0.0524</span>
<span class="co">#&gt; class_3       0      14     558       9       2      28       0 0.0867</span>
<span class="co">#&gt; class_4       0       0       6      53       0       4       0 0.1587</span>
<span class="co">#&gt; class_5       0      31       2       0     131       0       0 0.2012</span>
<span class="co">#&gt; class_6       1      12      32       1       0     272       0 0.1447</span>
<span class="co">#&gt; class_7      33       2       0       0       0       0     306 0.1026</span>
<span class="co">#&gt; Totals     3431    5005     607      63     167     323     318 0.0773</span>
<span class="co">#&gt;                  Rate</span>
<span class="co">#&gt; class_1 = 333 / 3,531</span>
<span class="co">#&gt; class_2 = 256 / 4,886</span>
<span class="co">#&gt; class_3 =    53 / 611</span>
<span class="co">#&gt; class_4 =     10 / 63</span>
<span class="co">#&gt; class_5 =    33 / 164</span>
<span class="co">#&gt; class_6 =    46 / 318</span>
<span class="co">#&gt; class_7 =    35 / 341</span>
<span class="co">#&gt; Totals  = 766 / 9,914</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.922736</span>
<span class="co">#&gt; 2 2  0.997176</span>
<span class="co">#&gt; 3 3  0.999798</span>
<span class="co">#&gt; 4 4  0.999899</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Scoring History: </span>
<span class="co">#&gt;              timestamp          duration training_speed   epochs iterations</span>
<span class="co">#&gt; 1  2020-11-19 17:02:50         0.000 sec             NA  0.00000          0</span>
<span class="co">#&gt; 2  2020-11-19 17:02:57         6.509 sec  16362 obs/sec  0.28725          1</span>
<span class="co">#&gt; 3  2020-11-19 17:03:14        24.109 sec  21320 obs/sec  1.43173          5</span>
<span class="co">#&gt; 4  2020-11-19 17:03:27        36.456 sec  22491 obs/sec  2.29147          8</span>
<span class="co">#&gt; 5  2020-11-19 17:03:38        47.583 sec  23658 obs/sec  3.14973         11</span>
<span class="co">#&gt; 6  2020-11-19 17:03:49        58.366 sec  24533 obs/sec  4.00855         14</span>
<span class="co">#&gt; 7  2020-11-19 17:04:00  1 min  9.468 sec  25024 obs/sec  4.86845         17</span>
<span class="co">#&gt; 8  2020-11-19 17:04:11  1 min 20.401 sec  25438 obs/sec  5.72897         20</span>
<span class="co">#&gt; 9  2020-11-19 17:04:22  1 min 31.340 sec  25750 obs/sec  6.58890         23</span>
<span class="co">#&gt; 10 2020-11-19 17:04:33  1 min 42.349 sec  25977 obs/sec  7.45041         26</span>
<span class="co">#&gt; 11 2020-11-19 17:04:43  1 min 53.011 sec  26242 obs/sec  8.31112         29</span>
<span class="co">#&gt; 12 2020-11-19 17:04:54  2 min  3.814 sec  26430 obs/sec  9.17147         32</span>
<span class="co">#&gt; 13 2020-11-19 17:05:04  2 min 14.215 sec  26668 obs/sec 10.03230         35</span>
<span class="co">#&gt; 14 2020-11-19 17:06:12  2 min 17.811 sec  26750 obs/sec 10.31993         36</span>
<span class="co">#&gt; 15 2020-11-19 17:06:23  2 min 28.960 sec  26797 obs/sec 11.17677         39</span>
<span class="co">#&gt; 16 2020-11-19 17:06:33  2 min 39.480 sec  26952 obs/sec 12.03718         42</span>
<span class="co">#&gt;           samples training_rmse training_logloss training_r2</span>
<span class="co">#&gt; 1        0.000000            NA               NA          NA</span>
<span class="co">#&gt; 2   100253.000000       0.42198          0.55542     0.90583</span>
<span class="co">#&gt; 3   499696.000000       0.34690          0.38095     0.93636</span>
<span class="co">#&gt; 4   799758.000000       0.31864          0.32765     0.94631</span>
<span class="co">#&gt; 5  1099303.000000       0.30723          0.30516     0.95008</span>
<span class="co">#&gt; 6  1399045.000000       0.28647          0.26619     0.95660</span>
<span class="co">#&gt; 7  1699163.000000       0.27851          0.25551     0.95898</span>
<span class="co">#&gt; 8  1999495.000000       0.27166          0.23917     0.96097</span>
<span class="co">#&gt; 9  2299625.000000       0.26491          0.22980     0.96289</span>
<span class="co">#&gt; 10 2600306.000000       0.25753          0.21728     0.96493</span>
<span class="co">#&gt; 11 2900706.000000       0.24528          0.19854     0.96819</span>
<span class="co">#&gt; 12 3200980.000000       0.24490          0.19669     0.96828</span>
<span class="co">#&gt; 13 3501423.000000       0.24083          0.19187     0.96933</span>
<span class="co">#&gt; 14 3601809.000000       0.23301          0.17859     0.97204</span>
<span class="co">#&gt; 15 3900861.000000       0.23110          0.17633     0.97249</span>
<span class="co">#&gt; 16 4201157.000000       0.22726          0.17065     0.97340</span>
<span class="co">#&gt;    training_classification_error validation_rmse validation_logloss</span>
<span class="co">#&gt; 1                             NA              NA                 NA</span>
<span class="co">#&gt; 2                        0.23651         0.42378            0.55630</span>
<span class="co">#&gt; 3                        0.16006         0.34660            0.38253</span>
<span class="co">#&gt; 4                        0.13438         0.31398            0.31967</span>
<span class="co">#&gt; 5                        0.12632         0.31084            0.31282</span>
<span class="co">#&gt; 6                        0.11009         0.28738            0.27033</span>
<span class="co">#&gt; 7                        0.10143         0.28019            0.25914</span>
<span class="co">#&gt; 8                        0.09964         0.27393            0.24381</span>
<span class="co">#&gt; 9                        0.09307         0.26910            0.23797</span>
<span class="co">#&gt; 10                       0.08979         0.25613            0.21806</span>
<span class="co">#&gt; 11                       0.08133         0.25531            0.21445</span>
<span class="co">#&gt; 12                       0.07983         0.24977            0.20772</span>
<span class="co">#&gt; 13                       0.07744         0.24760            0.20380</span>
<span class="co">#&gt; 14                       0.07279         0.24760            0.20241</span>
<span class="co">#&gt; 15                       0.07168         0.24411            0.19920</span>
<span class="co">#&gt; 16                       0.06904         0.23889            0.19082</span>
<span class="co">#&gt;    validation_r2 validation_classification_error</span>
<span class="co">#&gt; 1             NA                              NA</span>
<span class="co">#&gt; 2        0.90596                         0.24091</span>
<span class="co">#&gt; 3        0.93710                         0.15791</span>
<span class="co">#&gt; 4        0.94838                         0.13027</span>
<span class="co">#&gt; 5        0.94941                         0.12957</span>
<span class="co">#&gt; 6        0.95676                         0.10754</span>
<span class="co">#&gt; 7        0.95889                         0.10414</span>
<span class="co">#&gt; 8        0.96071                         0.10103</span>
<span class="co">#&gt; 9        0.96208                         0.09602</span>
<span class="co">#&gt; 10       0.96565                         0.08691</span>
<span class="co">#&gt; 11       0.96587                         0.08771</span>
<span class="co">#&gt; 12       0.96733                         0.08251</span>
<span class="co">#&gt; 13       0.96790                         0.08181</span>
<span class="co">#&gt; 14       0.96873                         0.08190</span>
<span class="co">#&gt; 15       0.96961                         0.07827</span>
<span class="co">#&gt; 16       0.97089                         0.07726</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span>
<span class="co">#&gt; =================================================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variable Importances: </span>
<span class="co">#&gt;                             variable relative_importance scaled_importance</span>
<span class="co">#&gt; 1 Horizontal_Distance_To_Fire_Points            1.000000          1.000000</span>
<span class="co">#&gt; 2                          Elevation            0.995377          0.995377</span>
<span class="co">#&gt; 3    Horizontal_Distance_To_Roadways            0.945073          0.945073</span>
<span class="co">#&gt; 4             Wilderness_Area.area_0            0.698678          0.698678</span>
<span class="co">#&gt; 5             Wilderness_Area.area_2            0.626186          0.626186</span>
<span class="co">#&gt;   percentage</span>
<span class="co">#&gt; 1   0.047423</span>
<span class="co">#&gt; 2   0.047204</span>
<span class="co">#&gt; 3   0.044818</span>
<span class="co">#&gt; 4   0.033133</span>
<span class="co">#&gt; 5   0.029696</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;                       variable relative_importance scaled_importance percentage</span>
<span class="co">#&gt; 51           Soil_Type.type_35            0.164608          0.164608   0.007806</span>
<span class="co">#&gt; 52            Soil_Type.type_6            0.161731          0.161731   0.007670</span>
<span class="co">#&gt; 53            Soil_Type.type_7            0.160922          0.160922   0.007631</span>
<span class="co">#&gt; 54           Soil_Type.type_14            0.148023          0.148023   0.007020</span>
<span class="co">#&gt; 55       Soil_Type.missing(NA)            0.000000          0.000000   0.000000</span>
<span class="co">#&gt; 56 Wilderness_Area.missing(NA)            0.000000          0.000000   0.000000</span></code></pre></div>
<p>This model is fully functional and can be inspected, restarted, or used to score a dataset, etc. Note that binary compatibility between H2O versions is currently not guaranteed.</p>
</div>
<div id="cross-validation" class="section level3">
<h3>
<span class="header-section-number">46.5.9</span> Cross-Validation<a class="anchor" aria-label="anchor" href="#cross-validation"><i class="fas fa-link"></i></a>
</h3>
<p>For N-fold cross-validation, specify <code>nfolds&gt;1</code> instead of (or in addition to) a validation frame, and <code>N+1</code> models will be built: 1 model on the full training data, and N models with each 1/N-th of the data held out (there are different holdout strategies). Those N models then score on the held out data, and their combined predictions on the full training data are scored to get the cross-validation metrics.</p>
<div class="sourceCode" id="cb1078"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dlmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  x<span class="op">=</span><span class="va">predictors</span>,
  y<span class="op">=</span><span class="va">response</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
  epochs<span class="op">=</span><span class="fl">1</span>,
  nfolds<span class="op">=</span><span class="fl">5</span>,
  fold_assignment<span class="op">=</span><span class="st">"Modulo"</span> <span class="co"># can be "AUTO", "Modulo", "Random" or "Stratified"</span>
  <span class="op">)</span>
<span class="va">dlmodel</span></code></pre></div>
<p>N-fold cross-validation is especially useful with early stopping, as the main model will pick the ideal number of epochs from the convergence behavior of the cross-validation models.</p>
</div>
</div>
<div id="regression-and-binary-classification" class="section level2">
<h2>
<span class="header-section-number">46.6</span> Regression and Binary Classification<a class="anchor" aria-label="anchor" href="#regression-and-binary-classification"><i class="fas fa-link"></i></a>
</h2>
<p>Assume we want to turn the multi-class problem above into a binary classification problem. We create a binary response as follows:</p>
<div class="sourceCode" id="cb1079"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train</span><span class="op">$</span><span class="va">bin_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">train</span><span class="op">[</span>,<span class="va">response</span><span class="op">]</span> <span class="op">==</span> <span class="st">"class_1"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Let’s build a quick model and inspect the model:</p>
<div class="sourceCode" id="cb1080"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dlmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  x<span class="op">=</span><span class="va">predictors</span>,
  y<span class="op">=</span><span class="st">"bin_response"</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
  epochs<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dlmodel</span><span class="op">)</span></code></pre></div>
<p>Instead of a binary classification model, we find a regression model (H2ORegressionModel) that contains only 1 output neuron (instead of 2). The reason is that the response was a numerical feature (ordinal numbers 0 and 1), and H2O Deep Learning was run with distribution=AUTO, which defaulted to a Gaussian regression problem for a real-valued response. H2O Deep Learning supports regression for distributions other than Gaussian such as Poisson, Gamma, Tweedie, Laplace. It also supports Huber loss and per-row offsets specified via an offset_column. We refer to our H2O Deep Learning regression code examples for more information.</p>
<p>To perform classification, the response must first be turned into a categorical (factor) feature:</p>
<div class="sourceCode" id="cb1081"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train</span><span class="op">$</span><span class="va">bin_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/as.factor.html">as.factor</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">bin_response</span><span class="op">)</span> <span class="co">##make categorical</span>
<span class="va">dlmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  x<span class="op">=</span><span class="va">predictors</span>,
  y<span class="op">=</span><span class="st">"bin_response"</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
  epochs<span class="op">=</span><span class="fl">0.1</span>
  <span class="co">#balance_classes=T    ## enable this for high class imbalance</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dlmodel</span><span class="op">)</span> <span class="co">## Now the model metrics contain AUC for binary classification</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">dlmodel</span><span class="op">)</span><span class="op">)</span> <span class="co">## display ROC curve</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/bin_class_as_factor-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Now the model performs (binary) classification, and has multiple (2) output neurons.</p>
</div>
<div id="unsupervised-anomaly-detection" class="section level2">
<h2>
<span class="header-section-number">46.7</span> Unsupervised Anomaly detection<a class="anchor" aria-label="anchor" href="#unsupervised-anomaly-detection"><i class="fas fa-link"></i></a>
</h2>
<p>For instructions on how to build unsupervised models with H2O Deep Learning, we refer to our previous Tutorial on Anomaly Detection with H2O Deep Learning and our MNIST Anomaly detection code example, as well as our Stacked AutoEncoder R code example and another one for Unsupervised Pretraining with an AutoEncoder R code example.</p>
</div>
<div id="h2o-deep-learning-tips-tricks" class="section level2">
<h2>
<span class="header-section-number">46.8</span> H2O Deep Learning Tips &amp; Tricks<a class="anchor" aria-label="anchor" href="#h2o-deep-learning-tips-tricks"><i class="fas fa-link"></i></a>
</h2>
<div id="performance-tuning" class="section level3">
<h3>
<span class="header-section-number">46.8.1</span> Performance Tuning<a class="anchor" aria-label="anchor" href="#performance-tuning"><i class="fas fa-link"></i></a>
</h3>
<p>The Definitive H2O Deep Learning Performance Tuning blog post covers many of the following points that affect the computational efficiency, so it’s highly recommended.</p>
</div>
<div id="activation-functions" class="section level3">
<h3>
<span class="header-section-number">46.8.2</span> Activation Functions<a class="anchor" aria-label="anchor" href="#activation-functions"><i class="fas fa-link"></i></a>
</h3>
<p>While sigmoids have been used historically for neural networks, H2O Deep Learning implements Tanh, a scaled and shifted variant of the sigmoid which is symmetric around 0. Since its output values are bounded by -1..1, the stability of the neural network is rarely endangered. However, the derivative of the tanh function is always non-zero and back-propagation (training) of the weights is more computationally expensive than for rectified linear units, or Rectifier, which is max(0,x) and has vanishing gradient for x&lt;=0, leading to much faster training speed for large networks and is often the fastest path to accuracy on larger problems. In case you encounter instabilities with the Rectifier (in which case model building is automatically aborted), try a limited value to re-scale the weights: max_w2=10. The Maxout activation function is computationally more expensive, but can lead to higher accuracy. It is a generalized version of the Rectifier with two non-zero channels. In practice, the Rectifier (and RectifierWithDropout, see below) is the most versatile and performant option for most problems.</p>
</div>
<div id="generalization-techniques" class="section level3">
<h3>
<span class="header-section-number">46.8.3</span> Generalization Techniques<a class="anchor" aria-label="anchor" href="#generalization-techniques"><i class="fas fa-link"></i></a>
</h3>
<p>L1 and L2 penalties can be applied by specifying the l1 and l2 parameters. Intuition: L1 lets only strong weights survive (constant pulling force towards zero), while L2 prevents any single weight from getting too big. Dropout has recently been introduced as a powerful generalization technique, and is available as a parameter per layer, including the input layer. <code>input_dropout_ratio</code> controls the amount of input layer neurons that are randomly dropped (set to zero), while <code>hidden_dropout_ratios</code> are specified for each hidden layer. The former controls overfitting with respect to the input data (useful for high-dimensional noisy data), while the latter controls overfitting of the learned features. Note that <code>hidden_dropout_ratios</code> require the activation function to end with …WithDropout.</p>
</div>
<div id="early-stopping-and-optimizing-for-lowest-validation-error" class="section level3">
<h3>
<span class="header-section-number">46.8.4</span> Early stopping and optimizing for lowest validation error<a class="anchor" aria-label="anchor" href="#early-stopping-and-optimizing-for-lowest-validation-error"><i class="fas fa-link"></i></a>
</h3>
<p>By default, Deep Learning training stops when the stopping_metric does not improve by at least stopping_tolerance (0.01 means 1% improvement) for stopping_rounds consecutive scoring events on the training (or validation) data. By default, <code>overwrite_with_best_model</code> is enabled and the model returned after training for the specified number of epochs (or after stopping early due to convergence) is the model that has the best training set error (according to the metric specified by stopping_metric), or, if a validation set is provided, the lowest validation set error. Note that the training or validation set errors can be based on a subset of the training or validation data, depending on the values for <code>score_validation_samples</code> or <code>score_training_samples</code>, see below. For early stopping on a predefined error rate on the training data (accuracy for classification or MSE for regression), specify <code>classification_stop</code> or <code>regression_stop.</code></p>
</div>
<div id="training-samples-per-mapreduce-iteration" class="section level3">
<h3>
<span class="header-section-number">46.8.5</span> Training Samples per MapReduce Iteration<a class="anchor" aria-label="anchor" href="#training-samples-per-mapreduce-iteration"><i class="fas fa-link"></i></a>
</h3>
<p>The parameter <code>train_samples_per_iteration</code> matters especially in multi-node operation. It controls the number of rows trained on for each <code>MapReduce</code> iteration. Depending on the value selected, one MapReduce pass can sample observations, and multiple such passes are needed to train for one epoch. All H2O compute nodes then communicate to agree on the best model coefficients (weights/biases) so far, and the model may then be scored (controlled by other parameters below). The default value of -2 indicates auto-tuning, which attemps to keep the communication overhead at 5% of the total runtime. The parameter <code>target_ratio_comm_to_comp</code> controls this ratio. This parameter is explained in more detail in the H2O Deep Learning booklet,</p>
</div>
<div id="categorical-data" class="section level3">
<h3>
<span class="header-section-number">46.8.6</span> Categorical Data<a class="anchor" aria-label="anchor" href="#categorical-data"><i class="fas fa-link"></i></a>
</h3>
<p>For categorical data, a feature with K factor levels is automatically one-hot encoded (horizontalized) into <code>K-1</code> input neurons. Hence, the input neuron layer can grow substantially for datasets with high factor counts. In these cases, it might make sense to reduce the number of hidden neurons in the first hidden layer, such that large numbers of factor levels can be handled. In the limit of 1 neuron in the first hidden layer, the resulting model is similar to logistic regression with stochastic gradient descent, except that for classification problems, there’s still a softmax output layer, and that the activation function is not necessarily a sigmoid (Tanh). If variable importances are computed, it is recommended to turn on <code>use_all_factor_levels</code> (K input neurons for K levels). The experimental option max_categorical_features uses feature hashing to reduce the number of input neurons via the hash trick at the expense of hash collisions and reduced accuracy. Another way to reduce the dimensionality of the (categorical) features is to use <code><a href="https://rdrr.io/pkg/h2o/man/h2o.glrm.html">h2o.glrm()</a></code>, we refer to the GLRM tutorial for more details.</p>
</div>
<div id="sparse-data" class="section level3">
<h3>
<span class="header-section-number">46.8.7</span> Sparse Data<a class="anchor" aria-label="anchor" href="#sparse-data"><i class="fas fa-link"></i></a>
</h3>
<p>If the input data is sparse (many zeros), then it might make sense to enable the sparse option. This will result in the input not being standardized (0 mean, 1 variance), but only de-scaled (1 variance) and 0 values remain 0, leading to more efficient back-propagation. Sparsity is also a reason why CPU implementations can be faster than GPU implementations, because they can take advantage of if/else statements more effectively.</p>
</div>
<div id="missing-values" class="section level3">
<h3>
<span class="header-section-number">46.8.8</span> Missing Values<a class="anchor" aria-label="anchor" href="#missing-values"><i class="fas fa-link"></i></a>
</h3>
<p>H2O Deep Learning automatically does mean imputation for missing values during training (leaving the input layer activation at 0 after standardizing the values). For testing, missing test set values are also treated the same way by default. See the <code>h2o.impute</code> function to do your own mean imputation.</p>
</div>
<div id="loss-functions-distributions-offsets-observation-weights" class="section level3">
<h3>
<span class="header-section-number">46.8.9</span> Loss functions, Distributions, Offsets, Observation Weights<a class="anchor" aria-label="anchor" href="#loss-functions-distributions-offsets-observation-weights"><i class="fas fa-link"></i></a>
</h3>
<p>H2O Deep Learning supports advanced statistical features such as multiple loss functions, non-Gaussian distributions, per-row offsets and observation weights. In addition to Gaussian distributions and Squared loss, H2O Deep Learning supports Poisson, Gamma, Tweedie and Laplace distributions. It also supports Absolute and Huber loss and per-row offsets specified via an <code>offset_column.</code> Observation weights are supported via a user-specified weights_column.</p>
<p>We refer to our H2O Deep Learning R test code examples for more information.</p>
</div>
<div id="exporting-weights-and-biases" class="section level3">
<h3>
<span class="header-section-number">46.8.10</span> Exporting Weights and Biases<a class="anchor" aria-label="anchor" href="#exporting-weights-and-biases"><i class="fas fa-link"></i></a>
</h3>
<p>The model parameters (weights connecting two adjacent layers and per-neuron bias terms) can be stored as H2O Frames (like a dataset) by enabling <code>export_weights_and_biases</code>, and they can be accessed as follows:</p>
<div class="sourceCode" id="cb1082"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1082-1" data-line-number="1">iris_dl &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">5</span>,<span class="kw">as.h2o</span>(iris),</a>
<a class="sourceLine" id="cb1082-2" data-line-number="2">             <span class="dt">export_weights_and_biases=</span>T)</a>
<a class="sourceLine" id="cb1082-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-4" data-line-number="4">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1082-5" data-line-number="5"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1082-6" data-line-number="6">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1082-7" data-line-number="7"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1082-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-9" data-line-number="9">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1082-10" data-line-number="10"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1082-11" data-line-number="11">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1082-12" data-line-number="12"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb1082-13" data-line-number="13">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1082-14" data-line-number="14"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1082-15" data-line-number="15"><span class="kw">h2o.weights</span>(iris_dl, <span class="dt">matrix_id=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1082-16" data-line-number="16"><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></a>
<a class="sourceLine" id="cb1082-17" data-line-number="17"><span class="co">#&gt; 1     -0.02702     -0.0941       0.0682     -0.1191</span></a>
<a class="sourceLine" id="cb1082-18" data-line-number="18"><span class="co">#&gt; 2      0.14384      0.1651       0.0136      0.0476</span></a>
<a class="sourceLine" id="cb1082-19" data-line-number="19"><span class="co">#&gt; 3      0.05243     -0.1310       0.1018     -0.0357</span></a>
<a class="sourceLine" id="cb1082-20" data-line-number="20"><span class="co">#&gt; 4     -0.05604      0.0501      -0.0666     -0.1194</span></a>
<a class="sourceLine" id="cb1082-21" data-line-number="21"><span class="co">#&gt; 5     -0.00512     -0.0627      -0.1818     -0.1160</span></a>
<a class="sourceLine" id="cb1082-22" data-line-number="22"><span class="co">#&gt; 6      0.10363     -0.0523       0.1111      0.1644</span></a>
<a class="sourceLine" id="cb1082-23" data-line-number="23"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-24" data-line-number="24"><span class="co">#&gt; [200 rows x 4 columns]</span></a>
<a class="sourceLine" id="cb1082-25" data-line-number="25"><span class="kw">h2o.weights</span>(iris_dl, <span class="dt">matrix_id=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1082-26" data-line-number="26"><span class="co">#&gt;        C1      C2       C3       C4      C5      C6     C7      C8      C9</span></a>
<a class="sourceLine" id="cb1082-27" data-line-number="27"><span class="co">#&gt; 1 -0.1103 -0.0749 -0.06577  0.12721  0.1256  0.1116 0.0120 -0.0808  0.0980</span></a>
<a class="sourceLine" id="cb1082-28" data-line-number="28"><span class="co">#&gt; 2 -0.0741  0.0875  0.04783 -0.03444  0.0275 -0.0827 0.0322 -0.1122  0.0687</span></a>
<a class="sourceLine" id="cb1082-29" data-line-number="29"><span class="co">#&gt; 3  0.0694  0.0250  0.02802  0.09724  0.0601  0.1179 0.0179  0.0703 -0.0177</span></a>
<a class="sourceLine" id="cb1082-30" data-line-number="30"><span class="co">#&gt; 4  0.0416 -0.0477 -0.04497 -0.07719  0.0683  0.0206 0.0293  0.1010 -0.0787</span></a>
<a class="sourceLine" id="cb1082-31" data-line-number="31"><span class="co">#&gt; 5 -0.0745 -0.0418  0.00749 -0.07777 -0.0515 -0.0278 0.0499 -0.0981 -0.0922</span></a>
<a class="sourceLine" id="cb1082-32" data-line-number="32"><span class="co">#&gt; 6 -0.0125 -0.0435 -0.11381 -0.00896 -0.0772 -0.0604 0.0454  0.0256 -0.1090</span></a>
<a class="sourceLine" id="cb1082-33" data-line-number="33"><span class="co">#&gt;       C10      C11     C12     C13     C14     C15     C16      C17      C18</span></a>
<a class="sourceLine" id="cb1082-34" data-line-number="34"><span class="co">#&gt; 1 -0.0976  0.04531  0.1140  0.0828 -0.0762  0.0109 -0.0829 -0.08461  0.00577</span></a>
<a class="sourceLine" id="cb1082-35" data-line-number="35"><span class="co">#&gt; 2 -0.0226 -0.00969 -0.1181 -0.0267 -0.1166 -0.0643  0.1041 -0.06914  0.10308</span></a>
<a class="sourceLine" id="cb1082-36" data-line-number="36"><span class="co">#&gt; 3  0.0778 -0.05884 -0.1225  0.0738  0.0952 -0.1339  0.0665  0.08422 -0.07413</span></a>
<a class="sourceLine" id="cb1082-37" data-line-number="37"><span class="co">#&gt; 4 -0.0499 -0.04772  0.0459 -0.0999 -0.0508  0.1145 -0.0785  0.08717  0.07804</span></a>
<a class="sourceLine" id="cb1082-38" data-line-number="38"><span class="co">#&gt; 5 -0.1340  0.05779  0.0833 -0.0983  0.1124 -0.0565  0.0722 -0.00193  0.00106</span></a>
<a class="sourceLine" id="cb1082-39" data-line-number="39"><span class="co">#&gt; 6 -0.0934  0.02279  0.0471 -0.0995  0.1026 -0.0201  0.0610 -0.06373 -0.09322</span></a>
<a class="sourceLine" id="cb1082-40" data-line-number="40"><span class="co">#&gt;        C19     C20     C21      C22     C23     C24      C25     C26     C27</span></a>
<a class="sourceLine" id="cb1082-41" data-line-number="41"><span class="co">#&gt; 1  0.05537 -0.0134 -0.0787  0.04486 -0.0117 -0.0314  0.04318 -0.0950  0.0982</span></a>
<a class="sourceLine" id="cb1082-42" data-line-number="42"><span class="co">#&gt; 2  0.01773  0.1108  0.0948 -0.12283  0.0343  0.0565  0.12366  0.1181  0.1061</span></a>
<a class="sourceLine" id="cb1082-43" data-line-number="43"><span class="co">#&gt; 3 -0.02998  0.0118 -0.0723 -0.01170 -0.0688 -0.0543 -0.04185 -0.0553  0.0883</span></a>
<a class="sourceLine" id="cb1082-44" data-line-number="44"><span class="co">#&gt; 4 -0.11385 -0.0216 -0.0122  0.00604 -0.0964  0.0516  0.06886 -0.0563 -0.0280</span></a>
<a class="sourceLine" id="cb1082-45" data-line-number="45"><span class="co">#&gt; 5  0.07854 -0.0280 -0.0120  0.05088 -0.0293 -0.0364  0.06083  0.1178  0.0597</span></a>
<a class="sourceLine" id="cb1082-46" data-line-number="46"><span class="co">#&gt; 6 -0.00899 -0.0476  0.0102 -0.04098 -0.0740 -0.1178  0.00158 -0.1047 -0.0150</span></a>
<a class="sourceLine" id="cb1082-47" data-line-number="47"><span class="co">#&gt;       C28     C29     C30       C31     C32      C33     C34      C35     C36</span></a>
<a class="sourceLine" id="cb1082-48" data-line-number="48"><span class="co">#&gt; 1 -0.0658  0.0836  0.1109 -0.114108  0.0927  0.03018  0.0649 -0.07242  0.1072</span></a>
<a class="sourceLine" id="cb1082-49" data-line-number="49"><span class="co">#&gt; 2 -0.0987  0.0933 -0.0589 -0.082352 -0.0497 -0.11716  0.0537  0.01394  0.1185</span></a>
<a class="sourceLine" id="cb1082-50" data-line-number="50"><span class="co">#&gt; 3 -0.0916  0.0951 -0.0685  0.068800  0.0190  0.00139 -0.0293  0.00061  0.1103</span></a>
<a class="sourceLine" id="cb1082-51" data-line-number="51"><span class="co">#&gt; 4  0.0806  0.0736  0.0506 -0.030899 -0.0625  0.06711 -0.0304 -0.06364 -0.1201</span></a>
<a class="sourceLine" id="cb1082-52" data-line-number="52"><span class="co">#&gt; 5  0.0506 -0.0663 -0.0332  0.000289  0.1334  0.01960 -0.0769 -0.06977  0.0829</span></a>
<a class="sourceLine" id="cb1082-53" data-line-number="53"><span class="co">#&gt; 6  0.0323  0.0363  0.0605  0.003449  0.1006 -0.04272  0.0406  0.11407 -0.0116</span></a>
<a class="sourceLine" id="cb1082-54" data-line-number="54"><span class="co">#&gt;        C37     C38    C39     C40       C41      C42     C43     C44     C45</span></a>
<a class="sourceLine" id="cb1082-55" data-line-number="55"><span class="co">#&gt; 1  0.04808  0.0768 0.0787  0.0567 -0.012286 -0.02565  0.0665 -0.0782 -0.0922</span></a>
<a class="sourceLine" id="cb1082-56" data-line-number="56"><span class="co">#&gt; 2 -0.10280 -0.0959 0.0185 -0.0869  0.030428  0.09449 -0.0336 -0.0620  0.0626</span></a>
<a class="sourceLine" id="cb1082-57" data-line-number="57"><span class="co">#&gt; 3 -0.00221  0.0487 0.0788 -0.0361 -0.051271  0.06393  0.0150 -0.0633  0.0567</span></a>
<a class="sourceLine" id="cb1082-58" data-line-number="58"><span class="co">#&gt; 4 -0.04347 -0.0973 0.1096 -0.1001  0.000459  0.06790 -0.0159  0.0254  0.0470</span></a>
<a class="sourceLine" id="cb1082-59" data-line-number="59"><span class="co">#&gt; 5 -0.09180 -0.0216 0.1199 -0.0359 -0.061013  0.00677  0.0343 -0.0707  0.0570</span></a>
<a class="sourceLine" id="cb1082-60" data-line-number="60"><span class="co">#&gt; 6  0.03254 -0.0502 0.0795  0.0509  0.087713 -0.04079  0.0986 -0.0174  0.1193</span></a>
<a class="sourceLine" id="cb1082-61" data-line-number="61"><span class="co">#&gt;        C46     C47     C48      C49     C50     C51     C52     C53     C54</span></a>
<a class="sourceLine" id="cb1082-62" data-line-number="62"><span class="co">#&gt; 1  0.07987  0.0337 -0.1261 -0.02004  0.0541  0.0173  0.0875 -0.0894  0.0587</span></a>
<a class="sourceLine" id="cb1082-63" data-line-number="63"><span class="co">#&gt; 2  0.06935 -0.1198 -0.1147 -0.04850  0.0463  0.0115  0.0597 -0.0552 -0.0672</span></a>
<a class="sourceLine" id="cb1082-64" data-line-number="64"><span class="co">#&gt; 3  0.04721  0.0199  0.1021  0.00244 -0.0221 -0.0522 -0.0780 -0.0499  0.0711</span></a>
<a class="sourceLine" id="cb1082-65" data-line-number="65"><span class="co">#&gt; 4  0.00991  0.0644  0.1051 -0.10904 -0.1240 -0.0984  0.0766 -0.0646  0.0285</span></a>
<a class="sourceLine" id="cb1082-66" data-line-number="66"><span class="co">#&gt; 5 -0.11478 -0.0866  0.0754  0.00892  0.0145  0.0947 -0.0477 -0.1122  0.1049</span></a>
<a class="sourceLine" id="cb1082-67" data-line-number="67"><span class="co">#&gt; 6  0.08400  0.0695 -0.0186  0.04829  0.0836 -0.0816 -0.0504 -0.0313  0.0170</span></a>
<a class="sourceLine" id="cb1082-68" data-line-number="68"><span class="co">#&gt;       C55     C56     C57     C58     C59     C60      C61     C62     C63</span></a>
<a class="sourceLine" id="cb1082-69" data-line-number="69"><span class="co">#&gt; 1 -0.0459 -0.1107 -0.0754  0.0652  0.0229  0.1127 -0.10501 -0.0963  0.0273</span></a>
<a class="sourceLine" id="cb1082-70" data-line-number="70"><span class="co">#&gt; 2  0.0683  0.0439 -0.0168  0.0221  0.0807 -0.0466 -0.03439 -0.0324 -0.0621</span></a>
<a class="sourceLine" id="cb1082-71" data-line-number="71"><span class="co">#&gt; 3 -0.0483 -0.0317  0.0520 -0.0274 -0.0403 -0.1236 -0.01300  0.1349 -0.0883</span></a>
<a class="sourceLine" id="cb1082-72" data-line-number="72"><span class="co">#&gt; 4  0.0197 -0.1257  0.0383 -0.0587  0.0397 -0.0294  0.08061  0.0705 -0.0314</span></a>
<a class="sourceLine" id="cb1082-73" data-line-number="73"><span class="co">#&gt; 5  0.0839  0.0468 -0.0466  0.0502 -0.1089  0.0845 -0.00042 -0.0373 -0.0152</span></a>
<a class="sourceLine" id="cb1082-74" data-line-number="74"><span class="co">#&gt; 6 -0.0653 -0.0280 -0.1075  0.0672 -0.1058 -0.0183  0.03298 -0.1206  0.1134</span></a>
<a class="sourceLine" id="cb1082-75" data-line-number="75"><span class="co">#&gt;       C64     C65      C66     C67     C68     C69     C70      C71     C72</span></a>
<a class="sourceLine" id="cb1082-76" data-line-number="76"><span class="co">#&gt; 1  0.0421  0.0330  0.00794 -0.0443  0.1026  0.0929 -0.0155 -0.11416  0.0708</span></a>
<a class="sourceLine" id="cb1082-77" data-line-number="77"><span class="co">#&gt; 2 -0.0248  0.0353 -0.01374  0.0762  0.0356 -0.1140  0.0507  0.08107 -0.0931</span></a>
<a class="sourceLine" id="cb1082-78" data-line-number="78"><span class="co">#&gt; 3 -0.0855  0.1066  0.00725  0.0928 -0.0311  0.0364  0.0356  0.09118  0.1115</span></a>
<a class="sourceLine" id="cb1082-79" data-line-number="79"><span class="co">#&gt; 4  0.0743  0.0237 -0.10633 -0.0612 -0.1120  0.0768 -0.0111  0.00658 -0.1010</span></a>
<a class="sourceLine" id="cb1082-80" data-line-number="80"><span class="co">#&gt; 5 -0.0133 -0.0983 -0.03934 -0.0792  0.0777  0.0399  0.0359 -0.01084  0.1054</span></a>
<a class="sourceLine" id="cb1082-81" data-line-number="81"><span class="co">#&gt; 6 -0.0923 -0.0378  0.08867  0.1194 -0.0418 -0.0716 -0.0902  0.05559 -0.0793</span></a>
<a class="sourceLine" id="cb1082-82" data-line-number="82"><span class="co">#&gt;       C73     C74     C75      C76     C77     C78     C79     C80      C81</span></a>
<a class="sourceLine" id="cb1082-83" data-line-number="83"><span class="co">#&gt; 1 -0.0950  0.0622 -0.0194  0.00951 -0.0353  0.1160  0.0992 -0.0464 -0.13023</span></a>
<a class="sourceLine" id="cb1082-84" data-line-number="84"><span class="co">#&gt; 2 -0.0268 -0.0129 -0.1006  0.04435  0.0928 -0.0803 -0.1125  0.0245 -0.00872</span></a>
<a class="sourceLine" id="cb1082-85" data-line-number="85"><span class="co">#&gt; 3  0.0881 -0.0495  0.0295  0.04176 -0.0817  0.0462  0.0466  0.0766  0.05604</span></a>
<a class="sourceLine" id="cb1082-86" data-line-number="86"><span class="co">#&gt; 4 -0.0733 -0.0619  0.0667 -0.05055  0.0580 -0.0856 -0.1208  0.0300  0.11658</span></a>
<a class="sourceLine" id="cb1082-87" data-line-number="87"><span class="co">#&gt; 5 -0.0215 -0.0103  0.0488 -0.11458  0.1007 -0.0650  0.0870 -0.0268 -0.07648</span></a>
<a class="sourceLine" id="cb1082-88" data-line-number="88"><span class="co">#&gt; 6 -0.0195 -0.0710 -0.1159 -0.01947  0.0180 -0.0382 -0.0859 -0.0774 -0.10909</span></a>
<a class="sourceLine" id="cb1082-89" data-line-number="89"><span class="co">#&gt;       C82     C83     C84      C85      C86     C87      C88     C89     C90</span></a>
<a class="sourceLine" id="cb1082-90" data-line-number="90"><span class="co">#&gt; 1  0.0765  0.1223  0.0645 -0.05129 -0.03204  0.0356  0.04281  0.1060 -0.0794</span></a>
<a class="sourceLine" id="cb1082-91" data-line-number="91"><span class="co">#&gt; 2  0.1205  0.1209 -0.0815  0.00773  0.00698 -0.0343 -0.11369  0.0492 -0.0392</span></a>
<a class="sourceLine" id="cb1082-92" data-line-number="92"><span class="co">#&gt; 3  0.0220 -0.1042  0.0112 -0.07398  0.03285 -0.0900 -0.03173 -0.0913 -0.1012</span></a>
<a class="sourceLine" id="cb1082-93" data-line-number="93"><span class="co">#&gt; 4  0.0102 -0.0209  0.0639  0.12065  0.04215  0.1083  0.00679 -0.0178  0.1215</span></a>
<a class="sourceLine" id="cb1082-94" data-line-number="94"><span class="co">#&gt; 5  0.0178 -0.0894 -0.0429  0.05187  0.06779 -0.0439 -0.09529 -0.1319  0.0299</span></a>
<a class="sourceLine" id="cb1082-95" data-line-number="95"><span class="co">#&gt; 6 -0.1264  0.0780 -0.0172  0.07916 -0.05274 -0.0807  0.00310  0.1203  0.0137</span></a>
<a class="sourceLine" id="cb1082-96" data-line-number="96"><span class="co">#&gt;       C91     C92     C93     C94     C95      C96     C97     C98      C99</span></a>
<a class="sourceLine" id="cb1082-97" data-line-number="97"><span class="co">#&gt; 1 -0.0748 -0.0241 -0.1328 -0.0477 -0.0218 -0.01331 -0.0809  0.0942  0.09412</span></a>
<a class="sourceLine" id="cb1082-98" data-line-number="98"><span class="co">#&gt; 2  0.0634 -0.1135  0.0603 -0.0955  0.0332  0.04992 -0.0706 -0.0134 -0.08081</span></a>
<a class="sourceLine" id="cb1082-99" data-line-number="99"><span class="co">#&gt; 3  0.0985  0.0983  0.0855 -0.0666 -0.1168  0.00186 -0.0449  0.0614 -0.08222</span></a>
<a class="sourceLine" id="cb1082-100" data-line-number="100"><span class="co">#&gt; 4  0.1134 -0.0276 -0.0921  0.0228 -0.0388 -0.08308 -0.1000  0.0107 -0.00714</span></a>
<a class="sourceLine" id="cb1082-101" data-line-number="101"><span class="co">#&gt; 5  0.1249  0.0366 -0.0887  0.0748  0.0872 -0.00906  0.0861 -0.1269 -0.11396</span></a>
<a class="sourceLine" id="cb1082-102" data-line-number="102"><span class="co">#&gt; 6 -0.1190  0.0334 -0.0775 -0.0345  0.0853  0.10488 -0.0907 -0.0345  0.05273</span></a>
<a class="sourceLine" id="cb1082-103" data-line-number="103"><span class="co">#&gt;      C100    C101    C102    C103     C104    C105    C106    C107    C108</span></a>
<a class="sourceLine" id="cb1082-104" data-line-number="104"><span class="co">#&gt; 1  0.0319  0.0346 -0.0885  0.0766  0.05543 -0.0264  0.0952 -0.0202 -0.0334</span></a>
<a class="sourceLine" id="cb1082-105" data-line-number="105"><span class="co">#&gt; 2 -0.0172 -0.1089  0.1043 -0.0934 -0.00824  0.0546  0.0523  0.1050 -0.0517</span></a>
<a class="sourceLine" id="cb1082-106" data-line-number="106"><span class="co">#&gt; 3  0.0105 -0.0526 -0.0327  0.0295  0.10067 -0.0525 -0.1307 -0.0615 -0.0047</span></a>
<a class="sourceLine" id="cb1082-107" data-line-number="107"><span class="co">#&gt; 4 -0.1120  0.0676  0.1112  0.1049  0.11370  0.0844  0.0990 -0.1222  0.0821</span></a>
<a class="sourceLine" id="cb1082-108" data-line-number="108"><span class="co">#&gt; 5 -0.0399  0.1105 -0.0405 -0.0680  0.01242  0.0568 -0.1280  0.0108  0.0274</span></a>
<a class="sourceLine" id="cb1082-109" data-line-number="109"><span class="co">#&gt; 6  0.1123  0.0710  0.0391 -0.1235 -0.02942 -0.1177  0.0280 -0.0418  0.0537</span></a>
<a class="sourceLine" id="cb1082-110" data-line-number="110"><span class="co">#&gt;      C109    C110     C111    C112    C113    C114     C115     C116    C117</span></a>
<a class="sourceLine" id="cb1082-111" data-line-number="111"><span class="co">#&gt; 1 -0.0879  0.1271 -0.06159  0.1023 -0.0993 -0.0441 -0.06043  0.03101 -0.0402</span></a>
<a class="sourceLine" id="cb1082-112" data-line-number="112"><span class="co">#&gt; 2 -0.1134  0.0521 -0.07200  0.0481 -0.0836 -0.0608  0.09807 -0.10958 -0.0256</span></a>
<a class="sourceLine" id="cb1082-113" data-line-number="113"><span class="co">#&gt; 3 -0.1295  0.0225 -0.03538  0.1186  0.0620  0.0412  0.11363 -0.02249  0.0249</span></a>
<a class="sourceLine" id="cb1082-114" data-line-number="114"><span class="co">#&gt; 4  0.0281 -0.1094 -0.00212  0.0243 -0.1012 -0.0563 -0.00964 -0.05337 -0.1043</span></a>
<a class="sourceLine" id="cb1082-115" data-line-number="115"><span class="co">#&gt; 5  0.0566 -0.0803 -0.00174 -0.0554  0.0843 -0.1095  0.01792 -0.00474 -0.0733</span></a>
<a class="sourceLine" id="cb1082-116" data-line-number="116"><span class="co">#&gt; 6  0.1130 -0.0759  0.10338  0.0475  0.0545 -0.0418  0.06837 -0.06397  0.0368</span></a>
<a class="sourceLine" id="cb1082-117" data-line-number="117"><span class="co">#&gt;       C118    C119    C120    C121     C122    C123     C124      C125    C126</span></a>
<a class="sourceLine" id="cb1082-118" data-line-number="118"><span class="co">#&gt; 1 -0.01895 -0.0261  0.0402 -0.0251  0.09424  0.0966  0.00228 -0.077522  0.0142</span></a>
<a class="sourceLine" id="cb1082-119" data-line-number="119"><span class="co">#&gt; 2  0.10099  0.0207  0.0923  0.0384  0.10403 -0.0551  0.10162  0.000661  0.0347</span></a>
<a class="sourceLine" id="cb1082-120" data-line-number="120"><span class="co">#&gt; 3  0.01425  0.0196  0.0315 -0.0680  0.00706  0.0239  0.09849  0.007964 -0.0382</span></a>
<a class="sourceLine" id="cb1082-121" data-line-number="121"><span class="co">#&gt; 4 -0.07785 -0.0196 -0.1080 -0.1235  0.09256 -0.1258 -0.00357 -0.103288  0.1014</span></a>
<a class="sourceLine" id="cb1082-122" data-line-number="122"><span class="co">#&gt; 5 -0.05457  0.0762  0.1199 -0.0742  0.00491  0.1337 -0.09375  0.103790 -0.0205</span></a>
<a class="sourceLine" id="cb1082-123" data-line-number="123"><span class="co">#&gt; 6  0.00667 -0.0227 -0.0971  0.0684 -0.05678  0.0892 -0.10303 -0.028431  0.1244</span></a>
<a class="sourceLine" id="cb1082-124" data-line-number="124"><span class="co">#&gt;      C127    C128    C129    C130     C131    C132    C133    C134    C135</span></a>
<a class="sourceLine" id="cb1082-125" data-line-number="125"><span class="co">#&gt; 1  0.1164 -0.0921  0.1007  0.0535  0.00792  0.0853 -0.0783  0.0231  0.0448</span></a>
<a class="sourceLine" id="cb1082-126" data-line-number="126"><span class="co">#&gt; 2  0.0645  0.0764 -0.0765 -0.1097 -0.06539  0.0993  0.0588 -0.0855 -0.1164</span></a>
<a class="sourceLine" id="cb1082-127" data-line-number="127"><span class="co">#&gt; 3  0.1056  0.0134 -0.1243  0.0629  0.11091  0.0412 -0.0443 -0.0262  0.0415</span></a>
<a class="sourceLine" id="cb1082-128" data-line-number="128"><span class="co">#&gt; 4 -0.0445 -0.0286 -0.0825 -0.0237  0.04635 -0.0280 -0.1218 -0.0425 -0.0345</span></a>
<a class="sourceLine" id="cb1082-129" data-line-number="129"><span class="co">#&gt; 5 -0.1058 -0.0383  0.0901  0.1090  0.04313  0.0880 -0.0190  0.0587  0.0124</span></a>
<a class="sourceLine" id="cb1082-130" data-line-number="130"><span class="co">#&gt; 6 -0.0181  0.0919 -0.0118  0.0289  0.11518 -0.0602 -0.0381 -0.0360 -0.0848</span></a>
<a class="sourceLine" id="cb1082-131" data-line-number="131"><span class="co">#&gt;      C136     C137    C138    C139     C140      C141     C142    C143     C144</span></a>
<a class="sourceLine" id="cb1082-132" data-line-number="132"><span class="co">#&gt; 1  0.0831  0.10877 -0.0541  0.0592 -0.06678  3.94e-02 -0.10558  0.0837 -0.05210</span></a>
<a class="sourceLine" id="cb1082-133" data-line-number="133"><span class="co">#&gt; 2 -0.1057  0.00788 -0.1201 -0.0708  0.08667  8.53e-02 -0.00107 -0.0955  0.00348</span></a>
<a class="sourceLine" id="cb1082-134" data-line-number="134"><span class="co">#&gt; 3  0.0274  0.03089 -0.0102  0.0182 -0.04679 -2.28e-05 -0.07386 -0.0424 -0.05414</span></a>
<a class="sourceLine" id="cb1082-135" data-line-number="135"><span class="co">#&gt; 4 -0.0655  0.09424  0.0665  0.0313 -0.00283  8.88e-02  0.03223  0.0969  0.05919</span></a>
<a class="sourceLine" id="cb1082-136" data-line-number="136"><span class="co">#&gt; 5 -0.1035  0.11476  0.0388 -0.0986 -0.09315 -9.06e-02  0.09219  0.0187  0.00749</span></a>
<a class="sourceLine" id="cb1082-137" data-line-number="137"><span class="co">#&gt; 6  0.1189 -0.12480  0.1164 -0.1029  0.05281  8.03e-02  0.11433 -0.0218 -0.04665</span></a>
<a class="sourceLine" id="cb1082-138" data-line-number="138"><span class="co">#&gt;      C145     C146     C147    C148     C149    C150    C151    C152    C153</span></a>
<a class="sourceLine" id="cb1082-139" data-line-number="139"><span class="co">#&gt; 1  0.0455 -0.09315  0.10797 -0.0752  0.01976  0.0528 -0.0395 -0.0759 -0.0156</span></a>
<a class="sourceLine" id="cb1082-140" data-line-number="140"><span class="co">#&gt; 2  0.0212 -0.00859 -0.00524  0.0860 -0.12075 -0.1190 -0.0254 -0.0767 -0.0197</span></a>
<a class="sourceLine" id="cb1082-141" data-line-number="141"><span class="co">#&gt; 3  0.0619 -0.11111  0.06870  0.0926 -0.11018 -0.1076 -0.0371 -0.0890 -0.1176</span></a>
<a class="sourceLine" id="cb1082-142" data-line-number="142"><span class="co">#&gt; 4 -0.0570  0.10892  0.11586  0.0197 -0.00812  0.1160  0.1054  0.1079  0.0194</span></a>
<a class="sourceLine" id="cb1082-143" data-line-number="143"><span class="co">#&gt; 5 -0.0668  0.08647 -0.03015 -0.0833 -0.07880 -0.0228  0.0107  0.0478  0.0792</span></a>
<a class="sourceLine" id="cb1082-144" data-line-number="144"><span class="co">#&gt; 6  0.0326  0.02405  0.00564  0.0923 -0.00806 -0.0927 -0.0852 -0.0881  0.1125</span></a>
<a class="sourceLine" id="cb1082-145" data-line-number="145"><span class="co">#&gt;       C154    C155     C156    C157    C158    C159    C160    C161    C162</span></a>
<a class="sourceLine" id="cb1082-146" data-line-number="146"><span class="co">#&gt; 1 -0.02146  0.0272 -0.10700 -0.0485  0.1069 -0.0222 -0.1215  0.1173 -0.1092</span></a>
<a class="sourceLine" id="cb1082-147" data-line-number="147"><span class="co">#&gt; 2 -0.04919 -0.1028 -0.09557 -0.0688  0.0724 -0.1061 -0.0826 -0.0372 -0.0321</span></a>
<a class="sourceLine" id="cb1082-148" data-line-number="148"><span class="co">#&gt; 3  0.09752 -0.0856 -0.00768 -0.0937 -0.1134 -0.0187  0.0210 -0.0455  0.0236</span></a>
<a class="sourceLine" id="cb1082-149" data-line-number="149"><span class="co">#&gt; 4  0.05555  0.1035 -0.02658  0.0598  0.0392  0.0871 -0.0382 -0.0745 -0.0352</span></a>
<a class="sourceLine" id="cb1082-150" data-line-number="150"><span class="co">#&gt; 5 -0.07678  0.0235  0.05797 -0.0554  0.0938 -0.0901  0.0801  0.1033 -0.0861</span></a>
<a class="sourceLine" id="cb1082-151" data-line-number="151"><span class="co">#&gt; 6  0.00529 -0.0236 -0.09379  0.0428 -0.0683  0.1010 -0.0253  0.0320 -0.1234</span></a>
<a class="sourceLine" id="cb1082-152" data-line-number="152"><span class="co">#&gt;      C163     C164    C165    C166    C167     C168     C169    C170     C171</span></a>
<a class="sourceLine" id="cb1082-153" data-line-number="153"><span class="co">#&gt; 1  0.0475  0.12497  0.0438 -0.0681  0.0130 -0.07495 -0.05462  0.0909 -0.09216</span></a>
<a class="sourceLine" id="cb1082-154" data-line-number="154"><span class="co">#&gt; 2  0.0342  0.00279 -0.1191 -0.0681  0.0942 -0.06833  0.06510  0.1216 -0.04768</span></a>
<a class="sourceLine" id="cb1082-155" data-line-number="155"><span class="co">#&gt; 3 -0.0109 -0.11894  0.0266 -0.1151 -0.0617  0.00173 -0.12031  0.1377  0.10794</span></a>
<a class="sourceLine" id="cb1082-156" data-line-number="156"><span class="co">#&gt; 4 -0.0114  0.05479 -0.0755 -0.0730 -0.0544 -0.11740  0.00999  0.1094  0.10811</span></a>
<a class="sourceLine" id="cb1082-157" data-line-number="157"><span class="co">#&gt; 5 -0.1010  0.10222  0.0897 -0.0279  0.0996  0.00548 -0.09620  0.0386  0.11528</span></a>
<a class="sourceLine" id="cb1082-158" data-line-number="158"><span class="co">#&gt; 6 -0.0125  0.06254 -0.0553  0.1110  0.0710  0.07833 -0.08422 -0.0710 -0.00932</span></a>
<a class="sourceLine" id="cb1082-159" data-line-number="159"><span class="co">#&gt;       C172    C173    C174     C175    C176    C177     C178    C179    C180</span></a>
<a class="sourceLine" id="cb1082-160" data-line-number="160"><span class="co">#&gt; 1 -0.11974 -0.0892 -0.0406  0.07403 -0.0620 -0.0524  0.00062  0.0850  0.0188</span></a>
<a class="sourceLine" id="cb1082-161" data-line-number="161"><span class="co">#&gt; 2  0.02099  0.0153  0.0339 -0.06163  0.0701  0.0285  0.05499  0.0993  0.0267</span></a>
<a class="sourceLine" id="cb1082-162" data-line-number="162"><span class="co">#&gt; 3 -0.00556  0.0947 -0.1136 -0.00343  0.0363  0.1267 -0.08477 -0.1310  0.0721</span></a>
<a class="sourceLine" id="cb1082-163" data-line-number="163"><span class="co">#&gt; 4 -0.05900  0.0135 -0.0809 -0.03244  0.0191 -0.0416 -0.06254 -0.0564  0.0416</span></a>
<a class="sourceLine" id="cb1082-164" data-line-number="164"><span class="co">#&gt; 5 -0.00887 -0.1004  0.0851  0.03697  0.0808 -0.0493  0.09818 -0.0103  0.0788</span></a>
<a class="sourceLine" id="cb1082-165" data-line-number="165"><span class="co">#&gt; 6 -0.05284  0.0259  0.0849 -0.10247  0.0355  0.1022  0.06330  0.0788 -0.0309</span></a>
<a class="sourceLine" id="cb1082-166" data-line-number="166"><span class="co">#&gt;      C181    C182      C183     C184    C185    C186     C187   C188    C189</span></a>
<a class="sourceLine" id="cb1082-167" data-line-number="167"><span class="co">#&gt; 1 -0.0624  0.0600 -0.100619 -0.10355 -0.0532 -0.0744  0.03719 0.1110 -0.0400</span></a>
<a class="sourceLine" id="cb1082-168" data-line-number="168"><span class="co">#&gt; 2 -0.0390 -0.0129  0.057856 -0.00785 -0.0933 -0.0581 -0.03945 0.0673 -0.1124</span></a>
<a class="sourceLine" id="cb1082-169" data-line-number="169"><span class="co">#&gt; 3 -0.0614  0.0358 -0.058056 -0.09399  0.0662 -0.1146  0.05791 0.0162  0.0926</span></a>
<a class="sourceLine" id="cb1082-170" data-line-number="170"><span class="co">#&gt; 4  0.0539  0.0967 -0.011134  0.07357  0.1123 -0.0690 -0.05058 0.1119 -0.0845</span></a>
<a class="sourceLine" id="cb1082-171" data-line-number="171"><span class="co">#&gt; 5  0.0945  0.0956 -0.000865  0.03768  0.0250  0.0329 -0.00464 0.0576  0.0277</span></a>
<a class="sourceLine" id="cb1082-172" data-line-number="172"><span class="co">#&gt; 6 -0.1213 -0.0605  0.046824  0.05828 -0.0692  0.0937  0.02647 0.1133  0.1138</span></a>
<a class="sourceLine" id="cb1082-173" data-line-number="173"><span class="co">#&gt;        C190     C191    C192     C193     C194    C195    C196    C197    C198</span></a>
<a class="sourceLine" id="cb1082-174" data-line-number="174"><span class="co">#&gt; 1 -0.036411 -0.01097 -0.1144  0.05057 -0.09845  0.0983 -0.0476  0.1168  0.0458</span></a>
<a class="sourceLine" id="cb1082-175" data-line-number="175"><span class="co">#&gt; 2  0.010732 -0.04342  0.0922  0.09822  0.01483 -0.0345  0.0902  0.0252 -0.1144</span></a>
<a class="sourceLine" id="cb1082-176" data-line-number="176"><span class="co">#&gt; 3  0.069120 -0.06352  0.1058  0.00429  0.08702 -0.1216 -0.0778  0.0257 -0.0153</span></a>
<a class="sourceLine" id="cb1082-177" data-line-number="177"><span class="co">#&gt; 4  0.065781  0.00765  0.0727  0.09194  0.08351  0.0850 -0.0502 -0.0785 -0.0677</span></a>
<a class="sourceLine" id="cb1082-178" data-line-number="178"><span class="co">#&gt; 5 -0.025878  0.09510 -0.0722 -0.08110 -0.04374  0.0957  0.0538 -0.0178 -0.0432</span></a>
<a class="sourceLine" id="cb1082-179" data-line-number="179"><span class="co">#&gt; 6  0.000974  0.07305 -0.0720  0.02777  0.00687 -0.0791 -0.0674 -0.0739  0.0982</span></a>
<a class="sourceLine" id="cb1082-180" data-line-number="180"><span class="co">#&gt;       C199    C200</span></a>
<a class="sourceLine" id="cb1082-181" data-line-number="181"><span class="co">#&gt; 1 -0.07104 -0.0811</span></a>
<a class="sourceLine" id="cb1082-182" data-line-number="182"><span class="co">#&gt; 2  0.01373  0.0426</span></a>
<a class="sourceLine" id="cb1082-183" data-line-number="183"><span class="co">#&gt; 3 -0.07396  0.0129</span></a>
<a class="sourceLine" id="cb1082-184" data-line-number="184"><span class="co">#&gt; 4 -0.06458 -0.0842</span></a>
<a class="sourceLine" id="cb1082-185" data-line-number="185"><span class="co">#&gt; 5  0.08370  0.1115</span></a>
<a class="sourceLine" id="cb1082-186" data-line-number="186"><span class="co">#&gt; 6  0.00944 -0.0254</span></a>
<a class="sourceLine" id="cb1082-187" data-line-number="187"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-188" data-line-number="188"><span class="co">#&gt; [200 rows x 200 columns]</span></a>
<a class="sourceLine" id="cb1082-189" data-line-number="189"><span class="kw">h2o.weights</span>(iris_dl, <span class="dt">matrix_id=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1082-190" data-line-number="190"><span class="co">#&gt;       C1      C2    C3    C4      C5     C6     C7    C8     C9    C10    C11</span></a>
<a class="sourceLine" id="cb1082-191" data-line-number="191"><span class="co">#&gt; 1  0.221 -0.6411 0.355  0.37 -0.6805 -0.633 -0.439 0.312  0.034  0.189 -0.305</span></a>
<a class="sourceLine" id="cb1082-192" data-line-number="192"><span class="co">#&gt; 2  0.594  0.6279 0.442 -0.38 -0.2770 -0.113  0.652 0.550  0.159 -0.563 -0.357</span></a>
<a class="sourceLine" id="cb1082-193" data-line-number="193"><span class="co">#&gt; 3 -0.423 -0.0905 0.456 -0.14  0.0278 -0.599 -0.467 0.123 -0.541  0.186 -0.591</span></a>
<a class="sourceLine" id="cb1082-194" data-line-number="194"><span class="co">#&gt;      C12      C13    C14    C15    C16     C17    C18    C19    C20    C21</span></a>
<a class="sourceLine" id="cb1082-195" data-line-number="195"><span class="co">#&gt; 1 -0.131 0.000824  0.637  0.448  0.252  0.1815  0.368  0.278  0.476  0.253</span></a>
<a class="sourceLine" id="cb1082-196" data-line-number="196"><span class="co">#&gt; 2  0.547 0.276019 -0.427 -0.342 -0.521 -0.0805 -0.325 -0.141  0.177 -0.371</span></a>
<a class="sourceLine" id="cb1082-197" data-line-number="197"><span class="co">#&gt; 3 -0.342 0.222491 -0.383 -0.580 -0.315 -0.4951 -0.562 -0.397 -0.191  0.448</span></a>
<a class="sourceLine" id="cb1082-198" data-line-number="198"><span class="co">#&gt;      C22    C23    C24   C25     C26      C27    C28    C29     C30    C31</span></a>
<a class="sourceLine" id="cb1082-199" data-line-number="199"><span class="co">#&gt; 1  0.673 -0.694 -0.595 0.415  0.2673  0.48604 -0.180 -0.217  0.6829 -0.299</span></a>
<a class="sourceLine" id="cb1082-200" data-line-number="200"><span class="co">#&gt; 2  0.548 -0.535  0.381 0.561 -0.6682 -0.46363 -0.467  0.126  0.0322 -0.406</span></a>
<a class="sourceLine" id="cb1082-201" data-line-number="201"><span class="co">#&gt; 3 -0.417  0.480  0.459 0.640 -0.0906  0.00539  0.591 -0.152 -0.4286  0.488</span></a>
<a class="sourceLine" id="cb1082-202" data-line-number="202"><span class="co">#&gt;      C32     C33    C34    C35     C36    C37    C38    C39     C40    C41</span></a>
<a class="sourceLine" id="cb1082-203" data-line-number="203"><span class="co">#&gt; 1  0.320 -0.0293  0.284  0.295  0.0542 -0.680  0.123 -0.594  0.5784 -0.492</span></a>
<a class="sourceLine" id="cb1082-204" data-line-number="204"><span class="co">#&gt; 2  0.432 -0.4395 -0.142 -0.144  0.5747 -0.301  0.558  0.665 -0.0456  0.353</span></a>
<a class="sourceLine" id="cb1082-205" data-line-number="205"><span class="co">#&gt; 3 -0.237 -0.0891  0.193 -0.594 -0.6304 -0.350 -0.121 -0.196 -0.4759 -0.379</span></a>
<a class="sourceLine" id="cb1082-206" data-line-number="206"><span class="co">#&gt;      C42    C43    C44    C45    C46     C47    C48    C49    C50    C51    C52</span></a>
<a class="sourceLine" id="cb1082-207" data-line-number="207"><span class="co">#&gt; 1  0.508 -0.593 -0.505 0.2284 -0.103 -0.3152  0.120  0.680 -0.394 0.3270  0.514</span></a>
<a class="sourceLine" id="cb1082-208" data-line-number="208"><span class="co">#&gt; 2 -0.631  0.125  0.447 0.0793 -0.192  0.0839  0.074  0.564  0.452 0.0432 -0.323</span></a>
<a class="sourceLine" id="cb1082-209" data-line-number="209"><span class="co">#&gt; 3 -0.163 -0.491 -0.652 0.4234 -0.379 -0.0789 -0.563 -0.181  0.660 0.5421 -0.649</span></a>
<a class="sourceLine" id="cb1082-210" data-line-number="210"><span class="co">#&gt;      C53    C54    C55    C56    C57      C58    C59     C60    C61    C62</span></a>
<a class="sourceLine" id="cb1082-211" data-line-number="211"><span class="co">#&gt; 1 -0.295 0.6012  0.516 0.0679 -0.450  0.00321  0.337 -0.2636 -0.224 -0.448</span></a>
<a class="sourceLine" id="cb1082-212" data-line-number="212"><span class="co">#&gt; 2  0.400 0.0629  0.195 0.3530  0.517 -0.61159 -0.651  0.0297 -0.634  0.121</span></a>
<a class="sourceLine" id="cb1082-213" data-line-number="213"><span class="co">#&gt; 3  0.691 0.6051 -0.367 0.2909 -0.342 -0.35741  0.186  0.5518  0.481  0.307</span></a>
<a class="sourceLine" id="cb1082-214" data-line-number="214"><span class="co">#&gt;     C63    C64     C65    C66    C67    C68    C69     C70    C71   C72    C73</span></a>
<a class="sourceLine" id="cb1082-215" data-line-number="215"><span class="co">#&gt; 1 0.457 -0.616 -0.3777 -0.450  0.512 -0.326 -0.450  0.1719 -0.185 0.575 -0.107</span></a>
<a class="sourceLine" id="cb1082-216" data-line-number="216"><span class="co">#&gt; 2 0.512  0.649 -0.0471 -0.267 -0.312 -0.544  0.635 -0.3751  0.382 0.323  0.536</span></a>
<a class="sourceLine" id="cb1082-217" data-line-number="217"><span class="co">#&gt; 3 0.345 -0.400 -0.2966 -0.657  0.491  0.397 -0.639 -0.0331 -0.346 0.571  0.186</span></a>
<a class="sourceLine" id="cb1082-218" data-line-number="218"><span class="co">#&gt;      C74    C75    C76     C77     C78    C79    C80    C81   C82    C83    C84</span></a>
<a class="sourceLine" id="cb1082-219" data-line-number="219"><span class="co">#&gt; 1  0.598 -0.313 -0.666 -0.1570 -0.0208  0.267 -0.340 -0.473 0.328 -0.450  0.359</span></a>
<a class="sourceLine" id="cb1082-220" data-line-number="220"><span class="co">#&gt; 2 -0.659  0.461 -0.505 -0.0829  0.3881 -0.281  0.583 -0.450 0.424 -0.509  0.316</span></a>
<a class="sourceLine" id="cb1082-221" data-line-number="221"><span class="co">#&gt; 3 -0.535 -0.313  0.543  0.1732 -0.3477 -0.101  0.666 -0.585 0.082  0.409 -0.623</span></a>
<a class="sourceLine" id="cb1082-222" data-line-number="222"><span class="co">#&gt;      C85    C86     C87     C88    C89   C90    C91     C92     C93    C94</span></a>
<a class="sourceLine" id="cb1082-223" data-line-number="223"><span class="co">#&gt; 1 -0.250 -0.638  0.4870 -0.2724 0.0719 0.048  0.628  0.0986  0.2322 -0.387</span></a>
<a class="sourceLine" id="cb1082-224" data-line-number="224"><span class="co">#&gt; 2 -0.397  0.359 -0.4832  0.0955 0.0288 0.214  0.305 -0.2733 -0.0951 -0.551</span></a>
<a class="sourceLine" id="cb1082-225" data-line-number="225"><span class="co">#&gt; 3 -0.393  0.331 -0.0837  0.1385 0.3454 0.310 -0.347 -0.2593  0.3379  0.144</span></a>
<a class="sourceLine" id="cb1082-226" data-line-number="226"><span class="co">#&gt;       C95      C96    C97    C98     C99     C100   C101    C102    C103   C104</span></a>
<a class="sourceLine" id="cb1082-227" data-line-number="227"><span class="co">#&gt; 1 -0.6430 -0.48931  0.191 -0.145  0.5399  0.00252  0.387  0.0393 -0.0453  0.285</span></a>
<a class="sourceLine" id="cb1082-228" data-line-number="228"><span class="co">#&gt; 2  0.1561  0.63293  0.488 -0.482  0.3748 -0.65743 -0.353 -0.2456  0.0860 -0.646</span></a>
<a class="sourceLine" id="cb1082-229" data-line-number="229"><span class="co">#&gt; 3  0.0907  0.00607 -0.479  0.380 -0.0244  0.13712 -0.116 -0.0769  0.5350 -0.117</span></a>
<a class="sourceLine" id="cb1082-230" data-line-number="230"><span class="co">#&gt;      C105    C106    C107   C108   C109   C110    C111   C112   C113   C114</span></a>
<a class="sourceLine" id="cb1082-231" data-line-number="231"><span class="co">#&gt; 1 -0.2039  0.1943  0.0273  0.501 -0.512 0.0149  0.1208 -0.545  0.501 -0.282</span></a>
<a class="sourceLine" id="cb1082-232" data-line-number="232"><span class="co">#&gt; 2  0.0966 -0.4805 -0.4261  0.184  0.640 0.3925 -0.0746 -0.178  0.168 -0.246</span></a>
<a class="sourceLine" id="cb1082-233" data-line-number="233"><span class="co">#&gt; 3  0.2536  0.0626 -0.1348 -0.196 -0.345 0.5819  0.2377 -0.402 -0.312  0.155</span></a>
<a class="sourceLine" id="cb1082-234" data-line-number="234"><span class="co">#&gt;      C115   C116  C117    C118    C119   C120   C121    C122   C123    C124</span></a>
<a class="sourceLine" id="cb1082-235" data-line-number="235"><span class="co">#&gt; 1 -0.0109 -0.575 0.267 -0.0816 -0.3704  0.236  0.544 -0.0449  0.455 -0.1536</span></a>
<a class="sourceLine" id="cb1082-236" data-line-number="236"><span class="co">#&gt; 2  0.3614 -0.304 0.427 -0.1644  0.0815 -0.530 -0.114  0.4491 -0.677  0.3985</span></a>
<a class="sourceLine" id="cb1082-237" data-line-number="237"><span class="co">#&gt; 3 -0.2341  0.140 0.540 -0.2602  0.1599  0.199  0.237 -0.0667  0.229 -0.0786</span></a>
<a class="sourceLine" id="cb1082-238" data-line-number="238"><span class="co">#&gt;     C125   C126    C127   C128    C129   C130   C131   C132   C133    C134</span></a>
<a class="sourceLine" id="cb1082-239" data-line-number="239"><span class="co">#&gt; 1  0.691  0.184 -0.0397 -0.438 -0.2855 -0.155 -0.651 -0.410 -0.460  0.0462</span></a>
<a class="sourceLine" id="cb1082-240" data-line-number="240"><span class="co">#&gt; 2 -0.388 -0.472 -0.5949  0.526 -0.0245  0.542  0.481 -0.514  0.148 -0.5670</span></a>
<a class="sourceLine" id="cb1082-241" data-line-number="241"><span class="co">#&gt; 3 -0.512  0.507  0.3048  0.311  0.5450 -0.259  0.440  0.305  0.614 -0.3263</span></a>
<a class="sourceLine" id="cb1082-242" data-line-number="242"><span class="co">#&gt;     C135   C136   C137    C138  C139   C140   C141   C142  C143  C144   C145</span></a>
<a class="sourceLine" id="cb1082-243" data-line-number="243"><span class="co">#&gt; 1 -0.122  0.132 -0.483 -0.0317 0.585 -0.441  0.136 -0.133 0.200 0.428  0.323</span></a>
<a class="sourceLine" id="cb1082-244" data-line-number="244"><span class="co">#&gt; 2 -0.074 -0.472 -0.381  0.3795 0.453  0.682  0.579  0.635 0.541 0.475 -0.615</span></a>
<a class="sourceLine" id="cb1082-245" data-line-number="245"><span class="co">#&gt; 3 -0.130  0.468 -0.602  0.3601 0.536  0.677 -0.329 -0.336 0.510 0.367 -0.134</span></a>
<a class="sourceLine" id="cb1082-246" data-line-number="246"><span class="co">#&gt;      C146   C147   C148    C149    C150   C151   C152   C153    C154   C155</span></a>
<a class="sourceLine" id="cb1082-247" data-line-number="247"><span class="co">#&gt; 1 -0.0636  0.446 -0.504  0.0138  0.5243  0.194  0.272 -0.112  0.5154  0.658</span></a>
<a class="sourceLine" id="cb1082-248" data-line-number="248"><span class="co">#&gt; 2 -0.1417 -0.322  0.103 -0.4125 -0.0811 -0.244 -0.556 -0.269 -0.0664 -0.347</span></a>
<a class="sourceLine" id="cb1082-249" data-line-number="249"><span class="co">#&gt; 3 -0.1403 -0.533 -0.487  0.4266 -0.4133 -0.382 -0.601 -0.246 -0.2009  0.545</span></a>
<a class="sourceLine" id="cb1082-250" data-line-number="250"><span class="co">#&gt;     C156   C157   C158   C159   C160    C161   C162    C163    C164   C165</span></a>
<a class="sourceLine" id="cb1082-251" data-line-number="251"><span class="co">#&gt; 1 -0.427 0.4684 -0.131 -0.245 0.4007 -0.6639 -0.315 -0.0924 -0.1032 -0.586</span></a>
<a class="sourceLine" id="cb1082-252" data-line-number="252"><span class="co">#&gt; 2  0.579 0.0616 -0.137  0.302 0.0737 -0.3256 -0.407 -0.4269 -0.0378 -0.618</span></a>
<a class="sourceLine" id="cb1082-253" data-line-number="253"><span class="co">#&gt; 3 -0.399 0.0010 -0.567 -0.217 0.4684  0.0366  0.605  0.3977 -0.6410 -0.655</span></a>
<a class="sourceLine" id="cb1082-254" data-line-number="254"><span class="co">#&gt;      C166   C167   C168   C169   C170   C171   C172   C173   C174   C175</span></a>
<a class="sourceLine" id="cb1082-255" data-line-number="255"><span class="co">#&gt; 1 -0.6072  0.475 -0.617 -0.274  0.423  0.294 -0.124  0.201 -0.404  0.035</span></a>
<a class="sourceLine" id="cb1082-256" data-line-number="256"><span class="co">#&gt; 2 -0.0545 -0.255  0.630  0.513 -0.529 -0.200 -0.366 -0.590 -0.432  0.181</span></a>
<a class="sourceLine" id="cb1082-257" data-line-number="257"><span class="co">#&gt; 3  0.0478 -0.555  0.124  0.650 -0.177  0.222 -0.583  0.630  0.500 -0.106</span></a>
<a class="sourceLine" id="cb1082-258" data-line-number="258"><span class="co">#&gt;      C176    C177   C178   C179   C180    C181  C182    C183   C184    C185</span></a>
<a class="sourceLine" id="cb1082-259" data-line-number="259"><span class="co">#&gt; 1  0.1438  0.5816 -0.478  0.370  0.316 -0.0206 0.656 -0.0264  0.535  0.0505</span></a>
<a class="sourceLine" id="cb1082-260" data-line-number="260"><span class="co">#&gt; 2 -0.0749 -0.5352  0.592  0.566 -0.645 -0.6772 0.297 -0.3675  0.250  0.4445</span></a>
<a class="sourceLine" id="cb1082-261" data-line-number="261"><span class="co">#&gt; 3 -0.5238  0.0726  0.323 -0.508  0.290  0.4277 0.121  0.0826 -0.290 -0.5744</span></a>
<a class="sourceLine" id="cb1082-262" data-line-number="262"><span class="co">#&gt;     C186     C187    C188   C189   C190   C191   C192   C193   C194   C195</span></a>
<a class="sourceLine" id="cb1082-263" data-line-number="263"><span class="co">#&gt; 1  0.431 -0.00463  0.0642  0.588  0.357  0.423 -0.271  0.239 -0.470 -0.193</span></a>
<a class="sourceLine" id="cb1082-264" data-line-number="264"><span class="co">#&gt; 2 -0.130  0.21874 -0.0486 -0.532  0.427 -0.063 -0.568  0.248  0.654 -0.499</span></a>
<a class="sourceLine" id="cb1082-265" data-line-number="265"><span class="co">#&gt; 3  0.477 -0.09013 -0.5105 -0.630 -0.574 -0.353  0.665 -0.646  0.481  0.661</span></a>
<a class="sourceLine" id="cb1082-266" data-line-number="266"><span class="co">#&gt;     C196   C197   C198   C199    C200</span></a>
<a class="sourceLine" id="cb1082-267" data-line-number="267"><span class="co">#&gt; 1 -0.708 -0.499 -0.560 -0.101  0.0391</span></a>
<a class="sourceLine" id="cb1082-268" data-line-number="268"><span class="co">#&gt; 2 -0.137 -0.565 -0.325 -0.622  0.4751</span></a>
<a class="sourceLine" id="cb1082-269" data-line-number="269"><span class="co">#&gt; 3  0.584 -0.336 -0.666 -0.611 -0.1059</span></a>
<a class="sourceLine" id="cb1082-270" data-line-number="270"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-271" data-line-number="271"><span class="co">#&gt; [3 rows x 200 columns]</span></a>
<a class="sourceLine" id="cb1082-272" data-line-number="272"><span class="kw">h2o.biases</span>(iris_dl,  <span class="dt">vector_id=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1082-273" data-line-number="273"><span class="co">#&gt;      C1</span></a>
<a class="sourceLine" id="cb1082-274" data-line-number="274"><span class="co">#&gt; 1 0.492</span></a>
<a class="sourceLine" id="cb1082-275" data-line-number="275"><span class="co">#&gt; 2 0.467</span></a>
<a class="sourceLine" id="cb1082-276" data-line-number="276"><span class="co">#&gt; 3 0.484</span></a>
<a class="sourceLine" id="cb1082-277" data-line-number="277"><span class="co">#&gt; 4 0.488</span></a>
<a class="sourceLine" id="cb1082-278" data-line-number="278"><span class="co">#&gt; 5 0.482</span></a>
<a class="sourceLine" id="cb1082-279" data-line-number="279"><span class="co">#&gt; 6 0.482</span></a>
<a class="sourceLine" id="cb1082-280" data-line-number="280"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-281" data-line-number="281"><span class="co">#&gt; [200 rows x 1 column]</span></a>
<a class="sourceLine" id="cb1082-282" data-line-number="282"><span class="kw">h2o.biases</span>(iris_dl,  <span class="dt">vector_id=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1082-283" data-line-number="283"><span class="co">#&gt;      C1</span></a>
<a class="sourceLine" id="cb1082-284" data-line-number="284"><span class="co">#&gt; 1 1.003</span></a>
<a class="sourceLine" id="cb1082-285" data-line-number="285"><span class="co">#&gt; 2 1.001</span></a>
<a class="sourceLine" id="cb1082-286" data-line-number="286"><span class="co">#&gt; 3 0.995</span></a>
<a class="sourceLine" id="cb1082-287" data-line-number="287"><span class="co">#&gt; 4 0.998</span></a>
<a class="sourceLine" id="cb1082-288" data-line-number="288"><span class="co">#&gt; 5 0.999</span></a>
<a class="sourceLine" id="cb1082-289" data-line-number="289"><span class="co">#&gt; 6 1.001</span></a>
<a class="sourceLine" id="cb1082-290" data-line-number="290"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-291" data-line-number="291"><span class="co">#&gt; [200 rows x 1 column]</span></a>
<a class="sourceLine" id="cb1082-292" data-line-number="292"><span class="kw">h2o.biases</span>(iris_dl,  <span class="dt">vector_id=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1082-293" data-line-number="293"><span class="co">#&gt;          C1</span></a>
<a class="sourceLine" id="cb1082-294" data-line-number="294"><span class="co">#&gt; 1  0.000216</span></a>
<a class="sourceLine" id="cb1082-295" data-line-number="295"><span class="co">#&gt; 2  0.000517</span></a>
<a class="sourceLine" id="cb1082-296" data-line-number="296"><span class="co">#&gt; 3 -0.000487</span></a>
<a class="sourceLine" id="cb1082-297" data-line-number="297"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1082-298" data-line-number="298"><span class="co">#&gt; [3 rows x 1 column]</span></a>
<a class="sourceLine" id="cb1082-299" data-line-number="299"><span class="co">#plot weights connecting `Sepal.Length` to first hidden neurons</span></a>
<a class="sourceLine" id="cb1082-300" data-line-number="300"><span class="kw">plot</span>(<span class="kw">as.data.frame</span>(<span class="kw">h2o.weights</span>(iris_dl,  <span class="dt">matrix_id=</span><span class="dv">1</span>))[,<span class="dv">1</span>])</a></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/export_weight_biases-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="reproducibility" class="section level3">
<h3>
<span class="header-section-number">46.8.11</span> Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"><i class="fas fa-link"></i></a>
</h3>
<p>Every run of DeepLearning results in different results since multithreading is done via Hogwild! that benefits from intentional lock-free race conditions between threads. To get reproducible results for small datasets and testing purposes, set <code>reproducible=T</code> and set <code>seed=1337</code> (pick any integer). This will not work for big data for technical reasons, and is probably also not desired because of the significant slowdown (runs on 1 core only).</p>
</div>
<div id="scoring-on-trainingvalidation-sets-during-training" class="section level3">
<h3>
<span class="header-section-number">46.8.12</span> Scoring on Training/Validation Sets During Training<a class="anchor" aria-label="anchor" href="#scoring-on-trainingvalidation-sets-during-training"><i class="fas fa-link"></i></a>
</h3>
<p>The training and/or validation set errors can be based on a subset of the training or validation data, depending on the values for <code>score_validation_samples</code> (defaults to 0: all) or <code>score_training_samples</code> (defaults to 10,000 rows, since the training error is only used for early stopping and monitoring). For large datasets, Deep Learning can automatically sample the validation set to avoid spending too much time in scoring during training, especially since scoring results are not currently displayed in the model returned to R.</p>
<p>Note that the default value of <code>score_duty_cycle=0.1</code> limits the amount of time spent in scoring to 10%, so a large number of scoring samples won’t slow down overall training progress too much, but it will always score once after the first MapReduce iteration, and once at the end of training.</p>
<p>Stratified sampling of the validation dataset can help with scoring on datasets with class imbalance. Note that this option also requires <code>balance_classes</code> to be enabled (used to over/under-sample the training dataset, based on the max. relative size of the resulting training dataset, max_after_balance_size):</p>
<p>More information can be found in the H2O Deep Learning booklet, in our H2O SlideShare Presentations, our H2O YouTube channel, as well as on our H2O Github Repository, especially in our H2O Deep Learning R tests, and H2O Deep Learning Python tests.</p>
</div>
</div>
<div id="all-done-shutdown-h2o" class="section level2">
<h2>
<span class="header-section-number">46.9</span> All done, shutdown H2O<a class="anchor" aria-label="anchor" href="#all-done-shutdown-h2o"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb1083"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.shutdown.html">h2o.shutdown</a></span><span class="op">(</span>prompt<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">45</span> Tuning Hyperparameters in a Neural Network</a></div>
<div class="next"><a href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#deep-learning-tips-for-classification-and-regression"><span class="header-section-number">46</span> Deep Learning tips for Classification and Regression</a></li>
<li><a class="nav-link" href="#introduction-26"><span class="header-section-number">46.1</span> Introduction</a></li>
<li><a class="nav-link" href="#h2o-r-package"><span class="header-section-number">46.2</span> H2O R Package</a></li>
<li><a class="nav-link" href="#start-h2o"><span class="header-section-number">46.3</span> Start H2O</a></li>
<li><a class="nav-link" href="#lets-have-some-fun-first-decision-boundaries"><span class="header-section-number">46.4</span> Let’s have some fun first: Decision Boundaries</a></li>
<li>
<a class="nav-link" href="#cover-type-dataset"><span class="header-section-number">46.5</span> Cover Type Dataset</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#first-run-of-h2o-deep-learning"><span class="header-section-number">46.5.1</span> First Run of H2O Deep Learning</a></li>
<li><a class="nav-link" href="#variable-importances"><span class="header-section-number">46.5.2</span> Variable Importances</a></li>
<li><a class="nav-link" href="#early-stopping"><span class="header-section-number">46.5.3</span> Early Stopping</a></li>
<li><a class="nav-link" href="#adaptive-learning-rate"><span class="header-section-number">46.5.4</span> Adaptive Learning Rate</a></li>
<li><a class="nav-link" href="#tuning"><span class="header-section-number">46.5.5</span> Tuning</a></li>
<li><a class="nav-link" href="#hyper-parameter-tuning-with-grid-search"><span class="header-section-number">46.5.6</span> Hyper-parameter Tuning with Grid Search</a></li>
<li><a class="nav-link" href="#random-hyper-parameter-search"><span class="header-section-number">46.5.7</span> Random Hyper-Parameter Search</a></li>
<li><a class="nav-link" href="#checkpointing"><span class="header-section-number">46.5.8</span> Checkpointing</a></li>
<li><a class="nav-link" href="#cross-validation"><span class="header-section-number">46.5.9</span> Cross-Validation</a></li>
</ul>
</li>
<li><a class="nav-link" href="#regression-and-binary-classification"><span class="header-section-number">46.6</span> Regression and Binary Classification</a></li>
<li><a class="nav-link" href="#unsupervised-anomaly-detection"><span class="header-section-number">46.7</span> Unsupervised Anomaly detection</a></li>
<li>
<a class="nav-link" href="#h2o-deep-learning-tips-tricks"><span class="header-section-number">46.8</span> H2O Deep Learning Tips &amp; Tricks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#performance-tuning"><span class="header-section-number">46.8.1</span> Performance Tuning</a></li>
<li><a class="nav-link" href="#activation-functions"><span class="header-section-number">46.8.2</span> Activation Functions</a></li>
<li><a class="nav-link" href="#generalization-techniques"><span class="header-section-number">46.8.3</span> Generalization Techniques</a></li>
<li><a class="nav-link" href="#early-stopping-and-optimizing-for-lowest-validation-error"><span class="header-section-number">46.8.4</span> Early stopping and optimizing for lowest validation error</a></li>
<li><a class="nav-link" href="#training-samples-per-mapreduce-iteration"><span class="header-section-number">46.8.5</span> Training Samples per MapReduce Iteration</a></li>
<li><a class="nav-link" href="#categorical-data"><span class="header-section-number">46.8.6</span> Categorical Data</a></li>
<li><a class="nav-link" href="#sparse-data"><span class="header-section-number">46.8.7</span> Sparse Data</a></li>
<li><a class="nav-link" href="#missing-values"><span class="header-section-number">46.8.8</span> Missing Values</a></li>
<li><a class="nav-link" href="#loss-functions-distributions-offsets-observation-weights"><span class="header-section-number">46.8.9</span> Loss functions, Distributions, Offsets, Observation Weights</a></li>
<li><a class="nav-link" href="#exporting-weights-and-biases"><span class="header-section-number">46.8.10</span> Exporting Weights and Biases</a></li>
<li><a class="nav-link" href="#reproducibility"><span class="header-section-number">46.8.11</span> Reproducibility</a></li>
<li><a class="nav-link" href="#scoring-on-trainingvalidation-sets-during-training"><span class="header-section-number">46.8.12</span> Scoring on Training/Validation Sets During Training</a></li>
</ul>
</li>
<li><a class="nav-link" href="#all-done-shutdown-h2o"><span class="header-section-number">46.9</span> All done, shutdown H2O</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hadley/r-pkgs/blob/master/604-nn-comparison-deep_learning_tips.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hadley/r-pkgs/edit/master/604-nn-comparison-deep_learning_tips.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Machine Learning Compilation</strong>" was written by Several authors. Compiled by Alfonso R. Reyes. It was last built on 2020-11-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
