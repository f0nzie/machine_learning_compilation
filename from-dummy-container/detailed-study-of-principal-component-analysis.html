<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Detailed study of Principal Component Analysis | A Machine Learning Compilation</title>
<meta name="author" content="Several authors. Compiled by Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Machine Learning Compilation</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li class="book-part">The Basics of Machine Learning</li>
<li><a class="" href="introduction-to-pca.html"><span class="header-section-number">2</span> Introduction to PCA</a></li>
<li><a class="" href="comparison-of-two-pca-packages.html"><span class="header-section-number">3</span> Comparison of two PCA packages</a></li>
<li><a class="active" href="detailed-study-of-principal-component-analysis.html"><span class="header-section-number">4</span> Detailed study of Principal Component Analysis</a></li>
<li><a class="" href="detection-of-diabetes-using-logistic-regression.html"><span class="header-section-number">5</span> Detection of diabetes using Logistic Regression</a></li>
<li><a class="" href="sensitivity-analysis-for-a-neural-network.html"><span class="header-section-number">6</span> Sensitivity analysis for a neural network</a></li>
<li><a class="" href="data-visualization-for-ml-models.html"><span class="header-section-number">7</span> Data Visualization for ML models</a></li>
<li class="book-part">Feature Engineering</li>
<li><a class="" href="ten-methods-to-assess-variable-importance.html"><span class="header-section-number">8</span> Ten methods to assess Variable Importance</a></li>
<li><a class="" href="employee-attrition-using-feature-importance.html"><span class="header-section-number">9</span> Employee Attrition using Feature Importance</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="a-gentle-introduction-to-support-vector-machines.html"><span class="header-section-number">10</span> A gentle introduction to Support Vector Machines</a></li>
<li><a class="" href="broad-view-of-svm.html"><span class="header-section-number">11</span> Broad view of SVM</a></li>
<li><a class="" href="feature-selection-to-enhance-cancer-detection.html"><span class="header-section-number">12</span> Feature Selection to enhance cancer detection</a></li>
<li><a class="" href="dealing-with-unbalanced-data.html"><span class="header-section-number">13</span> Dealing with unbalanced data</a></li>
<li><a class="" href="imputting-missing-values-with-random-forest.html"><span class="header-section-number">14</span> Imputting missing values with Random Forest</a></li>
<li><a class="" href="tuning-of-support-vector-machine-prediction.html"><span class="header-section-number">15</span> Tuning of Support Vector Machine prediction</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="introduction-to-algorithms-for-classification.html"><span class="header-section-number">16</span> Introduction to algorithms for Classification</a></li>
<li><a class="" href="comparing-classification-algorithms.html"><span class="header-section-number">17</span> Comparing Classification algorithms</a></li>
<li><a class="" href="who-buys-social-network-ads.html"><span class="header-section-number">18</span> Who buys Social Network ads</a></li>
<li><a class="" href="predicting-ozone-levels.html"><span class="header-section-number">19</span> Predicting Ozone levels</a></li>
<li><a class="" href="building-a-naive-bayes-classifier.html"><span class="header-section-number">20</span> Building a Naive Bayes Classifier</a></li>
<li><a class="" href="linear-and-non-linear-algorithms-for-classification.html"><span class="header-section-number">21</span> Linear and Non-Linear Algorithms for Classification</a></li>
<li><a class="" href="detect-mines-vs-rocks-with-random-forest.html"><span class="header-section-number">22</span> Detect mines vs rocks with Random Forest</a></li>
<li><a class="" href="predicting-the-type-of-glass.html"><span class="header-section-number">23</span> Predicting the type of glass</a></li>
<li><a class="" href="naive-bayes-for-sms-spam.html"><span class="header-section-number">24</span> Naive Bayes for SMS spam</a></li>
<li><a class="" href="vehicles-classiification-with-decision-trees.html"><span class="header-section-number">25</span> Vehicles classiification with Decision Trees</a></li>
<li><a class="" href="applying-naive-bayes-on-the-titanic-case.html"><span class="header-section-number">26</span> Applying Naive-Bayes on the Titanic case</a></li>
<li><a class="" href="classification-on-bad-loans.html"><span class="header-section-number">27</span> Classification on bad loans</a></li>
<li><a class="" href="predicting-flu-outcome-comparing-eight-classification-algorithms.html"><span class="header-section-number">28</span> Predicting Flu outcome comparing eight classification algorithms</a></li>
<li><a class="" href="a-detailed-study-of-bike-sharing-demand.html"><span class="header-section-number">29</span> A detailed study of bike sharing demand</a></li>
<li><a class="" href="prediction-of-arrhythmia-with-deep-neural-nets.html"><span class="header-section-number">30</span> Prediction of arrhythmia with deep neural nets</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression-with-islr.html"><span class="header-section-number">31</span> Linear Regression with ISLR</a></li>
<li><a class="" href="evaluation-of-three-linear-regression-models.html"><span class="header-section-number">32</span> Evaluation of three linear regression models</a></li>
<li><a class="" href="comparison-of-six-linear-regression-algorithms.html"><span class="header-section-number">33</span> Comparison of six Linear Regression algorithms</a></li>
<li><a class="" href="comparing-regression-models.html"><span class="header-section-number">34</span> Comparing regression models</a></li>
<li><a class="" href="finding-the-factors-of-happiness.html"><span class="header-section-number">35</span> Finding the factors of happiness</a></li>
<li><a class="" href="regression-with-a-neural-network.html"><span class="header-section-number">36</span> Regression with a neural network</a></li>
<li><a class="" href="comparing-multiple-regression-vs-a-neural-network.html"><span class="header-section-number">37</span> Comparing Multiple Regression vs a Neural Network</a></li>
<li><a class="" href="temperature-modeling-using-nested-dataframes.html"><span class="header-section-number">38</span> Temperature modeling using nested dataframes</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="credit-scoring-with-neuralnet.html"><span class="header-section-number">39</span> Credit Scoring with neuralnet</a></li>
<li><a class="" href="wine-classification-with-neuralnet.html"><span class="header-section-number">40</span> Wine classification with neuralnet</a></li>
<li><a class="" href="predicting-the-rating-of-cereals.html"><span class="header-section-number">41</span> Predicting the rating of cereals</a></li>
<li><a class="" href="fitting-a-linear-model-with-neural-networks.html"><span class="header-section-number">42</span> Fitting a linear model with neural networks</a></li>
<li><a class="" href="visualization-of-neural-networks.html"><span class="header-section-number">43</span> Visualization of neural networks</a></li>
<li><a class="" href="build-a-fully-connected-r-neural-network-from-scratch.html"><span class="header-section-number">44</span> Build a fully connected R neural network from scratch</a></li>
<li><a class="" href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">45</span> Tuning Hyperparameters in a Neural Network</a></li>
<li><a class="" href="deep-learning-tips-for-classification-and-regression.html"><span class="header-section-number">46</span> Deep Learning tips for Classification and Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></li>
<li><a class="" href="q-q-normal-to-compare-data-to-distributions.html"><span class="header-section-number">B</span> Q-Q normal to compare data to distributions</a></li>
<li><a class="" href="qq-and-pp-plots.html"><span class="header-section-number">C</span> QQ and PP Plots</a></li>
<li><a class="" href="visualizing-residuals.html"><span class="header-section-number">D</span> Visualizing residuals</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/f0nzie/machine_learning_compilation">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="detailed-study-of-principal-component-analysis" class="section level1">
<h1>
<span class="header-section-number">4</span> Detailed study of Principal Component Analysis<a class="anchor" aria-label="anchor" href="#detailed-study-of-principal-component-analysis"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li><p>Datasets: <code>decathlon2</code></p></li>
<li>
<p>Algorithms:</p>
<ul>
<li>PCA</li>
</ul>
</li>
</ul>
<p><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/" class="uri">http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/</a></p>
<p>Principal component analysis (PCA) allows us to summarize and to
visualize the information in a data set containing
individuals/observations described by multiple inter-correlated
quantitative variables. Each variable could be considered as a different
dimension. If you have more than 3 variables in your data sets, it could
be very difficult to visualize a multi-dimensional hyperspace.</p>
<p>Principal component analysis is used to extract the important
information from a multivariate data table and to express this
information as a set of few new variables called principal components.
These new variables correspond to a linear combination of the originals.
The number of principal components is less than or equal to the number
of original variables.</p>
<p>The information in a given data set corresponds to the total variation
it contains. The goal of PCA is to identify directions (or principal
components) along which the variation in the data is maximal.</p>
<p>In other words, PCA reduces the dimensionality of a multivariate data to
two or three principal components, that can be visualized graphically,
with minimal loss of information.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages(c("FactoMineR", "factoextra"))</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">decathlon2</span><span class="op">)</span>
<span class="co"># head(decathlon2)</span></code></pre></div>
<p>In PCA terminology, our data contains :</p>
<ul>
<li><p>Active individuals (in light blue, rows 1:23) : Individuals that are
used during the principal component analysis.</p></li>
<li><p>Supplementary individuals (in dark blue, rows 24:27) : The
coordinates of these individuals will be predicted using the PCA
information and parameters obtained with active
individuals/variables</p></li>
<li><p>Active variables (in pink, columns 1:10) : Variables that are used
for the principal component analysis.</p></li>
<li>
<p>Supplementary variables: As supplementary individuals, the
coordinates of these variables will be predicted also. These can be:</p>
<ul>
<li>Supplementary continuous variables (red): Columns 11 and 12
corresponding respectively to the rank and the points of
athletes.</li>
<li>Supplementary qualitative variables (green): Column 13
corresponding to the two athlete-tic meetings (2004 Olympic Game
or 2004 Decastar). This is a categorical (or factor) variable
factor. It can be used to color individuals by groups.</li>
</ul>
</li>
</ul>
<p>We start by subsetting active individuals and active variables for the
principal component analysis:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">decathlon2.active</span> <span class="op">&lt;-</span> <span class="va">decathlon2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">23</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">decathlon2.active</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt;         X100m Long.jump Shot.put High.jump X400m X110m.hurdle</span>
<span class="co">#&gt; SEBRLE   11.0      7.58     14.8      2.07  49.8         14.7</span>
<span class="co">#&gt; CLAY     10.8      7.40     14.3      1.86  49.4         14.1</span>
<span class="co">#&gt; BERNARD  11.0      7.23     14.2      1.92  48.9         15.0</span>
<span class="co">#&gt; YURKOV   11.3      7.09     15.2      2.10  50.4         15.3</span></code></pre></div>
<div id="data-standardization" class="section level2">
<h2>
<span class="header-section-number">4.1</span> Data standardization<a class="anchor" aria-label="anchor" href="#data-standardization"><i class="fas fa-link"></i></a>
</h2>
<p>In principal component analysis, variables are often scaled (
i.e. standardized). This is particularly recommended when variables are
measured in different scales (e.g: kilograms, kilometers, centimeters,
…); otherwise, the PCA outputs obtained will be severely affected.</p>
<p>The goal is to make the variables comparable. Generally variables are
scaled to have i) standard deviation one and ii) mean zero.</p>
<p>The function PCA() [FactoMineR package] can be used. A simplified format
is:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr">FactoMineR</a></span><span class="op">)</span>
<span class="va">res.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">decathlon2.active</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="co">#&gt; **Results for the Principal Component Analysis (PCA)**</span>
<span class="co">#&gt; The analysis was performed on 23 individuals, described by 10 variables</span>
<span class="co">#&gt; *The results are available in the following objects:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    name               description                          </span>
<span class="co">#&gt; 1  "$eig"             "eigenvalues"                        </span>
<span class="co">#&gt; 2  "$var"             "results for the variables"          </span>
<span class="co">#&gt; 3  "$var$coord"       "coord. for the variables"           </span>
<span class="co">#&gt; 4  "$var$cor"         "correlations variables - dimensions"</span>
<span class="co">#&gt; 5  "$var$cos2"        "cos2 for the variables"             </span>
<span class="co">#&gt; 6  "$var$contrib"     "contributions of the variables"     </span>
<span class="co">#&gt; 7  "$ind"             "results for the individuals"        </span>
<span class="co">#&gt; 8  "$ind$coord"       "coord. for the individuals"         </span>
<span class="co">#&gt; 9  "$ind$cos2"        "cos2 for the individuals"           </span>
<span class="co">#&gt; 10 "$ind$contrib"     "contributions of the individuals"   </span>
<span class="co">#&gt; 11 "$call"            "summary statistics"                 </span>
<span class="co">#&gt; 12 "$call$centre"     "mean of the variables"              </span>
<span class="co">#&gt; 13 "$call$ecart.type" "standard error of the variables"    </span>
<span class="co">#&gt; 14 "$call$row.w"      "weights for the individuals"        </span>
<span class="co">#&gt; 15 "$call$col.w"      "weights for the variables"</span></code></pre></div>
<blockquote>
<p>The object that is created using the function PCA() contains many
information found in many different lists and matrices. These values
are described in the next section.</p>
</blockquote>
</div>
<div id="eigenvalues-variances" class="section level2">
<h2>
<span class="header-section-number">4.2</span> Eigenvalues / Variances<a class="anchor" aria-label="anchor" href="#eigenvalues-variances"><i class="fas fa-link"></i></a>
</h2>
<p>As described in previous sections, the eigenvalues measure the amount of
variation retained by each principal component. Eigenvalues are large
for the first PCs and small for the subsequent PCs. That is, the first
PCs corresponds to the directions with the maximum amount of variation
in the data set.</p>
<p>We examine the eigenvalues to determine the number of principal
components to be considered. The eigenvalues and the proportion of
variances (i.e., information) retained by the principal components (PCs)
can be extracted using the function get_eigenvalue() [factoextra
package].</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.sthda.com/english/rpkgs/factoextra">factoextra</a></span><span class="op">)</span>
<span class="va">eig.val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">get_eigenvalue</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="va">eig.val</span>
<span class="co">#&gt;        eigenvalue variance.percent cumulative.variance.percent</span>
<span class="co">#&gt; Dim.1       4.124            41.24                        41.2</span>
<span class="co">#&gt; Dim.2       1.839            18.39                        59.6</span>
<span class="co">#&gt; Dim.3       1.239            12.39                        72.0</span>
<span class="co">#&gt; Dim.4       0.819             8.19                        80.2</span>
<span class="co">#&gt; Dim.5       0.702             7.02                        87.2</span>
<span class="co">#&gt; Dim.6       0.423             4.23                        91.5</span>
<span class="co">#&gt; Dim.7       0.303             3.03                        94.5</span>
<span class="co">#&gt; Dim.8       0.274             2.74                        97.2</span>
<span class="co">#&gt; Dim.9       0.155             1.55                        98.8</span>
<span class="co">#&gt; Dim.10      0.122             1.22                       100.0</span></code></pre></div>
<p>The sum of all the eigenvalues give a total variance of 10.</p>
<p>The proportion of variation explained by each eigenvalue is given in the
second column. For example, 4.124 divided by 10 equals 0.4124, or, about
41.24% of the variation is explained by this first eigenvalue. The
cumulative percentage explained is obtained by adding the successive
proportions of variation explained to obtain the running total. For
instance, 41.242% plus 18.385% equals 59.627%, and so forth. Therefore,
about 59.627% of the variation is explained by the first two eigenvalues
together.</p>
<p>Unfortunately, there is no well-accepted objective way to decide how
many principal components are enough. This will depend on the specific
field of application and the specific data set. In practice, we tend to
look at the first few principal components in order to find interesting
patterns in the data.</p>
<p>In our analysis, the first three principal components explain 72% of the
variation. This is an acceptably large percentage.</p>
<p>An alternative method to determine the number of principal components is
to look at a Scree Plot, which is the plot of eigenvalues ordered from
largest to the smallest. The number of component is determined at the
point, beyond which the remaining eigenvalues are all relatively small
and of comparable size (Jollife 2002, Peres-Neto, Jackson, and Somers
(2005)).</p>
<p>The scree plot can be produced using the function fviz_eig() or
fviz_screeplot() [factoextra package].</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_eig</a></span><span class="op">(</span><span class="va">res.pca</span>, addlabels <span class="op">=</span> <span class="cn">TRUE</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>From the plot above, we might want to stop at the fifth principal
component. 87% of the information (variances) contained in the data are
retained by the first five principal components.</p>
</div>
<div id="graph-of-variables" class="section level2">
<h2>
<span class="header-section-number">4.3</span> Graph of variables<a class="anchor" aria-label="anchor" href="#graph-of-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Results A simple method to extract the results, for variables, from a
PCA output is to use the function get_pca_var() [factoextra package].
This function provides a list of matrices containing all the results for
the active variables (coordinates, correlation between variables and
axes, squared cosine and contributions)</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="va">var</span>
<span class="co">#&gt; Principal Component Analysis Results for variables</span>
<span class="co">#&gt;  ===================================================</span>
<span class="co">#&gt;   Name       Description                                    </span>
<span class="co">#&gt; 1 "$coord"   "Coordinates for the variables"                </span>
<span class="co">#&gt; 2 "$cor"     "Correlations between variables and dimensions"</span>
<span class="co">#&gt; 3 "$cos2"    "Cos2 for the variables"                       </span>
<span class="co">#&gt; 4 "$contrib" "contributions of the variables"</span></code></pre></div>
<p>The components of the get_pca_var() can be used in the plot of variables
as follow:</p>
<ul>
<li>var$coord: coordinates of variables to create a scatter plot</li>
<li>var$cos2: represents the quality of representation for variables on
the factor map. It’s calculated as the squared coordinates: var.cos2
= var.coord * var.coord.</li>
<li>var$contrib: contains the contributions (in percentage) of the
variables to the principal components. The contribution of a
variable (var) to a given principal component is (in percentage) :
(var.cos2 * 100) / (total cos2 of the component).</li>
</ul>
<blockquote>
<p>Note that, it’s possible to plot variables and to color them according
to either i) their quality on the factor map (cos2) or ii) their
contribution values to the principal components (contrib).</p>
</blockquote>
<p>The different components can be accessed as follow:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Coordinates</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span><span class="op">)</span>
<span class="co">#&gt;               Dim.1   Dim.2  Dim.3   Dim.4  Dim.5</span>
<span class="co">#&gt; X100m        -0.851 -0.1794  0.302  0.0336 -0.194</span>
<span class="co">#&gt; Long.jump     0.794  0.2809 -0.191 -0.1154  0.233</span>
<span class="co">#&gt; Shot.put      0.734  0.0854  0.518  0.1285 -0.249</span>
<span class="co">#&gt; High.jump     0.610 -0.4652  0.330  0.1446  0.403</span>
<span class="co">#&gt; X400m        -0.702  0.2902  0.284  0.4308  0.104</span>
<span class="co">#&gt; X110m.hurdle -0.764 -0.0247  0.449 -0.0169  0.224</span>
<span class="co"># Cos2: quality on the factore map</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">var</span><span class="op">$</span><span class="va">cos2</span><span class="op">)</span>
<span class="co">#&gt;              Dim.1    Dim.2  Dim.3    Dim.4  Dim.5</span>
<span class="co">#&gt; X100m        0.724 0.032184 0.0909 0.001127 0.0378</span>
<span class="co">#&gt; Long.jump    0.631 0.078881 0.0363 0.013315 0.0544</span>
<span class="co">#&gt; Shot.put     0.539 0.007294 0.2679 0.016504 0.0619</span>
<span class="co">#&gt; High.jump    0.372 0.216424 0.1090 0.020895 0.1622</span>
<span class="co">#&gt; X400m        0.492 0.084203 0.0804 0.185611 0.0108</span>
<span class="co">#&gt; X110m.hurdle 0.584 0.000612 0.2015 0.000285 0.0503</span>
<span class="co"># Contributions to the principal components</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">var</span><span class="op">$</span><span class="va">contrib</span><span class="op">)</span>
<span class="co">#&gt;              Dim.1   Dim.2 Dim.3   Dim.4 Dim.5</span>
<span class="co">#&gt; X100m        17.54  1.7505  7.34  0.1376  5.39</span>
<span class="co">#&gt; Long.jump    15.29  4.2904  2.93  1.6249  7.75</span>
<span class="co">#&gt; Shot.put     13.06  0.3967 21.62  2.0141  8.82</span>
<span class="co">#&gt; High.jump     9.02 11.7716  8.79  2.5499 23.12</span>
<span class="co">#&gt; X400m        11.94  4.5799  6.49 22.6509  1.54</span>
<span class="co">#&gt; X110m.hurdle 14.16  0.0333 16.26  0.0348  7.17</span></code></pre></div>
<p>In this section, we describe how to visualize variables and draw
conclusions about their correlations. Next, we highlight variables
according to either i) their quality of representation on the factor map
or ii) their contributions to the principal components.</p>
</div>
<div id="correlation-circle" class="section level2">
<h2>
<span class="header-section-number">4.4</span> Correlation circle<a class="anchor" aria-label="anchor" href="#correlation-circle"><i class="fas fa-link"></i></a>
</h2>
<p>The correlation between a variable and a principal component (PC) is
used as the coordinates of the variable on the PC. The representation of
variables differs from the plot of the observations: The observations
are represented by their projections, but the variables are represented
by their correlations (Abdi and Williams 2010).</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Coordinates of variables</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span>, <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt;            Dim.1   Dim.2  Dim.3   Dim.4  Dim.5</span>
<span class="co">#&gt; X100m     -0.851 -0.1794  0.302  0.0336 -0.194</span>
<span class="co">#&gt; Long.jump  0.794  0.2809 -0.191 -0.1154  0.233</span>
<span class="co">#&gt; Shot.put   0.734  0.0854  0.518  0.1285 -0.249</span>
<span class="co">#&gt; High.jump  0.610 -0.4652  0.330  0.1446  0.403</span></code></pre></div>
<p>To plot variables, type this:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, col.var <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>The plot above is also known as variable correlation plots. It shows the
relationships between all variables. It can be interpreted as follow:</p>
<ul>
<li>Positively correlated variables are grouped together.</li>
<li>Negatively correlated variables are positioned on opposite sides of
the plot origin (opposed quadrants).</li>
<li>The distance between variables and the origin measures the quality
of the variables on the factor map. Variables that are away from the
origin are well represented on the factor map.</li>
</ul>
</div>
<div id="quality-of-representation" class="section level2">
<h2>
<span class="header-section-number">4.5</span> Quality of representation<a class="anchor" aria-label="anchor" href="#quality-of-representation"><i class="fas fa-link"></i></a>
</h2>
<p>The quality of representation of the variables on factor map is called
cos2 (square cosine, squared coordinates) . You can access to the cos2
as follow:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">var</span><span class="op">$</span><span class="va">cos2</span>, <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt;           Dim.1   Dim.2  Dim.3   Dim.4  Dim.5</span>
<span class="co">#&gt; X100m     0.724 0.03218 0.0909 0.00113 0.0378</span>
<span class="co">#&gt; Long.jump 0.631 0.07888 0.0363 0.01331 0.0544</span>
<span class="co">#&gt; Shot.put  0.539 0.00729 0.2679 0.01650 0.0619</span>
<span class="co">#&gt; High.jump 0.372 0.21642 0.1090 0.02089 0.1622</span></code></pre></div>
<p>You can visualize the cos2 of variables on all the dimensions using the
corrplot package:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span>
<span class="co">#&gt; corrplot 0.84 loaded</span>
<span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">var</span><span class="op">$</span><span class="va">cos2</span>, is.corr<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>It’s also possible to create a bar plot of variables cos2 using the
function <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_cos2.html">fviz_cos2()</a></code> [in factoextra]:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Total cos2 of variables on Dim.1 and Dim.2</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cos2.html">fviz_cos2</a></span><span class="op">(</span><span class="va">res.pca</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Note that,</p>
<ul>
<li><p>A high cos2 indicates a good representation of the variable on the
principal component. In this case the variable is positioned close
to the circumference of the correlation circle.</p></li>
<li><p>A low cos2 indicates that the variable is not perfectly represented
by the PCs. In this case the variable is close to the center of the
circle.</p></li>
</ul>
<p>For a given variable, the sum of the cos2 on all the principal
components is equal to one.</p>
<p>If a variable is perfectly represented by only two principal components
(Dim.1 &amp; Dim.2), the sum of the cos2 on these two PCs is equal to one.
In this case the variables will be positioned on the circle of
correlations.</p>
<p>For some of the variables, more than 2 components might be required to
perfectly represent the data. In this case the variables are positioned
inside the circle of correlations.</p>
<p>In summary:</p>
<ul>
<li>The cos2 values are used to estimate the quality of the
representation</li>
<li>The closer a variable is to the circle of correlations, the better
its representation on the factor map (and the more important it is
to interpret these components)</li>
<li>Variables that are closed to the center of the plot are less
important for the first components.</li>
</ul>
<p>It’s possible to color variables by their <code>cos2</code> values using the
argument <code>col.var = "cos2"</code>. This produces a gradient colors. In this
case, the argument gradient.cols can be used to provide a custom color.
For instance, gradient.cols = c(“white”, “blue”, “red”) means that:</p>
<ul>
<li>variables with low cos2 values will be colored in “white”</li>
<li>variables with mid cos2 values will be colored in “blue”</li>
<li>variables with high cos2 values will be colored in red</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Color by cos2 values: quality on the factor map</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, col.var <span class="op">=</span> <span class="st">"cos2"</span>,
             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>, 
             repel <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># Avoid text overlapping</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Note that, it’s also possible to change the transparency of the
variables according to their cos2 values using the option alpha.var =
“cos2”. For example, type this:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Change the transparency by cos2 values</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, alpha.var <span class="op">=</span> <span class="st">"cos2"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="contributions-of-variables-to-pcs" class="section level2">
<h2>
<span class="header-section-number">4.6</span> Contributions of variables to PCs<a class="anchor" aria-label="anchor" href="#contributions-of-variables-to-pcs"><i class="fas fa-link"></i></a>
</h2>
<p>The contributions of variables in accounting for the variability in a
given principal component are expressed in percentage.</p>
<ul>
<li>Variables that are correlated with PC1 (i.e., Dim.1) and PC2 (i.e.,
Dim.2) are the most important in explaining the variability in the
data set.</li>
<li>Variables that do not correlated with any PC or correlated with the
last dimensions are variables with low contribution and might be
removed to simplify the overall analysis.</li>
</ul>
<p>The contribution of variables can be extracted as follow :</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">var</span><span class="op">$</span><span class="va">contrib</span>, <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt;           Dim.1  Dim.2 Dim.3 Dim.4 Dim.5</span>
<span class="co">#&gt; X100m     17.54  1.751  7.34 0.138  5.39</span>
<span class="co">#&gt; Long.jump 15.29  4.290  2.93 1.625  7.75</span>
<span class="co">#&gt; Shot.put  13.06  0.397 21.62 2.014  8.82</span>
<span class="co">#&gt; High.jump  9.02 11.772  8.79 2.550 23.12</span></code></pre></div>
<blockquote>
<p>The larger the value of the contribution, the more the variable
contributes to the component.</p>
</blockquote>
<p>It’s possible to use the function corrplot() [corrplot package] to
highlight the most contributing variables for each dimension:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/taiyun/corrplot">"corrplot"</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">var</span><span class="op">$</span><span class="va">contrib</span>, is.corr<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>    </code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>The function <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_contrib.html">fviz_contrib()</a></code> [<code>factoextra</code> package] can be used to draw
a bar plot of variable contributions. If your data contains many
variables, you can decide to show only the top contributing variables.
The R code below shows the top 10 variables contributing to the
principal components:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Contributions of variables to PC1</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_contrib.html">fviz_contrib</a></span><span class="op">(</span><span class="va">res.pca</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">1</span>, top <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co"># Contributions of variables to PC2</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_contrib.html">fviz_contrib</a></span><span class="op">(</span><span class="va">res.pca</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">2</span>, top <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-20-1.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-20-2.png" width="70%" style="display: block; margin: auto;"></p>
<p>The total contribution to PC1 and PC2 is obtained with the following R
code:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_contrib.html">fviz_contrib</a></span><span class="op">(</span><span class="va">res.pca</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, top <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>The red dashed line on the graph above indicates the expected average
contribution. If the contribution of the variables were uniform, the
expected value would be 1/length(variables) = 1/10 = 10%. For a given
component, a variable with a contribution larger than this cutoff could
be considered as important in contributing to the component.</p>
<p>Note that, the total contribution of a given variable, on explaining the
variations retained by two principal components, say PC1 and PC2, is
calculated as contrib = [(C1 * Eig1) + (C2 * Eig2)]/(Eig1 + Eig2),
where</p>
<ul>
<li>C1 and C2 are the contributions of the variable on PC1 and PC2,
respectively</li>
<li>Eig1 and Eig2 are the eigenvalues of PC1 and PC2, respectively.
Recall that eigenvalues measure the amount of variation retained by
each PC.</li>
</ul>
<p>In this case, the expected average contribution (cutoff) is calculated
as follow: As mentioned above, if the contributions of the 10 variables
were uniform, the expected average contribution on a given PC would be
1/10 = 10%. The expected average contribution of a variable for PC1 and
PC2 is : [(10* Eig1) + (10 * Eig2)]/(Eig1 + Eig2)</p>
<p>It can be seen that the variables - X100m, Long.jump and Pole.vault -
contribute the most to the dimensions 1 and 2.</p>
<p>The most important (or, contributing) variables can be highlighted on
the correlation plot as follow:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, col.var <span class="op">=</span> <span class="st">"contrib"</span>,
             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Note that, it’s also possible to change the transparency of variables
according to their contrib values using the option
<code>alpha.var = "contrib"</code>. For example, type this:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Change the transparency by contrib values</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, alpha.var <span class="op">=</span> <span class="st">"contrib"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-23-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="color-by-a-custom-continuous-variable" class="section level2">
<h2>
<span class="header-section-number">4.7</span> Color by a custom continuous variable<a class="anchor" aria-label="anchor" href="#color-by-a-custom-continuous-variable"><i class="fas fa-link"></i></a>
</h2>
<p>In the previous sections, we showed how to color variables by their
contributions and their <code>cos2</code>. Note that, it’s possible to color
variables by any custom continuous variable. The coloring variable
should have the same length as the number of active variables in the PCA
(here n = 10).</p>
<p>For example, type this:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a random continuous variable of length 10</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">my.cont.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="co"># Color variables by the continuous variable</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, col.var <span class="op">=</span> <span class="va">my.cont.var</span>,
             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"yellow"</span>, <span class="st">"red"</span><span class="op">)</span>,
             legend.title <span class="op">=</span> <span class="st">"Cont.Var"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="color-by-groups" class="section level2">
<h2>
<span class="header-section-number">4.8</span> Color by groups<a class="anchor" aria-label="anchor" href="#color-by-groups"><i class="fas fa-link"></i></a>
</h2>
<p>It’s also possible to change the color of variables by groups defined by
a qualitative/categorical variable, also called factor in R terminology.</p>
<p>As we don’t have any grouping variable in our data sets for classifying
variables, we’ll create it.</p>
<p>In the following demo example, we start by classifying the variables
into 3 groups using the kmeans clustering algorithm. Next, we use the
clusters returned by the kmeans algorithm to color variables.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a grouping variable using kmeans</span>
<span class="co"># Create 3 groups of variables (centers = 3)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">res.km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">var</span><span class="op">$</span><span class="va">coord</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">res.km</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span>
<span class="co"># Color variables by groups</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, col.var <span class="op">=</span> <span class="va">grp</span>, 
             palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#0073C2FF"</span>, <span class="st">"#EFC000FF"</span>, <span class="st">"#868686FF"</span><span class="op">)</span>,
             legend.title <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-25-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="dimension-description" class="section level2">
<h2>
<span class="header-section-number">4.9</span> Dimension description<a class="anchor" aria-label="anchor" href="#dimension-description"><i class="fas fa-link"></i></a>
</h2>
<p>In the section <span class="citation">(<span class="citeproc-not-found" data-reference-id="ref"><strong>???</strong></span>)</span>(pca-variable-contributions), we described how to
highlight variables according to their contributions to the principal
components.</p>
<p>Note also that, the function dimdesc() [in FactoMineR], for dimension
description, can be used to identify the most significantly associated
variables with a given principal component . It can be used as follow:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res.desc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/dimdesc.html">dimdesc</a></span><span class="op">(</span><span class="va">res.pca</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, proba <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="co"># Description of dimension 1</span>
<span class="va">res.desc</span><span class="op">$</span><span class="va">Dim.1</span>
<span class="co">#&gt; $quanti</span>
<span class="co">#&gt;              correlation  p.value</span>
<span class="co">#&gt; Long.jump          0.794 6.06e-06</span>
<span class="co">#&gt; Discus             0.743 4.84e-05</span>
<span class="co">#&gt; Shot.put           0.734 6.72e-05</span>
<span class="co">#&gt; High.jump          0.610 1.99e-03</span>
<span class="co">#&gt; Javeline           0.428 4.15e-02</span>
<span class="co">#&gt; X400m             -0.702 1.91e-04</span>
<span class="co">#&gt; X110m.hurdle      -0.764 2.20e-05</span>
<span class="co">#&gt; X100m             -0.851 2.73e-07</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "condes" "list "</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Description of dimension 2</span>
<span class="va">res.desc</span><span class="op">$</span><span class="va">Dim.2</span>
<span class="co">#&gt; $quanti</span>
<span class="co">#&gt;            correlation  p.value</span>
<span class="co">#&gt; Pole.vault       0.807 3.21e-06</span>
<span class="co">#&gt; X1500m           0.784 9.38e-06</span>
<span class="co">#&gt; High.jump       -0.465 2.53e-02</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,"class")</span>
<span class="co">#&gt; [1] "condes" "list "</span></code></pre></div>
</div>
<div id="graph-of-individuals" class="section level2">
<h2>
<span class="header-section-number">4.10</span> Graph of individuals<a class="anchor" aria-label="anchor" href="#graph-of-individuals"><i class="fas fa-link"></i></a>
</h2>
<p>Results The results, for individuals can be extracted using the function
<code><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_ind()</a></code>[factoextra package]. Similarly to the <code><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_var()</a></code>,
the function <code><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_ind()</a></code> provides a list of matrices containing all
the results for the individuals (coordinates, correlation between
individuals and axes, squared cosine and contributions)</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/get_pca.html">get_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="va">ind</span>
<span class="co">#&gt; Principal Component Analysis Results for individuals</span>
<span class="co">#&gt;  ===================================================</span>
<span class="co">#&gt;   Name       Description                       </span>
<span class="co">#&gt; 1 "$coord"   "Coordinates for the individuals" </span>
<span class="co">#&gt; 2 "$cos2"    "Cos2 for the individuals"        </span>
<span class="co">#&gt; 3 "$contrib" "contributions of the individuals"</span></code></pre></div>
<p>To get access to the different components, use this:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Coordinates of individuals</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ind</span><span class="op">$</span><span class="va">coord</span><span class="op">)</span>
<span class="co">#&gt;            Dim.1  Dim.2  Dim.3   Dim.4   Dim.5</span>
<span class="co">#&gt; SEBRLE     0.196  1.589  0.642  0.0839  1.1683</span>
<span class="co">#&gt; CLAY       0.808  2.475 -1.387  1.2984 -0.8250</span>
<span class="co">#&gt; BERNARD   -1.359  1.648  0.201 -1.9641  0.0842</span>
<span class="co">#&gt; YURKOV    -0.889 -0.443  2.530  0.7129  0.4078</span>
<span class="co">#&gt; ZSIVOCZKY -0.108 -2.069 -1.334 -0.1015 -0.2015</span>
<span class="co">#&gt; McMULLEN   0.121 -1.014 -0.863  1.3416  1.6215</span>
<span class="co"># Quality of individuals</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ind</span><span class="op">$</span><span class="va">cos2</span><span class="op">)</span>
<span class="co">#&gt;             Dim.1  Dim.2   Dim.3   Dim.4    Dim.5</span>
<span class="co">#&gt; SEBRLE    0.00753 0.4975 0.08133 0.00139 0.268903</span>
<span class="co">#&gt; CLAY      0.04870 0.4570 0.14363 0.12579 0.050785</span>
<span class="co">#&gt; BERNARD   0.19720 0.2900 0.00429 0.41182 0.000757</span>
<span class="co">#&gt; YURKOV    0.09611 0.0238 0.77823 0.06181 0.020228</span>
<span class="co">#&gt; ZSIVOCZKY 0.00157 0.5764 0.23975 0.00139 0.005465</span>
<span class="co">#&gt; McMULLEN  0.00218 0.1522 0.11014 0.26649 0.389262</span>
<span class="co"># Contributions of individuals</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">ind</span><span class="op">$</span><span class="va">contrib</span><span class="op">)</span>
<span class="co">#&gt;            Dim.1  Dim.2  Dim.3   Dim.4   Dim.5</span>
<span class="co">#&gt; SEBRLE    0.0403  5.971  1.448  0.0373  8.4589</span>
<span class="co">#&gt; CLAY      0.6881 14.484  6.754  8.9446  4.2179</span>
<span class="co">#&gt; BERNARD   1.9474  6.423  0.141 20.4682  0.0439</span>
<span class="co">#&gt; YURKOV    0.8331  0.463 22.452  2.6966  1.0308</span>
<span class="co">#&gt; ZSIVOCZKY 0.0123 10.122  6.246  0.0547  0.2515</span>
<span class="co">#&gt; McMULLEN  0.0155  2.431  2.610  9.5506 16.2949</span></code></pre></div>
</div>
<div id="plots-quality-and-contribution-1" class="section level2">
<h2>
<span class="header-section-number">4.11</span> Plots: quality and contribution<a class="anchor" aria-label="anchor" href="#plots-quality-and-contribution-1"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind()</a></code> is used to produce the graph of individuals. To
create a simple plot, type this:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Like variables, it’s also possible to color individuals by their cos2
values:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>, col.ind <span class="op">=</span> <span class="st">"cos2"</span>, 
             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,
             repel <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># Avoid text overlapping (slow if many points)</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-31-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>Note that, individuals that are similar are grouped together on the
plot.</p>
</blockquote>
<p>You can also change the point size according the cos2 of the
corresponding individuals:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>, pointsize <span class="op">=</span> <span class="st">"cos2"</span>, 
             pointshape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"#E7B800"</span>,
             repel <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># Avoid text overlapping (slow if many points)</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-32-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>To change both point size and color by cos2, try this:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>, col.ind <span class="op">=</span> <span class="st">"cos2"</span>, pointsize <span class="op">=</span> <span class="st">"cos2"</span>,
             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,
             repel <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># Avoid text overlapping (slow if many points)</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-33-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>To create a bar plot of the quality of representation (cos2) of
individuals on the factor map, you can use the function fviz_cos2() as
previously described for variables:</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_cos2.html">fviz_cos2</a></span><span class="op">(</span><span class="va">res.pca</span>, choice <span class="op">=</span> <span class="st">"ind"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-34-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>To visualize the contribution of individuals to the first two principal
components, type this:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Total contribution on PC1 and PC2</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_contrib.html">fviz_contrib</a></span><span class="op">(</span><span class="va">res.pca</span>, choice <span class="op">=</span> <span class="st">"ind"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-35-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="color-by-a-custom-continuous-variable-1" class="section level2">
<h2>
<span class="header-section-number">4.12</span> Color by a custom continuous variable<a class="anchor" aria-label="anchor" href="#color-by-a-custom-continuous-variable-1"><i class="fas fa-link"></i></a>
</h2>
<p>As for variables, individuals can be colored by any custom continuous
variable by specifying the argument col.ind.</p>
<p>For example, type this:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create a random continuous variable of length 23,</span>
<span class="co"># Same length as the number of active individuals in the PCA</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">my.cont.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">23</span><span class="op">)</span>
<span class="co"># Color individuals by the continuous variable</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>, col.ind <span class="op">=</span> <span class="va">my.cont.var</span>,
             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"yellow"</span>, <span class="st">"red"</span><span class="op">)</span>,
             legend.title <span class="op">=</span> <span class="st">"Cont.Var"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-36-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="color-by-groups-1" class="section level2">
<h2>
<span class="header-section-number">4.13</span> Color by groups<a class="anchor" aria-label="anchor" href="#color-by-groups-1"><i class="fas fa-link"></i></a>
</h2>
<p>Here, we describe how to color individuals by group. Additionally, we
show how to add concentration ellipses and confidence ellipses by
groups. For this, we’ll use the iris data as demo data sets.</p>
<p>Iris data sets look like this:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span>
<span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span>
<span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></code></pre></div>
<p>The column “Species” will be used as grouping variable. We start by
computing principal component analysis as follow:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The variable Species (index = 5) is removed</span>
<span class="co"># before PCA analysis</span>
<span class="va">iris.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>In the R code below: the argument habillage or <code>col.ind</code> can be used to
specify the factor variable for coloring the individuals by groups.</p>
<p>To add a concentration ellipse around each group, specify the argument
<code>addEllipses = TRUE</code>. The argument palette can be used to change group
colors.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">iris.pca</span>,
             geom.ind <span class="op">=</span> <span class="st">"point"</span>, <span class="co"># show points only (nbut not "text")</span>
             col.ind <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="co"># color by groups</span>
             palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,
             addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Concentration ellipses</span>
             legend.title <span class="op">=</span> <span class="st">"Groups"</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-39-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>To remove the group mean point, specify the argument mean.point =
FALSE. If you want confidence ellipses instead of concentration
ellipses, use ellipse.type = “confidence”.</p>
</blockquote>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add confidence ellipses</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">iris.pca</span>, geom.ind <span class="op">=</span> <span class="st">"point"</span>, col.ind <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, 
             palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,
             addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, ellipse.type <span class="op">=</span> <span class="st">"confidence"</span>,
             legend.title <span class="op">=</span> <span class="st">"Groups"</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-40-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Note that, allowed values for palette include:</p>
<ul>
<li>“grey” for grey color palettes;</li>
<li>brewer palettes e.g. “RdBu”, “Blues”, …; To view all, type this in
R: <code><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">RColorBrewer::display.brewer.all()</a></code>.</li>
<li>custom color palette e.g. c(“blue”, “red”); and scientific journal
palettes from ggsci R package, e.g.: “npg”, “aaas”, * “lancet”,
“jco”, “ucscgb”, “uchicago”, “simpsons” and “rickandmorty”. For
example, to use the jco (journal of clinical oncology) color
palette, type this:</li>
</ul>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">iris.pca</span>,
             label <span class="op">=</span> <span class="st">"none"</span>, <span class="co"># hide individual labels</span>
             habillage <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="co"># color by groups</span>
             addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Concentration ellipses</span>
             palette <span class="op">=</span> <span class="st">"jco"</span>
             <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-41-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="graph-customization" class="section level2">
<h2>
<span class="header-section-number">4.14</span> Graph customization<a class="anchor" aria-label="anchor" href="#graph-customization"><i class="fas fa-link"></i></a>
</h2>
<p>Note that, <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind()</a></code> and <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var()</a></code> and related functions
are wrapper around the core function <code><a href="https://rdrr.io/pkg/factoextra/man/fviz.html">fviz()</a></code> [in factoextra]. fviz() is
a wrapper around the function ggscatter() [in ggpubr]. Therefore,
further arguments, to be passed to the function fviz() and
<code><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html">ggscatter()</a></code>, can be specified in <code><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind()</a></code> and fviz_pca_var().</p>
<p>Here, we present some of these additional arguments to customize the PCA
graph of variables and individuals.</p>
<div id="dimensions" class="section level3">
<h3>
<span class="header-section-number">4.14.1</span> Dimensions<a class="anchor" aria-label="anchor" href="#dimensions"><i class="fas fa-link"></i></a>
</h3>
<p>By default, variables/individuals are represented on dimensions 1 and 2.
If you want to visualize them on dimensions 2 and 3, for example, you
should specify the argument <code>axes = c(2, 3)</code>.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Variables on dimensions 2 and 3</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Individuals on dimensions 2 and 3</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>, axes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-42-1.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-42-2.png" width="70%" style="display: block; margin: auto;"></p>
<p>Plot elements: point, text, arrow The argument geom (for geometry) and
derivatives are used to specify the geometry elements or graphical
elements to be used for plotting.</p>
<ol style="list-style-type: decimal">
<li>geom.var: a text specifying the geometry to be used for plotting
variables. Allowed values are the combination of c(“point”, “arrow”,
“text”).</li>
</ol>
<ul>
<li>Use geom.var = “point”, to show only points;</li>
<li>Use geom.var = “text” to show only text labels;</li>
<li>Use geom.var = c(“point”, “text”) to show both points and text
labels</li>
<li>Use geom.var = c(“arrow”, “text”) to show arrows and labels
(default).</li>
</ul>
<p>For example, type this:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show variable points and text labels</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, geom.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"point"</span>, <span class="st">"text"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-43-1.png" width="70%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Show individuals text labels only</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>, geom.ind <span class="op">=</span>  <span class="st">"text"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-44-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="size-and-shape-of-plot-elements" class="section level2">
<h2>
<span class="header-section-number">4.15</span> Size and shape of plot elements<a class="anchor" aria-label="anchor" href="#size-and-shape-of-plot-elements"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Change the size of arrows an labels</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, arrowsize <span class="op">=</span> <span class="fl">1</span>, labelsize <span class="op">=</span> <span class="fl">5</span>, 
             repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># Change points size, shape and fill color</span>
<span class="co"># Change labelsize</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>, 
             pointsize <span class="op">=</span> <span class="fl">3</span>, pointshape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>,
             labelsize <span class="op">=</span> <span class="fl">5</span>, repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-45-1.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-45-2.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="ellipses" class="section level2">
<h2>
<span class="header-section-number">4.16</span> Ellipses<a class="anchor" aria-label="anchor" href="#ellipses"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Add confidence ellipses</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">iris.pca</span>, geom.ind <span class="op">=</span> <span class="st">"point"</span>, 
             col.ind <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="co"># color by groups</span>
             palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,
             addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, ellipse.type <span class="op">=</span> <span class="st">"confidence"</span>,
             legend.title <span class="op">=</span> <span class="st">"Groups"</span>
             <span class="op">)</span>
<span class="co"># Convex hull</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">iris.pca</span>, geom.ind <span class="op">=</span> <span class="st">"point"</span>,
             col.ind <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="co"># color by groups</span>
             palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,
             addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, ellipse.type <span class="op">=</span> <span class="st">"convex"</span>,
             legend.title <span class="op">=</span> <span class="st">"Groups"</span>
             <span class="op">)</span></code></pre></div>
<p><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-46-1.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-46-2.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div id="group-mean-points" class="section level2">
<h2>
<span class="header-section-number">4.17</span> Group mean points<a class="anchor" aria-label="anchor" href="#group-mean-points"><i class="fas fa-link"></i></a>
</h2>
<p>When coloring individuals by groups (section <span class="citation">(<span class="citeproc-not-found" data-reference-id="ref"><strong>???</strong></span>)</span>(color-ind-by-groups)),
the mean points of groups (barycenters) are also displayed by default.</p>
<p>To remove the mean points, use the argument mean.point = FALSE.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">iris.pca</span>,
             geom.ind <span class="op">=</span> <span class="st">"point"</span>, <span class="co"># show points only (but not "text")</span>
             group.ind <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, <span class="co"># color by groups</span>
             legend.title <span class="op">=</span> <span class="st">"Groups"</span>,
             mean.point <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-47-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="axis-lines" class="section level2">
<h2>
<span class="header-section-number">4.18</span> Axis lines<a class="anchor" aria-label="anchor" href="#axis-lines"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, axes.linetype <span class="op">=</span> <span class="st">"blank"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-48-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="graphical-parameters" class="section level2">
<h2>
<span class="header-section-number">4.19</span> Graphical parameters<a class="anchor" aria-label="anchor" href="#graphical-parameters"><i class="fas fa-link"></i></a>
</h2>
<p>To change easily the graphical of any ggplots, you can use the function
ggpar() [ggpubr package]</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ind.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">iris.pca</span>, geom <span class="op">=</span> <span class="st">"point"</span>, col.ind <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
<span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggpar.html">ggpar</a></span><span class="op">(</span><span class="va">ind.p</span>,
              title <span class="op">=</span> <span class="st">"Principal Component Analysis"</span>,
              subtitle <span class="op">=</span> <span class="st">"Iris data set"</span>,
              caption <span class="op">=</span> <span class="st">"Source: factoextra"</span>,
              xlab <span class="op">=</span> <span class="st">"PC1"</span>, ylab <span class="op">=</span> <span class="st">"PC2"</span>,
              legend.title <span class="op">=</span> <span class="st">"Species"</span>, legend.position <span class="op">=</span> <span class="st">"top"</span>,
              ggtheme <span class="op">=</span> <span class="fu">theme_gray</span><span class="op">(</span><span class="op">)</span>, palette <span class="op">=</span> <span class="st">"jco"</span>
              <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-49-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="biplot" class="section level2">
<h2>
<span class="header-section-number">4.20</span> Biplot<a class="anchor" aria-label="anchor" href="#biplot"><i class="fas fa-link"></i></a>
</h2>
<p>To make a simple biplot of individuals and variables, type this:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_biplot</a></span><span class="op">(</span><span class="va">res.pca</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>,
                col.var <span class="op">=</span> <span class="st">"#2E9FDF"</span>, <span class="co"># Variables color</span>
                col.ind <span class="op">=</span> <span class="st">"#696969"</span>  <span class="co"># Individuals color</span>
                <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-50-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>Note that, the <strong>biplot</strong> might be only useful when there is a low
number of variables and individuals in the data set; otherwise the
final plot would be unreadable.</p>
</blockquote>
<blockquote>
<p>Note also that, the coordinate of individuals and variables are not
constructed on the same space. Therefore, in the biplot, you should
mainly focus on the direction of variables but not on their absolute
positions on the plot.</p>
</blockquote>
<blockquote>
<p>Roughly speaking a biplot can be interpreted as follow: * an
individual that is on the same side of a given variable has a high
value for this variable; * an individual that is on the opposite side
of a given variable has a low value for this variable.</p>
</blockquote>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_biplot</a></span><span class="op">(</span><span class="va">iris.pca</span>, 
                col.ind <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, palette <span class="op">=</span> <span class="st">"jco"</span>, 
                addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, label <span class="op">=</span> <span class="st">"var"</span>,
                col.var <span class="op">=</span> <span class="st">"black"</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>,
                legend.title <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-51-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>In the following example, we want to color both individuals and
variables by groups. The trick is to use <code>pointshape = 21</code> for
individual points. This particular point shape can be filled by a color
using the argument fill.ind. The border line color of individual points
is set to “black” using col.ind. To color variable by groups, the
argument <code>col.var</code> will be used.</p>
<p>To customize individuals and variable colors, we use the helper
functions <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/set_palette.html">fill_palette()</a></code> and <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/set_palette.html">color_palette()</a></code> [in ggpubr package].</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_biplot</a></span><span class="op">(</span><span class="va">iris.pca</span>, 
                <span class="co"># Fill individuals by groups</span>
                geom.ind <span class="op">=</span> <span class="st">"point"</span>,
                pointshape <span class="op">=</span> <span class="fl">21</span>,
                pointsize <span class="op">=</span> <span class="fl">2.5</span>,
                fill.ind <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>,
                col.ind <span class="op">=</span> <span class="st">"black"</span>,
                <span class="co"># Color variable by groups</span>
                col.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sepal"</span>, <span class="st">"sepal"</span>, <span class="st">"petal"</span>, <span class="st">"petal"</span><span class="op">)</span><span class="op">)</span>,
                
                legend.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Species"</span>, color <span class="op">=</span> <span class="st">"Clusters"</span><span class="op">)</span>,
                repel <span class="op">=</span> <span class="cn">TRUE</span>        <span class="co"># Avoid label overplotting</span>
             <span class="op">)</span><span class="op">+</span>
  <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/set_palette.html">fill_palette</a></span><span class="op">(</span><span class="st">"jco"</span><span class="op">)</span><span class="op">+</span>      <span class="co"># Indiviual fill color</span>
  <span class="fu">ggpubr</span><span class="fu">::</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/set_palette.html">color_palette</a></span><span class="op">(</span><span class="st">"npg"</span><span class="op">)</span>      <span class="co"># Variable colors</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-52-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Another complex example is to color individuals by groups (discrete
color) and variables by their contributions to the principal components
(gradient colors). Additionally, we’ll change the transparency of
variables by their contributions using the argument alpha.var.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_biplot</a></span><span class="op">(</span><span class="va">iris.pca</span>, 
                <span class="co"># Individuals</span>
                geom.ind <span class="op">=</span> <span class="st">"point"</span>,
                fill.ind <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, col.ind <span class="op">=</span> <span class="st">"black"</span>,
                pointshape <span class="op">=</span> <span class="fl">21</span>, pointsize <span class="op">=</span> <span class="fl">2</span>,
                palette <span class="op">=</span> <span class="st">"jco"</span>,
                addEllipses <span class="op">=</span> <span class="cn">TRUE</span>,
                <span class="co"># Variables</span>
                alpha.var <span class="op">=</span><span class="st">"contrib"</span>, col.var <span class="op">=</span> <span class="st">"contrib"</span>,
                gradient.cols <span class="op">=</span> <span class="st">"RdYlBu"</span>,
                
                legend.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Species"</span>, color <span class="op">=</span> <span class="st">"Contrib"</span>,
                                    alpha <span class="op">=</span> <span class="st">"Contrib"</span><span class="op">)</span>
                <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-53-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="supplementary-elements" class="section level2">
<h2>
<span class="header-section-number">4.21</span> Supplementary elements<a class="anchor" aria-label="anchor" href="#supplementary-elements"><i class="fas fa-link"></i></a>
</h2>
<p>Definition and types As described above (section <span class="citation">(<span class="citeproc-not-found" data-reference-id="ref"><strong>???</strong></span>)</span>(pca-data-format)),
the <code>decathlon2</code> datasets contain supplementary continuous variables
(quanti.sup, columns 11:12), supplementary qualitative variables
(quali.sup, column 13) and supplementary individuals (ind.sup, rows
24:27).</p>
<p>Supplementary variables and individuals are not used for the
determination of the principal components. Their coordinates are
predicted using only the information provided by the performed principal
component analysis on active variables/individuals.</p>
<p>Specification in PCA To specify supplementary individuals and variables,
the function <code><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA()</a></code> can be used as follow:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/PCA.html">PCA</a></span><span class="op">(</span><span class="va">decathlon2</span>, ind.sup <span class="op">=</span> <span class="fl">24</span><span class="op">:</span><span class="fl">27</span>, 
               quanti.sup <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">12</span>, quali.sup <span class="op">=</span> <span class="fl">13</span>, graph<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div id="quantitative-variables-1" class="section level2">
<h2>
<span class="header-section-number">4.22</span> Quantitative variables<a class="anchor" aria-label="anchor" href="#quantitative-variables-1"><i class="fas fa-link"></i></a>
</h2>
<p>Predicted results (coordinates, correlation and cos2) for the
supplementary quantitative variables:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res.pca</span><span class="op">$</span><span class="va">quanti.sup</span>
<span class="co">#&gt; $coord</span>
<span class="co">#&gt;         Dim.1   Dim.2  Dim.3   Dim.4   Dim.5</span>
<span class="co">#&gt; Rank   -0.701 -0.2452 -0.183  0.0558 -0.0738</span>
<span class="co">#&gt; Points  0.964  0.0777  0.158 -0.1662 -0.0311</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $cor</span>
<span class="co">#&gt;         Dim.1   Dim.2  Dim.3   Dim.4   Dim.5</span>
<span class="co">#&gt; Rank   -0.701 -0.2452 -0.183  0.0558 -0.0738</span>
<span class="co">#&gt; Points  0.964  0.0777  0.158 -0.1662 -0.0311</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $cos2</span>
<span class="co">#&gt;        Dim.1   Dim.2  Dim.3   Dim.4   Dim.5</span>
<span class="co">#&gt; Rank   0.492 0.06012 0.0336 0.00311 0.00545</span>
<span class="co">#&gt; Points 0.929 0.00603 0.0250 0.02763 0.00097</span></code></pre></div>
<p>Visualize all variables (active and supplementary ones):</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-56-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>Note that, by default, supplementary quantitative variables are shown
in blue color and dashed lines.</p>
</blockquote>
<p>Further arguments to customize the plot:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Change color of variables</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>,
             col.var <span class="op">=</span> <span class="st">"black"</span>,     <span class="co"># Active variables</span>
             col.quanti.sup <span class="op">=</span> <span class="st">"red"</span> <span class="co"># Suppl. quantitative variables</span>
             <span class="op">)</span>
<span class="co"># Hide active variables on the plot, </span>
<span class="co"># show only supplementary variables</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, invisible <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span>
<span class="co"># Hide supplementary variables</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, invisible <span class="op">=</span> <span class="st">"quanti.sup"</span><span class="op">)</span></code></pre></div>
<p><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-57-1.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-57-2.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-57-3.png" width="70%" style="display: block; margin: auto;"></p>
<blockquote>
<p>Using the fviz_pca_var(), the quantitative supplementary variables are
displayed automatically on the correlation circle plot. Note that, you
can add the quanti.sup variables manually, using the fviz_add()
function, for further customization. An example is shown below.</p>
</blockquote>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot of active variables</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, invisible <span class="op">=</span> <span class="st">"quanti.sup"</span><span class="op">)</span>
<span class="co"># Add supplementary active variables</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_add.html">fviz_add</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">res.pca</span><span class="op">$</span><span class="va">quanti.sup</span><span class="op">$</span><span class="va">coord</span>, 
         geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"arrow"</span>, <span class="st">"text"</span><span class="op">)</span>, 
         color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-58-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="individuals" class="section level2">
<h2>
<span class="header-section-number">4.23</span> Individuals<a class="anchor" aria-label="anchor" href="#individuals"><i class="fas fa-link"></i></a>
</h2>
<p>Predicted results for the supplementary individuals (ind.sup):</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res.pca</span><span class="op">$</span><span class="va">ind.sup</span>
<span class="co">#&gt; $coord</span>
<span class="co">#&gt;          Dim.1   Dim.2  Dim.3  Dim.4   Dim.5</span>
<span class="co">#&gt; KARPOV   0.795  0.7795 -1.633  1.724 -0.7507</span>
<span class="co">#&gt; WARNERS -0.386 -0.1216 -1.739 -0.706 -0.0323</span>
<span class="co">#&gt; Nool    -0.559  1.9775 -0.483 -2.278 -0.2546</span>
<span class="co">#&gt; Drews   -1.109  0.0174 -3.049 -1.534 -0.3264</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $cos2</span>
<span class="co">#&gt;          Dim.1    Dim.2  Dim.3  Dim.4    Dim.5</span>
<span class="co">#&gt; KARPOV  0.0510 4.91e-02 0.2155 0.2403 0.045549</span>
<span class="co">#&gt; WARNERS 0.0242 2.40e-03 0.4904 0.0809 0.000169</span>
<span class="co">#&gt; Nool    0.0290 3.62e-01 0.0216 0.4811 0.006008</span>
<span class="co">#&gt; Drews   0.0921 2.27e-05 0.6956 0.1762 0.007974</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dist</span>
<span class="co">#&gt;  KARPOV WARNERS    Nool   Drews </span>
<span class="co">#&gt;    3.52    2.48    3.28    3.66</span></code></pre></div>
<p>Visualize all individuals (active and supplementary ones). On the graph,
you can add also the supplementary qualitative variables (quali.sup),
which coordinates is accessible using res.pca<span class="math inline">\(quali.supp\)</span>coord.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>, col.ind.sup <span class="op">=</span> <span class="st">"blue"</span>, repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_add.html">fviz_add</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">res.pca</span><span class="op">$</span><span class="va">quali.sup</span><span class="op">$</span><span class="va">coord</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="va">p</span></code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-60-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>Supplementary individuals are shown in blue. The levels of the
supplementary qualitative variable are shown in red color.</p>
</blockquote>
</div>
<div id="qualitative-variables" class="section level2">
<h2>
<span class="header-section-number">4.24</span> Qualitative variables<a class="anchor" aria-label="anchor" href="#qualitative-variables"><i class="fas fa-link"></i></a>
</h2>
<p>In the previous section, we showed that you can add the supplementary
qualitative variables on individuals plot using fviz_add().</p>
<p>Note that, the supplementary qualitative variables can be also used for
coloring individuals by groups. This can help to interpret the data. The
data sets decathlon2 contain a supplementary qualitative variable at
columns 13 corresponding to the type of competitions.</p>
<p>The results concerning the supplementary qualitative variable are:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res.pca</span><span class="op">$</span><span class="va">quali</span>
<span class="co">#&gt; $coord</span>
<span class="co">#&gt;          Dim.1  Dim.2   Dim.3  Dim.4  Dim.5</span>
<span class="co">#&gt; Decastar -1.34  0.122 -0.0379  0.181  0.134</span>
<span class="co">#&gt; OlympicG  1.23 -0.112  0.0347 -0.166 -0.123</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $cos2</span>
<span class="co">#&gt;          Dim.1   Dim.2   Dim.3  Dim.4   Dim.5</span>
<span class="co">#&gt; Decastar 0.905 0.00744 0.00072 0.0164 0.00905</span>
<span class="co">#&gt; OlympicG 0.905 0.00744 0.00072 0.0164 0.00905</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $v.test</span>
<span class="co">#&gt;          Dim.1  Dim.2  Dim.3  Dim.4 Dim.5</span>
<span class="co">#&gt; Decastar -2.97  0.403 -0.153  0.897  0.72</span>
<span class="co">#&gt; OlympicG  2.97 -0.403  0.153 -0.897 -0.72</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dist</span>
<span class="co">#&gt; Decastar OlympicG </span>
<span class="co">#&gt;     1.41     1.29 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $eta2</span>
<span class="co">#&gt;             Dim.1  Dim.2   Dim.3  Dim.4  Dim.5</span>
<span class="co">#&gt; Competition 0.401 0.0074 0.00106 0.0366 0.0236</span></code></pre></div>
<p>To color individuals by a supplementary qualitative variable, the
argument <code>habillage</code> is used to specify the index of the supplementary
qualitative variable. Historically, this argument name comes from the
<strong>FactoMineR</strong> package. It’s a french word meaning “dressing” in
english. To keep consistency between <strong>FactoMineR</strong> and <strong>factoextra</strong>,
we decided to keep the same argument name</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span>, habillage <span class="op">=</span> <span class="fl">13</span>,
             addEllipses <span class="op">=</span><span class="cn">TRUE</span>, ellipse.type <span class="op">=</span> <span class="st">"confidence"</span>,
             palette <span class="op">=</span> <span class="st">"jco"</span>, repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-62-1.png" width="70%" style="display: block; margin: auto;"></div>
<blockquote>
<p>Recall that, to remove the mean points of groups, specify the argument
mean.point = FALSE.</p>
</blockquote>
</div>
<div id="filtering-results" class="section level2">
<h2>
<span class="header-section-number">4.25</span> Filtering results<a class="anchor" aria-label="anchor" href="#filtering-results"><i class="fas fa-link"></i></a>
</h2>
<p>If you have many individuals/variable, it’s possible to visualize only
some of them using the arguments <code>select.ind</code> and <code>select.var</code>.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Visualize variable with cos2 &gt;= 0.6</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, select.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cos2 <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Top 5 active variables with the highest cos2</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, select.var<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>cos2 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Select by names</span>
<span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Long.jump"</span>, <span class="st">"High.jump"</span>, <span class="st">"X100m"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span>, select.var <span class="op">=</span> <span class="va">name</span><span class="op">)</span>
<span class="co"># top 5 contributing individuals and variable</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_biplot</a></span><span class="op">(</span><span class="va">res.pca</span>, select.ind <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>contrib <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, 
               select.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>contrib <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
               ggtheme <span class="op">=</span> <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-63-1.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-63-2.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-63-3.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-63-4.png" width="70%" style="display: block; margin: auto;"></p>
<blockquote>
<p>When the selection is done according to the contribution values,
supplementary individuals/variables are not shown because they don’t
contribute to the construction of the axes.</p>
</blockquote>
</div>
<div id="exporting-results" class="section level2">
<h2>
<span class="header-section-number">4.26</span> Exporting results<a class="anchor" aria-label="anchor" href="#exporting-results"><i class="fas fa-link"></i></a>
</h2>
<p>Export plots to PDF/PNG files The factoextra package produces a
ggplot2-based graphs. To save any ggplots, the standard R code is as
follow:</p>
<pre><code><a href="https://rdrr.io/r/grDevices/pdf.html"># Print the plot to a pdf file
pdf("myplot.pdf")
print(myplot)
dev.off()</a></code></pre>
<p>In the following examples, we’ll show you how to save the different
graphs into pdf or png files.</p>
<p>The first step is to create the plots you want as an R object:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Scree plot</span>
<span class="va">scree.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_eig</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="co"># Plot of individuals</span>
<span class="va">ind.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="co"># Plot of variables</span>
<span class="va">var.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"PCA.pdf"</span><span class="op">)</span><span class="op">)</span>   <span class="co"># Create a new pdf device</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">scree.plot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ind.plot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">var.plot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Close the pdf device</span>
<span class="co">#&gt; png </span>
<span class="co">#&gt;   2</span></code></pre></div>
<blockquote>
<p>Note that, using the above R code will create the PDF file into your
current working directory. To see the path of your current working
directory, type getwd() in the R console.</p>
</blockquote>
<p>To print each plot to specific png file, the R code looks like this:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Print scree plot to a png file</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"pca-scree-plot.png"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">scree.plot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; png </span>
<span class="co">#&gt;   2</span>
<span class="co"># Print individuals plot to a png file</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"pca-variables.png"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">var.plot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; png </span>
<span class="co">#&gt;   2</span>
<span class="co"># Print variables plot to a png file</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"pca-individuals.png"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ind.plot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; png </span>
<span class="co">#&gt;   2</span></code></pre></div>
<p>Another alternative, to export ggplots, is to use the function
ggexport() [in ggpubr package]. We like ggexport(), because it’s very
simple. With one line R code, it allows us to export individual plots to
a file (pdf, eps or png) (one plot per page). It can also arrange the
plots (2 plot per page, for example) before exporting them. The examples
below demonstrates how to export ggplots using ggexport().</p>
<p>Export individual plots to a pdf file (one plot per page):</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span>
<span class="co">#&gt; Loading required package: magrittr</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggexport.html">ggexport</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">scree.plot</span>, <span class="va">ind.plot</span>, <span class="va">var.plot</span><span class="op">)</span>, 
         filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"PCA.pdf"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; file saved to ../output/data/PCA.pdf</span></code></pre></div>
<p>Arrange and export. Specify nrow and ncol to display multiple plots on
the same page:</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggexport.html">ggexport</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">scree.plot</span>, <span class="va">ind.plot</span>, <span class="va">var.plot</span><span class="op">)</span>, 
         nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span>,
         filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"PCA.pdf"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; file saved to ../output/data/PCA.pdf</span></code></pre></div>
<p>Export plots to png files. If you specify a list of plots, then multiple
png files will be automatically created to hold each plot.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggexport.html">ggexport</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">scree.plot</span>, <span class="va">ind.plot</span>, <span class="va">var.plot</span><span class="op">)</span>,
         filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"PCA.png"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "../output/data/PCA%03d.png"</span>
<span class="co">#&gt; file saved to ../output/data/PCA%03d.png</span></code></pre></div>
</div>
<div id="export-results-to-txtcsv-files" class="section level2">
<h2>
<span class="header-section-number">4.27</span> Export results to txt/csv files<a class="anchor" aria-label="anchor" href="#export-results-to-txtcsv-files"><i class="fas fa-link"></i></a>
</h2>
<p>All the outputs of the PCA (individuals/variables coordinates,
contributions, etc) can be exported at once, into a TXT/CSV file, using
the function write.infile() [in FactoMineR] package:</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Export into a TXT file</span>
<span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/write.infile.html">write.infile</a></span><span class="op">(</span><span class="va">res.pca</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"pca.txt"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span>
<span class="co"># Export into a CSV file</span>
<span class="fu"><a href="https://rdrr.io/pkg/FactoMineR/man/write.infile.html">write.infile</a></span><span class="op">(</span><span class="va">res.pca</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"pca.csv"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">";"</span><span class="op">)</span></code></pre></div>
</div>
<div id="summary" class="section level2">
<h2>
<span class="header-section-number">4.28</span> Summary<a class="anchor" aria-label="anchor" href="#summary"><i class="fas fa-link"></i></a>
</h2>
<p>In conclusion, we described how to perform and interpret principal
component analysis (PCA). We computed PCA using the PCA() function
[FactoMineR]. Next, we used the factoextra R package to produce
ggplot2-based visualization of the PCA results.</p>
<p>There are other functions [packages] to compute PCA in R:</p>
<ol style="list-style-type: decimal">
<li>Using prcomp() [stats]</li>
</ol>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/princomp.html">princomp</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Using dudi.pca() [ade4]</li>
</ol>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4">ade4</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'ade4'</span>
<span class="co">#&gt; The following object is masked from 'package:FactoMineR':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     reconst</span>
<span class="va">res.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, nf <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Using epPCA() [ExPosition]</li>
</ol>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ExPosition</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: prettyGraphs</span>
<span class="va">res.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ExPosition/man/epPCA.html">epPCA</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>No matter what functions you decide to use, in the list above, the
factoextra package can handle the output for creating beautiful plots
similar to what we described in the previous sections for FactoMineR:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_eig</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>     <span class="co"># Scree plot</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span> <span class="co"># Graph of individuals</span>
<span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_var</a></span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span> <span class="co"># Graph of variables</span></code></pre></div>
<p><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-75-1.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-75-2.png" width="70%" style="display: block; margin: auto;"><img src="001-meta_110b-pca-methods_files/figure-html/unnamed-chunk-75-3.png" width="70%" style="display: block; margin: auto;"></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="comparison-of-two-pca-packages.html"><span class="header-section-number">3</span> Comparison of two PCA packages</a></div>
<div class="next"><a href="detection-of-diabetes-using-logistic-regression.html"><span class="header-section-number">5</span> Detection of diabetes using Logistic Regression</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#detailed-study-of-principal-component-analysis"><span class="header-section-number">4</span> Detailed study of Principal Component Analysis</a></li>
<li><a class="nav-link" href="#data-standardization"><span class="header-section-number">4.1</span> Data standardization</a></li>
<li><a class="nav-link" href="#eigenvalues-variances"><span class="header-section-number">4.2</span> Eigenvalues / Variances</a></li>
<li><a class="nav-link" href="#graph-of-variables"><span class="header-section-number">4.3</span> Graph of variables</a></li>
<li><a class="nav-link" href="#correlation-circle"><span class="header-section-number">4.4</span> Correlation circle</a></li>
<li><a class="nav-link" href="#quality-of-representation"><span class="header-section-number">4.5</span> Quality of representation</a></li>
<li><a class="nav-link" href="#contributions-of-variables-to-pcs"><span class="header-section-number">4.6</span> Contributions of variables to PCs</a></li>
<li><a class="nav-link" href="#color-by-a-custom-continuous-variable"><span class="header-section-number">4.7</span> Color by a custom continuous variable</a></li>
<li><a class="nav-link" href="#color-by-groups"><span class="header-section-number">4.8</span> Color by groups</a></li>
<li><a class="nav-link" href="#dimension-description"><span class="header-section-number">4.9</span> Dimension description</a></li>
<li><a class="nav-link" href="#graph-of-individuals"><span class="header-section-number">4.10</span> Graph of individuals</a></li>
<li><a class="nav-link" href="#plots-quality-and-contribution-1"><span class="header-section-number">4.11</span> Plots: quality and contribution</a></li>
<li><a class="nav-link" href="#color-by-a-custom-continuous-variable-1"><span class="header-section-number">4.12</span> Color by a custom continuous variable</a></li>
<li><a class="nav-link" href="#color-by-groups-1"><span class="header-section-number">4.13</span> Color by groups</a></li>
<li>
<a class="nav-link" href="#graph-customization"><span class="header-section-number">4.14</span> Graph customization</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#dimensions"><span class="header-section-number">4.14.1</span> Dimensions</a></li></ul>
</li>
<li><a class="nav-link" href="#size-and-shape-of-plot-elements"><span class="header-section-number">4.15</span> Size and shape of plot elements</a></li>
<li><a class="nav-link" href="#ellipses"><span class="header-section-number">4.16</span> Ellipses</a></li>
<li><a class="nav-link" href="#group-mean-points"><span class="header-section-number">4.17</span> Group mean points</a></li>
<li><a class="nav-link" href="#axis-lines"><span class="header-section-number">4.18</span> Axis lines</a></li>
<li><a class="nav-link" href="#graphical-parameters"><span class="header-section-number">4.19</span> Graphical parameters</a></li>
<li><a class="nav-link" href="#biplot"><span class="header-section-number">4.20</span> Biplot</a></li>
<li><a class="nav-link" href="#supplementary-elements"><span class="header-section-number">4.21</span> Supplementary elements</a></li>
<li><a class="nav-link" href="#quantitative-variables-1"><span class="header-section-number">4.22</span> Quantitative variables</a></li>
<li><a class="nav-link" href="#individuals"><span class="header-section-number">4.23</span> Individuals</a></li>
<li><a class="nav-link" href="#qualitative-variables"><span class="header-section-number">4.24</span> Qualitative variables</a></li>
<li><a class="nav-link" href="#filtering-results"><span class="header-section-number">4.25</span> Filtering results</a></li>
<li><a class="nav-link" href="#exporting-results"><span class="header-section-number">4.26</span> Exporting results</a></li>
<li><a class="nav-link" href="#export-results-to-txtcsv-files"><span class="header-section-number">4.27</span> Export results to txt/csv files</a></li>
<li><a class="nav-link" href="#summary"><span class="header-section-number">4.28</span> Summary</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/f0nzie/machine_learning_compilation/blob/master/001-meta_110b-pca-methods.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/f0nzie/machine_learning_compilation/edit/master/001-meta_110b-pca-methods.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Machine Learning Compilation</strong>" was written by Several authors. Compiled by Alfonso R. Reyes. It was last built on 2020-11-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
