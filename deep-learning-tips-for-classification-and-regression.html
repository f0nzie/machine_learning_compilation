<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 44 Deep Learning tips for Classification and Regression | A Machine Learning Book</title>
<meta name="author" content="Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Machine Learning Book</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prerequisites</a></li>
<li class="book-part">The Basics of Machine Learning</li>
<li><a class="" href="introduction-to-pca.html"><span class="header-section-number">1</span> Introduction to PCA</a></li>
<li><a class="" href="comparison-of-two-pca-packages.html"><span class="header-section-number">2</span> Comparison of two PCA packages</a></li>
<li><a class="" href="detailed-study-of-principal-component-analysis.html"><span class="header-section-number">3</span> Detailed study of Principal Component Analysis</a></li>
<li><a class="" href="detection-of-diabetes-using-logistic-regression.html"><span class="header-section-number">4</span> Detection of diabetes using Logistic Regression</a></li>
<li><a class="" href="sensitivity-analysis-for-a-neural-network.html"><span class="header-section-number">5</span> Sensitivity analysis for a neural network</a></li>
<li><a class="" href="data-visualization-for-ml-models.html"><span class="header-section-number">6</span> Data Visualization for ML models</a></li>
<li class="book-part">Feature Engineering</li>
<li><a class="" href="ten-methods-to-assess-variable-importance.html"><span class="header-section-number">7</span> Ten methods to assess Variable Importance</a></li>
<li><a class="" href="employee-attrition-using-feature-importance.html"><span class="header-section-number">8</span> Employee Attrition using Feature Importance</a></li>
<li><a class="" href="feature-selection-to-enhance-cancer-detection.html"><span class="header-section-number">9</span> Feature Selection to enhance cancer detection</a></li>
<li><a class="" href="dealing-with-unbalanced-data.html"><span class="header-section-number">10</span> Dealing with unbalanced data</a></li>
<li><a class="" href="imputting-missing-values-with-random-forest.html"><span class="header-section-number">11</span> Imputting missing values with Random Forest</a></li>
<li class="book-part">Algorithms Comparison</li>
<li><a class="" href="introduction-to-algorithms-for-classification.html"><span class="header-section-number">12</span> Introduction to algorithms for Classification</a></li>
<li><a class="" href="comparing-classification-algorithms.html"><span class="header-section-number">13</span> Comparing Classification algorithms</a></li>
<li><a class="" href="linear-and-non-linear-algorithms-for-classification.html"><span class="header-section-number">14</span> Linear and Non-Linear Algorithms for Classification</a></li>
<li><a class="" href="predicting-flu-outcome-comparing-eight-classification-algorithms.html"><span class="header-section-number">15</span> Predicting Flu outcome comparing eight classification algorithms</a></li>
<li><a class="" href="classification-on-bad-loans.html"><span class="header-section-number">16</span> Classification on bad loans</a></li>
<li><a class="" href="comparison-of-six-linear-regression-algorithms.html"><span class="header-section-number">17</span> Comparison of six Linear Regression algorithms</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="a-gentle-introduction-to-support-vector-machines.html"><span class="header-section-number">18</span> A gentle introduction to Support Vector Machines</a></li>
<li><a class="" href="broad-view-of-svm.html"><span class="header-section-number">19</span> Broad view of SVM</a></li>
<li><a class="" href="tuning-of-support-vector-machine-prediction.html"><span class="header-section-number">20</span> Tuning of Support Vector Machine prediction</a></li>
<li><a class="" href="who-buys-social-network-ads.html"><span class="header-section-number">21</span> Who buys Social Network ads</a></li>
<li><a class="" href="predicting-ozone-levels.html"><span class="header-section-number">22</span> Predicting Ozone levels</a></li>
<li><a class="" href="building-a-naive-bayes-classifier.html"><span class="header-section-number">23</span> Building a Naive Bayes Classifier</a></li>
<li><a class="" href="detect-mines-vs-rocks-with-random-forest.html"><span class="header-section-number">24</span> Detect mines vs rocks with Random Forest</a></li>
<li><a class="" href="predicting-the-type-of-glass.html"><span class="header-section-number">25</span> Predicting the type of glass</a></li>
<li><a class="" href="naive-bayes-for-sms-spam.html"><span class="header-section-number">26</span> Naive Bayes for SMS spam</a></li>
<li><a class="" href="vehicles-classiification-with-decision-trees.html"><span class="header-section-number">27</span> Vehicles classiification with Decision Trees</a></li>
<li><a class="" href="applying-naive-bayes-on-the-titanic-case.html"><span class="header-section-number">28</span> Applying Naive-Bayes on the Titanic case</a></li>
<li><a class="" href="a-detailed-study-of-bike-sharing-demand.html"><span class="header-section-number">29</span> A detailed study of bike sharing demand</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression-with-islr.html"><span class="header-section-number">30</span> Linear Regression with ISLR</a></li>
<li><a class="" href="evaluation-of-three-linear-regression-models.html"><span class="header-section-number">31</span> Evaluation of three linear regression models</a></li>
<li><a class="" href="comparing-regression-models.html"><span class="header-section-number">32</span> Comparing regression models</a></li>
<li><a class="" href="finding-the-factors-of-happiness.html"><span class="header-section-number">33</span> Finding the factors of happiness</a></li>
<li><a class="" href="regression-with-a-neural-network.html"><span class="header-section-number">34</span> Regression with a neural network</a></li>
<li><a class="" href="comparing-multiple-regression-vs-a-neural-network.html"><span class="header-section-number">35</span> Comparing Multiple Regression vs a Neural Network</a></li>
<li><a class="" href="temperature-modeling-using-nested-dataframes.html"><span class="header-section-number">36</span> Temperature modeling using nested dataframes</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="credit-scoring-with-neuralnet.html"><span class="header-section-number">37</span> Credit Scoring with neuralnet</a></li>
<li><a class="" href="wine-classification-with-neuralnet.html"><span class="header-section-number">38</span> Wine classification with neuralnet</a></li>
<li><a class="" href="predicting-the-rating-of-cereals.html"><span class="header-section-number">39</span> Predicting the rating of cereals</a></li>
<li><a class="" href="fitting-a-linear-model-with-neural-networks.html"><span class="header-section-number">40</span> Fitting a linear model with neural networks</a></li>
<li><a class="" href="visualization-of-neural-networks.html"><span class="header-section-number">41</span> Visualization of neural networks</a></li>
<li><a class="" href="build-a-fully-connected-r-neural-network-from-scratch.html"><span class="header-section-number">42</span> Build a fully connected R neural network from scratch</a></li>
<li><a class="" href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">43</span> Tuning Hyperparameters in a Neural Network</a></li>
<li><a class="active" href="deep-learning-tips-for-classification-and-regression.html"><span class="header-section-number">44</span> Deep Learning tips for Classification and Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></li>
<li><a class="" href="q-q-normal-to-compare-data-to-distributions.html"><span class="header-section-number">B</span> Q-Q normal to compare data to distributions</a></li>
<li><a class="" href="qq-and-pp-plots.html"><span class="header-section-number">C</span> QQ and PP Plots</a></li>
<li><a class="" href="visualizing-residuals.html"><span class="header-section-number">D</span> Visualizing residuals</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hadley/r-pkgs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="deep-learning-tips-for-classification-and-regression" class="section level1">
<h1>
<span class="header-section-number">44</span> Deep Learning tips for Classification and Regression<a class="anchor" aria-label="anchor" href="#deep-learning-tips-for-classification-and-regression"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li>Datasets: <code>spiral.csv</code>, <code>grid.csv</code>, <code>covtype.full.csv</code>
</li>
<li>Algorithms:
<ul>
<li>Deep Learning with <code>h2o</code>
</li>
</ul>
</li>
<li>Techniques:
<ul>
<li>Decision Boundaries</li>
<li>Hyper-parameter Tuning with Grid Search</li>
<li>Checkpointing</li>
<li>Cross-Validation</li>
</ul>
</li>
</ul>
<div id="introduction-25" class="section level2">
<h2>
<span class="header-section-number">44.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-25"><i class="fas fa-link"></i></a>
</h2>
<p>Source: <a href="http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html" class="uri">http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html</a></p>
<p>Repo: <a href="https://github.com/h2oai/h2o-tutorials" class="uri">https://github.com/h2oai/h2o-tutorials</a></p>
<p>This tutorial shows how a H2O Deep Learning model can be used to do supervised classification and regression. A great tutorial about Deep Learning is given by Quoc Le here and here. This tutorial covers usage of H2O from R. A python version of this tutorial will be available as well in a separate document. This file is available in plain R, R markdown and regular markdown formats, and the plots are available as PDF files. All documents are available on Github.</p>
<p>If run from plain R, execute R in the directory of this script. If run from RStudio, be sure to setwd() to the location of this script.<code><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html">h2o.init()</a></code> starts H2O in R’s current working directory. <code><a href="https://rdrr.io/pkg/h2o/man/h2o.importFile.html">h2o.importFile()</a></code> looks for files from the perspective of where H2O was started.</p>
<p>More examples and explanations can be found in our H2O Deep Learning booklet and on our H2O Github Repository. The PDF slide deck can be found on Github.</p>
</div>
<div id="h2o-r-package" class="section level2">
<h2>
<span class="header-section-number">44.2</span> H2O R Package<a class="anchor" aria-label="anchor" href="#h2o-r-package"><i class="fas fa-link"></i></a>
</h2>
<p>Load the H2O R package:</p>
<p>Source: <a href="http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html" class="uri">http://docs.h2o.ai/h2o-tutorials/latest-stable/tutorials/deeplearning/index.html</a></p>
<div class="sourceCode" id="cb999"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## R installation instructions are at http://h2o.ai/download</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/h2oai/h2o-3">h2o</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ----------------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Your next step is to start H2O:</span>
<span class="co">#&gt;     &gt; h2o.init()</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; For H2O package documentation, ask for help:</span>
<span class="co">#&gt;     &gt; ??h2o</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; After starting H2O, you can use the Web UI at http://localhost:54321</span>
<span class="co">#&gt; For more information visit http://docs.h2o.ai</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ----------------------------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'h2o'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     cor, sd, var</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     &amp;&amp;, %*%, %in%, ||, apply, as.factor, as.numeric, colnames,</span>
<span class="co">#&gt;     colnames&lt;-, ifelse, is.character, is.factor, is.numeric, log,</span>
<span class="co">#&gt;     log10, log1p, log2, round, signif, trunc</span></code></pre></div>
</div>
<div id="start-h2o" class="section level2">
<h2>
<span class="header-section-number">44.3</span> Start H2O<a class="anchor" aria-label="anchor" href="#start-h2o"><i class="fas fa-link"></i></a>
</h2>
<p>Start up a 1-node H2O server on your local machine, and allow it to use all CPU cores and up to 2GB of memory:</p>
<div class="sourceCode" id="cb1000"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html">h2o.init</a></span><span class="op">(</span>nthreads<span class="op">=</span><span class="op">-</span><span class="fl">1</span>, max_mem_size<span class="op">=</span><span class="st">"2G"</span><span class="op">)</span>
<span class="co">#&gt;  Connection successful!</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; R is connected to the H2O cluster: </span>
<span class="co">#&gt;     H2O cluster uptime:         34 minutes 38 seconds </span>
<span class="co">#&gt;     H2O cluster timezone:       Etc/UTC </span>
<span class="co">#&gt;     H2O data parsing timezone:  UTC </span>
<span class="co">#&gt;     H2O cluster version:        3.30.0.1 </span>
<span class="co">#&gt;     H2O cluster version age:    7 months and 14 days !!! </span>
<span class="co">#&gt;     H2O cluster name:           H2O_started_from_R_root_mwl453 </span>
<span class="co">#&gt;     H2O cluster total nodes:    1 </span>
<span class="co">#&gt;     H2O cluster total memory:   7.23 GB </span>
<span class="co">#&gt;     H2O cluster total cores:    8 </span>
<span class="co">#&gt;     H2O cluster allowed cores:  8 </span>
<span class="co">#&gt;     H2O cluster healthy:        TRUE </span>
<span class="co">#&gt;     H2O Connection ip:          localhost </span>
<span class="co">#&gt;     H2O Connection port:        54321 </span>
<span class="co">#&gt;     H2O Connection proxy:       NA </span>
<span class="co">#&gt;     H2O Internal Security:      FALSE </span>
<span class="co">#&gt;     H2O API Extensions:         Amazon S3, XGBoost, Algos, AutoML, Core V3, TargetEncoder, Core V4 </span>
<span class="co">#&gt;     R Version:                  R version 3.6.3 (2020-02-29)</span>
<span class="co">#&gt; Warning in h2o.clusterInfo(): </span>
<span class="co">#&gt; Your H2O cluster version is too old (7 months and 14 days)!</span>
<span class="co">#&gt; Please download and install the latest version from http://h2o.ai/download/</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.removeAll.html">h2o.removeAll</a></span><span class="op">(</span><span class="op">)</span> <span class="co">## clean slate - just in case the cluster was already running</span></code></pre></div>
<p>The <code>h2o.deeplearning</code> function fits H2O’s Deep Learning models from within R. We can run the example from the man page using the example function, or run a longer demonstration from the h2o package using the demo function::</p>
<div class="sourceCode" id="cb1001"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/args.html">args</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>
<span class="co">#&gt; function (x, y, training_frame, model_id = NULL, validation_frame = NULL, </span>
<span class="co">#&gt;     nfolds = 0, keep_cross_validation_models = TRUE, keep_cross_validation_predictions = FALSE, </span>
<span class="co">#&gt;     keep_cross_validation_fold_assignment = FALSE, fold_assignment = c("AUTO", </span>
<span class="co">#&gt;         "Random", "Modulo", "Stratified"), fold_column = NULL, </span>
<span class="co">#&gt;     ignore_const_cols = TRUE, score_each_iteration = FALSE, weights_column = NULL, </span>
<span class="co">#&gt;     offset_column = NULL, balance_classes = FALSE, class_sampling_factors = NULL, </span>
<span class="co">#&gt;     max_after_balance_size = 5, max_hit_ratio_k = 0, checkpoint = NULL, </span>
<span class="co">#&gt;     pretrained_autoencoder = NULL, overwrite_with_best_model = TRUE, </span>
<span class="co">#&gt;     use_all_factor_levels = TRUE, standardize = TRUE, activation = c("Tanh", </span>
<span class="co">#&gt;         "TanhWithDropout", "Rectifier", "RectifierWithDropout", </span>
<span class="co">#&gt;         "Maxout", "MaxoutWithDropout"), hidden = c(200, 200), </span>
<span class="co">#&gt;     epochs = 10, train_samples_per_iteration = -2, target_ratio_comm_to_comp = 0.05, </span>
<span class="co">#&gt;     seed = -1, adaptive_rate = TRUE, rho = 0.99, epsilon = 1e-08, </span>
<span class="co">#&gt;     rate = 0.005, rate_annealing = 1e-06, rate_decay = 1, momentum_start = 0, </span>
<span class="co">#&gt;     momentum_ramp = 1e+06, momentum_stable = 0, nesterov_accelerated_gradient = TRUE, </span>
<span class="co">#&gt;     input_dropout_ratio = 0, hidden_dropout_ratios = NULL, l1 = 0, </span>
<span class="co">#&gt;     l2 = 0, max_w2 = 3.4028235e+38, initial_weight_distribution = c("UniformAdaptive", </span>
<span class="co">#&gt;         "Uniform", "Normal"), initial_weight_scale = 1, initial_weights = NULL, </span>
<span class="co">#&gt;     initial_biases = NULL, loss = c("Automatic", "CrossEntropy", </span>
<span class="co">#&gt;         "Quadratic", "Huber", "Absolute", "Quantile"), distribution = c("AUTO", </span>
<span class="co">#&gt;         "bernoulli", "multinomial", "gaussian", "poisson", "gamma", </span>
<span class="co">#&gt;         "tweedie", "laplace", "quantile", "huber"), quantile_alpha = 0.5, </span>
<span class="co">#&gt;     tweedie_power = 1.5, huber_alpha = 0.9, score_interval = 5, </span>
<span class="co">#&gt;     score_training_samples = 10000, score_validation_samples = 0, </span>
<span class="co">#&gt;     score_duty_cycle = 0.1, classification_stop = 0, regression_stop = 1e-06, </span>
<span class="co">#&gt;     stopping_rounds = 5, stopping_metric = c("AUTO", "deviance", </span>
<span class="co">#&gt;         "logloss", "MSE", "RMSE", "MAE", "RMSLE", "AUC", "AUCPR", </span>
<span class="co">#&gt;         "lift_top_group", "misclassification", "mean_per_class_error", </span>
<span class="co">#&gt;         "custom", "custom_increasing"), stopping_tolerance = 0, </span>
<span class="co">#&gt;     max_runtime_secs = 0, score_validation_sampling = c("Uniform", </span>
<span class="co">#&gt;         "Stratified"), diagnostics = TRUE, fast_mode = TRUE, </span>
<span class="co">#&gt;     force_load_balance = TRUE, variable_importances = TRUE, replicate_training_data = TRUE, </span>
<span class="co">#&gt;     single_node_mode = FALSE, shuffle_training_data = FALSE, </span>
<span class="co">#&gt;     missing_values_handling = c("MeanImputation", "Skip"), quiet_mode = FALSE, </span>
<span class="co">#&gt;     autoencoder = FALSE, sparse = FALSE, col_major = FALSE, average_activation = 0, </span>
<span class="co">#&gt;     sparsity_beta = 0, max_categorical_features = 2147483647, </span>
<span class="co">#&gt;     reproducible = FALSE, export_weights_and_biases = FALSE, </span>
<span class="co">#&gt;     mini_batch_size = 1, categorical_encoding = c("AUTO", "Enum", </span>
<span class="co">#&gt;         "OneHotInternal", "OneHotExplicit", "Binary", "Eigen", </span>
<span class="co">#&gt;         "LabelEncoder", "SortByResponse", "EnumLimited"), elastic_averaging = FALSE, </span>
<span class="co">#&gt;     elastic_averaging_moving_rate = 0.9, elastic_averaging_regularization = 0.001, </span>
<span class="co">#&gt;     export_checkpoints_dir = NULL, verbose = FALSE) </span>
<span class="co">#&gt; NULL</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/help.html">help</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/example.html">example</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; h2.dpl&gt; ## Not run: </span>
<span class="co">#&gt; h2.dpl&gt; ##D library(h2o)</span>
<span class="co">#&gt; h2.dpl&gt; ##D h2o.init()</span>
<span class="co">#&gt; h2.dpl&gt; ##D iris_hf &lt;- as.h2o(iris)</span>
<span class="co">#&gt; h2.dpl&gt; ##D iris_dl &lt;- h2o.deeplearning(x = 1:4, y = 5, training_frame = iris_hf, seed=123456)</span>
<span class="co">#&gt; h2.dpl&gt; ##D </span>
<span class="co">#&gt; h2.dpl&gt; ##D # now make a prediction</span>
<span class="co">#&gt; h2.dpl&gt; ##D predictions &lt;- h2o.predict(iris_dl, iris_hf)</span>
<span class="co">#&gt; h2.dpl&gt; ## End(Not run)</span>
<span class="co">#&gt; h2.dpl&gt; </span>
<span class="co">#&gt; h2.dpl&gt; </span>
<span class="co">#&gt; h2.dpl&gt;</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/demo.html">demo</a></span><span class="op">(</span><span class="va">h2o.deeplearning</span><span class="op">)</span>  <span class="co">#requires user interaction</span></code></pre></div>
<p>While <strong>H2O Deep Learning</strong> has many parameters, it was designed to be just as easy to use as the other supervised training methods in H2O. Early stopping, automatic data standardization and handling of categorical variables and missing values and adaptive learning rates (per weight) reduce the amount of parameters the user has to specify. Often, it’s just the number and sizes of hidden layers, the number of epochs and the activation function and maybe some regularization techniques.</p>
</div>
<div id="lets-have-some-fun-first-decision-boundaries" class="section level2">
<h2>
<span class="header-section-number">44.4</span> Let’s have some fun first: Decision Boundaries<a class="anchor" aria-label="anchor" href="#lets-have-some-fun-first-decision-boundaries"><i class="fas fa-link"></i></a>
</h2>
<p>We start with a small dataset representing red and black dots on a plane, arranged in the shape of two nested spirals. Then we task H2O’s machine learning methods to separate the red and black dots, i.e., recognize each spiral as such by assigning each point in the plane to one of the two spirals.</p>
<p>We visualize the nature of H2O Deep Learning (DL), H2O’s tree methods (GBM/DRF) and H2O’s generalized linear modeling (GLM) by plotting the decision boundary between the red and black spirals:</p>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1002-1" data-line-number="1"><span class="co"># setwd("~/h2o-tutorials/tutorials/deeplearning") ##For RStudio</span></a>
<a class="sourceLine" id="cb1002-2" data-line-number="2">spiral &lt;-<span class="st"> </span><span class="kw">h2o.importFile</span>(<span class="dt">path =</span> <span class="kw">normalizePath</span>(<span class="kw">file.path</span>(data_raw_dir, <span class="st">"spiral.csv"</span>)))</a>
<a class="sourceLine" id="cb1002-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1002-4" data-line-number="4">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1002-5" data-line-number="5"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1002-6" data-line-number="6">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1002-7" data-line-number="7"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1002-8" data-line-number="8">grid   &lt;-<span class="st"> </span><span class="kw">h2o.importFile</span>(<span class="dt">path =</span> <span class="kw">normalizePath</span>(<span class="kw">file.path</span>(data_raw_dir, <span class="st">"grid.csv"</span>)))</a>
<a class="sourceLine" id="cb1002-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1002-10" data-line-number="10">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1002-11" data-line-number="11"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1002-12" data-line-number="12">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1002-13" data-line-number="13"><span class="st">  </span><span class="er">|====</span><span class="st">                                                                  </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%</a>
<a class="sourceLine" id="cb1002-14" data-line-number="14">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1002-15" data-line-number="15"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1002-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1002-17" data-line-number="17"><span class="co"># Define helper to plot contours</span></a>
<a class="sourceLine" id="cb1002-18" data-line-number="18">plotC &lt;-<span class="st"> </span><span class="cf">function</span>(name, model, <span class="dt">data=</span>spiral, <span class="dt">g=</span>grid) {</a>
<a class="sourceLine" id="cb1002-19" data-line-number="19">  data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(data) <span class="co">#get data from into R</span></a>
<a class="sourceLine" id="cb1002-20" data-line-number="20">  pred &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">h2o.predict</span>(model, g))</a>
<a class="sourceLine" id="cb1002-21" data-line-number="21">  n=<span class="fl">0.5</span><span class="op">*</span>(<span class="kw">sqrt</span>(<span class="kw">nrow</span>(g))<span class="op">-</span><span class="dv">1</span>); d &lt;-<span class="st"> </span><span class="fl">1.5</span>; h &lt;-<span class="st"> </span>d<span class="op">*</span>(<span class="op">-</span>n<span class="op">:</span>n)<span class="op">/</span>n</a>
<a class="sourceLine" id="cb1002-22" data-line-number="22">  <span class="kw">plot</span>(data[,<span class="op">-</span><span class="dv">3</span>],<span class="dt">pch=</span><span class="dv">19</span>,<span class="dt">col=</span>data[,<span class="dv">3</span>],<span class="dt">cex=</span><span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb1002-23" data-line-number="23">       <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span>d,d),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span>d,d),<span class="dt">main=</span>name)</a>
<a class="sourceLine" id="cb1002-24" data-line-number="24">  <span class="kw">contour</span>(h,h,<span class="dt">z=</span><span class="kw">array</span>(<span class="kw">ifelse</span>(pred[,<span class="dv">1</span>]<span class="op">==</span><span class="st">"Red"</span>,<span class="dv">0</span>,<span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1002-25" data-line-number="25">          <span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span>n<span class="op">+</span><span class="dv">1</span>,<span class="dv">2</span><span class="op">*</span>n<span class="op">+</span><span class="dv">1</span>)),<span class="dt">col=</span><span class="st">"blue"</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">add=</span>T)</a>
<a class="sourceLine" id="cb1002-26" data-line-number="26">}</a></code></pre></div>
<p>We build a few different models:</p>
<div class="sourceCode" id="cb1003"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>
<span class="fu">plotC</span><span class="op">(</span> <span class="st">"DL"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="fl">1e3</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="st">"GBM"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.gbm.html">h2o.gbm</a></span>         <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="st">"DRF"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.randomForest.html">h2o.randomForest</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="st">"GLM"</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.glm.html">h2o.glm</a></span>         <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,family<span class="op">=</span><span class="st">"binomial"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure">
<img src="604-nn-comparison-deep_learning_tips_files/figure-html/deeplearning_gbm_drf_glm-1.png" width="70%" style="display: block; margin: auto;">
Let’s investigate some more Deep Learning models. First, we explore the evolution over training time (number of passes over the data), and we use checkpointing to continue training the same model:</div>
<div class="sourceCode" id="cb1004"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>
<span class="va">ep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">250</span>,<span class="fl">500</span>,<span class="fl">750</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
                              model_id<span class="op">=</span><span class="st">"dl_1"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
            checkpoint<span class="op">=</span><span class="st">"dl_1"</span>,model_id<span class="op">=</span><span class="st">"dl_2"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,
            checkpoint<span class="op">=</span><span class="st">"dl_2"</span>,model_id<span class="op">=</span><span class="st">"dl_3"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">ep</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,<span class="st">" epochs"</span><span class="op">)</span>,
      <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="va">spiral</span>,epochs<span class="op">=</span><span class="va">ep</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,
            checkpoint<span class="op">=</span><span class="st">"dl_3"</span>,model_id<span class="op">=</span><span class="st">"dl_4"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/deeplearning_evolution_training_time-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>You can see how the network learns the structure of the spirals with enough training time. We explore different network architectures next:</p>
<div class="sourceCode" id="cb1005"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">hidden</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">13</span>,<span class="fl">17</span>,<span class="fl">19</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">42</span>,<span class="fl">42</span>,<span class="fl">42</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">200</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL hidden="</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">hidden</span>, collapse<span class="op">=</span><span class="st">"x"</span><span class="op">)</span><span class="op">)</span>,
        <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span> ,<span class="va">spiral</span>, hidden<span class="op">=</span><span class="va">hidden</span>, epochs<span class="op">=</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/deeplearning_for_loop_hidden-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>It is clear that different configurations can achieve similar performance, and that tuning will be required for optimal performance. Next, we compare between different activation functions, including one with 50% dropout regularization in the hidden layers:</p>
<div class="sourceCode" id="cb1006"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#set up the canvas for 2x2 plots</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">act</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tanh"</span>, <span class="st">"Maxout"</span>, <span class="st">"Rectifier"</span>, <span class="st">"RectifierWithDropout"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu">plotC</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"DL "</span>,<span class="va">act</span>,<span class="st">" activation"</span><span class="op">)</span>, 
        <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="fl">3</span>, <span class="va">spiral</span>,
              activation <span class="op">=</span> <span class="va">act</span>, 
              hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>, 
              epochs <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/compare_activation_functions-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Clearly, the dropout rate was too high or the number of epochs was too low for the last configuration, which often ends up performing the best on larger datasets where generalization is important.</p>
<p>More information about the parameters can be found in the H2O Deep Learning booklet.</p>
</div>
<div id="cover-type-dataset" class="section level2">
<h2>
<span class="header-section-number">44.5</span> Cover Type Dataset<a class="anchor" aria-label="anchor" href="#cover-type-dataset"><i class="fas fa-link"></i></a>
</h2>
<p>We important the full cover type dataset (581k rows, 13 columns, 10 numerical, 3 categorical). We also split the data 3 ways: 60% for training, 20% for validation (hyper parameter tuning) and 20% for final testing.</p>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1007-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">h2o.importFile</span>(<span class="dt">path =</span> <span class="kw">normalizePath</span>(<span class="kw">file.path</span>(data_raw_dir, <span class="st">"covtype.full.csv"</span>)))</a>
<a class="sourceLine" id="cb1007-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1007-3" data-line-number="3">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1007-4" data-line-number="4"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1007-5" data-line-number="5">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1007-6" data-line-number="6"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1007-7" data-line-number="7"><span class="kw">dim</span>(df)</a>
<a class="sourceLine" id="cb1007-8" data-line-number="8"><span class="co">#&gt; [1] 581012     13</span></a>
<a class="sourceLine" id="cb1007-9" data-line-number="9">df</a>
<a class="sourceLine" id="cb1007-10" data-line-number="10"><span class="co">#&gt;   Elevation Aspect Slope Horizontal_Distance_To_Hydrology</span></a>
<a class="sourceLine" id="cb1007-11" data-line-number="11"><span class="co">#&gt; 1      3066    124     5                                0</span></a>
<a class="sourceLine" id="cb1007-12" data-line-number="12"><span class="co">#&gt; 2      3136     32    20                              450</span></a>
<a class="sourceLine" id="cb1007-13" data-line-number="13"><span class="co">#&gt; 3      2655     28    14                               42</span></a>
<a class="sourceLine" id="cb1007-14" data-line-number="14"><span class="co">#&gt; 4      3191     45    19                              323</span></a>
<a class="sourceLine" id="cb1007-15" data-line-number="15"><span class="co">#&gt; 5      3217     80    13                               30</span></a>
<a class="sourceLine" id="cb1007-16" data-line-number="16"><span class="co">#&gt; 6      3119    293    13                               30</span></a>
<a class="sourceLine" id="cb1007-17" data-line-number="17"><span class="co">#&gt;   Vertical_Distance_To_Hydrology Horizontal_Distance_To_Roadways Hillshade_9am</span></a>
<a class="sourceLine" id="cb1007-18" data-line-number="18"><span class="co">#&gt; 1                              0                            1533           229</span></a>
<a class="sourceLine" id="cb1007-19" data-line-number="19"><span class="co">#&gt; 2                            -38                            1290           211</span></a>
<a class="sourceLine" id="cb1007-20" data-line-number="20"><span class="co">#&gt; 3                              8                            1890           214</span></a>
<a class="sourceLine" id="cb1007-21" data-line-number="21"><span class="co">#&gt; 4                             88                            3932           221</span></a>
<a class="sourceLine" id="cb1007-22" data-line-number="22"><span class="co">#&gt; 5                              1                            3901           237</span></a>
<a class="sourceLine" id="cb1007-23" data-line-number="23"><span class="co">#&gt; 6                             10                            4810           182</span></a>
<a class="sourceLine" id="cb1007-24" data-line-number="24"><span class="co">#&gt;   Hillshade_Noon Hillshade_3pm Horizontal_Distance_To_Fire_Points</span></a>
<a class="sourceLine" id="cb1007-25" data-line-number="25"><span class="co">#&gt; 1            236           141                                459</span></a>
<a class="sourceLine" id="cb1007-26" data-line-number="26"><span class="co">#&gt; 2            193           111                               1112</span></a>
<a class="sourceLine" id="cb1007-27" data-line-number="27"><span class="co">#&gt; 3            209           128                               1001</span></a>
<a class="sourceLine" id="cb1007-28" data-line-number="28"><span class="co">#&gt; 4            195           100                               2919</span></a>
<a class="sourceLine" id="cb1007-29" data-line-number="29"><span class="co">#&gt; 5            217           109                               2859</span></a>
<a class="sourceLine" id="cb1007-30" data-line-number="30"><span class="co">#&gt; 6            237           194                               1200</span></a>
<a class="sourceLine" id="cb1007-31" data-line-number="31"><span class="co">#&gt;   Wilderness_Area Soil_Type Cover_Type</span></a>
<a class="sourceLine" id="cb1007-32" data-line-number="32"><span class="co">#&gt; 1          area_0   type_22    class_1</span></a>
<a class="sourceLine" id="cb1007-33" data-line-number="33"><span class="co">#&gt; 2          area_0   type_28    class_1</span></a>
<a class="sourceLine" id="cb1007-34" data-line-number="34"><span class="co">#&gt; 3          area_2    type_9    class_2</span></a>
<a class="sourceLine" id="cb1007-35" data-line-number="35"><span class="co">#&gt; 4          area_0   type_39    class_2</span></a>
<a class="sourceLine" id="cb1007-36" data-line-number="36"><span class="co">#&gt; 5          area_0   type_22    class_7</span></a>
<a class="sourceLine" id="cb1007-37" data-line-number="37"><span class="co">#&gt; 6          area_0   type_21    class_1</span></a>
<a class="sourceLine" id="cb1007-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1007-39" data-line-number="39"><span class="co">#&gt; [581012 rows x 13 columns]</span></a>
<a class="sourceLine" id="cb1007-40" data-line-number="40">splits &lt;-<span class="st"> </span><span class="kw">h2o.splitFrame</span>(df, <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>), <span class="dt">seed=</span><span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb1007-41" data-line-number="41">train  &lt;-<span class="st"> </span><span class="kw">h2o.assign</span>(splits[[<span class="dv">1</span>]], <span class="st">"train.hex"</span>) <span class="co"># 60%</span></a>
<a class="sourceLine" id="cb1007-42" data-line-number="42">valid  &lt;-<span class="st"> </span><span class="kw">h2o.assign</span>(splits[[<span class="dv">2</span>]], <span class="st">"valid.hex"</span>) <span class="co"># 20%</span></a>
<a class="sourceLine" id="cb1007-43" data-line-number="43">test   &lt;-<span class="st"> </span><span class="kw">h2o.assign</span>(splits[[<span class="dv">3</span>]], <span class="st">"test.hex"</span>)  <span class="co"># 20%</span></a></code></pre></div>
<p>Here’s a scalable way to do scatter plots via binning (works for categorical and numeric columns) to get more familiar with the dataset.</p>
<div class="sourceCode" id="cb1008"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dev.new(noRStudioGD=FALSE) #direct plotting output to a new window</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># reset canvas</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Elevation"</span>,                       <span class="st">"Cover_Type"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Horizontal_Distance_To_Roadways"</span>, <span class="st">"Cover_Type"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Soil_Type"</span>,                       <span class="st">"Cover_Type"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.tabulate.html">h2o.tabulate</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Horizontal_Distance_To_Roadways"</span>, <span class="st">"Elevation"</span> <span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-1.png" width="70%" style="display: block; margin: auto;"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-2.png" width="70%" style="display: block; margin: auto;"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-3.png" width="70%" style="display: block; margin: auto;"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/plot_cover_type-4.png" width="70%" style="display: block; margin: auto;"></p>
<div id="first-run-of-h2o-deep-learning" class="section level3">
<h3>
<span class="header-section-number">44.5.1</span> First Run of H2O Deep Learning<a class="anchor" aria-label="anchor" href="#first-run-of-h2o-deep-learning"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s run our first Deep Learning model on the covtype dataset. We want to predict the <code>Cover_Type</code> column, a categorical feature with 7 levels, and the Deep Learning model will be tasked to perform (multi-class) classification. It uses the other 12 predictors of the dataset, of which 10 are numerical, and 2 are categorical with a total of 44 levels. We can expect the Deep Learning model to have 56 input neurons (after automatic one-hot encoding).</p>
<div class="sourceCode" id="cb1009"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">response</span> <span class="op">&lt;-</span> <span class="st">"Cover_Type"</span>
<span class="va">predictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/setops.html">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="va">response</span><span class="op">)</span>
<span class="va">predictors</span>
<span class="co">#&gt;  [1] "Elevation"                          "Aspect"                            </span>
<span class="co">#&gt;  [3] "Slope"                              "Horizontal_Distance_To_Hydrology"  </span>
<span class="co">#&gt;  [5] "Vertical_Distance_To_Hydrology"     "Horizontal_Distance_To_Roadways"   </span>
<span class="co">#&gt;  [7] "Hillshade_9am"                      "Hillshade_Noon"                    </span>
<span class="co">#&gt;  [9] "Hillshade_3pm"                      "Horizontal_Distance_To_Fire_Points"</span>
<span class="co">#&gt; [11] "Wilderness_Area"                    "Soil_Type"</span></code></pre></div>
<div class="sourceCode" id="cb1010"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">train_df</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    349015 obs. of  13 variables:</span>
<span class="co">#&gt;  $ Elevation                         : int  3136 3217 3119 2679 3261 2885 3227 2843 2853 2883 ...</span>
<span class="co">#&gt;  $ Aspect                            : int  32 80 293 48 322 26 32 12 124 177 ...</span>
<span class="co">#&gt;  $ Slope                             : int  20 13 13 7 13 9 6 18 12 9 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Hydrology  : int  450 30 30 150 30 192 108 335 30 426 ...</span>
<span class="co">#&gt;  $ Vertical_Distance_To_Hydrology    : int  -38 1 10 24 5 38 13 50 -5 126 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Roadways   : int  1290 3901 4810 1588 5701 3271 5542 2642 1485 2139 ...</span>
<span class="co">#&gt;  $ Hillshade_9am                     : int  211 237 182 223 186 216 219 199 240 225 ...</span>
<span class="co">#&gt;  $ Hillshade_Noon                    : int  193 217 237 224 226 220 227 201 231 246 ...</span>
<span class="co">#&gt;  $ Hillshade_3pm                     : int  111 109 194 136 180 140 145 135 119 153 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Fire_Points: int  1112 2859 1200 6265 769 2643 765 1719 2497 713 ...</span>
<span class="co">#&gt;  $ Wilderness_Area                   : Factor w/ 4 levels "area_0","area_1",..: 1 1 1 1 1 1 1 3 3 3 ...</span>
<span class="co">#&gt;  $ Soil_Type                         : Factor w/ 40 levels "type_0","type_1",..: 22 16 15 4 15 22 15 27 12 25 ...</span>
<span class="co">#&gt;  $ Cover_Type                        : Factor w/ 7 levels "class_1","class_2",..: 1 7 1 2 1 2 1 2 1 2 ...</span></code></pre></div>
<div class="sourceCode" id="cb1011"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">valid_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">valid</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">valid_df</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    116018 obs. of  13 variables:</span>
<span class="co">#&gt;  $ Elevation                         : int  3066 2655 2902 2994 2697 2990 3237 2884 2972 2696 ...</span>
<span class="co">#&gt;  $ Aspect                            : int  124 28 304 61 93 59 135 71 100 169 ...</span>
<span class="co">#&gt;  $ Slope                             : int  5 14 22 9 9 12 14 9 4 10 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Hydrology  : int  0 42 511 391 306 108 240 459 175 323 ...</span>
<span class="co">#&gt;  $ Vertical_Distance_To_Hydrology    : int  0 8 18 57 -2 10 -11 141 13 149 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Roadways   : int  1533 1890 1273 4286 553 2190 1189 1214 5031 2452 ...</span>
<span class="co">#&gt;  $ Hillshade_9am                     : int  229 214 155 227 234 229 241 231 227 228 ...</span>
<span class="co">#&gt;  $ Hillshade_Noon                    : int  236 209 223 222 227 215 233 222 234 244 ...</span>
<span class="co">#&gt;  $ Hillshade_3pm                     : int  141 128 206 128 125 117 118 124 142 148 ...</span>
<span class="co">#&gt;  $ Horizontal_Distance_To_Fire_Points: int  459 1001 1347 1928 1716 1048 2748 1355 6198 1044 ...</span>
<span class="co">#&gt;  $ Wilderness_Area                   : Factor w/ 4 levels "area_0","area_1",..: 1 3 3 1 1 3 1 3 1 3 ...</span>
<span class="co">#&gt;  $ Soil_Type                         : Factor w/ 39 levels "type_0","type_1",..: 15 39 25 4 4 25 14 25 11 23 ...</span>
<span class="co">#&gt;  $ Cover_Type                        : Factor w/ 7 levels "class_1","class_2",..: 1 2 2 2 2 2 1 2 1 3 ...</span></code></pre></div>
<p>To keep it fast, we only run for one epoch (one pass over the training data).</p>
<div class="sourceCode" id="cb1012"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1012-1" data-line-number="1">m1 &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(</a>
<a class="sourceLine" id="cb1012-2" data-line-number="2">  <span class="dt">model_id=</span><span class="st">"dl_model_first"</span>, </a>
<a class="sourceLine" id="cb1012-3" data-line-number="3">  <span class="dt">training_frame =</span> train, </a>
<a class="sourceLine" id="cb1012-4" data-line-number="4">  <span class="dt">validation_frame =</span> valid,   <span class="co">## validation dataset: used for scoring and early stopping</span></a>
<a class="sourceLine" id="cb1012-5" data-line-number="5">  <span class="dt">x =</span> predictors,</a>
<a class="sourceLine" id="cb1012-6" data-line-number="6">  <span class="dt">y =</span> response,</a>
<a class="sourceLine" id="cb1012-7" data-line-number="7">  <span class="co">#activation="Rectifier",  ## default</span></a>
<a class="sourceLine" id="cb1012-8" data-line-number="8">  <span class="co">#hidden=c(200,200),       ## default: 2 hidden layers with 200 neurons each</span></a>
<a class="sourceLine" id="cb1012-9" data-line-number="9">  <span class="dt">epochs =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1012-10" data-line-number="10">  <span class="dt">variable_importances=</span>T    <span class="co">## not enabled by default</span></a>
<a class="sourceLine" id="cb1012-11" data-line-number="11">)</a>
<a class="sourceLine" id="cb1012-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-13" data-line-number="13">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-14" data-line-number="14"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1012-15" data-line-number="15">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-16" data-line-number="16"><span class="st">  </span><span class="er">|=======</span><span class="st">                                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">10</span>%</a>
<a class="sourceLine" id="cb1012-17" data-line-number="17">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-18" data-line-number="18"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb1012-19" data-line-number="19">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-20" data-line-number="20"><span class="st">  </span><span class="er">|=====================</span><span class="st">                                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">30</span>%</a>
<a class="sourceLine" id="cb1012-21" data-line-number="21">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-22" data-line-number="22"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb1012-23" data-line-number="23">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-24" data-line-number="24"><span class="st">  </span><span class="er">|===================================</span><span class="st">                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%</a>
<a class="sourceLine" id="cb1012-25" data-line-number="25">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-26" data-line-number="26"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb1012-27" data-line-number="27">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-28" data-line-number="28"><span class="st">  </span><span class="er">|=================================================</span><span class="st">                     </span><span class="er">|</span><span class="st">  </span><span class="dv">70</span>%</a>
<a class="sourceLine" id="cb1012-29" data-line-number="29">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-30" data-line-number="30"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb1012-31" data-line-number="31">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-32" data-line-number="32"><span class="st">  </span><span class="er">|===============================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">90</span>%</a>
<a class="sourceLine" id="cb1012-33" data-line-number="33">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1012-34" data-line-number="34"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1012-35" data-line-number="35"><span class="kw">summary</span>(m1)</a>
<a class="sourceLine" id="cb1012-36" data-line-number="36"><span class="co">#&gt; Model Details:</span></a>
<a class="sourceLine" id="cb1012-37" data-line-number="37"><span class="co">#&gt; ==============</span></a>
<a class="sourceLine" id="cb1012-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-39" data-line-number="39"><span class="co">#&gt; H2OMultinomialModel: deeplearning</span></a>
<a class="sourceLine" id="cb1012-40" data-line-number="40"><span class="co">#&gt; Model Key:  dl_model_first </span></a>
<a class="sourceLine" id="cb1012-41" data-line-number="41"><span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 53,007 weights/biases, 633.2 KB, 383,667 training samples, mini-batch size 1</span></a>
<a class="sourceLine" id="cb1012-42" data-line-number="42"><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></a>
<a class="sourceLine" id="cb1012-43" data-line-number="43"><span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span></a>
<a class="sourceLine" id="cb1012-44" data-line-number="44"><span class="co">#&gt; 2     2   200 Rectifier  0.00 % 0.000000 0.000000  0.053231 0.216279 0.000000</span></a>
<a class="sourceLine" id="cb1012-45" data-line-number="45"><span class="co">#&gt; 3     3   200 Rectifier  0.00 % 0.000000 0.000000  0.009176 0.008470 0.000000</span></a>
<a class="sourceLine" id="cb1012-46" data-line-number="46"><span class="co">#&gt; 4     4     7   Softmax      NA 0.000000 0.000000  0.106650 0.277287 0.000000</span></a>
<a class="sourceLine" id="cb1012-47" data-line-number="47"><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></a>
<a class="sourceLine" id="cb1012-48" data-line-number="48"><span class="co">#&gt; 1          NA         NA        NA       NA</span></a>
<a class="sourceLine" id="cb1012-49" data-line-number="49"><span class="co">#&gt; 2   -0.009328   0.118514 -0.002703 0.123871</span></a>
<a class="sourceLine" id="cb1012-50" data-line-number="50"><span class="co">#&gt; 3   -0.025363   0.118372  0.661830 0.400879</span></a>
<a class="sourceLine" id="cb1012-51" data-line-number="51"><span class="co">#&gt; 4   -0.367434   0.497186 -0.528376 0.147536</span></a>
<a class="sourceLine" id="cb1012-52" data-line-number="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-53" data-line-number="53"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1012-54" data-line-number="54"><span class="co">#&gt; ** Reported on training data. **</span></a>
<a class="sourceLine" id="cb1012-55" data-line-number="55"><span class="co">#&gt; ** Metrics reported on temporary training frame with 10116 samples **</span></a>
<a class="sourceLine" id="cb1012-56" data-line-number="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-57" data-line-number="57"><span class="co">#&gt; Training Set Metrics: </span></a>
<a class="sourceLine" id="cb1012-58" data-line-number="58"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1012-59" data-line-number="59"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-60" data-line-number="60"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.129</span></a>
<a class="sourceLine" id="cb1012-61" data-line-number="61"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.359</span></a>
<a class="sourceLine" id="cb1012-62" data-line-number="62"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.417</span></a>
<a class="sourceLine" id="cb1012-63" data-line-number="63"><span class="co">#&gt; Mean Per-Class Error: 0.32</span></a>
<a class="sourceLine" id="cb1012-64" data-line-number="64"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span></a>
<a class="sourceLine" id="cb1012-65" data-line-number="65"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1012-66" data-line-number="66"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1012-67" data-line-number="67"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1012-68" data-line-number="68"><span class="co">#&gt; class_1    2784     737       0       0       2       6      59 0.2241</span></a>
<a class="sourceLine" id="cb1012-69" data-line-number="69"><span class="co">#&gt; class_2     387    4527      17       0       9      51       6 0.0941</span></a>
<a class="sourceLine" id="cb1012-70" data-line-number="70"><span class="co">#&gt; class_3       0      56     465       3       0     105       0 0.2607</span></a>
<a class="sourceLine" id="cb1012-71" data-line-number="71"><span class="co">#&gt; class_4       0       0      15      29       0      11       0 0.4727</span></a>
<a class="sourceLine" id="cb1012-72" data-line-number="72"><span class="co">#&gt; class_5       5     102       6       0      56       3       0 0.6744</span></a>
<a class="sourceLine" id="cb1012-73" data-line-number="73"><span class="co">#&gt; class_6       0      35      71       0       0     194       0 0.3533</span></a>
<a class="sourceLine" id="cb1012-74" data-line-number="74"><span class="co">#&gt; class_7      54       5       0       0       0       0     316 0.1573</span></a>
<a class="sourceLine" id="cb1012-75" data-line-number="75"><span class="co">#&gt; Totals     3230    5462     574      32      67     370     381 0.1725</span></a>
<a class="sourceLine" id="cb1012-76" data-line-number="76"><span class="co">#&gt;                     Rate</span></a>
<a class="sourceLine" id="cb1012-77" data-line-number="77"><span class="co">#&gt; class_1 =    804 / 3,588</span></a>
<a class="sourceLine" id="cb1012-78" data-line-number="78"><span class="co">#&gt; class_2 =    470 / 4,997</span></a>
<a class="sourceLine" id="cb1012-79" data-line-number="79"><span class="co">#&gt; class_3 =      164 / 629</span></a>
<a class="sourceLine" id="cb1012-80" data-line-number="80"><span class="co">#&gt; class_4 =        26 / 55</span></a>
<a class="sourceLine" id="cb1012-81" data-line-number="81"><span class="co">#&gt; class_5 =      116 / 172</span></a>
<a class="sourceLine" id="cb1012-82" data-line-number="82"><span class="co">#&gt; class_6 =      106 / 300</span></a>
<a class="sourceLine" id="cb1012-83" data-line-number="83"><span class="co">#&gt; class_7 =       59 / 375</span></a>
<a class="sourceLine" id="cb1012-84" data-line-number="84"><span class="co">#&gt; Totals  = 1,745 / 10,116</span></a>
<a class="sourceLine" id="cb1012-85" data-line-number="85"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-86" data-line-number="86"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span></a>
<a class="sourceLine" id="cb1012-87" data-line-number="87"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1012-88" data-line-number="88"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1012-89" data-line-number="89"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1012-90" data-line-number="90"><span class="co">#&gt; 1 1  0.827501</span></a>
<a class="sourceLine" id="cb1012-91" data-line-number="91"><span class="co">#&gt; 2 2  0.982800</span></a>
<a class="sourceLine" id="cb1012-92" data-line-number="92"><span class="co">#&gt; 3 3  0.997628</span></a>
<a class="sourceLine" id="cb1012-93" data-line-number="93"><span class="co">#&gt; 4 4  0.999703</span></a>
<a class="sourceLine" id="cb1012-94" data-line-number="94"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1012-95" data-line-number="95"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1012-96" data-line-number="96"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1012-97" data-line-number="97"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-98" data-line-number="98"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-99" data-line-number="99"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1012-100" data-line-number="100"><span class="co">#&gt; ** Reported on validation data. **</span></a>
<a class="sourceLine" id="cb1012-101" data-line-number="101"><span class="co">#&gt; ** Metrics reported on full validation frame **</span></a>
<a class="sourceLine" id="cb1012-102" data-line-number="102"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-103" data-line-number="103"><span class="co">#&gt; Validation Set Metrics: </span></a>
<a class="sourceLine" id="cb1012-104" data-line-number="104"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1012-105" data-line-number="105"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-106" data-line-number="106"><span class="co">#&gt; Extract validation frame with `h2o.getFrame("valid.hex")`</span></a>
<a class="sourceLine" id="cb1012-107" data-line-number="107"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.128</span></a>
<a class="sourceLine" id="cb1012-108" data-line-number="108"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.358</span></a>
<a class="sourceLine" id="cb1012-109" data-line-number="109"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.416</span></a>
<a class="sourceLine" id="cb1012-110" data-line-number="110"><span class="co">#&gt; Mean Per-Class Error: 0.314</span></a>
<a class="sourceLine" id="cb1012-111" data-line-number="111"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span></a>
<a class="sourceLine" id="cb1012-112" data-line-number="112"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1012-113" data-line-number="113"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1012-114" data-line-number="114"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1012-115" data-line-number="115"><span class="co">#&gt; class_1   33137    8656       0       0      45      26     636 0.2203</span></a>
<a class="sourceLine" id="cb1012-116" data-line-number="116"><span class="co">#&gt; class_2    4483   50906     197       0     168     564      62 0.0971</span></a>
<a class="sourceLine" id="cb1012-117" data-line-number="117"><span class="co">#&gt; class_3       0     718    5254      51       0    1120       0 0.2645</span></a>
<a class="sourceLine" id="cb1012-118" data-line-number="118"><span class="co">#&gt; class_4       0       3     182     290       0      87       0 0.4840</span></a>
<a class="sourceLine" id="cb1012-119" data-line-number="119"><span class="co">#&gt; class_5      52    1087      46       0     661      24       0 0.6465</span></a>
<a class="sourceLine" id="cb1012-120" data-line-number="120"><span class="co">#&gt; class_6       6     484     668       8       1    2297       0 0.3369</span></a>
<a class="sourceLine" id="cb1012-121" data-line-number="121"><span class="co">#&gt; class_7     559      53       0       0       0       0    3487 0.1493</span></a>
<a class="sourceLine" id="cb1012-122" data-line-number="122"><span class="co">#&gt; Totals    38237   61907    6347     349     875    4118    4185 0.1723</span></a>
<a class="sourceLine" id="cb1012-123" data-line-number="123"><span class="co">#&gt;                       Rate</span></a>
<a class="sourceLine" id="cb1012-124" data-line-number="124"><span class="co">#&gt; class_1 =   9,363 / 42,500</span></a>
<a class="sourceLine" id="cb1012-125" data-line-number="125"><span class="co">#&gt; class_2 =   5,474 / 56,380</span></a>
<a class="sourceLine" id="cb1012-126" data-line-number="126"><span class="co">#&gt; class_3 =    1,889 / 7,143</span></a>
<a class="sourceLine" id="cb1012-127" data-line-number="127"><span class="co">#&gt; class_4 =        272 / 562</span></a>
<a class="sourceLine" id="cb1012-128" data-line-number="128"><span class="co">#&gt; class_5 =    1,209 / 1,870</span></a>
<a class="sourceLine" id="cb1012-129" data-line-number="129"><span class="co">#&gt; class_6 =    1,167 / 3,464</span></a>
<a class="sourceLine" id="cb1012-130" data-line-number="130"><span class="co">#&gt; class_7 =      612 / 4,099</span></a>
<a class="sourceLine" id="cb1012-131" data-line-number="131"><span class="co">#&gt; Totals  = 19,986 / 116,018</span></a>
<a class="sourceLine" id="cb1012-132" data-line-number="132"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-133" data-line-number="133"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span></a>
<a class="sourceLine" id="cb1012-134" data-line-number="134"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1012-135" data-line-number="135"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1012-136" data-line-number="136"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1012-137" data-line-number="137"><span class="co">#&gt; 1 1  0.827734</span></a>
<a class="sourceLine" id="cb1012-138" data-line-number="138"><span class="co">#&gt; 2 2  0.983968</span></a>
<a class="sourceLine" id="cb1012-139" data-line-number="139"><span class="co">#&gt; 3 3  0.997974</span></a>
<a class="sourceLine" id="cb1012-140" data-line-number="140"><span class="co">#&gt; 4 4  0.999629</span></a>
<a class="sourceLine" id="cb1012-141" data-line-number="141"><span class="co">#&gt; 5 5  0.999991</span></a>
<a class="sourceLine" id="cb1012-142" data-line-number="142"><span class="co">#&gt; 6 6  0.999991</span></a>
<a class="sourceLine" id="cb1012-143" data-line-number="143"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1012-144" data-line-number="144"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-145" data-line-number="145"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-146" data-line-number="146"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-147" data-line-number="147"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-148" data-line-number="148"><span class="co">#&gt; Scoring History: </span></a>
<a class="sourceLine" id="cb1012-149" data-line-number="149"><span class="co">#&gt;             timestamp   duration training_speed  epochs iterations</span></a>
<a class="sourceLine" id="cb1012-150" data-line-number="150"><span class="co">#&gt; 1 2020-11-18 08:15:44  0.000 sec             NA 0.00000          0</span></a>
<a class="sourceLine" id="cb1012-151" data-line-number="151"><span class="co">#&gt; 2 2020-11-18 08:15:49  6.346 sec   8002 obs/sec 0.09971          1</span></a>
<a class="sourceLine" id="cb1012-152" data-line-number="152"><span class="co">#&gt; 3 2020-11-18 08:16:07 24.904 sec  11439 obs/sec 0.69844          7</span></a>
<a class="sourceLine" id="cb1012-153" data-line-number="153"><span class="co">#&gt; 4 2020-11-18 08:16:19 36.381 sec  12310 obs/sec 1.09929         11</span></a>
<a class="sourceLine" id="cb1012-154" data-line-number="154"><span class="co">#&gt;         samples training_rmse training_logloss training_r2</span></a>
<a class="sourceLine" id="cb1012-155" data-line-number="155"><span class="co">#&gt; 1      0.000000            NA               NA          NA</span></a>
<a class="sourceLine" id="cb1012-156" data-line-number="156"><span class="co">#&gt; 2  34802.000000       0.45905          0.65713     0.89397</span></a>
<a class="sourceLine" id="cb1012-157" data-line-number="157"><span class="co">#&gt; 3 243767.000000       0.38236          0.46498     0.92644</span></a>
<a class="sourceLine" id="cb1012-158" data-line-number="158"><span class="co">#&gt; 4 383667.000000       0.35860          0.41691     0.93530</span></a>
<a class="sourceLine" id="cb1012-159" data-line-number="159"><span class="co">#&gt;   training_classification_error validation_rmse validation_logloss</span></a>
<a class="sourceLine" id="cb1012-160" data-line-number="160"><span class="co">#&gt; 1                            NA              NA                 NA</span></a>
<a class="sourceLine" id="cb1012-161" data-line-number="161"><span class="co">#&gt; 2                       0.28351         0.45735            0.65116</span></a>
<a class="sourceLine" id="cb1012-162" data-line-number="162"><span class="co">#&gt; 3                       0.19415         0.38132            0.46152</span></a>
<a class="sourceLine" id="cb1012-163" data-line-number="163"><span class="co">#&gt; 4                       0.17250         0.35817            0.41600</span></a>
<a class="sourceLine" id="cb1012-164" data-line-number="164"><span class="co">#&gt;   validation_r2 validation_classification_error</span></a>
<a class="sourceLine" id="cb1012-165" data-line-number="165"><span class="co">#&gt; 1            NA                              NA</span></a>
<a class="sourceLine" id="cb1012-166" data-line-number="166"><span class="co">#&gt; 2       0.89278                         0.28131</span></a>
<a class="sourceLine" id="cb1012-167" data-line-number="167"><span class="co">#&gt; 3       0.92547                         0.19603</span></a>
<a class="sourceLine" id="cb1012-168" data-line-number="168"><span class="co">#&gt; 4       0.93424                         0.17227</span></a>
<a class="sourceLine" id="cb1012-169" data-line-number="169"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-170" data-line-number="170"><span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span></a>
<a class="sourceLine" id="cb1012-171" data-line-number="171"><span class="co">#&gt; =================================================</span></a>
<a class="sourceLine" id="cb1012-172" data-line-number="172"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-173" data-line-number="173"><span class="co">#&gt; Variable Importances: </span></a>
<a class="sourceLine" id="cb1012-174" data-line-number="174"><span class="co">#&gt;                             variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1012-175" data-line-number="175"><span class="co">#&gt; 1                          Elevation            1.000000          1.000000</span></a>
<a class="sourceLine" id="cb1012-176" data-line-number="176"><span class="co">#&gt; 2    Horizontal_Distance_To_Roadways            0.963031          0.963031</span></a>
<a class="sourceLine" id="cb1012-177" data-line-number="177"><span class="co">#&gt; 3             Wilderness_Area.area_0            0.955646          0.955646</span></a>
<a class="sourceLine" id="cb1012-178" data-line-number="178"><span class="co">#&gt; 4 Horizontal_Distance_To_Fire_Points            0.884995          0.884995</span></a>
<a class="sourceLine" id="cb1012-179" data-line-number="179"><span class="co">#&gt; 5             Wilderness_Area.area_1            0.800832          0.800832</span></a>
<a class="sourceLine" id="cb1012-180" data-line-number="180"><span class="co">#&gt;   percentage</span></a>
<a class="sourceLine" id="cb1012-181" data-line-number="181"><span class="co">#&gt; 1   0.031918</span></a>
<a class="sourceLine" id="cb1012-182" data-line-number="182"><span class="co">#&gt; 2   0.030738</span></a>
<a class="sourceLine" id="cb1012-183" data-line-number="183"><span class="co">#&gt; 3   0.030502</span></a>
<a class="sourceLine" id="cb1012-184" data-line-number="184"><span class="co">#&gt; 4   0.028247</span></a>
<a class="sourceLine" id="cb1012-185" data-line-number="185"><span class="co">#&gt; 5   0.025561</span></a>
<a class="sourceLine" id="cb1012-186" data-line-number="186"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1012-187" data-line-number="187"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1012-188" data-line-number="188"><span class="co">#&gt;                       variable relative_importance scaled_importance percentage</span></a>
<a class="sourceLine" id="cb1012-189" data-line-number="189"><span class="co">#&gt; 51           Soil_Type.type_35            0.436635          0.436635   0.013936</span></a>
<a class="sourceLine" id="cb1012-190" data-line-number="190"><span class="co">#&gt; 52            Soil_Type.type_7            0.425206          0.425206   0.013572</span></a>
<a class="sourceLine" id="cb1012-191" data-line-number="191"><span class="co">#&gt; 53               Hillshade_3pm            0.423174          0.423174   0.013507</span></a>
<a class="sourceLine" id="cb1012-192" data-line-number="192"><span class="co">#&gt; 54                      Aspect            0.271013          0.271013   0.008650</span></a>
<a class="sourceLine" id="cb1012-193" data-line-number="193"><span class="co">#&gt; 55       Soil_Type.missing(NA)            0.000000          0.000000   0.000000</span></a>
<a class="sourceLine" id="cb1012-194" data-line-number="194"><span class="co">#&gt; 56 Wilderness_Area.missing(NA)            0.000000          0.000000   0.000000</span></a></code></pre></div>
<p>Inspect the model in Flow for more information about model building etc. by issuing a cell with the content getModel “dl_model_first”, and pressing Ctrl-Enter.</p>
</div>
<div id="variable-importances" class="section level3">
<h3>
<span class="header-section-number">44.5.2</span> Variable Importances<a class="anchor" aria-label="anchor" href="#variable-importances"><i class="fas fa-link"></i></a>
</h3>
<p>Variable importances for Neural Network models are notoriously difficult to compute, and there are many pitfalls. H2O Deep Learning has implemented the method of Gedeon, and returns relative variable importances in descending order of importance.</p>
<div class="sourceCode" id="cb1013"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.varimp.html">h2o.varimp</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                             variable relative_importance scaled_importance</span>
<span class="co">#&gt; 1                          Elevation               1.000             1.000</span>
<span class="co">#&gt; 2    Horizontal_Distance_To_Roadways               0.963             0.963</span>
<span class="co">#&gt; 3             Wilderness_Area.area_0               0.956             0.956</span>
<span class="co">#&gt; 4 Horizontal_Distance_To_Fire_Points               0.885             0.885</span>
<span class="co">#&gt; 5             Wilderness_Area.area_1               0.801             0.801</span>
<span class="co">#&gt; 6             Wilderness_Area.area_2               0.753             0.753</span>
<span class="co">#&gt;   percentage</span>
<span class="co">#&gt; 1     0.0319</span>
<span class="co">#&gt; 2     0.0307</span>
<span class="co">#&gt; 3     0.0305</span>
<span class="co">#&gt; 4     0.0282</span>
<span class="co">#&gt; 5     0.0256</span>
<span class="co">#&gt; 6     0.0240</span></code></pre></div>
</div>
<div id="early-stopping" class="section level3">
<h3>
<span class="header-section-number">44.5.3</span> Early Stopping<a class="anchor" aria-label="anchor" href="#early-stopping"><i class="fas fa-link"></i></a>
</h3>
<p>Now we run another, smaller network, and we let it stop automatically once the misclassification rate converges (specifically, if the moving average of length 2 does not improve by at least 1% for 2 consecutive scoring events). We also sample the validation set to 10,000 rows for faster scoring.</p>
<div class="sourceCode" id="cb1014"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1014-1" data-line-number="1">m2 &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(</a>
<a class="sourceLine" id="cb1014-2" data-line-number="2">  <span class="dt">model_id=</span><span class="st">"dl_model_faster"</span>, </a>
<a class="sourceLine" id="cb1014-3" data-line-number="3">  <span class="dt">training_frame=</span>train, </a>
<a class="sourceLine" id="cb1014-4" data-line-number="4">  <span class="dt">validation_frame=</span>valid,</a>
<a class="sourceLine" id="cb1014-5" data-line-number="5">  <span class="dt">x=</span>predictors,</a>
<a class="sourceLine" id="cb1014-6" data-line-number="6">  <span class="dt">y=</span>response,</a>
<a class="sourceLine" id="cb1014-7" data-line-number="7">  <span class="dt">hidden=</span><span class="kw">c</span>(<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">32</span>),                  <span class="co">## small network, runs faster</span></a>
<a class="sourceLine" id="cb1014-8" data-line-number="8">  <span class="dt">epochs=</span><span class="dv">1000000</span>,                      <span class="co">## hopefully converges earlier...</span></a>
<a class="sourceLine" id="cb1014-9" data-line-number="9">  <span class="dt">score_validation_samples=</span><span class="dv">10000</span>,      <span class="co">## sample the validation dataset (faster)</span></a>
<a class="sourceLine" id="cb1014-10" data-line-number="10">  <span class="dt">stopping_rounds=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1014-11" data-line-number="11">  <span class="dt">stopping_metric=</span><span class="st">"misclassification"</span>, <span class="co">## could be "MSE","logloss","r2"</span></a>
<a class="sourceLine" id="cb1014-12" data-line-number="12">  <span class="dt">stopping_tolerance=</span><span class="fl">0.01</span></a>
<a class="sourceLine" id="cb1014-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb1014-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-15" data-line-number="15">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1014-16" data-line-number="16"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1014-17" data-line-number="17">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1014-18" data-line-number="18"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1014-19" data-line-number="19"><span class="kw">summary</span>(m2)</a>
<a class="sourceLine" id="cb1014-20" data-line-number="20"><span class="co">#&gt; Model Details:</span></a>
<a class="sourceLine" id="cb1014-21" data-line-number="21"><span class="co">#&gt; ==============</span></a>
<a class="sourceLine" id="cb1014-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-23" data-line-number="23"><span class="co">#&gt; H2OMultinomialModel: deeplearning</span></a>
<a class="sourceLine" id="cb1014-24" data-line-number="24"><span class="co">#&gt; Model Key:  dl_model_faster </span></a>
<a class="sourceLine" id="cb1014-25" data-line-number="25"><span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 4,167 weights/biases, 57.9 KB, 9,900,157 training samples, mini-batch size 1</span></a>
<a class="sourceLine" id="cb1014-26" data-line-number="26"><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></a>
<a class="sourceLine" id="cb1014-27" data-line-number="27"><span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span></a>
<a class="sourceLine" id="cb1014-28" data-line-number="28"><span class="co">#&gt; 2     2    32 Rectifier  0.00 % 0.000000 0.000000  0.046379 0.206360 0.000000</span></a>
<a class="sourceLine" id="cb1014-29" data-line-number="29"><span class="co">#&gt; 3     3    32 Rectifier  0.00 % 0.000000 0.000000  0.000265 0.000157 0.000000</span></a>
<a class="sourceLine" id="cb1014-30" data-line-number="30"><span class="co">#&gt; 4     4    32 Rectifier  0.00 % 0.000000 0.000000  0.000575 0.000411 0.000000</span></a>
<a class="sourceLine" id="cb1014-31" data-line-number="31"><span class="co">#&gt; 5     5     7   Softmax      NA 0.000000 0.000000  0.108598 0.282699 0.000000</span></a>
<a class="sourceLine" id="cb1014-32" data-line-number="32"><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></a>
<a class="sourceLine" id="cb1014-33" data-line-number="33"><span class="co">#&gt; 1          NA         NA        NA       NA</span></a>
<a class="sourceLine" id="cb1014-34" data-line-number="34"><span class="co">#&gt; 2   -0.005529   0.313544  0.267110 0.364800</span></a>
<a class="sourceLine" id="cb1014-35" data-line-number="35"><span class="co">#&gt; 3   -0.037901   0.406833  0.318878 0.837257</span></a>
<a class="sourceLine" id="cb1014-36" data-line-number="36"><span class="co">#&gt; 4    0.078492   0.781886  0.595162 1.581360</span></a>
<a class="sourceLine" id="cb1014-37" data-line-number="37"><span class="co">#&gt; 5   -5.660137   4.545395 -3.644021 0.993629</span></a>
<a class="sourceLine" id="cb1014-38" data-line-number="38"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-39" data-line-number="39"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1014-40" data-line-number="40"><span class="co">#&gt; ** Reported on training data. **</span></a>
<a class="sourceLine" id="cb1014-41" data-line-number="41"><span class="co">#&gt; ** Metrics reported on temporary training frame with 9935 samples **</span></a>
<a class="sourceLine" id="cb1014-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-43" data-line-number="43"><span class="co">#&gt; Training Set Metrics: </span></a>
<a class="sourceLine" id="cb1014-44" data-line-number="44"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1014-45" data-line-number="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-46" data-line-number="46"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.11</span></a>
<a class="sourceLine" id="cb1014-47" data-line-number="47"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.331</span></a>
<a class="sourceLine" id="cb1014-48" data-line-number="48"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.367</span></a>
<a class="sourceLine" id="cb1014-49" data-line-number="49"><span class="co">#&gt; Mean Per-Class Error: 0.215</span></a>
<a class="sourceLine" id="cb1014-50" data-line-number="50"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span></a>
<a class="sourceLine" id="cb1014-51" data-line-number="51"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1014-52" data-line-number="52"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1014-53" data-line-number="53"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1014-54" data-line-number="54"><span class="co">#&gt; class_1    2948     599       2       0      11       1      35 0.1802</span></a>
<a class="sourceLine" id="cb1014-55" data-line-number="55"><span class="co">#&gt; class_2     385    4381      29       0      53      19       1 0.1000</span></a>
<a class="sourceLine" id="cb1014-56" data-line-number="56"><span class="co">#&gt; class_3       0      34     504      29       3      49       0 0.1858</span></a>
<a class="sourceLine" id="cb1014-57" data-line-number="57"><span class="co">#&gt; class_4       0       0       6      37       0       2       0 0.1778</span></a>
<a class="sourceLine" id="cb1014-58" data-line-number="58"><span class="co">#&gt; class_5       2      50       5       0      93       1       0 0.3841</span></a>
<a class="sourceLine" id="cb1014-59" data-line-number="59"><span class="co">#&gt; class_6       1      30      59       8       0     192       0 0.3379</span></a>
<a class="sourceLine" id="cb1014-60" data-line-number="60"><span class="co">#&gt; class_7      44       7       1       0       0       0     314 0.1421</span></a>
<a class="sourceLine" id="cb1014-61" data-line-number="61"><span class="co">#&gt; Totals     3380    5101     606      74     160     264     350 0.1476</span></a>
<a class="sourceLine" id="cb1014-62" data-line-number="62"><span class="co">#&gt;                    Rate</span></a>
<a class="sourceLine" id="cb1014-63" data-line-number="63"><span class="co">#&gt; class_1 =   648 / 3,596</span></a>
<a class="sourceLine" id="cb1014-64" data-line-number="64"><span class="co">#&gt; class_2 =   487 / 4,868</span></a>
<a class="sourceLine" id="cb1014-65" data-line-number="65"><span class="co">#&gt; class_3 =     115 / 619</span></a>
<a class="sourceLine" id="cb1014-66" data-line-number="66"><span class="co">#&gt; class_4 =        8 / 45</span></a>
<a class="sourceLine" id="cb1014-67" data-line-number="67"><span class="co">#&gt; class_5 =      58 / 151</span></a>
<a class="sourceLine" id="cb1014-68" data-line-number="68"><span class="co">#&gt; class_6 =      98 / 290</span></a>
<a class="sourceLine" id="cb1014-69" data-line-number="69"><span class="co">#&gt; class_7 =      52 / 366</span></a>
<a class="sourceLine" id="cb1014-70" data-line-number="70"><span class="co">#&gt; Totals  = 1,466 / 9,935</span></a>
<a class="sourceLine" id="cb1014-71" data-line-number="71"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-72" data-line-number="72"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span></a>
<a class="sourceLine" id="cb1014-73" data-line-number="73"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1014-74" data-line-number="74"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1014-75" data-line-number="75"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1014-76" data-line-number="76"><span class="co">#&gt; 1 1  0.852441</span></a>
<a class="sourceLine" id="cb1014-77" data-line-number="77"><span class="co">#&gt; 2 2  0.986412</span></a>
<a class="sourceLine" id="cb1014-78" data-line-number="78"><span class="co">#&gt; 3 3  0.997786</span></a>
<a class="sourceLine" id="cb1014-79" data-line-number="79"><span class="co">#&gt; 4 4  0.999497</span></a>
<a class="sourceLine" id="cb1014-80" data-line-number="80"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1014-81" data-line-number="81"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1014-82" data-line-number="82"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1014-83" data-line-number="83"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-84" data-line-number="84"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-85" data-line-number="85"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1014-86" data-line-number="86"><span class="co">#&gt; ** Reported on validation data. **</span></a>
<a class="sourceLine" id="cb1014-87" data-line-number="87"><span class="co">#&gt; ** Metrics reported on temporary validation frame with 9962 samples **</span></a>
<a class="sourceLine" id="cb1014-88" data-line-number="88"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-89" data-line-number="89"><span class="co">#&gt; Validation Set Metrics: </span></a>
<a class="sourceLine" id="cb1014-90" data-line-number="90"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1014-91" data-line-number="91"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-92" data-line-number="92"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.111</span></a>
<a class="sourceLine" id="cb1014-93" data-line-number="93"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.333</span></a>
<a class="sourceLine" id="cb1014-94" data-line-number="94"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.375</span></a>
<a class="sourceLine" id="cb1014-95" data-line-number="95"><span class="co">#&gt; Mean Per-Class Error: 0.224</span></a>
<a class="sourceLine" id="cb1014-96" data-line-number="96"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span></a>
<a class="sourceLine" id="cb1014-97" data-line-number="97"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1014-98" data-line-number="98"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1014-99" data-line-number="99"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1014-100" data-line-number="100"><span class="co">#&gt; class_1    3027     576       1       0      13       2      48 0.1745</span></a>
<a class="sourceLine" id="cb1014-101" data-line-number="101"><span class="co">#&gt; class_2     363    4364      28       1      63      20       4 0.0989</span></a>
<a class="sourceLine" id="cb1014-102" data-line-number="102"><span class="co">#&gt; class_3       0      35     503      23       0      37       0 0.1589</span></a>
<a class="sourceLine" id="cb1014-103" data-line-number="103"><span class="co">#&gt; class_4       0       0       8      39       0       4       0 0.2353</span></a>
<a class="sourceLine" id="cb1014-104" data-line-number="104"><span class="co">#&gt; class_5       3      60       5       0      99       0       0 0.4072</span></a>
<a class="sourceLine" id="cb1014-105" data-line-number="105"><span class="co">#&gt; class_6       1      23      62      12       2     192       0 0.3425</span></a>
<a class="sourceLine" id="cb1014-106" data-line-number="106"><span class="co">#&gt; class_7      47       6       0       0       0       0     291 0.1541</span></a>
<a class="sourceLine" id="cb1014-107" data-line-number="107"><span class="co">#&gt; Totals     3441    5064     607      75     177     255     343 0.1453</span></a>
<a class="sourceLine" id="cb1014-108" data-line-number="108"><span class="co">#&gt;                    Rate</span></a>
<a class="sourceLine" id="cb1014-109" data-line-number="109"><span class="co">#&gt; class_1 =   640 / 3,667</span></a>
<a class="sourceLine" id="cb1014-110" data-line-number="110"><span class="co">#&gt; class_2 =   479 / 4,843</span></a>
<a class="sourceLine" id="cb1014-111" data-line-number="111"><span class="co">#&gt; class_3 =      95 / 598</span></a>
<a class="sourceLine" id="cb1014-112" data-line-number="112"><span class="co">#&gt; class_4 =       12 / 51</span></a>
<a class="sourceLine" id="cb1014-113" data-line-number="113"><span class="co">#&gt; class_5 =      68 / 167</span></a>
<a class="sourceLine" id="cb1014-114" data-line-number="114"><span class="co">#&gt; class_6 =     100 / 292</span></a>
<a class="sourceLine" id="cb1014-115" data-line-number="115"><span class="co">#&gt; class_7 =      53 / 344</span></a>
<a class="sourceLine" id="cb1014-116" data-line-number="116"><span class="co">#&gt; Totals  = 1,447 / 9,962</span></a>
<a class="sourceLine" id="cb1014-117" data-line-number="117"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-118" data-line-number="118"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span></a>
<a class="sourceLine" id="cb1014-119" data-line-number="119"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1014-120" data-line-number="120"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1014-121" data-line-number="121"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1014-122" data-line-number="122"><span class="co">#&gt; 1 1  0.854748</span></a>
<a class="sourceLine" id="cb1014-123" data-line-number="123"><span class="co">#&gt; 2 2  0.985445</span></a>
<a class="sourceLine" id="cb1014-124" data-line-number="124"><span class="co">#&gt; 3 3  0.997992</span></a>
<a class="sourceLine" id="cb1014-125" data-line-number="125"><span class="co">#&gt; 4 4  0.999699</span></a>
<a class="sourceLine" id="cb1014-126" data-line-number="126"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1014-127" data-line-number="127"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1014-128" data-line-number="128"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1014-129" data-line-number="129"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-130" data-line-number="130"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-131" data-line-number="131"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-132" data-line-number="132"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-133" data-line-number="133"><span class="co">#&gt; Scoring History: </span></a>
<a class="sourceLine" id="cb1014-134" data-line-number="134"><span class="co">#&gt;              timestamp          duration training_speed   epochs iterations</span></a>
<a class="sourceLine" id="cb1014-135" data-line-number="135"><span class="co">#&gt; 1  2020-11-18 08:16:21         0.000 sec             NA  0.00000          0</span></a>
<a class="sourceLine" id="cb1014-136" data-line-number="136"><span class="co">#&gt; 2  2020-11-18 08:16:22         1.119 sec  94071 obs/sec  0.28625          1</span></a>
<a class="sourceLine" id="cb1014-137" data-line-number="137"><span class="co">#&gt; 3  2020-11-18 08:16:27         6.437 sec 110312 obs/sec  2.00640          7</span></a>
<a class="sourceLine" id="cb1014-138" data-line-number="138"><span class="co">#&gt; 4  2020-11-18 08:16:33        12.252 sec 115386 obs/sec  4.01159         14</span></a>
<a class="sourceLine" id="cb1014-139" data-line-number="139"><span class="co">#&gt; 5  2020-11-18 08:16:39        17.791 sec 119030 obs/sec  6.01742         21</span></a>
<a class="sourceLine" id="cb1014-140" data-line-number="140"><span class="co">#&gt; 6  2020-11-18 08:16:44        23.099 sec 122154 obs/sec  8.02371         28</span></a>
<a class="sourceLine" id="cb1014-141" data-line-number="141"><span class="co">#&gt; 7  2020-11-18 08:16:49        28.471 sec 123889 obs/sec 10.03075         35</span></a>
<a class="sourceLine" id="cb1014-142" data-line-number="142"><span class="co">#&gt; 8  2020-11-18 08:16:55        33.787 sec 125251 obs/sec 12.03729         42</span></a>
<a class="sourceLine" id="cb1014-143" data-line-number="143"><span class="co">#&gt; 9  2020-11-18 08:17:00        39.137 sec 126109 obs/sec 14.04232         49</span></a>
<a class="sourceLine" id="cb1014-144" data-line-number="144"><span class="co">#&gt; 10 2020-11-18 08:17:05        44.334 sec 127190 obs/sec 16.04644         56</span></a>
<a class="sourceLine" id="cb1014-145" data-line-number="145"><span class="co">#&gt; 11 2020-11-18 08:17:10        49.450 sec 128263 obs/sec 18.05136         63</span></a>
<a class="sourceLine" id="cb1014-146" data-line-number="146"><span class="co">#&gt; 12 2020-11-18 08:17:16        54.684 sec 128858 obs/sec 20.05755         70</span></a>
<a class="sourceLine" id="cb1014-147" data-line-number="147"><span class="co">#&gt; 13 2020-11-18 08:17:21        59.775 sec 129673 obs/sec 22.06397         77</span></a>
<a class="sourceLine" id="cb1014-148" data-line-number="148"><span class="co">#&gt; 14 2020-11-18 08:17:26  1 min  4.845 sec 130396 obs/sec 24.07068         84</span></a>
<a class="sourceLine" id="cb1014-149" data-line-number="149"><span class="co">#&gt; 15 2020-11-18 08:17:31  1 min  9.858 sec 131104 obs/sec 26.07411         91</span></a>
<a class="sourceLine" id="cb1014-150" data-line-number="150"><span class="co">#&gt; 16 2020-11-18 08:17:37  1 min 15.479 sec 131993 obs/sec 28.36599         99</span></a>
<a class="sourceLine" id="cb1014-151" data-line-number="151"><span class="co">#&gt; 17 2020-11-18 08:17:37  1 min 15.514 sec 131988 obs/sec 28.36599         99</span></a>
<a class="sourceLine" id="cb1014-152" data-line-number="152"><span class="co">#&gt;           samples training_rmse training_logloss training_r2</span></a>
<a class="sourceLine" id="cb1014-153" data-line-number="153"><span class="co">#&gt; 1        0.000000            NA               NA          NA</span></a>
<a class="sourceLine" id="cb1014-154" data-line-number="154"><span class="co">#&gt; 2    99904.000000       0.44978          0.62527     0.89700</span></a>
<a class="sourceLine" id="cb1014-155" data-line-number="155"><span class="co">#&gt; 3   700262.000000       0.37905          0.45912     0.92685</span></a>
<a class="sourceLine" id="cb1014-156" data-line-number="156"><span class="co">#&gt; 4  1400104.000000       0.36727          0.44379     0.93132</span></a>
<a class="sourceLine" id="cb1014-157" data-line-number="157"><span class="co">#&gt; 5  2100169.000000       0.35566          0.41433     0.93560</span></a>
<a class="sourceLine" id="cb1014-158" data-line-number="158"><span class="co">#&gt; 6  2800394.000000       0.34499          0.39009     0.93940</span></a>
<a class="sourceLine" id="cb1014-159" data-line-number="159"><span class="co">#&gt; 7  3500882.000000       0.34840          0.39748     0.93820</span></a>
<a class="sourceLine" id="cb1014-160" data-line-number="160"><span class="co">#&gt; 8  4201194.000000       0.34460          0.40209     0.93954</span></a>
<a class="sourceLine" id="cb1014-161" data-line-number="161"><span class="co">#&gt; 9  4900982.000000       0.34293          0.40024     0.94012</span></a>
<a class="sourceLine" id="cb1014-162" data-line-number="162"><span class="co">#&gt; 10 5600447.000000       0.33615          0.37460     0.94247</span></a>
<a class="sourceLine" id="cb1014-163" data-line-number="163"><span class="co">#&gt; 11 6300195.000000       0.33129          0.36696     0.94412</span></a>
<a class="sourceLine" id="cb1014-164" data-line-number="164"><span class="co">#&gt; 12 7000386.000000       0.33501          0.37068     0.94286</span></a>
<a class="sourceLine" id="cb1014-165" data-line-number="165"><span class="co">#&gt; 13 7700656.000000       0.32852          0.35812     0.94505</span></a>
<a class="sourceLine" id="cb1014-166" data-line-number="166"><span class="co">#&gt; 14 8401027.000000       0.33126          0.36738     0.94413</span></a>
<a class="sourceLine" id="cb1014-167" data-line-number="167"><span class="co">#&gt; 15 9100255.000000       0.33709          0.37532     0.94214</span></a>
<a class="sourceLine" id="cb1014-168" data-line-number="168"><span class="co">#&gt; 16 9900157.000000       0.33593          0.38076     0.94254</span></a>
<a class="sourceLine" id="cb1014-169" data-line-number="169"><span class="co">#&gt; 17 9900157.000000       0.33126          0.36738     0.94413</span></a>
<a class="sourceLine" id="cb1014-170" data-line-number="170"><span class="co">#&gt;    training_classification_error validation_rmse validation_logloss</span></a>
<a class="sourceLine" id="cb1014-171" data-line-number="171"><span class="co">#&gt; 1                             NA              NA                 NA</span></a>
<a class="sourceLine" id="cb1014-172" data-line-number="172"><span class="co">#&gt; 2                        0.26935         0.45675            0.64082</span></a>
<a class="sourceLine" id="cb1014-173" data-line-number="173"><span class="co">#&gt; 3                        0.19436         0.38390            0.46604</span></a>
<a class="sourceLine" id="cb1014-174" data-line-number="174"><span class="co">#&gt; 4                        0.18027         0.36813            0.44247</span></a>
<a class="sourceLine" id="cb1014-175" data-line-number="175"><span class="co">#&gt; 5                        0.17151         0.36063            0.42595</span></a>
<a class="sourceLine" id="cb1014-176" data-line-number="176"><span class="co">#&gt; 6                        0.15712         0.35284            0.40814</span></a>
<a class="sourceLine" id="cb1014-177" data-line-number="177"><span class="co">#&gt; 7                        0.16568         0.35212            0.41286</span></a>
<a class="sourceLine" id="cb1014-178" data-line-number="178"><span class="co">#&gt; 8                        0.15863         0.34863            0.41373</span></a>
<a class="sourceLine" id="cb1014-179" data-line-number="179"><span class="co">#&gt; 9                        0.15752         0.34658            0.41026</span></a>
<a class="sourceLine" id="cb1014-180" data-line-number="180"><span class="co">#&gt; 10                       0.14937         0.34062            0.38878</span></a>
<a class="sourceLine" id="cb1014-181" data-line-number="181"><span class="co">#&gt; 11                       0.14776         0.33781            0.38504</span></a>
<a class="sourceLine" id="cb1014-182" data-line-number="182"><span class="co">#&gt; 12                       0.14786         0.33720            0.37883</span></a>
<a class="sourceLine" id="cb1014-183" data-line-number="183"><span class="co">#&gt; 13                       0.14394         0.33321            0.37369</span></a>
<a class="sourceLine" id="cb1014-184" data-line-number="184"><span class="co">#&gt; 14                       0.14756         0.33297            0.37462</span></a>
<a class="sourceLine" id="cb1014-185" data-line-number="185"><span class="co">#&gt; 15                       0.15179         0.34302            0.39330</span></a>
<a class="sourceLine" id="cb1014-186" data-line-number="186"><span class="co">#&gt; 16                       0.15400         0.33804            0.38629</span></a>
<a class="sourceLine" id="cb1014-187" data-line-number="187"><span class="co">#&gt; 17                       0.14756         0.33297            0.37462</span></a>
<a class="sourceLine" id="cb1014-188" data-line-number="188"><span class="co">#&gt;    validation_r2 validation_classification_error</span></a>
<a class="sourceLine" id="cb1014-189" data-line-number="189"><span class="co">#&gt; 1             NA                              NA</span></a>
<a class="sourceLine" id="cb1014-190" data-line-number="190"><span class="co">#&gt; 2        0.89191                         0.27956</span></a>
<a class="sourceLine" id="cb1014-191" data-line-number="191"><span class="co">#&gt; 3        0.92364                         0.20187</span></a>
<a class="sourceLine" id="cb1014-192" data-line-number="192"><span class="co">#&gt; 4        0.92978                         0.18500</span></a>
<a class="sourceLine" id="cb1014-193" data-line-number="193"><span class="co">#&gt; 5        0.93261                         0.17366</span></a>
<a class="sourceLine" id="cb1014-194" data-line-number="194"><span class="co">#&gt; 6        0.93549                         0.16623</span></a>
<a class="sourceLine" id="cb1014-195" data-line-number="195"><span class="co">#&gt; 7        0.93576                         0.16643</span></a>
<a class="sourceLine" id="cb1014-196" data-line-number="196"><span class="co">#&gt; 8        0.93702                         0.16292</span></a>
<a class="sourceLine" id="cb1014-197" data-line-number="197"><span class="co">#&gt; 9        0.93776                         0.16171</span></a>
<a class="sourceLine" id="cb1014-198" data-line-number="198"><span class="co">#&gt; 10       0.93988                         0.15660</span></a>
<a class="sourceLine" id="cb1014-199" data-line-number="199"><span class="co">#&gt; 11       0.94087                         0.15148</span></a>
<a class="sourceLine" id="cb1014-200" data-line-number="200"><span class="co">#&gt; 12       0.94108                         0.15117</span></a>
<a class="sourceLine" id="cb1014-201" data-line-number="201"><span class="co">#&gt; 13       0.94247                         0.14786</span></a>
<a class="sourceLine" id="cb1014-202" data-line-number="202"><span class="co">#&gt; 14       0.94255                         0.14525</span></a>
<a class="sourceLine" id="cb1014-203" data-line-number="203"><span class="co">#&gt; 15       0.93903                         0.15860</span></a>
<a class="sourceLine" id="cb1014-204" data-line-number="204"><span class="co">#&gt; 16       0.94079                         0.15609</span></a>
<a class="sourceLine" id="cb1014-205" data-line-number="205"><span class="co">#&gt; 17       0.94255                         0.14525</span></a>
<a class="sourceLine" id="cb1014-206" data-line-number="206"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-207" data-line-number="207"><span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span></a>
<a class="sourceLine" id="cb1014-208" data-line-number="208"><span class="co">#&gt; =================================================</span></a>
<a class="sourceLine" id="cb1014-209" data-line-number="209"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-210" data-line-number="210"><span class="co">#&gt; Variable Importances: </span></a>
<a class="sourceLine" id="cb1014-211" data-line-number="211"><span class="co">#&gt;                             variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1014-212" data-line-number="212"><span class="co">#&gt; 1             Wilderness_Area.area_3            1.000000          1.000000</span></a>
<a class="sourceLine" id="cb1014-213" data-line-number="213"><span class="co">#&gt; 2                          Elevation            0.841213          0.841213</span></a>
<a class="sourceLine" id="cb1014-214" data-line-number="214"><span class="co">#&gt; 3    Horizontal_Distance_To_Roadways            0.821551          0.821551</span></a>
<a class="sourceLine" id="cb1014-215" data-line-number="215"><span class="co">#&gt; 4             Wilderness_Area.area_0            0.768772          0.768772</span></a>
<a class="sourceLine" id="cb1014-216" data-line-number="216"><span class="co">#&gt; 5 Horizontal_Distance_To_Fire_Points            0.766086          0.766086</span></a>
<a class="sourceLine" id="cb1014-217" data-line-number="217"><span class="co">#&gt;   percentage</span></a>
<a class="sourceLine" id="cb1014-218" data-line-number="218"><span class="co">#&gt; 1   0.037476</span></a>
<a class="sourceLine" id="cb1014-219" data-line-number="219"><span class="co">#&gt; 2   0.031526</span></a>
<a class="sourceLine" id="cb1014-220" data-line-number="220"><span class="co">#&gt; 3   0.030789</span></a>
<a class="sourceLine" id="cb1014-221" data-line-number="221"><span class="co">#&gt; 4   0.028811</span></a>
<a class="sourceLine" id="cb1014-222" data-line-number="222"><span class="co">#&gt; 5   0.028710</span></a>
<a class="sourceLine" id="cb1014-223" data-line-number="223"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1014-224" data-line-number="224"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1014-225" data-line-number="225"><span class="co">#&gt;                            variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1014-226" data-line-number="226"><span class="co">#&gt; 51 Horizontal_Distance_To_Hydrology            0.267061          0.267061</span></a>
<a class="sourceLine" id="cb1014-227" data-line-number="227"><span class="co">#&gt; 52   Vertical_Distance_To_Hydrology            0.201747          0.201747</span></a>
<a class="sourceLine" id="cb1014-228" data-line-number="228"><span class="co">#&gt; 53                            Slope            0.180563          0.180563</span></a>
<a class="sourceLine" id="cb1014-229" data-line-number="229"><span class="co">#&gt; 54                           Aspect            0.037149          0.037149</span></a>
<a class="sourceLine" id="cb1014-230" data-line-number="230"><span class="co">#&gt; 55            Soil_Type.missing(NA)            0.000000          0.000000</span></a>
<a class="sourceLine" id="cb1014-231" data-line-number="231"><span class="co">#&gt; 56      Wilderness_Area.missing(NA)            0.000000          0.000000</span></a>
<a class="sourceLine" id="cb1014-232" data-line-number="232"><span class="co">#&gt;    percentage</span></a>
<a class="sourceLine" id="cb1014-233" data-line-number="233"><span class="co">#&gt; 51   0.010008</span></a>
<a class="sourceLine" id="cb1014-234" data-line-number="234"><span class="co">#&gt; 52   0.007561</span></a>
<a class="sourceLine" id="cb1014-235" data-line-number="235"><span class="co">#&gt; 53   0.006767</span></a>
<a class="sourceLine" id="cb1014-236" data-line-number="236"><span class="co">#&gt; 54   0.001392</span></a>
<a class="sourceLine" id="cb1014-237" data-line-number="237"><span class="co">#&gt; 55   0.000000</span></a>
<a class="sourceLine" id="cb1014-238" data-line-number="238"><span class="co">#&gt; 56   0.000000</span></a>
<a class="sourceLine" id="cb1014-239" data-line-number="239"><span class="kw">plot</span>(m2)</a></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/dl_ctype_early_stopping-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="adaptive-learning-rate" class="section level3">
<h3>
<span class="header-section-number">44.5.4</span> Adaptive Learning Rate<a class="anchor" aria-label="anchor" href="#adaptive-learning-rate"><i class="fas fa-link"></i></a>
</h3>
<p>By default, H2O Deep Learning uses an adaptive learning rate (ADADELTA) for its stochastic gradient descent optimization. There are only two tuning parameters for this method: rho and epsilon, which balance the global and local search efficiencies. rho is the similarity to prior weight updates (similar to momentum), and epsilon is a parameter that prevents the optimization to get stuck in local optima. Defaults are rho=0.99 and epsilon=1e-8. For cases where convergence speed is very important, it might make sense to perform a few runs to optimize these two parameters (e.g., with rho in c(0.9,0.95,0.99,0.999) and epsilon in c(1e-10,1e-8,1e-6,1e-4)). Of course, as always with grid searches, caution has to be applied when extrapolating grid search results to a different parameter regime (e.g., for more epochs or different layer topologies or activation functions, etc.).</p>
<p>If adaptive_rate is disabled, several manual learning rate parameters become important: rate, rate_annealing, rate_decay, momentum_start, momentum_ramp, momentum_stable and <code>nesterov_accelerated_gradient</code>, the discussion of which we leave to H2O Deep Learning booklet.</p>
</div>
<div id="tuning" class="section level3">
<h3>
<span class="header-section-number">44.5.5</span> Tuning<a class="anchor" aria-label="anchor" href="#tuning"><i class="fas fa-link"></i></a>
</h3>
<p>With some tuning, it is possible to obtain less than 10% test set error rate in about one minute. Error rates of below 5% are possible with larger models. Note that deep tree methods can be more effective for this dataset than Deep Learning, as they directly partition the space into sectors, which seems to be needed here.</p>
<div class="sourceCode" id="cb1015"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1015-1" data-line-number="1">m3 &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(</a>
<a class="sourceLine" id="cb1015-2" data-line-number="2">  <span class="dt">model_id=</span><span class="st">"dl_model_tuned"</span>, </a>
<a class="sourceLine" id="cb1015-3" data-line-number="3">  <span class="dt">training_frame=</span>train, </a>
<a class="sourceLine" id="cb1015-4" data-line-number="4">  <span class="dt">validation_frame=</span>valid, </a>
<a class="sourceLine" id="cb1015-5" data-line-number="5">  <span class="dt">x=</span>predictors, </a>
<a class="sourceLine" id="cb1015-6" data-line-number="6">  <span class="dt">y=</span>response, </a>
<a class="sourceLine" id="cb1015-7" data-line-number="7">  <span class="dt">overwrite_with_best_model=</span>F,    <span class="co">## Return final model after 10 epochs, even if not the best</span></a>
<a class="sourceLine" id="cb1015-8" data-line-number="8">  <span class="dt">hidden=</span><span class="kw">c</span>(<span class="dv">128</span>,<span class="dv">128</span>,<span class="dv">128</span>),          <span class="co">## more hidden layers -&gt; more complex interactions</span></a>
<a class="sourceLine" id="cb1015-9" data-line-number="9">  <span class="dt">epochs=</span><span class="dv">10</span>,                      <span class="co">## to keep it short enough</span></a>
<a class="sourceLine" id="cb1015-10" data-line-number="10">  <span class="dt">score_validation_samples=</span><span class="dv">10000</span>, <span class="co">## downsample validation set for faster scoring</span></a>
<a class="sourceLine" id="cb1015-11" data-line-number="11">  <span class="dt">score_duty_cycle=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span></a>
<a class="sourceLine" id="cb1015-12" data-line-number="12">  <span class="dt">adaptive_rate=</span>F,                <span class="co">## manually tuned learning rate</span></a>
<a class="sourceLine" id="cb1015-13" data-line-number="13">  <span class="dt">rate=</span><span class="fl">0.01</span>, </a>
<a class="sourceLine" id="cb1015-14" data-line-number="14">  <span class="dt">rate_annealing=</span><span class="fl">2e-6</span>,            </a>
<a class="sourceLine" id="cb1015-15" data-line-number="15">  <span class="dt">momentum_start=</span><span class="fl">0.2</span>,             <span class="co">## manually tuned momentum</span></a>
<a class="sourceLine" id="cb1015-16" data-line-number="16">  <span class="dt">momentum_stable=</span><span class="fl">0.4</span>, </a>
<a class="sourceLine" id="cb1015-17" data-line-number="17">  <span class="dt">momentum_ramp=</span><span class="fl">1e7</span>, </a>
<a class="sourceLine" id="cb1015-18" data-line-number="18">  <span class="dt">l1=</span><span class="fl">1e-5</span>,                        <span class="co">## add some L1/L2 regularization</span></a>
<a class="sourceLine" id="cb1015-19" data-line-number="19">  <span class="dt">l2=</span><span class="fl">1e-5</span>,</a>
<a class="sourceLine" id="cb1015-20" data-line-number="20">  <span class="dt">max_w2=</span><span class="dv">10</span>                       <span class="co">## helps stability for Rectifier</span></a>
<a class="sourceLine" id="cb1015-21" data-line-number="21">) </a>
<a class="sourceLine" id="cb1015-22" data-line-number="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-23" data-line-number="23">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-24" data-line-number="24"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1015-25" data-line-number="25">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-26" data-line-number="26"><span class="st">  </span><span class="er">|==</span><span class="st">                                                                    </span><span class="er">|</span><span class="st">   </span><span class="dv">3</span>%</a>
<a class="sourceLine" id="cb1015-27" data-line-number="27">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-28" data-line-number="28"><span class="st">  </span><span class="er">|====</span><span class="st">                                                                  </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%</a>
<a class="sourceLine" id="cb1015-29" data-line-number="29">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-30" data-line-number="30"><span class="st">  </span><span class="er">|======</span><span class="st">                                                                </span><span class="er">|</span><span class="st">   </span><span class="dv">9</span>%</a>
<a class="sourceLine" id="cb1015-31" data-line-number="31">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-32" data-line-number="32"><span class="st">  </span><span class="er">|========</span><span class="st">                                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%</a>
<a class="sourceLine" id="cb1015-33" data-line-number="33">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-34" data-line-number="34"><span class="st">  </span><span class="er">|==========</span><span class="st">                                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">14</span>%</a>
<a class="sourceLine" id="cb1015-35" data-line-number="35">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-36" data-line-number="36"><span class="st">  </span><span class="er">|============</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">17</span>%</a>
<a class="sourceLine" id="cb1015-37" data-line-number="37">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-38" data-line-number="38"><span class="st">  </span><span class="er">|==============</span><span class="st">                                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">20</span>%</a>
<a class="sourceLine" id="cb1015-39" data-line-number="39">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-40" data-line-number="40"><span class="st">  </span><span class="er">|================</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">23</span>%</a>
<a class="sourceLine" id="cb1015-41" data-line-number="41">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-42" data-line-number="42"><span class="st">  </span><span class="er">|==================</span><span class="st">                                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">26</span>%</a>
<a class="sourceLine" id="cb1015-43" data-line-number="43">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-44" data-line-number="44"><span class="st">  </span><span class="er">|====================</span><span class="st">                                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">29</span>%</a>
<a class="sourceLine" id="cb1015-45" data-line-number="45">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-46" data-line-number="46"><span class="st">  </span><span class="er">|======================</span><span class="st">                                                </span><span class="er">|</span><span class="st">  </span><span class="dv">32</span>%</a>
<a class="sourceLine" id="cb1015-47" data-line-number="47">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-48" data-line-number="48"><span class="st">  </span><span class="er">|========================</span><span class="st">                                              </span><span class="er">|</span><span class="st">  </span><span class="dv">34</span>%</a>
<a class="sourceLine" id="cb1015-49" data-line-number="49">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-50" data-line-number="50"><span class="st">  </span><span class="er">|==========================</span><span class="st">                                            </span><span class="er">|</span><span class="st">  </span><span class="dv">37</span>%</a>
<a class="sourceLine" id="cb1015-51" data-line-number="51">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-52" data-line-number="52"><span class="st">  </span><span class="er">|============================</span><span class="st">                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">40</span>%</a>
<a class="sourceLine" id="cb1015-53" data-line-number="53">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-54" data-line-number="54"><span class="st">  </span><span class="er">|==============================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">43</span>%</a>
<a class="sourceLine" id="cb1015-55" data-line-number="55">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-56" data-line-number="56"><span class="st">  </span><span class="er">|================================</span><span class="st">                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">46</span>%</a>
<a class="sourceLine" id="cb1015-57" data-line-number="57">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-58" data-line-number="58"><span class="st">  </span><span class="er">|==================================</span><span class="st">                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">49</span>%</a>
<a class="sourceLine" id="cb1015-59" data-line-number="59">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-60" data-line-number="60"><span class="st">  </span><span class="er">|====================================</span><span class="st">                                  </span><span class="er">|</span><span class="st">  </span><span class="dv">52</span>%</a>
<a class="sourceLine" id="cb1015-61" data-line-number="61">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-62" data-line-number="62"><span class="st">  </span><span class="er">|======================================</span><span class="st">                                </span><span class="er">|</span><span class="st">  </span><span class="dv">54</span>%</a>
<a class="sourceLine" id="cb1015-63" data-line-number="63">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-64" data-line-number="64"><span class="st">  </span><span class="er">|========================================</span><span class="st">                              </span><span class="er">|</span><span class="st">  </span><span class="dv">57</span>%</a>
<a class="sourceLine" id="cb1015-65" data-line-number="65">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-66" data-line-number="66"><span class="st">  </span><span class="er">|==========================================</span><span class="st">                            </span><span class="er">|</span><span class="st">  </span><span class="dv">60</span>%</a>
<a class="sourceLine" id="cb1015-67" data-line-number="67">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-68" data-line-number="68"><span class="st">  </span><span class="er">|============================================</span><span class="st">                          </span><span class="er">|</span><span class="st">  </span><span class="dv">63</span>%</a>
<a class="sourceLine" id="cb1015-69" data-line-number="69">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-70" data-line-number="70"><span class="st">  </span><span class="er">|==============================================</span><span class="st">                        </span><span class="er">|</span><span class="st">  </span><span class="dv">66</span>%</a>
<a class="sourceLine" id="cb1015-71" data-line-number="71">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-72" data-line-number="72"><span class="st">  </span><span class="er">|================================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">69</span>%</a>
<a class="sourceLine" id="cb1015-73" data-line-number="73">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-74" data-line-number="74"><span class="st">  </span><span class="er">|==================================================</span><span class="st">                    </span><span class="er">|</span><span class="st">  </span><span class="dv">72</span>%</a>
<a class="sourceLine" id="cb1015-75" data-line-number="75">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-76" data-line-number="76"><span class="st">  </span><span class="er">|====================================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">74</span>%</a>
<a class="sourceLine" id="cb1015-77" data-line-number="77">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-78" data-line-number="78"><span class="st">  </span><span class="er">|======================================================</span><span class="st">                </span><span class="er">|</span><span class="st">  </span><span class="dv">77</span>%</a>
<a class="sourceLine" id="cb1015-79" data-line-number="79">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-80" data-line-number="80"><span class="st">  </span><span class="er">|========================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">80</span>%</a>
<a class="sourceLine" id="cb1015-81" data-line-number="81">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-82" data-line-number="82"><span class="st">  </span><span class="er">|==========================================================</span><span class="st">            </span><span class="er">|</span><span class="st">  </span><span class="dv">83</span>%</a>
<a class="sourceLine" id="cb1015-83" data-line-number="83">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-84" data-line-number="84"><span class="st">  </span><span class="er">|============================================================</span><span class="st">          </span><span class="er">|</span><span class="st">  </span><span class="dv">86</span>%</a>
<a class="sourceLine" id="cb1015-85" data-line-number="85">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-86" data-line-number="86"><span class="st">  </span><span class="er">|==============================================================</span><span class="st">        </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%</a>
<a class="sourceLine" id="cb1015-87" data-line-number="87">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-88" data-line-number="88"><span class="st">  </span><span class="er">|================================================================</span><span class="st">      </span><span class="er">|</span><span class="st">  </span><span class="dv">92</span>%</a>
<a class="sourceLine" id="cb1015-89" data-line-number="89">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-90" data-line-number="90"><span class="st">  </span><span class="er">|==================================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">95</span>%</a>
<a class="sourceLine" id="cb1015-91" data-line-number="91">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-92" data-line-number="92"><span class="st">  </span><span class="er">|====================================================================</span><span class="st">  </span><span class="er">|</span><span class="st">  </span><span class="dv">97</span>%</a>
<a class="sourceLine" id="cb1015-93" data-line-number="93">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1015-94" data-line-number="94"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1015-95" data-line-number="95"><span class="kw">summary</span>(m3)</a>
<a class="sourceLine" id="cb1015-96" data-line-number="96"><span class="co">#&gt; Model Details:</span></a>
<a class="sourceLine" id="cb1015-97" data-line-number="97"><span class="co">#&gt; ==============</span></a>
<a class="sourceLine" id="cb1015-98" data-line-number="98"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-99" data-line-number="99"><span class="co">#&gt; H2OMultinomialModel: deeplearning</span></a>
<a class="sourceLine" id="cb1015-100" data-line-number="100"><span class="co">#&gt; Model Key:  dl_model_tuned </span></a>
<a class="sourceLine" id="cb1015-101" data-line-number="101"><span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 41,223 weights/biases, 332.9 KB, 3,499,045 training samples, mini-batch size 1</span></a>
<a class="sourceLine" id="cb1015-102" data-line-number="102"><span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span></a>
<a class="sourceLine" id="cb1015-103" data-line-number="103"><span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span></a>
<a class="sourceLine" id="cb1015-104" data-line-number="104"><span class="co">#&gt; 2     2   128 Rectifier  0.00 % 0.000010 0.000010  0.001250 0.000000 0.269981</span></a>
<a class="sourceLine" id="cb1015-105" data-line-number="105"><span class="co">#&gt; 3     3   128 Rectifier  0.00 % 0.000010 0.000010  0.001250 0.000000 0.269981</span></a>
<a class="sourceLine" id="cb1015-106" data-line-number="106"><span class="co">#&gt; 4     4   128 Rectifier  0.00 % 0.000010 0.000010  0.001250 0.000000 0.269981</span></a>
<a class="sourceLine" id="cb1015-107" data-line-number="107"><span class="co">#&gt; 5     5     7   Softmax      NA 0.000010 0.000010  0.001250 0.000000 0.269981</span></a>
<a class="sourceLine" id="cb1015-108" data-line-number="108"><span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span></a>
<a class="sourceLine" id="cb1015-109" data-line-number="109"><span class="co">#&gt; 1          NA         NA        NA       NA</span></a>
<a class="sourceLine" id="cb1015-110" data-line-number="110"><span class="co">#&gt; 2   -0.014469   0.319835 -0.037247 0.271448</span></a>
<a class="sourceLine" id="cb1015-111" data-line-number="111"><span class="co">#&gt; 3   -0.052402   0.222778  0.939648 0.374465</span></a>
<a class="sourceLine" id="cb1015-112" data-line-number="112"><span class="co">#&gt; 4   -0.062278   0.212382  0.817989 0.156239</span></a>
<a class="sourceLine" id="cb1015-113" data-line-number="113"><span class="co">#&gt; 5   -0.017439   0.270912  0.027387 0.939401</span></a>
<a class="sourceLine" id="cb1015-114" data-line-number="114"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-115" data-line-number="115"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1015-116" data-line-number="116"><span class="co">#&gt; ** Reported on training data. **</span></a>
<a class="sourceLine" id="cb1015-117" data-line-number="117"><span class="co">#&gt; ** Metrics reported on temporary training frame with 10045 samples **</span></a>
<a class="sourceLine" id="cb1015-118" data-line-number="118"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-119" data-line-number="119"><span class="co">#&gt; Training Set Metrics: </span></a>
<a class="sourceLine" id="cb1015-120" data-line-number="120"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1015-121" data-line-number="121"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-122" data-line-number="122"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.054</span></a>
<a class="sourceLine" id="cb1015-123" data-line-number="123"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.232</span></a>
<a class="sourceLine" id="cb1015-124" data-line-number="124"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.182</span></a>
<a class="sourceLine" id="cb1015-125" data-line-number="125"><span class="co">#&gt; Mean Per-Class Error: 0.134</span></a>
<a class="sourceLine" id="cb1015-126" data-line-number="126"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span></a>
<a class="sourceLine" id="cb1015-127" data-line-number="127"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1015-128" data-line-number="128"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1015-129" data-line-number="129"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1015-130" data-line-number="130"><span class="co">#&gt; class_1    3380     250       0       0       2       1      16 0.0737</span></a>
<a class="sourceLine" id="cb1015-131" data-line-number="131"><span class="co">#&gt; class_2     220    4703       9       0      11       9       2 0.0507</span></a>
<a class="sourceLine" id="cb1015-132" data-line-number="132"><span class="co">#&gt; class_3       0      14     551       4       1      24       0 0.0724</span></a>
<a class="sourceLine" id="cb1015-133" data-line-number="133"><span class="co">#&gt; class_4       0       0       9      51       0       2       0 0.1774</span></a>
<a class="sourceLine" id="cb1015-134" data-line-number="134"><span class="co">#&gt; class_5       2      36       4       0     127       0       0 0.2485</span></a>
<a class="sourceLine" id="cb1015-135" data-line-number="135"><span class="co">#&gt; class_6       1      19      49       2       0     227       0 0.2383</span></a>
<a class="sourceLine" id="cb1015-136" data-line-number="136"><span class="co">#&gt; class_7      19       4       0       0       1       0     295 0.0752</span></a>
<a class="sourceLine" id="cb1015-137" data-line-number="137"><span class="co">#&gt; Totals     3622    5026     622      57     142     263     313 0.0708</span></a>
<a class="sourceLine" id="cb1015-138" data-line-number="138"><span class="co">#&gt;                   Rate</span></a>
<a class="sourceLine" id="cb1015-139" data-line-number="139"><span class="co">#&gt; class_1 =  269 / 3,649</span></a>
<a class="sourceLine" id="cb1015-140" data-line-number="140"><span class="co">#&gt; class_2 =  251 / 4,954</span></a>
<a class="sourceLine" id="cb1015-141" data-line-number="141"><span class="co">#&gt; class_3 =     43 / 594</span></a>
<a class="sourceLine" id="cb1015-142" data-line-number="142"><span class="co">#&gt; class_4 =      11 / 62</span></a>
<a class="sourceLine" id="cb1015-143" data-line-number="143"><span class="co">#&gt; class_5 =     42 / 169</span></a>
<a class="sourceLine" id="cb1015-144" data-line-number="144"><span class="co">#&gt; class_6 =     71 / 298</span></a>
<a class="sourceLine" id="cb1015-145" data-line-number="145"><span class="co">#&gt; class_7 =     24 / 319</span></a>
<a class="sourceLine" id="cb1015-146" data-line-number="146"><span class="co">#&gt; Totals  = 711 / 10,045</span></a>
<a class="sourceLine" id="cb1015-147" data-line-number="147"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-148" data-line-number="148"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span></a>
<a class="sourceLine" id="cb1015-149" data-line-number="149"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1015-150" data-line-number="150"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1015-151" data-line-number="151"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1015-152" data-line-number="152"><span class="co">#&gt; 1 1  0.929219</span></a>
<a class="sourceLine" id="cb1015-153" data-line-number="153"><span class="co">#&gt; 2 2  0.996914</span></a>
<a class="sourceLine" id="cb1015-154" data-line-number="154"><span class="co">#&gt; 3 3  0.999900</span></a>
<a class="sourceLine" id="cb1015-155" data-line-number="155"><span class="co">#&gt; 4 4  1.000000</span></a>
<a class="sourceLine" id="cb1015-156" data-line-number="156"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1015-157" data-line-number="157"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1015-158" data-line-number="158"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1015-159" data-line-number="159"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-160" data-line-number="160"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-161" data-line-number="161"><span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span></a>
<a class="sourceLine" id="cb1015-162" data-line-number="162"><span class="co">#&gt; ** Reported on validation data. **</span></a>
<a class="sourceLine" id="cb1015-163" data-line-number="163"><span class="co">#&gt; ** Metrics reported on temporary validation frame with 10063 samples **</span></a>
<a class="sourceLine" id="cb1015-164" data-line-number="164"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-165" data-line-number="165"><span class="co">#&gt; Validation Set Metrics: </span></a>
<a class="sourceLine" id="cb1015-166" data-line-number="166"><span class="co">#&gt; =====================</span></a>
<a class="sourceLine" id="cb1015-167" data-line-number="167"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-168" data-line-number="168"><span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0609</span></a>
<a class="sourceLine" id="cb1015-169" data-line-number="169"><span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.247</span></a>
<a class="sourceLine" id="cb1015-170" data-line-number="170"><span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.203</span></a>
<a class="sourceLine" id="cb1015-171" data-line-number="171"><span class="co">#&gt; Mean Per-Class Error: 0.171</span></a>
<a class="sourceLine" id="cb1015-172" data-line-number="172"><span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span></a>
<a class="sourceLine" id="cb1015-173" data-line-number="173"><span class="co">#&gt; =========================================================================</span></a>
<a class="sourceLine" id="cb1015-174" data-line-number="174"><span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span></a>
<a class="sourceLine" id="cb1015-175" data-line-number="175"><span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span></a>
<a class="sourceLine" id="cb1015-176" data-line-number="176"><span class="co">#&gt; class_1    3394     345       0       0       1       0      13 0.0957</span></a>
<a class="sourceLine" id="cb1015-177" data-line-number="177"><span class="co">#&gt; class_2     208    4587      15       0      20       9       2 0.0525</span></a>
<a class="sourceLine" id="cb1015-178" data-line-number="178"><span class="co">#&gt; class_3       0      15     556       3       2      19       0 0.0655</span></a>
<a class="sourceLine" id="cb1015-179" data-line-number="179"><span class="co">#&gt; class_4       0       0      11      29       0       4       0 0.3409</span></a>
<a class="sourceLine" id="cb1015-180" data-line-number="180"><span class="co">#&gt; class_5       1      43       4       0     103       2       0 0.3268</span></a>
<a class="sourceLine" id="cb1015-181" data-line-number="181"><span class="co">#&gt; class_6       0      18      43       2       0     230       0 0.2150</span></a>
<a class="sourceLine" id="cb1015-182" data-line-number="182"><span class="co">#&gt; class_7      34       4       0       0       0       0     346 0.0990</span></a>
<a class="sourceLine" id="cb1015-183" data-line-number="183"><span class="co">#&gt; Totals     3637    5012     629      34     126     264     361 0.0813</span></a>
<a class="sourceLine" id="cb1015-184" data-line-number="184"><span class="co">#&gt;                   Rate</span></a>
<a class="sourceLine" id="cb1015-185" data-line-number="185"><span class="co">#&gt; class_1 =  359 / 3,753</span></a>
<a class="sourceLine" id="cb1015-186" data-line-number="186"><span class="co">#&gt; class_2 =  254 / 4,841</span></a>
<a class="sourceLine" id="cb1015-187" data-line-number="187"><span class="co">#&gt; class_3 =     39 / 595</span></a>
<a class="sourceLine" id="cb1015-188" data-line-number="188"><span class="co">#&gt; class_4 =      15 / 44</span></a>
<a class="sourceLine" id="cb1015-189" data-line-number="189"><span class="co">#&gt; class_5 =     50 / 153</span></a>
<a class="sourceLine" id="cb1015-190" data-line-number="190"><span class="co">#&gt; class_6 =     63 / 293</span></a>
<a class="sourceLine" id="cb1015-191" data-line-number="191"><span class="co">#&gt; class_7 =     38 / 384</span></a>
<a class="sourceLine" id="cb1015-192" data-line-number="192"><span class="co">#&gt; Totals  = 818 / 10,063</span></a>
<a class="sourceLine" id="cb1015-193" data-line-number="193"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-194" data-line-number="194"><span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span></a>
<a class="sourceLine" id="cb1015-195" data-line-number="195"><span class="co">#&gt; =======================================================================</span></a>
<a class="sourceLine" id="cb1015-196" data-line-number="196"><span class="co">#&gt; Top-7 Hit Ratios: </span></a>
<a class="sourceLine" id="cb1015-197" data-line-number="197"><span class="co">#&gt;   k hit_ratio</span></a>
<a class="sourceLine" id="cb1015-198" data-line-number="198"><span class="co">#&gt; 1 1  0.918712</span></a>
<a class="sourceLine" id="cb1015-199" data-line-number="199"><span class="co">#&gt; 2 2  0.996025</span></a>
<a class="sourceLine" id="cb1015-200" data-line-number="200"><span class="co">#&gt; 3 3  0.999702</span></a>
<a class="sourceLine" id="cb1015-201" data-line-number="201"><span class="co">#&gt; 4 4  1.000000</span></a>
<a class="sourceLine" id="cb1015-202" data-line-number="202"><span class="co">#&gt; 5 5  1.000000</span></a>
<a class="sourceLine" id="cb1015-203" data-line-number="203"><span class="co">#&gt; 6 6  1.000000</span></a>
<a class="sourceLine" id="cb1015-204" data-line-number="204"><span class="co">#&gt; 7 7  1.000000</span></a>
<a class="sourceLine" id="cb1015-205" data-line-number="205"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-206" data-line-number="206"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-207" data-line-number="207"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-208" data-line-number="208"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-209" data-line-number="209"><span class="co">#&gt; Scoring History: </span></a>
<a class="sourceLine" id="cb1015-210" data-line-number="210"><span class="co">#&gt;              timestamp          duration training_speed   epochs iterations</span></a>
<a class="sourceLine" id="cb1015-211" data-line-number="211"><span class="co">#&gt; 1  2020-11-18 08:17:37         0.000 sec             NA  0.00000          0</span></a>
<a class="sourceLine" id="cb1015-212" data-line-number="212"><span class="co">#&gt; 2  2020-11-18 08:17:42         5.542 sec  19082 obs/sec  0.28628          1</span></a>
<a class="sourceLine" id="cb1015-213" data-line-number="213"><span class="co">#&gt; 3  2020-11-18 08:17:54        17.027 sec  24304 obs/sec  1.14706          4</span></a>
<a class="sourceLine" id="cb1015-214" data-line-number="214"><span class="co">#&gt; 4  2020-11-18 08:18:04        27.496 sec  26166 obs/sec  2.00480          7</span></a>
<a class="sourceLine" id="cb1015-215" data-line-number="215"><span class="co">#&gt; 5  2020-11-18 08:18:14        37.605 sec  27275 obs/sec  2.86432         10</span></a>
<a class="sourceLine" id="cb1015-216" data-line-number="216"><span class="co">#&gt; 6  2020-11-18 08:18:24        47.614 sec  27964 obs/sec  3.72169         13</span></a>
<a class="sourceLine" id="cb1015-217" data-line-number="217"><span class="co">#&gt; 7  2020-11-18 08:18:34        57.570 sec  28462 obs/sec  4.58375         16</span></a>
<a class="sourceLine" id="cb1015-218" data-line-number="218"><span class="co">#&gt; 8  2020-11-18 08:18:44  1 min  7.661 sec  28755 obs/sec  5.44578         19</span></a>
<a class="sourceLine" id="cb1015-219" data-line-number="219"><span class="co">#&gt; 9  2020-11-18 08:18:54  1 min 17.651 sec  28996 obs/sec  6.30451         22</span></a>
<a class="sourceLine" id="cb1015-220" data-line-number="220"><span class="co">#&gt; 10 2020-11-18 08:19:05  1 min 28.383 sec  29011 obs/sec  7.16317         25</span></a>
<a class="sourceLine" id="cb1015-221" data-line-number="221"><span class="co">#&gt; 11 2020-11-18 08:19:25  1 min 48.393 sec  29249 obs/sec  8.88186         31</span></a>
<a class="sourceLine" id="cb1015-222" data-line-number="222"><span class="co">#&gt; 12 2020-11-18 08:19:35  1 min 58.534 sec  29327 obs/sec  9.73987         34</span></a>
<a class="sourceLine" id="cb1015-223" data-line-number="223"><span class="co">#&gt; 13 2020-11-18 08:19:39  2 min  1.980 sec  29366 obs/sec 10.02549         35</span></a>
<a class="sourceLine" id="cb1015-224" data-line-number="224"><span class="co">#&gt;           samples training_rmse training_logloss training_r2</span></a>
<a class="sourceLine" id="cb1015-225" data-line-number="225"><span class="co">#&gt; 1        0.000000            NA               NA          NA</span></a>
<a class="sourceLine" id="cb1015-226" data-line-number="226"><span class="co">#&gt; 2    99915.000000       0.42710          0.56043     0.90223</span></a>
<a class="sourceLine" id="cb1015-227" data-line-number="227"><span class="co">#&gt; 3   400341.000000       0.35198          0.39035     0.93360</span></a>
<a class="sourceLine" id="cb1015-228" data-line-number="228"><span class="co">#&gt; 4   699706.000000       0.32226          0.33312     0.94434</span></a>
<a class="sourceLine" id="cb1015-229" data-line-number="229"><span class="co">#&gt; 5   999690.000000       0.31503          0.31987     0.94681</span></a>
<a class="sourceLine" id="cb1015-230" data-line-number="230"><span class="co">#&gt; 6  1298925.000000       0.28070          0.25799     0.95777</span></a>
<a class="sourceLine" id="cb1015-231" data-line-number="231"><span class="co">#&gt; 7  1599797.000000       0.27686          0.25114     0.95892</span></a>
<a class="sourceLine" id="cb1015-232" data-line-number="232"><span class="co">#&gt; 8  1900660.000000       0.26993          0.24083     0.96095</span></a>
<a class="sourceLine" id="cb1015-233" data-line-number="233"><span class="co">#&gt; 9  2200369.000000       0.25845          0.21907     0.96420</span></a>
<a class="sourceLine" id="cb1015-234" data-line-number="234"><span class="co">#&gt; 10 2500054.000000       0.24942          0.20769     0.96666</span></a>
<a class="sourceLine" id="cb1015-235" data-line-number="235"><span class="co">#&gt; 11 3099901.000000       0.23464          0.18430     0.97049</span></a>
<a class="sourceLine" id="cb1015-236" data-line-number="236"><span class="co">#&gt; 12 3399361.000000       0.23711          0.18862     0.96987</span></a>
<a class="sourceLine" id="cb1015-237" data-line-number="237"><span class="co">#&gt; 13 3499045.000000       0.23237          0.18214     0.97106</span></a>
<a class="sourceLine" id="cb1015-238" data-line-number="238"><span class="co">#&gt;    training_classification_error validation_rmse validation_logloss</span></a>
<a class="sourceLine" id="cb1015-239" data-line-number="239"><span class="co">#&gt; 1                             NA              NA                 NA</span></a>
<a class="sourceLine" id="cb1015-240" data-line-number="240"><span class="co">#&gt; 2                        0.24002         0.42640            0.55683</span></a>
<a class="sourceLine" id="cb1015-241" data-line-number="241"><span class="co">#&gt; 3                        0.16685         0.35638            0.39999</span></a>
<a class="sourceLine" id="cb1015-242" data-line-number="242"><span class="co">#&gt; 4                        0.13888         0.32719            0.34145</span></a>
<a class="sourceLine" id="cb1015-243" data-line-number="243"><span class="co">#&gt; 5                        0.13201         0.31887            0.32861</span></a>
<a class="sourceLine" id="cb1015-244" data-line-number="244"><span class="co">#&gt; 6                        0.10393         0.28934            0.27570</span></a>
<a class="sourceLine" id="cb1015-245" data-line-number="245"><span class="co">#&gt; 7                        0.10184         0.28428            0.26652</span></a>
<a class="sourceLine" id="cb1015-246" data-line-number="246"><span class="co">#&gt; 8                        0.09597         0.27747            0.25583</span></a>
<a class="sourceLine" id="cb1015-247" data-line-number="247"><span class="co">#&gt; 9                        0.08950         0.26544            0.23226</span></a>
<a class="sourceLine" id="cb1015-248" data-line-number="248"><span class="co">#&gt; 10                       0.08123         0.26327            0.23057</span></a>
<a class="sourceLine" id="cb1015-249" data-line-number="249"><span class="co">#&gt; 11                       0.07227         0.25048            0.20793</span></a>
<a class="sourceLine" id="cb1015-250" data-line-number="250"><span class="co">#&gt; 12                       0.07347         0.25329            0.21252</span></a>
<a class="sourceLine" id="cb1015-251" data-line-number="251"><span class="co">#&gt; 13                       0.07078         0.24673            0.20320</span></a>
<a class="sourceLine" id="cb1015-252" data-line-number="252"><span class="co">#&gt;    validation_r2 validation_classification_error</span></a>
<a class="sourceLine" id="cb1015-253" data-line-number="253"><span class="co">#&gt; 1             NA                              NA</span></a>
<a class="sourceLine" id="cb1015-254" data-line-number="254"><span class="co">#&gt; 2        0.90927                         0.24317</span></a>
<a class="sourceLine" id="cb1015-255" data-line-number="255"><span class="co">#&gt; 3        0.93662                         0.17092</span></a>
<a class="sourceLine" id="cb1015-256" data-line-number="256"><span class="co">#&gt; 4        0.94658                         0.14389</span></a>
<a class="sourceLine" id="cb1015-257" data-line-number="257"><span class="co">#&gt; 5        0.94926                         0.13743</span></a>
<a class="sourceLine" id="cb1015-258" data-line-number="258"><span class="co">#&gt; 6        0.95822                         0.11249</span></a>
<a class="sourceLine" id="cb1015-259" data-line-number="259"><span class="co">#&gt; 7        0.95967                         0.10534</span></a>
<a class="sourceLine" id="cb1015-260" data-line-number="260"><span class="co">#&gt; 8        0.96158                         0.10116</span></a>
<a class="sourceLine" id="cb1015-261" data-line-number="261"><span class="co">#&gt; 9        0.96484                         0.09272</span></a>
<a class="sourceLine" id="cb1015-262" data-line-number="262"><span class="co">#&gt; 10       0.96541                         0.08864</span></a>
<a class="sourceLine" id="cb1015-263" data-line-number="263"><span class="co">#&gt; 11       0.96869                         0.08417</span></a>
<a class="sourceLine" id="cb1015-264" data-line-number="264"><span class="co">#&gt; 12       0.96799                         0.08576</span></a>
<a class="sourceLine" id="cb1015-265" data-line-number="265"><span class="co">#&gt; 13       0.96962                         0.08129</span></a>
<a class="sourceLine" id="cb1015-266" data-line-number="266"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-267" data-line-number="267"><span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span></a>
<a class="sourceLine" id="cb1015-268" data-line-number="268"><span class="co">#&gt; =================================================</span></a>
<a class="sourceLine" id="cb1015-269" data-line-number="269"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-270" data-line-number="270"><span class="co">#&gt; Variable Importances: </span></a>
<a class="sourceLine" id="cb1015-271" data-line-number="271"><span class="co">#&gt;                             variable relative_importance scaled_importance</span></a>
<a class="sourceLine" id="cb1015-272" data-line-number="272"><span class="co">#&gt; 1                          Elevation            1.000000          1.000000</span></a>
<a class="sourceLine" id="cb1015-273" data-line-number="273"><span class="co">#&gt; 2    Horizontal_Distance_To_Roadways            0.949956          0.949956</span></a>
<a class="sourceLine" id="cb1015-274" data-line-number="274"><span class="co">#&gt; 3 Horizontal_Distance_To_Fire_Points            0.895530          0.895530</span></a>
<a class="sourceLine" id="cb1015-275" data-line-number="275"><span class="co">#&gt; 4             Wilderness_Area.area_0            0.726058          0.726058</span></a>
<a class="sourceLine" id="cb1015-276" data-line-number="276"><span class="co">#&gt; 5   Horizontal_Distance_To_Hydrology            0.609224          0.609224</span></a>
<a class="sourceLine" id="cb1015-277" data-line-number="277"><span class="co">#&gt;   percentage</span></a>
<a class="sourceLine" id="cb1015-278" data-line-number="278"><span class="co">#&gt; 1   0.048568</span></a>
<a class="sourceLine" id="cb1015-279" data-line-number="279"><span class="co">#&gt; 2   0.046137</span></a>
<a class="sourceLine" id="cb1015-280" data-line-number="280"><span class="co">#&gt; 3   0.043494</span></a>
<a class="sourceLine" id="cb1015-281" data-line-number="281"><span class="co">#&gt; 4   0.035263</span></a>
<a class="sourceLine" id="cb1015-282" data-line-number="282"><span class="co">#&gt; 5   0.029589</span></a>
<a class="sourceLine" id="cb1015-283" data-line-number="283"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1015-284" data-line-number="284"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1015-285" data-line-number="285"><span class="co">#&gt;                       variable relative_importance scaled_importance percentage</span></a>
<a class="sourceLine" id="cb1015-286" data-line-number="286"><span class="co">#&gt; 51            Soil_Type.type_7            0.162088          0.162088   0.007872</span></a>
<a class="sourceLine" id="cb1015-287" data-line-number="287"><span class="co">#&gt; 52           Soil_Type.type_24            0.158540          0.158540   0.007700</span></a>
<a class="sourceLine" id="cb1015-288" data-line-number="288"><span class="co">#&gt; 53            Soil_Type.type_6            0.153531          0.153531   0.007457</span></a>
<a class="sourceLine" id="cb1015-289" data-line-number="289"><span class="co">#&gt; 54                      Aspect            0.149670          0.149670   0.007269</span></a>
<a class="sourceLine" id="cb1015-290" data-line-number="290"><span class="co">#&gt; 55       Soil_Type.missing(NA)            0.000000          0.000000   0.000000</span></a>
<a class="sourceLine" id="cb1015-291" data-line-number="291"><span class="co">#&gt; 56 Wilderness_Area.missing(NA)            0.000000          0.000000   0.000000</span></a></code></pre></div>
<p>Let’s compare the training error with the validation and test set errors</p>
<div class="sourceCode" id="cb1016"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, train<span class="op">=</span><span class="cn">T</span><span class="op">)</span>          <span class="co">## sampled training data (from model building)</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on training data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary training frame with 10045 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Training Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.054</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.232</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.182</span>
<span class="co">#&gt; Mean Per-Class Error: 0.134</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3380     250       0       0       2       1      16 0.0737</span>
<span class="co">#&gt; class_2     220    4703       9       0      11       9       2 0.0507</span>
<span class="co">#&gt; class_3       0      14     551       4       1      24       0 0.0724</span>
<span class="co">#&gt; class_4       0       0       9      51       0       2       0 0.1774</span>
<span class="co">#&gt; class_5       2      36       4       0     127       0       0 0.2485</span>
<span class="co">#&gt; class_6       1      19      49       2       0     227       0 0.2383</span>
<span class="co">#&gt; class_7      19       4       0       0       1       0     295 0.0752</span>
<span class="co">#&gt; Totals     3622    5026     622      57     142     263     313 0.0708</span>
<span class="co">#&gt;                   Rate</span>
<span class="co">#&gt; class_1 =  269 / 3,649</span>
<span class="co">#&gt; class_2 =  251 / 4,954</span>
<span class="co">#&gt; class_3 =     43 / 594</span>
<span class="co">#&gt; class_4 =      11 / 62</span>
<span class="co">#&gt; class_5 =     42 / 169</span>
<span class="co">#&gt; class_6 =     71 / 298</span>
<span class="co">#&gt; class_7 =     24 / 319</span>
<span class="co">#&gt; Totals  = 711 / 10,045</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.929219</span>
<span class="co">#&gt; 2 2  0.996914</span>
<span class="co">#&gt; 3 3  0.999900</span>
<span class="co">#&gt; 4 4  1.000000</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span>          <span class="co">## sampled validation data (from model building)</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 10063 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0609</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.247</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.203</span>
<span class="co">#&gt; Mean Per-Class Error: 0.171</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3394     345       0       0       1       0      13 0.0957</span>
<span class="co">#&gt; class_2     208    4587      15       0      20       9       2 0.0525</span>
<span class="co">#&gt; class_3       0      15     556       3       2      19       0 0.0655</span>
<span class="co">#&gt; class_4       0       0      11      29       0       4       0 0.3409</span>
<span class="co">#&gt; class_5       1      43       4       0     103       2       0 0.3268</span>
<span class="co">#&gt; class_6       0      18      43       2       0     230       0 0.2150</span>
<span class="co">#&gt; class_7      34       4       0       0       0       0     346 0.0990</span>
<span class="co">#&gt; Totals     3637    5012     629      34     126     264     361 0.0813</span>
<span class="co">#&gt;                   Rate</span>
<span class="co">#&gt; class_1 =  359 / 3,753</span>
<span class="co">#&gt; class_2 =  254 / 4,841</span>
<span class="co">#&gt; class_3 =     39 / 595</span>
<span class="co">#&gt; class_4 =      15 / 44</span>
<span class="co">#&gt; class_5 =     50 / 153</span>
<span class="co">#&gt; class_6 =     63 / 293</span>
<span class="co">#&gt; class_7 =     38 / 384</span>
<span class="co">#&gt; Totals  = 818 / 10,063</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.918712</span>
<span class="co">#&gt; 2 2  0.996025</span>
<span class="co">#&gt; 3 3  0.999702</span>
<span class="co">#&gt; 4 4  1.000000</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, newdata<span class="op">=</span><span class="va">train</span><span class="op">)</span>    <span class="co">## full training data</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0555</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.236</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.185</span>
<span class="co">#&gt; Mean Per-Class Error: 0.145</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;, &lt;data&gt;)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1  116148   10256       3       0     109      29     575 0.0863</span>
<span class="co">#&gt; class_2    6755  162360     406       0     527     241      53 0.0469</span>
<span class="co">#&gt; class_3       1     509   20089      82      27     734       0 0.0631</span>
<span class="co">#&gt; class_4       0       2     347    1228       0      81       0 0.2593</span>
<span class="co">#&gt; class_5      64    1249     127       0    4256      24       0 0.2559</span>
<span class="co">#&gt; class_6      18     565    1674      51       4    8121       0 0.2216</span>
<span class="co">#&gt; class_7     826     174       0       0       1       0   11299 0.0814</span>
<span class="co">#&gt; Totals   123812  175115   22646    1361    4924    9230   11927 0.0731</span>
<span class="co">#&gt;                       Rate</span>
<span class="co">#&gt; class_1 = 10,972 / 127,120</span>
<span class="co">#&gt; class_2 =  7,982 / 170,342</span>
<span class="co">#&gt; class_3 =   1,353 / 21,442</span>
<span class="co">#&gt; class_4 =      430 / 1,658</span>
<span class="co">#&gt; class_5 =    1,464 / 5,720</span>
<span class="co">#&gt; class_6 =   2,312 / 10,433</span>
<span class="co">#&gt; class_7 =   1,001 / 12,300</span>
<span class="co">#&gt; Totals  = 25,514 / 349,015</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;, &lt;data&gt;)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.926897</span>
<span class="co">#&gt; 2 2  0.996751</span>
<span class="co">#&gt; 3 3  0.999708</span>
<span class="co">#&gt; 4 4  0.999937</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, newdata<span class="op">=</span><span class="va">valid</span><span class="op">)</span>    <span class="co">## full validation data</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0615</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.248</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.206</span>
<span class="co">#&gt; Mean Per-Class Error: 0.155</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;, &lt;data&gt;)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1   38420    3823       2       0      41       9     205 0.0960</span>
<span class="co">#&gt; class_2    2506   53385     131       0     217     121      20 0.0531</span>
<span class="co">#&gt; class_3       1     213    6625      29      10     265       0 0.0725</span>
<span class="co">#&gt; class_4       0       0     118     420       0      24       0 0.2527</span>
<span class="co">#&gt; class_5      22     467      48       0    1327       6       0 0.2904</span>
<span class="co">#&gt; class_6       5     223     578      22       1    2635       0 0.2393</span>
<span class="co">#&gt; class_7     289      45       0       0       1       0    3764 0.0817</span>
<span class="co">#&gt; Totals    41243   58156    7502     471    1597    3060    3989 0.0814</span>
<span class="co">#&gt;                      Rate</span>
<span class="co">#&gt; class_1 =  4,080 / 42,500</span>
<span class="co">#&gt; class_2 =  2,995 / 56,380</span>
<span class="co">#&gt; class_3 =     518 / 7,143</span>
<span class="co">#&gt; class_4 =       142 / 562</span>
<span class="co">#&gt; class_5 =     543 / 1,870</span>
<span class="co">#&gt; class_6 =     829 / 3,464</span>
<span class="co">#&gt; class_7 =     335 / 4,099</span>
<span class="co">#&gt; Totals  = 9,442 / 116,018</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;, &lt;data&gt;)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.918616</span>
<span class="co">#&gt; 2 2  0.995897</span>
<span class="co">#&gt; 3 3  0.999500</span>
<span class="co">#&gt; 4 4  0.999896</span>
<span class="co">#&gt; 5 5  0.999991</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">m3</span>, newdata<span class="op">=</span><span class="va">test</span><span class="op">)</span>     <span class="co">## full test data</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0611</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.247</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.204</span>
<span class="co">#&gt; Mean Per-Class Error: 0.152</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;, &lt;data&gt;)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1   38153    3768       1       0      50       4     244 0.0963</span>
<span class="co">#&gt; class_2    2442   53613     165       0     206     122      31 0.0524</span>
<span class="co">#&gt; class_3       1     214    6670      32      10     242       0 0.0696</span>
<span class="co">#&gt; class_4       0       2     105     401       0      19       0 0.2391</span>
<span class="co">#&gt; class_5      18     439      38       0    1395      13       0 0.2669</span>
<span class="co">#&gt; class_6      12     221     600      20       2    2615       0 0.2464</span>
<span class="co">#&gt; class_7     335      46       0       0       0       0    3730 0.0927</span>
<span class="co">#&gt; Totals    40961   58303    7579     453    1663    3015    4005 0.0811</span>
<span class="co">#&gt;                      Rate</span>
<span class="co">#&gt; class_1 =  4,067 / 42,220</span>
<span class="co">#&gt; class_2 =  2,966 / 56,579</span>
<span class="co">#&gt; class_3 =     499 / 7,169</span>
<span class="co">#&gt; class_4 =       126 / 527</span>
<span class="co">#&gt; class_5 =     508 / 1,903</span>
<span class="co">#&gt; class_6 =     855 / 3,470</span>
<span class="co">#&gt; class_7 =     381 / 4,111</span>
<span class="co">#&gt; Totals  = 9,402 / 115,979</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;, &lt;data&gt;)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.918934</span>
<span class="co">#&gt; 2 2  0.995801</span>
<span class="co">#&gt; 3 3  0.999612</span>
<span class="co">#&gt; 4 4  0.999888</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span></code></pre></div>
<p>To confirm that the reported confusion matrix on the validation set (here, the test set) was correct, we make a prediction on the test set and compare the confusion matrices explicitly:</p>
<div class="sourceCode" id="cb1017"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1017-1" data-line-number="1">pred &lt;-<span class="st"> </span><span class="kw">h2o.predict</span>(m3, test)</a>
<a class="sourceLine" id="cb1017-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1017-3" data-line-number="3">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1017-4" data-line-number="4"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1017-5" data-line-number="5">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1017-6" data-line-number="6"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1017-7" data-line-number="7">pred</a>
<a class="sourceLine" id="cb1017-8" data-line-number="8"><span class="co">#&gt;   predict  class_1  class_2  class_3  class_4  class_5  class_6  class_7</span></a>
<a class="sourceLine" id="cb1017-9" data-line-number="9"><span class="co">#&gt; 1 class_2 4.95e-01 0.504397 1.85e-04 1.35e-05 3.95e-05 6.12e-04 5.63e-05</span></a>
<a class="sourceLine" id="cb1017-10" data-line-number="10"><span class="co">#&gt; 2 class_1 9.98e-01 0.000915 4.91e-06 2.12e-05 5.68e-07 4.30e-06 1.39e-03</span></a>
<a class="sourceLine" id="cb1017-11" data-line-number="11"><span class="co">#&gt; 3 class_1 9.85e-01 0.015025 2.10e-07 1.35e-06 5.77e-09 3.16e-07 3.37e-06</span></a>
<a class="sourceLine" id="cb1017-12" data-line-number="12"><span class="co">#&gt; 4 class_1 9.99e-01 0.000963 8.66e-10 7.00e-09 5.22e-11 1.12e-07 5.99e-08</span></a>
<a class="sourceLine" id="cb1017-13" data-line-number="13"><span class="co">#&gt; 5 class_2 6.12e-02 0.937918 2.41e-05 2.60e-04 3.37e-04 2.09e-04 1.48e-05</span></a>
<a class="sourceLine" id="cb1017-14" data-line-number="14"><span class="co">#&gt; 6 class_5 4.60e-07 0.055709 1.17e-06 1.68e-08 9.44e-01 9.99e-11 2.29e-08</span></a>
<a class="sourceLine" id="cb1017-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1017-16" data-line-number="16"><span class="co">#&gt; [115979 rows x 8 columns]</span></a>
<a class="sourceLine" id="cb1017-17" data-line-number="17">test<span class="op">$</span>Accuracy &lt;-<span class="st"> </span>pred<span class="op">$</span>predict <span class="op">==</span><span class="st"> </span>test<span class="op">$</span>Cover_Type</a>
<a class="sourceLine" id="cb1017-18" data-line-number="18"><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(test<span class="op">$</span>Accuracy)</a>
<a class="sourceLine" id="cb1017-19" data-line-number="19"><span class="co">#&gt; [1] 0.0811</span></a></code></pre></div>
</div>
<div id="hyper-parameter-tuning-with-grid-search" class="section level3">
<h3>
<span class="header-section-number">44.5.6</span> Hyper-parameter Tuning with Grid Search<a class="anchor" aria-label="anchor" href="#hyper-parameter-tuning-with-grid-search"><i class="fas fa-link"></i></a>
</h3>
<p>Since there are a lot of parameters that can impact model accuracy, hyper-parameter tuning is especially important for Deep Learning:</p>
<p>For speed, we will only train on the first 10,000 rows of the training dataset:</p>
<div class="sourceCode" id="cb1018"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sampled_train</span><span class="op">=</span><span class="va">train</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10000</span>,<span class="op">]</span></code></pre></div>
<p>The simplest hyperparameter search method is a brute-force scan of the full Cartesian product of all combinations specified by a grid search:</p>
<div class="sourceCode" id="cb1019"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1019-1" data-line-number="1">hyper_params &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb1019-2" data-line-number="2">  <span class="dt">hidden=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">32</span>,<span class="dv">32</span>,<span class="dv">32</span>),<span class="kw">c</span>(<span class="dv">64</span>,<span class="dv">64</span>)),</a>
<a class="sourceLine" id="cb1019-3" data-line-number="3">  <span class="dt">input_dropout_ratio=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>),</a>
<a class="sourceLine" id="cb1019-4" data-line-number="4">  <span class="dt">rate=</span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.02</span>),</a>
<a class="sourceLine" id="cb1019-5" data-line-number="5">  <span class="dt">rate_annealing=</span><span class="kw">c</span>(<span class="fl">1e-8</span>,<span class="fl">1e-7</span>,<span class="fl">1e-6</span>)</a>
<a class="sourceLine" id="cb1019-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb1019-7" data-line-number="7">hyper_params</a>
<a class="sourceLine" id="cb1019-8" data-line-number="8"><span class="co">#&gt; $hidden</span></a>
<a class="sourceLine" id="cb1019-9" data-line-number="9"><span class="co">#&gt; $hidden[[1]]</span></a>
<a class="sourceLine" id="cb1019-10" data-line-number="10"><span class="co">#&gt; [1] 32 32 32</span></a>
<a class="sourceLine" id="cb1019-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1019-12" data-line-number="12"><span class="co">#&gt; $hidden[[2]]</span></a>
<a class="sourceLine" id="cb1019-13" data-line-number="13"><span class="co">#&gt; [1] 64 64</span></a>
<a class="sourceLine" id="cb1019-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1019-15" data-line-number="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1019-16" data-line-number="16"><span class="co">#&gt; $input_dropout_ratio</span></a>
<a class="sourceLine" id="cb1019-17" data-line-number="17"><span class="co">#&gt; [1] 0.00 0.05</span></a>
<a class="sourceLine" id="cb1019-18" data-line-number="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1019-19" data-line-number="19"><span class="co">#&gt; $rate</span></a>
<a class="sourceLine" id="cb1019-20" data-line-number="20"><span class="co">#&gt; [1] 0.01 0.02</span></a>
<a class="sourceLine" id="cb1019-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1019-22" data-line-number="22"><span class="co">#&gt; $rate_annealing</span></a>
<a class="sourceLine" id="cb1019-23" data-line-number="23"><span class="co">#&gt; [1] 1e-08 1e-07 1e-06</span></a>
<a class="sourceLine" id="cb1019-24" data-line-number="24">grid &lt;-<span class="st"> </span><span class="kw">h2o.grid</span>(</a>
<a class="sourceLine" id="cb1019-25" data-line-number="25">  <span class="dt">algorithm=</span><span class="st">"deeplearning"</span>,</a>
<a class="sourceLine" id="cb1019-26" data-line-number="26">  <span class="dt">grid_id=</span><span class="st">"dl_grid"</span>, </a>
<a class="sourceLine" id="cb1019-27" data-line-number="27">  <span class="dt">training_frame=</span>sampled_train,</a>
<a class="sourceLine" id="cb1019-28" data-line-number="28">  <span class="dt">validation_frame=</span>valid, </a>
<a class="sourceLine" id="cb1019-29" data-line-number="29">  <span class="dt">x=</span>predictors, </a>
<a class="sourceLine" id="cb1019-30" data-line-number="30">  <span class="dt">y=</span>response,</a>
<a class="sourceLine" id="cb1019-31" data-line-number="31">  <span class="dt">epochs=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1019-32" data-line-number="32">  <span class="dt">stopping_metric=</span><span class="st">"misclassification"</span>,</a>
<a class="sourceLine" id="cb1019-33" data-line-number="33">  <span class="dt">stopping_tolerance=</span><span class="fl">1e-2</span>,        <span class="co">## stop when misclassification does not improve by &gt;=1% for 2 scoring events</span></a>
<a class="sourceLine" id="cb1019-34" data-line-number="34">  <span class="dt">stopping_rounds=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1019-35" data-line-number="35">  <span class="dt">score_validation_samples=</span><span class="dv">10000</span>, <span class="co">## downsample validation set for faster scoring</span></a>
<a class="sourceLine" id="cb1019-36" data-line-number="36">  <span class="dt">score_duty_cycle=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span></a>
<a class="sourceLine" id="cb1019-37" data-line-number="37">  <span class="dt">adaptive_rate=</span>F,                <span class="co">## manually tuned learning rate</span></a>
<a class="sourceLine" id="cb1019-38" data-line-number="38">  <span class="dt">momentum_start=</span><span class="fl">0.5</span>,             <span class="co">## manually tuned momentum</span></a>
<a class="sourceLine" id="cb1019-39" data-line-number="39">  <span class="dt">momentum_stable=</span><span class="fl">0.9</span>, </a>
<a class="sourceLine" id="cb1019-40" data-line-number="40">  <span class="dt">momentum_ramp=</span><span class="fl">1e7</span>, </a>
<a class="sourceLine" id="cb1019-41" data-line-number="41">  <span class="dt">l1=</span><span class="fl">1e-5</span>,</a>
<a class="sourceLine" id="cb1019-42" data-line-number="42">  <span class="dt">l2=</span><span class="fl">1e-5</span>,</a>
<a class="sourceLine" id="cb1019-43" data-line-number="43">  <span class="dt">activation=</span><span class="kw">c</span>(<span class="st">"Rectifier"</span>),</a>
<a class="sourceLine" id="cb1019-44" data-line-number="44">  <span class="dt">max_w2=</span><span class="dv">10</span>,                      <span class="co">## can help improve stability for Rectifier</span></a>
<a class="sourceLine" id="cb1019-45" data-line-number="45">  <span class="dt">hyper_params=</span>hyper_params</a>
<a class="sourceLine" id="cb1019-46" data-line-number="46">)</a>
<a class="sourceLine" id="cb1019-47" data-line-number="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1019-48" data-line-number="48">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1019-49" data-line-number="49"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1019-50" data-line-number="50">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1019-51" data-line-number="51"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1019-52" data-line-number="52">grid</a>
<a class="sourceLine" id="cb1019-53" data-line-number="53"><span class="co">#&gt; H2O Grid Details</span></a>
<a class="sourceLine" id="cb1019-54" data-line-number="54"><span class="co">#&gt; ================</span></a>
<a class="sourceLine" id="cb1019-55" data-line-number="55"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1019-56" data-line-number="56"><span class="co">#&gt; Grid ID: dl_grid </span></a>
<a class="sourceLine" id="cb1019-57" data-line-number="57"><span class="co">#&gt; Used hyper parameters: </span></a>
<a class="sourceLine" id="cb1019-58" data-line-number="58"><span class="co">#&gt;   -  hidden </span></a>
<a class="sourceLine" id="cb1019-59" data-line-number="59"><span class="co">#&gt;   -  input_dropout_ratio </span></a>
<a class="sourceLine" id="cb1019-60" data-line-number="60"><span class="co">#&gt;   -  rate </span></a>
<a class="sourceLine" id="cb1019-61" data-line-number="61"><span class="co">#&gt;   -  rate_annealing </span></a>
<a class="sourceLine" id="cb1019-62" data-line-number="62"><span class="co">#&gt; Number of models: 24 </span></a>
<a class="sourceLine" id="cb1019-63" data-line-number="63"><span class="co">#&gt; Number of failed models: 0 </span></a>
<a class="sourceLine" id="cb1019-64" data-line-number="64"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1019-65" data-line-number="65"><span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing logloss</span></a>
<a class="sourceLine" id="cb1019-66" data-line-number="66"><span class="co">#&gt;     hidden input_dropout_ratio rate rate_annealing        model_ids</span></a>
<a class="sourceLine" id="cb1019-67" data-line-number="67"><span class="co">#&gt; 1 [64, 64]                 0.0 0.02         1.0E-7 dl_grid_model_14</span></a>
<a class="sourceLine" id="cb1019-68" data-line-number="68"><span class="co">#&gt; 2 [64, 64]                 0.0 0.02         1.0E-6 dl_grid_model_22</span></a>
<a class="sourceLine" id="cb1019-69" data-line-number="69"><span class="co">#&gt; 3 [64, 64]                 0.0 0.01         1.0E-6 dl_grid_model_18</span></a>
<a class="sourceLine" id="cb1019-70" data-line-number="70"><span class="co">#&gt; 4 [64, 64]                0.05 0.01         1.0E-7 dl_grid_model_12</span></a>
<a class="sourceLine" id="cb1019-71" data-line-number="71"><span class="co">#&gt; 5 [64, 64]                 0.0 0.01         1.0E-8  dl_grid_model_2</span></a>
<a class="sourceLine" id="cb1019-72" data-line-number="72"><span class="co">#&gt;              logloss</span></a>
<a class="sourceLine" id="cb1019-73" data-line-number="73"><span class="co">#&gt; 1 0.5717452314439635</span></a>
<a class="sourceLine" id="cb1019-74" data-line-number="74"><span class="co">#&gt; 2 0.5723938262306084</span></a>
<a class="sourceLine" id="cb1019-75" data-line-number="75"><span class="co">#&gt; 3  0.578766555692541</span></a>
<a class="sourceLine" id="cb1019-76" data-line-number="76"><span class="co">#&gt; 4 0.5839318932912395</span></a>
<a class="sourceLine" id="cb1019-77" data-line-number="77"><span class="co">#&gt; 5 0.5909614970189161</span></a>
<a class="sourceLine" id="cb1019-78" data-line-number="78"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1019-79" data-line-number="79"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb1019-80" data-line-number="80"><span class="co">#&gt;          hidden input_dropout_ratio rate rate_annealing        model_ids</span></a>
<a class="sourceLine" id="cb1019-81" data-line-number="81"><span class="co">#&gt; 19 [32, 32, 32]                 0.0 0.02         1.0E-6 dl_grid_model_21</span></a>
<a class="sourceLine" id="cb1019-82" data-line-number="82"><span class="co">#&gt; 20 [32, 32, 32]                0.05 0.02         1.0E-6 dl_grid_model_23</span></a>
<a class="sourceLine" id="cb1019-83" data-line-number="83"><span class="co">#&gt; 21 [32, 32, 32]                 0.0 0.01         1.0E-8  dl_grid_model_1</span></a>
<a class="sourceLine" id="cb1019-84" data-line-number="84"><span class="co">#&gt; 22 [32, 32, 32]                 0.0 0.01         1.0E-6 dl_grid_model_17</span></a>
<a class="sourceLine" id="cb1019-85" data-line-number="85"><span class="co">#&gt; 23 [32, 32, 32]                 0.0 0.02         1.0E-8  dl_grid_model_5</span></a>
<a class="sourceLine" id="cb1019-86" data-line-number="86"><span class="co">#&gt; 24 [32, 32, 32]                 0.0 0.02         1.0E-7 dl_grid_model_13</span></a>
<a class="sourceLine" id="cb1019-87" data-line-number="87"><span class="co">#&gt;               logloss</span></a>
<a class="sourceLine" id="cb1019-88" data-line-number="88"><span class="co">#&gt; 19 0.6232799684359932</span></a>
<a class="sourceLine" id="cb1019-89" data-line-number="89"><span class="co">#&gt; 20 0.6252295717620697</span></a>
<a class="sourceLine" id="cb1019-90" data-line-number="90"><span class="co">#&gt; 21 0.6361708020687168</span></a>
<a class="sourceLine" id="cb1019-91" data-line-number="91"><span class="co">#&gt; 22 0.6393453687970879</span></a>
<a class="sourceLine" id="cb1019-92" data-line-number="92"><span class="co">#&gt; 23 0.6409564453678517</span></a>
<a class="sourceLine" id="cb1019-93" data-line-number="93"><span class="co">#&gt; 24 0.6696074266255975</span></a></code></pre></div>
<p>Let’s see which model had the lowest validation error:</p>
<div class="sourceCode" id="cb1020"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid"</span>,sort_by<span class="op">=</span><span class="st">"err"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">grid</span>
<span class="co">#&gt; H2O Grid Details</span>
<span class="co">#&gt; ================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Grid ID: dl_grid </span>
<span class="co">#&gt; Used hyper parameters: </span>
<span class="co">#&gt;   -  hidden </span>
<span class="co">#&gt;   -  input_dropout_ratio </span>
<span class="co">#&gt;   -  rate </span>
<span class="co">#&gt;   -  rate_annealing </span>
<span class="co">#&gt; Number of models: 24 </span>
<span class="co">#&gt; Number of failed models: 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing err</span>
<span class="co">#&gt;         hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 1     [64, 64]                 0.0 0.02         1.0E-6 dl_grid_model_22</span>
<span class="co">#&gt; 2     [64, 64]                 0.0 0.02         1.0E-7 dl_grid_model_14</span>
<span class="co">#&gt; 3     [64, 64]                 0.0 0.01         1.0E-6 dl_grid_model_18</span>
<span class="co">#&gt; 4 [32, 32, 32]                0.05 0.02         1.0E-8  dl_grid_model_7</span>
<span class="co">#&gt; 5 [32, 32, 32]                0.05 0.01         1.0E-6 dl_grid_model_19</span>
<span class="co">#&gt;                   err</span>
<span class="co">#&gt; 1 0.24200501253132833</span>
<span class="co">#&gt; 2  0.2491280518186348</span>
<span class="co">#&gt; 3  0.2496234561702982</span>
<span class="co">#&gt; 4   0.252061959364313</span>
<span class="co">#&gt; 5  0.2532681369124838</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;          hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 19 [32, 32, 32]                0.05 0.01         1.0E-8  dl_grid_model_3</span>
<span class="co">#&gt; 20 [32, 32, 32]                 0.0 0.01         1.0E-7  dl_grid_model_9</span>
<span class="co">#&gt; 21 [32, 32, 32]                0.05 0.02         1.0E-6 dl_grid_model_23</span>
<span class="co">#&gt; 22 [32, 32, 32]                 0.0 0.02         1.0E-7 dl_grid_model_13</span>
<span class="co">#&gt; 23 [32, 32, 32]                 0.0 0.01         1.0E-6 dl_grid_model_17</span>
<span class="co">#&gt; 24 [32, 32, 32]                 0.0 0.01         1.0E-8  dl_grid_model_1</span>
<span class="co">#&gt;                    err</span>
<span class="co">#&gt; 19 0.26625262947009914</span>
<span class="co">#&gt; 20  0.2669538214965441</span>
<span class="co">#&gt; 21   0.267797971683904</span>
<span class="co">#&gt; 22  0.2698619171502902</span>
<span class="co">#&gt; 23  0.2810665605412397</span>
<span class="co">#&gt; 24  0.2853149645602476</span>

<span class="co">## To see what other "sort_by" criteria are allowed</span>
<span class="co">#grid &lt;- h2o.getGrid("dl_grid",sort_by="wrong_thing",decreasing=FALSE)</span>

<span class="co">## Sort by logloss</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid"</span>,sort_by<span class="op">=</span><span class="st">"logloss"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; H2O Grid Details</span>
<span class="co">#&gt; ================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Grid ID: dl_grid </span>
<span class="co">#&gt; Used hyper parameters: </span>
<span class="co">#&gt;   -  hidden </span>
<span class="co">#&gt;   -  input_dropout_ratio </span>
<span class="co">#&gt;   -  rate </span>
<span class="co">#&gt;   -  rate_annealing </span>
<span class="co">#&gt; Number of models: 24 </span>
<span class="co">#&gt; Number of failed models: 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing logloss</span>
<span class="co">#&gt;     hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 1 [64, 64]                 0.0 0.02         1.0E-7 dl_grid_model_14</span>
<span class="co">#&gt; 2 [64, 64]                 0.0 0.02         1.0E-6 dl_grid_model_22</span>
<span class="co">#&gt; 3 [64, 64]                 0.0 0.01         1.0E-6 dl_grid_model_18</span>
<span class="co">#&gt; 4 [64, 64]                0.05 0.01         1.0E-7 dl_grid_model_12</span>
<span class="co">#&gt; 5 [64, 64]                 0.0 0.01         1.0E-8  dl_grid_model_2</span>
<span class="co">#&gt;              logloss</span>
<span class="co">#&gt; 1 0.5717452314439635</span>
<span class="co">#&gt; 2 0.5723938262306084</span>
<span class="co">#&gt; 3  0.578766555692541</span>
<span class="co">#&gt; 4 0.5839318932912395</span>
<span class="co">#&gt; 5 0.5909614970189161</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;          hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 19 [32, 32, 32]                 0.0 0.02         1.0E-6 dl_grid_model_21</span>
<span class="co">#&gt; 20 [32, 32, 32]                0.05 0.02         1.0E-6 dl_grid_model_23</span>
<span class="co">#&gt; 21 [32, 32, 32]                 0.0 0.01         1.0E-8  dl_grid_model_1</span>
<span class="co">#&gt; 22 [32, 32, 32]                 0.0 0.01         1.0E-6 dl_grid_model_17</span>
<span class="co">#&gt; 23 [32, 32, 32]                 0.0 0.02         1.0E-8  dl_grid_model_5</span>
<span class="co">#&gt; 24 [32, 32, 32]                 0.0 0.02         1.0E-7 dl_grid_model_13</span>
<span class="co">#&gt;               logloss</span>
<span class="co">#&gt; 19 0.6232799684359932</span>
<span class="co">#&gt; 20 0.6252295717620697</span>
<span class="co">#&gt; 21 0.6361708020687168</span>
<span class="co">#&gt; 22 0.6393453687970879</span>
<span class="co">#&gt; 23 0.6409564453678517</span>
<span class="co">#&gt; 24 0.6696074266255975</span>

<span class="co">## Find the best model and its full set of parameters</span>
<span class="va">grid</span><span class="op">@</span><span class="va">summary_table</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>
<span class="co">#&gt; Hyper-Parameter Search Summary: ordered by increasing err</span>
<span class="co">#&gt;     hidden input_dropout_ratio rate rate_annealing        model_ids</span>
<span class="co">#&gt; 1 [64, 64]                 0.0 0.02         1.0E-6 dl_grid_model_22</span>
<span class="co">#&gt;                   err</span>
<span class="co">#&gt; 1 0.24200501253132833</span>
<span class="va">best_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getModel.html">h2o.getModel</a></span><span class="op">(</span><span class="va">grid</span><span class="op">@</span><span class="va">model_ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">best_model</span>
<span class="co">#&gt; Model Details:</span>
<span class="co">#&gt; ==============</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialModel: deeplearning</span>
<span class="co">#&gt; Model ID:  dl_grid_model_22 </span>
<span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 8,263 weights/biases, 72.2 KB, 100,000 training samples, mini-batch size 1</span>
<span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span>
<span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span>
<span class="co">#&gt; 2     2    64 Rectifier  0.00 % 0.000010 0.000010  0.018182 0.000000 0.504000</span>
<span class="co">#&gt; 3     3    64 Rectifier  0.00 % 0.000010 0.000010  0.018182 0.000000 0.504000</span>
<span class="co">#&gt; 4     4     7   Softmax      NA 0.000010 0.000010  0.018182 0.000000 0.504000</span>
<span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span>
<span class="co">#&gt; 1          NA         NA        NA       NA</span>
<span class="co">#&gt; 2   -0.022210   0.274555 -0.135699 0.240294</span>
<span class="co">#&gt; 3   -0.095881   0.220183  0.736373 0.239315</span>
<span class="co">#&gt; 4    0.006550   0.391448  0.004610 1.113434</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on training data. **</span>
<span class="co">#&gt; ** Metrics reported on full training frame **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Training Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Extract training frame with `h2o.getFrame("RTMP_sid_b902_9")`</span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.163</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.403</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.5</span>
<span class="co">#&gt; Mean Per-Class Error: 0.404</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2606    1002       0       0       3       2      75 0.2934</span>
<span class="co">#&gt; class_2     496    4268      37       0      13      17       4 0.1173</span>
<span class="co">#&gt; class_3       0      58     491       4       0      77       0 0.2206</span>
<span class="co">#&gt; class_4       0       0      26      15       0       3       0 0.6591</span>
<span class="co">#&gt; class_5       8     107       1       0      39       1       0 0.7500</span>
<span class="co">#&gt; class_6       0      71     109       0       0     129       0 0.5825</span>
<span class="co">#&gt; class_7      67       2       0       0       0       0     269 0.2041</span>
<span class="co">#&gt; Totals     3177    5508     664      19      55     229     348 0.2183</span>
<span class="co">#&gt;                     Rate</span>
<span class="co">#&gt; class_1 =  1,082 / 3,688</span>
<span class="co">#&gt; class_2 =    567 / 4,835</span>
<span class="co">#&gt; class_3 =      139 / 630</span>
<span class="co">#&gt; class_4 =        29 / 44</span>
<span class="co">#&gt; class_5 =      117 / 156</span>
<span class="co">#&gt; class_6 =      180 / 309</span>
<span class="co">#&gt; class_7 =       69 / 338</span>
<span class="co">#&gt; Totals  = 2,183 / 10,000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.781700</span>
<span class="co">#&gt; 2 2  0.980400</span>
<span class="co">#&gt; 3 3  0.997000</span>
<span class="co">#&gt; 4 4  0.999000</span>
<span class="co">#&gt; 5 5  0.999900</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 9975 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.182</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.427</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.572</span>
<span class="co">#&gt; Mean Per-Class Error: 0.455</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2552    1066       0       0       6       1      80 0.3112</span>
<span class="co">#&gt; class_2     544    4172      52       0      18      20       7 0.1332</span>
<span class="co">#&gt; class_3       0      83     437       0       0      84       0 0.2765</span>
<span class="co">#&gt; class_4       0       0      36      14       0       3       0 0.7358</span>
<span class="co">#&gt; class_5       5     121       5       0      31       0       0 0.8086</span>
<span class="co">#&gt; class_6       0      84     124       0       0      89       0 0.7003</span>
<span class="co">#&gt; class_7      72       3       0       0       0       0     266 0.2199</span>
<span class="co">#&gt; Totals     3173    5529     654      14      55     197     353 0.2420</span>
<span class="co">#&gt;                    Rate</span>
<span class="co">#&gt; class_1 = 1,153 / 3,705</span>
<span class="co">#&gt; class_2 =   641 / 4,813</span>
<span class="co">#&gt; class_3 =     167 / 604</span>
<span class="co">#&gt; class_4 =       39 / 53</span>
<span class="co">#&gt; class_5 =     131 / 162</span>
<span class="co">#&gt; class_6 =     208 / 297</span>
<span class="co">#&gt; class_7 =      75 / 341</span>
<span class="co">#&gt; Totals  = 2,414 / 9,975</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.757995</span>
<span class="co">#&gt; 2 2  0.970727</span>
<span class="co">#&gt; 3 3  0.995789</span>
<span class="co">#&gt; 4 4  0.998998</span>
<span class="co">#&gt; 5 5  0.999800</span>
<span class="co">#&gt; 6 6  0.999900</span>
<span class="co">#&gt; 7 7  1.000000</span>

<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">best_model</span><span class="op">@</span><span class="va">allparameters</span><span class="op">)</span>
<span class="co">#&gt; $model_id</span>
<span class="co">#&gt; [1] "dl_grid_model_22"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $training_frame</span>
<span class="co">#&gt; [1] "RTMP_sid_b902_9"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $validation_frame</span>
<span class="co">#&gt; [1] "valid.hex"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nfolds</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $keep_cross_validation_models</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $keep_cross_validation_predictions</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $keep_cross_validation_fold_assignment</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fold_assignment</span>
<span class="co">#&gt; [1] "AUTO"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ignore_const_cols</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_each_iteration</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $balance_classes</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_after_balance_size</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_confusion_matrix_size</span>
<span class="co">#&gt; [1] 20</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_hit_ratio_k</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $overwrite_with_best_model</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $use_all_factor_levels</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $standardize</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $activation</span>
<span class="co">#&gt; [1] "Rectifier"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $hidden</span>
<span class="co">#&gt; [1] 64 64</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $epochs</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $train_samples_per_iteration</span>
<span class="co">#&gt; [1] -2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $target_ratio_comm_to_comp</span>
<span class="co">#&gt; [1] 0.05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $seed</span>
<span class="co">#&gt; [1] "8894640457857559116"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $adaptive_rate</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rho</span>
<span class="co">#&gt; [1] 0.99</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $epsilon</span>
<span class="co">#&gt; [1] 1e-08</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rate</span>
<span class="co">#&gt; [1] 0.02</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rate_annealing</span>
<span class="co">#&gt; [1] 1e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rate_decay</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $momentum_start</span>
<span class="co">#&gt; [1] 0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $momentum_ramp</span>
<span class="co">#&gt; [1] 1e+07</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $momentum_stable</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nesterov_accelerated_gradient</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $input_dropout_ratio</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $l1</span>
<span class="co">#&gt; [1] 1e-05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $l2</span>
<span class="co">#&gt; [1] 1e-05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_w2</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $initial_weight_distribution</span>
<span class="co">#&gt; [1] "UniformAdaptive"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $initial_weight_scale</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $loss</span>
<span class="co">#&gt; [1] "Automatic"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $distribution</span>
<span class="co">#&gt; [1] "AUTO"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $quantile_alpha</span>
<span class="co">#&gt; [1] 0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tweedie_power</span>
<span class="co">#&gt; [1] 1.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $huber_alpha</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_interval</span>
<span class="co">#&gt; [1] 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_training_samples</span>
<span class="co">#&gt; [1] 10000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_validation_samples</span>
<span class="co">#&gt; [1] 10000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_duty_cycle</span>
<span class="co">#&gt; [1] 0.025</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $classification_stop</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $regression_stop</span>
<span class="co">#&gt; [1] 1e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stopping_rounds</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stopping_metric</span>
<span class="co">#&gt; [1] "misclassification"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $stopping_tolerance</span>
<span class="co">#&gt; [1] 0.01</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_runtime_secs</span>
<span class="co">#&gt; [1] 1.8e+308</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $score_validation_sampling</span>
<span class="co">#&gt; [1] "Uniform"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $diagnostics</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $fast_mode</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $force_load_balance</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $variable_importances</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $replicate_training_data</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $single_node_mode</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $shuffle_training_data</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $missing_values_handling</span>
<span class="co">#&gt; [1] "MeanImputation"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $quiet_mode</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $autoencoder</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sparse</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $col_major</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $average_activation</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sparsity_beta</span>
<span class="co">#&gt; [1] 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max_categorical_features</span>
<span class="co">#&gt; [1] 2147483647</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $reproducible</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $export_weights_and_biases</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mini_batch_size</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $categorical_encoding</span>
<span class="co">#&gt; [1] "AUTO"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $elastic_averaging</span>
<span class="co">#&gt; [1] FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $elastic_averaging_moving_rate</span>
<span class="co">#&gt; [1] 0.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $elastic_averaging_regularization</span>
<span class="co">#&gt; [1] 0.001</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt;  [1] "Soil_Type"                          "Wilderness_Area"                   </span>
<span class="co">#&gt;  [3] "Elevation"                          "Aspect"                            </span>
<span class="co">#&gt;  [5] "Slope"                              "Horizontal_Distance_To_Hydrology"  </span>
<span class="co">#&gt;  [7] "Vertical_Distance_To_Hydrology"     "Horizontal_Distance_To_Roadways"   </span>
<span class="co">#&gt;  [9] "Hillshade_9am"                      "Hillshade_Noon"                    </span>
<span class="co">#&gt; [11] "Hillshade_3pm"                      "Horizontal_Distance_To_Fire_Points"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $y</span>
<span class="co">#&gt; [1] "Cover_Type"</span>
<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">best_model</span>, valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 9975 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.182</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.427</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.572</span>
<span class="co">#&gt; Mean Per-Class Error: 0.455</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2552    1066       0       0       6       1      80 0.3112</span>
<span class="co">#&gt; class_2     544    4172      52       0      18      20       7 0.1332</span>
<span class="co">#&gt; class_3       0      83     437       0       0      84       0 0.2765</span>
<span class="co">#&gt; class_4       0       0      36      14       0       3       0 0.7358</span>
<span class="co">#&gt; class_5       5     121       5       0      31       0       0 0.8086</span>
<span class="co">#&gt; class_6       0      84     124       0       0      89       0 0.7003</span>
<span class="co">#&gt; class_7      72       3       0       0       0       0     266 0.2199</span>
<span class="co">#&gt; Totals     3173    5529     654      14      55     197     353 0.2420</span>
<span class="co">#&gt;                    Rate</span>
<span class="co">#&gt; class_1 = 1,153 / 3,705</span>
<span class="co">#&gt; class_2 =   641 / 4,813</span>
<span class="co">#&gt; class_3 =     167 / 604</span>
<span class="co">#&gt; class_4 =       39 / 53</span>
<span class="co">#&gt; class_5 =     131 / 162</span>
<span class="co">#&gt; class_6 =     208 / 297</span>
<span class="co">#&gt; class_7 =      75 / 341</span>
<span class="co">#&gt; Totals  = 2,414 / 9,975</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.757995</span>
<span class="co">#&gt; 2 2  0.970727</span>
<span class="co">#&gt; 3 3  0.995789</span>
<span class="co">#&gt; 4 4  0.998998</span>
<span class="co">#&gt; 5 5  0.999800</span>
<span class="co">#&gt; 6 6  0.999900</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.logloss.html">h2o.logloss</a></span><span class="op">(</span><span class="va">best_model</span>, valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.572</span></code></pre></div>
</div>
<div id="random-hyper-parameter-search" class="section level3">
<h3>
<span class="header-section-number">44.5.7</span> Random Hyper-Parameter Search<a class="anchor" aria-label="anchor" href="#random-hyper-parameter-search"><i class="fas fa-link"></i></a>
</h3>
<p>Often, hyper-parameter search for more than 4 parameters can be done more efficiently with random parameter search than with grid search. Basically, chances are good to find one of many good models in less time than performing an exhaustive grid search. We simply build up to max_models models with parameters drawn randomly from user-specified distributions (here, uniform). For this example, we use the adaptive learning rate and focus on tuning the network architecture and the regularization parameters. We also let the grid search stop automatically once the performance at the top of the leaderboard doesn’t change much anymore, i.e., once the search has converged.</p>
<div class="sourceCode" id="cb1021"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hyper_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  activation<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rectifier"</span>,<span class="st">"Tanh"</span>,<span class="st">"Maxout"</span>,<span class="st">"RectifierWithDropout"</span>,<span class="st">"TanhWithDropout"</span>,<span class="st">"MaxoutWithDropout"</span><span class="op">)</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">50</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">30</span>,<span class="fl">30</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span>,<span class="fl">25</span><span class="op">)</span><span class="op">)</span>,
  input_dropout_ratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.05</span><span class="op">)</span>,
  l1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-4</span>,<span class="fl">1e-6</span><span class="op">)</span>,
  l2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1e-4</span>,<span class="fl">1e-6</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">hyper_params</span>

<span class="co">## Stop once the top 5 models are within 1% of each other (i.e., the windowed average varies less than 1%)</span>
<span class="va">search_criteria</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>strategy <span class="op">=</span> <span class="st">"RandomDiscrete"</span>, max_runtime_secs <span class="op">=</span> <span class="fl">360</span>, max_models <span class="op">=</span> <span class="fl">100</span>, seed<span class="op">=</span><span class="fl">1234567</span>, stopping_rounds<span class="op">=</span><span class="fl">5</span>, stopping_tolerance<span class="op">=</span><span class="fl">1e-2</span><span class="op">)</span>
<span class="va">dl_random_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.grid.html">h2o.grid</a></span><span class="op">(</span>
  algorithm<span class="op">=</span><span class="st">"deeplearning"</span>,
  grid_id <span class="op">=</span> <span class="st">"dl_grid_random"</span>,
  training_frame<span class="op">=</span><span class="va">sampled_train</span>,
  validation_frame<span class="op">=</span><span class="va">valid</span>, 
  x<span class="op">=</span><span class="va">predictors</span>, 
  y<span class="op">=</span><span class="va">response</span>,
  epochs<span class="op">=</span><span class="fl">1</span>,
  stopping_metric<span class="op">=</span><span class="st">"logloss"</span>,
  stopping_tolerance<span class="op">=</span><span class="fl">1e-2</span>,        <span class="co">## stop when logloss does not improve by &gt;=1% for 2 scoring events</span>
  stopping_rounds<span class="op">=</span><span class="fl">2</span>,
  score_validation_samples<span class="op">=</span><span class="fl">10000</span>, <span class="co">## downsample validation set for faster scoring</span>
  score_duty_cycle<span class="op">=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span>
  max_w2<span class="op">=</span><span class="fl">10</span>,                      <span class="co">## can help improve stability for Rectifier</span>
  hyper_params <span class="op">=</span> <span class="va">hyper_params</span>,
  search_criteria <span class="op">=</span> <span class="va">search_criteria</span>
<span class="op">)</span>                                
<span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid_random"</span>,sort_by<span class="op">=</span><span class="st">"logloss"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">grid</span>

<span class="va">grid</span><span class="op">@</span><span class="va">summary_table</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>
<span class="va">best_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getModel.html">h2o.getModel</a></span><span class="op">(</span><span class="va">grid</span><span class="op">@</span><span class="va">model_ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">## model with lowest logloss</span>
<span class="va">best_model</span></code></pre></div>
<p>Let’s look at the model with the lowest validation misclassification rate:</p>
<div class="sourceCode" id="cb1022"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getGrid.html">h2o.getGrid</a></span><span class="op">(</span><span class="st">"dl_grid"</span>,sort_by<span class="op">=</span><span class="st">"err"</span>,decreasing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">best_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.getModel.html">h2o.getModel</a></span><span class="op">(</span><span class="va">grid</span><span class="op">@</span><span class="va">model_ids</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">## model with lowest classification error (on validation, since it was available during training)</span>
<span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.confusionMatrix.html">h2o.confusionMatrix</a></span><span class="op">(</span><span class="va">best_model</span>,valid<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    2552    1066       0       0       6       1      80 0.3112</span>
<span class="co">#&gt; class_2     544    4172      52       0      18      20       7 0.1332</span>
<span class="co">#&gt; class_3       0      83     437       0       0      84       0 0.2765</span>
<span class="co">#&gt; class_4       0       0      36      14       0       3       0 0.7358</span>
<span class="co">#&gt; class_5       5     121       5       0      31       0       0 0.8086</span>
<span class="co">#&gt; class_6       0      84     124       0       0      89       0 0.7003</span>
<span class="co">#&gt; class_7      72       3       0       0       0       0     266 0.2199</span>
<span class="co">#&gt; Totals     3173    5529     654      14      55     197     353 0.2420</span>
<span class="co">#&gt;                    Rate</span>
<span class="co">#&gt; class_1 = 1,153 / 3,705</span>
<span class="co">#&gt; class_2 =   641 / 4,813</span>
<span class="co">#&gt; class_3 =     167 / 604</span>
<span class="co">#&gt; class_4 =       39 / 53</span>
<span class="co">#&gt; class_5 =     131 / 162</span>
<span class="co">#&gt; class_6 =     208 / 297</span>
<span class="co">#&gt; class_7 =      75 / 341</span>
<span class="co">#&gt; Totals  = 2,414 / 9,975</span>
<span class="va">best_params</span> <span class="op">&lt;-</span> <span class="va">best_model</span><span class="op">@</span><span class="va">allparameters</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">activation</span>
<span class="co">#&gt; [1] "Rectifier"</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">hidden</span>
<span class="co">#&gt; [1] 64 64</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">input_dropout_ratio</span>
<span class="co">#&gt; [1] 0</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">l1</span>
<span class="co">#&gt; [1] 1e-05</span>
<span class="va">best_params</span><span class="op">$</span><span class="va">l2</span>
<span class="co">#&gt; [1] 1e-05</span></code></pre></div>
</div>
<div id="checkpointing" class="section level3">
<h3>
<span class="header-section-number">44.5.8</span> Checkpointing<a class="anchor" aria-label="anchor" href="#checkpointing"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s continue training the manually tuned model from before, for 2 more epochs. Note that since many important parameters such as epochs, l1, l2, max_w2, score_interval, train_samples_per_iteration, input_dropout_ratio, hidden_dropout_ratios, score_duty_cycle, classification_stop, regression_stop, variable_importances, force_load_balance can be modified between checkpoint restarts, it is best to specify as many parameters as possible explicitly.</p>
<div class="sourceCode" id="cb1023"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">max_epochs</span> <span class="op">&lt;-</span> <span class="fl">12</span> <span class="co">## Add two more epochs</span>
<span class="va">m_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  model_id<span class="op">=</span><span class="st">"dl_model_tuned_continued"</span>, 
  checkpoint<span class="op">=</span><span class="st">"dl_model_tuned"</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>, 
  validation_frame<span class="op">=</span><span class="va">valid</span>, 
  x<span class="op">=</span><span class="va">predictors</span>, 
  y<span class="op">=</span><span class="va">response</span>, 
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">128</span>,<span class="fl">128</span>,<span class="fl">128</span><span class="op">)</span>,          <span class="co">## more hidden layers -&gt; more complex interactions</span>
  epochs<span class="op">=</span><span class="va">max_epochs</span>,              <span class="co">## hopefully long enough to converge (otherwise restart again)</span>
  stopping_metric<span class="op">=</span><span class="st">"logloss"</span>,      <span class="co">## logloss is directly optimized by Deep Learning</span>
  stopping_tolerance<span class="op">=</span><span class="fl">1e-2</span>,        <span class="co">## stop when validation logloss does not improve by &gt;=1% for 2 scoring events</span>
  stopping_rounds<span class="op">=</span><span class="fl">2</span>,
  score_validation_samples<span class="op">=</span><span class="fl">10000</span>, <span class="co">## downsample validation set for faster scoring</span>
  score_duty_cycle<span class="op">=</span><span class="fl">0.025</span>,         <span class="co">## don't score more than 2.5% of the wall time</span>
  adaptive_rate<span class="op">=</span><span class="cn">F</span>,                <span class="co">## manually tuned learning rate</span>
  rate<span class="op">=</span><span class="fl">0.01</span>, 
  rate_annealing<span class="op">=</span><span class="fl">2e-6</span>,            
  momentum_start<span class="op">=</span><span class="fl">0.2</span>,             <span class="co">## manually tuned momentum</span>
  momentum_stable<span class="op">=</span><span class="fl">0.4</span>, 
  momentum_ramp<span class="op">=</span><span class="fl">1e7</span>, 
  l1<span class="op">=</span><span class="fl">1e-5</span>,                        <span class="co">## add some L1/L2 regularization</span>
  l2<span class="op">=</span><span class="fl">1e-5</span>,
  max_w2<span class="op">=</span><span class="fl">10</span>                       <span class="co">## helps stability for Rectifier</span>
<span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m_cont</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">m_cont</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/checpointing-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Once we are satisfied with the results, we can save the model to disk (on the cluster). In this example, we store the model in a directory called <code>mybest_deeplearning_covtype_model</code>, which will be created for us since force=TRUE.</p>
<div class="sourceCode" id="cb1024"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.saveModel.html">h2o.saveModel</a></span><span class="op">(</span><span class="va">m_cont</span>, 
          path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_out_dir</span>, <span class="st">"mybest_deeplearning_covtype_model"</span><span class="op">)</span>, force<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>It can be loaded later with the following command:</p>
<div class="sourceCode" id="cb1025"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>
<span class="co">#&gt; [1] "/home/rstudio/all/output/data/mybest_deeplearning_covtype_model/dl_model_tuned_continued"</span>
<span class="va">m_loaded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.loadModel.html">h2o.loadModel</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m_loaded</span><span class="op">)</span>
<span class="co">#&gt; Model Details:</span>
<span class="co">#&gt; ==============</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialModel: deeplearning</span>
<span class="co">#&gt; Model Key:  dl_model_tuned_continued </span>
<span class="co">#&gt; Status of Neuron Layers: predicting Cover_Type, 7-class classification, multinomial distribution, CrossEntropy loss, 41,223 weights/biases, 333.0 KB, 4,198,790 training samples, mini-batch size 1</span>
<span class="co">#&gt;   layer units      type dropout       l1       l2 mean_rate rate_rms momentum</span>
<span class="co">#&gt; 1     1    56     Input  0.00 %       NA       NA        NA       NA       NA</span>
<span class="co">#&gt; 2     2   128 Rectifier  0.00 % 0.000010 0.000010  0.001064 0.000000 0.283976</span>
<span class="co">#&gt; 3     3   128 Rectifier  0.00 % 0.000010 0.000010  0.001064 0.000000 0.283976</span>
<span class="co">#&gt; 4     4   128 Rectifier  0.00 % 0.000010 0.000010  0.001064 0.000000 0.283976</span>
<span class="co">#&gt; 5     5     7   Softmax      NA 0.000010 0.000010  0.001064 0.000000 0.283976</span>
<span class="co">#&gt;   mean_weight weight_rms mean_bias bias_rms</span>
<span class="co">#&gt; 1          NA         NA        NA       NA</span>
<span class="co">#&gt; 2   -0.014361   0.328490 -0.042285 0.278615</span>
<span class="co">#&gt; 3   -0.053000   0.227848  0.944773 0.383519</span>
<span class="co">#&gt; 4   -0.062588   0.217068  0.818615 0.162429</span>
<span class="co">#&gt; 5   -0.017631   0.270582  0.029891 0.943480</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on training data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary training frame with 9954 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Training Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0543</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.233</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.177</span>
<span class="co">#&gt; Mean Per-Class Error: 0.131</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3352     281       0       0       0       0      20 0.0824</span>
<span class="co">#&gt; class_2     222    4570       7       0      18      11       1 0.0536</span>
<span class="co">#&gt; class_3       0      13     534       6       2      34       0 0.0934</span>
<span class="co">#&gt; class_4       0       0       8      33       0       4       0 0.2667</span>
<span class="co">#&gt; class_5       3      36       1       0     142       0       0 0.2198</span>
<span class="co">#&gt; class_6       4      11      24       1       0     274       0 0.1274</span>
<span class="co">#&gt; class_7      23       2       0       0       0       0     317 0.0731</span>
<span class="co">#&gt; Totals     3604    4913     574      40     162     323     338 0.0735</span>
<span class="co">#&gt;                  Rate</span>
<span class="co">#&gt; class_1 = 301 / 3,653</span>
<span class="co">#&gt; class_2 = 259 / 4,829</span>
<span class="co">#&gt; class_3 =    55 / 589</span>
<span class="co">#&gt; class_4 =     12 / 45</span>
<span class="co">#&gt; class_5 =    40 / 182</span>
<span class="co">#&gt; class_6 =    40 / 314</span>
<span class="co">#&gt; class_7 =    25 / 342</span>
<span class="co">#&gt; Totals  = 732 / 9,954</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.926462</span>
<span class="co">#&gt; 2 2  0.997689</span>
<span class="co">#&gt; 3 3  0.999900</span>
<span class="co">#&gt; 4 4  1.000000</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; H2OMultinomialMetrics: deeplearning</span>
<span class="co">#&gt; ** Reported on validation data. **</span>
<span class="co">#&gt; ** Metrics reported on temporary validation frame with 10014 samples **</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Validation Set Metrics: </span>
<span class="co">#&gt; =====================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; MSE: (Extract with `h2o.mse`) 0.0593</span>
<span class="co">#&gt; RMSE: (Extract with `h2o.rmse`) 0.244</span>
<span class="co">#&gt; Logloss: (Extract with `h2o.logloss`) 0.199</span>
<span class="co">#&gt; Mean Per-Class Error: 0.133</span>
<span class="co">#&gt; Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,valid = TRUE)`)</span>
<span class="co">#&gt; =========================================================================</span>
<span class="co">#&gt; Confusion Matrix: Row labels: Actual class; Column labels: Predicted class</span>
<span class="co">#&gt;         class_1 class_2 class_3 class_4 class_5 class_6 class_7  Error</span>
<span class="co">#&gt; class_1    3315     284       0       0       3       0      13 0.0830</span>
<span class="co">#&gt; class_2     235    4608      14       0      20      13       3 0.0582</span>
<span class="co">#&gt; class_3       1      23     555       4       2      29       0 0.0961</span>
<span class="co">#&gt; class_4       0       0       6      38       0       5       0 0.2245</span>
<span class="co">#&gt; class_5       8      35       3       0     124       0       0 0.2706</span>
<span class="co">#&gt; class_6       1      21      21       1       0     269       0 0.1406</span>
<span class="co">#&gt; class_7      19       2       0       0       1       0     338 0.0611</span>
<span class="co">#&gt; Totals     3579    4973     599      43     150     316     354 0.0766</span>
<span class="co">#&gt;                   Rate</span>
<span class="co">#&gt; class_1 =  300 / 3,615</span>
<span class="co">#&gt; class_2 =  285 / 4,893</span>
<span class="co">#&gt; class_3 =     59 / 614</span>
<span class="co">#&gt; class_4 =      11 / 49</span>
<span class="co">#&gt; class_5 =     46 / 170</span>
<span class="co">#&gt; class_6 =     44 / 313</span>
<span class="co">#&gt; class_7 =     22 / 360</span>
<span class="co">#&gt; Totals  = 767 / 10,014</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,valid = TRUE)`</span>
<span class="co">#&gt; =======================================================================</span>
<span class="co">#&gt; Top-7 Hit Ratios: </span>
<span class="co">#&gt;   k hit_ratio</span>
<span class="co">#&gt; 1 1  0.923407</span>
<span class="co">#&gt; 2 2  0.995706</span>
<span class="co">#&gt; 3 3  0.999700</span>
<span class="co">#&gt; 4 4  1.000000</span>
<span class="co">#&gt; 5 5  1.000000</span>
<span class="co">#&gt; 6 6  1.000000</span>
<span class="co">#&gt; 7 7  1.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Scoring History: </span>
<span class="co">#&gt;              timestamp          duration training_speed   epochs iterations</span>
<span class="co">#&gt; 1  2020-11-18 08:17:37         0.000 sec             NA  0.00000          0</span>
<span class="co">#&gt; 2  2020-11-18 08:17:42         5.542 sec  19082 obs/sec  0.28628          1</span>
<span class="co">#&gt; 3  2020-11-18 08:17:54        17.027 sec  24304 obs/sec  1.14706          4</span>
<span class="co">#&gt; 4  2020-11-18 08:18:04        27.496 sec  26166 obs/sec  2.00480          7</span>
<span class="co">#&gt; 5  2020-11-18 08:18:14        37.605 sec  27275 obs/sec  2.86432         10</span>
<span class="co">#&gt; 6  2020-11-18 08:18:24        47.614 sec  27964 obs/sec  3.72169         13</span>
<span class="co">#&gt; 7  2020-11-18 08:18:34        57.570 sec  28462 obs/sec  4.58375         16</span>
<span class="co">#&gt; 8  2020-11-18 08:18:44  1 min  7.661 sec  28755 obs/sec  5.44578         19</span>
<span class="co">#&gt; 9  2020-11-18 08:18:54  1 min 17.651 sec  28996 obs/sec  6.30451         22</span>
<span class="co">#&gt; 10 2020-11-18 08:19:05  1 min 28.383 sec  29011 obs/sec  7.16317         25</span>
<span class="co">#&gt; 11 2020-11-18 08:19:25  1 min 48.393 sec  29249 obs/sec  8.88186         31</span>
<span class="co">#&gt; 12 2020-11-18 08:19:35  1 min 58.534 sec  29327 obs/sec  9.73987         34</span>
<span class="co">#&gt; 13 2020-11-18 08:19:39  2 min  1.980 sec  29366 obs/sec 10.02549         35</span>
<span class="co">#&gt; 14 2020-11-18 08:20:43  2 min  5.489 sec  29396 obs/sec 10.31169         36</span>
<span class="co">#&gt; 15 2020-11-18 08:20:53  2 min 15.380 sec  29511 obs/sec 11.17123         39</span>
<span class="co">#&gt; 16 2020-11-18 08:21:03  2 min 25.301 sec  29602 obs/sec 12.03040         42</span>
<span class="co">#&gt;           samples training_rmse training_logloss training_r2</span>
<span class="co">#&gt; 1        0.000000            NA               NA          NA</span>
<span class="co">#&gt; 2    99915.000000       0.42710          0.56043     0.90223</span>
<span class="co">#&gt; 3   400341.000000       0.35198          0.39035     0.93360</span>
<span class="co">#&gt; 4   699706.000000       0.32226          0.33312     0.94434</span>
<span class="co">#&gt; 5   999690.000000       0.31503          0.31987     0.94681</span>
<span class="co">#&gt; 6  1298925.000000       0.28070          0.25799     0.95777</span>
<span class="co">#&gt; 7  1599797.000000       0.27686          0.25114     0.95892</span>
<span class="co">#&gt; 8  1900660.000000       0.26993          0.24083     0.96095</span>
<span class="co">#&gt; 9  2200369.000000       0.25845          0.21907     0.96420</span>
<span class="co">#&gt; 10 2500054.000000       0.24942          0.20769     0.96666</span>
<span class="co">#&gt; 11 3099901.000000       0.23464          0.18430     0.97049</span>
<span class="co">#&gt; 12 3399361.000000       0.23711          0.18862     0.96987</span>
<span class="co">#&gt; 13 3499045.000000       0.23237          0.18214     0.97106</span>
<span class="co">#&gt; 14 3598936.000000       0.23483          0.18245     0.97200</span>
<span class="co">#&gt; 15 3898928.000000       0.23135          0.17761     0.97282</span>
<span class="co">#&gt; 16 4198790.000000       0.23297          0.17724     0.97244</span>
<span class="co">#&gt;    training_classification_error validation_rmse validation_logloss</span>
<span class="co">#&gt; 1                             NA              NA                 NA</span>
<span class="co">#&gt; 2                        0.24002         0.42640            0.55683</span>
<span class="co">#&gt; 3                        0.16685         0.35638            0.39999</span>
<span class="co">#&gt; 4                        0.13888         0.32719            0.34145</span>
<span class="co">#&gt; 5                        0.13201         0.31887            0.32861</span>
<span class="co">#&gt; 6                        0.10393         0.28934            0.27570</span>
<span class="co">#&gt; 7                        0.10184         0.28428            0.26652</span>
<span class="co">#&gt; 8                        0.09597         0.27747            0.25583</span>
<span class="co">#&gt; 9                        0.08950         0.26544            0.23226</span>
<span class="co">#&gt; 10                       0.08123         0.26327            0.23057</span>
<span class="co">#&gt; 11                       0.07227         0.25048            0.20793</span>
<span class="co">#&gt; 12                       0.07347         0.25329            0.21252</span>
<span class="co">#&gt; 13                       0.07078         0.24673            0.20320</span>
<span class="co">#&gt; 14                       0.07113         0.24904            0.20854</span>
<span class="co">#&gt; 15                       0.07193         0.24561            0.20187</span>
<span class="co">#&gt; 16                       0.07354         0.24350            0.19886</span>
<span class="co">#&gt;    validation_r2 validation_classification_error</span>
<span class="co">#&gt; 1             NA                              NA</span>
<span class="co">#&gt; 2        0.90927                         0.24317</span>
<span class="co">#&gt; 3        0.93662                         0.17092</span>
<span class="co">#&gt; 4        0.94658                         0.14389</span>
<span class="co">#&gt; 5        0.94926                         0.13743</span>
<span class="co">#&gt; 6        0.95822                         0.11249</span>
<span class="co">#&gt; 7        0.95967                         0.10534</span>
<span class="co">#&gt; 8        0.96158                         0.10116</span>
<span class="co">#&gt; 9        0.96484                         0.09272</span>
<span class="co">#&gt; 10       0.96541                         0.08864</span>
<span class="co">#&gt; 11       0.96869                         0.08417</span>
<span class="co">#&gt; 12       0.96799                         0.08576</span>
<span class="co">#&gt; 13       0.96962                         0.08129</span>
<span class="co">#&gt; 14       0.96882                         0.08189</span>
<span class="co">#&gt; 15       0.96967                         0.07979</span>
<span class="co">#&gt; 16       0.97019                         0.07659</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variable Importances: (Extract with `h2o.varimp`) </span>
<span class="co">#&gt; =================================================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variable Importances: </span>
<span class="co">#&gt;                             variable relative_importance scaled_importance</span>
<span class="co">#&gt; 1                          Elevation            1.000000          1.000000</span>
<span class="co">#&gt; 2    Horizontal_Distance_To_Roadways            0.952188          0.952188</span>
<span class="co">#&gt; 3 Horizontal_Distance_To_Fire_Points            0.904541          0.904541</span>
<span class="co">#&gt; 4             Wilderness_Area.area_0            0.719598          0.719598</span>
<span class="co">#&gt; 5   Horizontal_Distance_To_Hydrology            0.611858          0.611858</span>
<span class="co">#&gt;   percentage</span>
<span class="co">#&gt; 1   0.048804</span>
<span class="co">#&gt; 2   0.046471</span>
<span class="co">#&gt; 3   0.044145</span>
<span class="co">#&gt; 4   0.035119</span>
<span class="co">#&gt; 5   0.029861</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;                       variable relative_importance scaled_importance percentage</span>
<span class="co">#&gt; 51            Soil_Type.type_7            0.159459          0.159459   0.007782</span>
<span class="co">#&gt; 52           Soil_Type.type_24            0.155227          0.155227   0.007576</span>
<span class="co">#&gt; 53            Soil_Type.type_6            0.149235          0.149235   0.007283</span>
<span class="co">#&gt; 54                      Aspect            0.143355          0.143355   0.006996</span>
<span class="co">#&gt; 55       Soil_Type.missing(NA)            0.000000          0.000000   0.000000</span>
<span class="co">#&gt; 56 Wilderness_Area.missing(NA)            0.000000          0.000000   0.000000</span></code></pre></div>
<p>This model is fully functional and can be inspected, restarted, or used to score a dataset, etc. Note that binary compatibility between H2O versions is currently not guaranteed.</p>
</div>
<div id="cross-validation" class="section level3">
<h3>
<span class="header-section-number">44.5.9</span> Cross-Validation<a class="anchor" aria-label="anchor" href="#cross-validation"><i class="fas fa-link"></i></a>
</h3>
<p>For N-fold cross-validation, specify <code>nfolds&gt;1</code> instead of (or in addition to) a validation frame, and <code>N+1</code> models will be built: 1 model on the full training data, and N models with each 1/N-th of the data held out (there are different holdout strategies). Those N models then score on the held out data, and their combined predictions on the full training data are scored to get the cross-validation metrics.</p>
<div class="sourceCode" id="cb1026"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dlmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  x<span class="op">=</span><span class="va">predictors</span>,
  y<span class="op">=</span><span class="va">response</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
  epochs<span class="op">=</span><span class="fl">1</span>,
  nfolds<span class="op">=</span><span class="fl">5</span>,
  fold_assignment<span class="op">=</span><span class="st">"Modulo"</span> <span class="co"># can be "AUTO", "Modulo", "Random" or "Stratified"</span>
  <span class="op">)</span>
<span class="va">dlmodel</span></code></pre></div>
<p>N-fold cross-validation is especially useful with early stopping, as the main model will pick the ideal number of epochs from the convergence behavior of the cross-validation models.</p>
</div>
</div>
<div id="regression-and-binary-classification" class="section level2">
<h2>
<span class="header-section-number">44.6</span> Regression and Binary Classification<a class="anchor" aria-label="anchor" href="#regression-and-binary-classification"><i class="fas fa-link"></i></a>
</h2>
<p>Assume we want to turn the multi-class problem above into a binary classification problem. We create a binary response as follows:</p>
<div class="sourceCode" id="cb1027"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train</span><span class="op">$</span><span class="va">bin_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">train</span><span class="op">[</span>,<span class="va">response</span><span class="op">]</span> <span class="op">==</span> <span class="st">"class_1"</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p>Let’s build a quick model and inspect the model:</p>
<div class="sourceCode" id="cb1028"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dlmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  x<span class="op">=</span><span class="va">predictors</span>,
  y<span class="op">=</span><span class="st">"bin_response"</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
  epochs<span class="op">=</span><span class="fl">0.1</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dlmodel</span><span class="op">)</span></code></pre></div>
<p>Instead of a binary classification model, we find a regression model (H2ORegressionModel) that contains only 1 output neuron (instead of 2). The reason is that the response was a numerical feature (ordinal numbers 0 and 1), and H2O Deep Learning was run with distribution=AUTO, which defaulted to a Gaussian regression problem for a real-valued response. H2O Deep Learning supports regression for distributions other than Gaussian such as Poisson, Gamma, Tweedie, Laplace. It also supports Huber loss and per-row offsets specified via an offset_column. We refer to our H2O Deep Learning regression code examples for more information.</p>
<p>To perform classification, the response must first be turned into a categorical (factor) feature:</p>
<div class="sourceCode" id="cb1029"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">train</span><span class="op">$</span><span class="va">bin_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/as.factor.html">as.factor</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">bin_response</span><span class="op">)</span> <span class="co">##make categorical</span>
<span class="va">dlmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.deeplearning.html">h2o.deeplearning</a></span><span class="op">(</span>
  x<span class="op">=</span><span class="va">predictors</span>,
  y<span class="op">=</span><span class="st">"bin_response"</span>, 
  training_frame<span class="op">=</span><span class="va">train</span>,
  hidden<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>,
  epochs<span class="op">=</span><span class="fl">0.1</span>
  <span class="co">#balance_classes=T    ## enable this for high class imbalance</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dlmodel</span><span class="op">)</span> <span class="co">## Now the model metrics contain AUC for binary classification</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.performance.html">h2o.performance</a></span><span class="op">(</span><span class="va">dlmodel</span><span class="op">)</span><span class="op">)</span> <span class="co">## display ROC curve</span></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/bin_class_as_factor-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Now the model performs (binary) classification, and has multiple (2) output neurons.</p>
</div>
<div id="unsupervised-anomaly-detection" class="section level2">
<h2>
<span class="header-section-number">44.7</span> Unsupervised Anomaly detection<a class="anchor" aria-label="anchor" href="#unsupervised-anomaly-detection"><i class="fas fa-link"></i></a>
</h2>
<p>For instructions on how to build unsupervised models with H2O Deep Learning, we refer to our previous Tutorial on Anomaly Detection with H2O Deep Learning and our MNIST Anomaly detection code example, as well as our Stacked AutoEncoder R code example and another one for Unsupervised Pretraining with an AutoEncoder R code example.</p>
</div>
<div id="h2o-deep-learning-tips-tricks" class="section level2">
<h2>
<span class="header-section-number">44.8</span> H2O Deep Learning Tips &amp; Tricks<a class="anchor" aria-label="anchor" href="#h2o-deep-learning-tips-tricks"><i class="fas fa-link"></i></a>
</h2>
<div id="performance-tuning" class="section level3">
<h3>
<span class="header-section-number">44.8.1</span> Performance Tuning<a class="anchor" aria-label="anchor" href="#performance-tuning"><i class="fas fa-link"></i></a>
</h3>
<p>The Definitive H2O Deep Learning Performance Tuning blog post covers many of the following points that affect the computational efficiency, so it’s highly recommended.</p>
</div>
<div id="activation-functions" class="section level3">
<h3>
<span class="header-section-number">44.8.2</span> Activation Functions<a class="anchor" aria-label="anchor" href="#activation-functions"><i class="fas fa-link"></i></a>
</h3>
<p>While sigmoids have been used historically for neural networks, H2O Deep Learning implements Tanh, a scaled and shifted variant of the sigmoid which is symmetric around 0. Since its output values are bounded by -1..1, the stability of the neural network is rarely endangered. However, the derivative of the tanh function is always non-zero and back-propagation (training) of the weights is more computationally expensive than for rectified linear units, or Rectifier, which is max(0,x) and has vanishing gradient for x&lt;=0, leading to much faster training speed for large networks and is often the fastest path to accuracy on larger problems. In case you encounter instabilities with the Rectifier (in which case model building is automatically aborted), try a limited value to re-scale the weights: max_w2=10. The Maxout activation function is computationally more expensive, but can lead to higher accuracy. It is a generalized version of the Rectifier with two non-zero channels. In practice, the Rectifier (and RectifierWithDropout, see below) is the most versatile and performant option for most problems.</p>
</div>
<div id="generalization-techniques" class="section level3">
<h3>
<span class="header-section-number">44.8.3</span> Generalization Techniques<a class="anchor" aria-label="anchor" href="#generalization-techniques"><i class="fas fa-link"></i></a>
</h3>
<p>L1 and L2 penalties can be applied by specifying the l1 and l2 parameters. Intuition: L1 lets only strong weights survive (constant pulling force towards zero), while L2 prevents any single weight from getting too big. Dropout has recently been introduced as a powerful generalization technique, and is available as a parameter per layer, including the input layer. <code>input_dropout_ratio</code> controls the amount of input layer neurons that are randomly dropped (set to zero), while <code>hidden_dropout_ratios</code> are specified for each hidden layer. The former controls overfitting with respect to the input data (useful for high-dimensional noisy data), while the latter controls overfitting of the learned features. Note that <code>hidden_dropout_ratios</code> require the activation function to end with …WithDropout.</p>
</div>
<div id="early-stopping-and-optimizing-for-lowest-validation-error" class="section level3">
<h3>
<span class="header-section-number">44.8.4</span> Early stopping and optimizing for lowest validation error<a class="anchor" aria-label="anchor" href="#early-stopping-and-optimizing-for-lowest-validation-error"><i class="fas fa-link"></i></a>
</h3>
<p>By default, Deep Learning training stops when the stopping_metric does not improve by at least stopping_tolerance (0.01 means 1% improvement) for stopping_rounds consecutive scoring events on the training (or validation) data. By default, <code>overwrite_with_best_model</code> is enabled and the model returned after training for the specified number of epochs (or after stopping early due to convergence) is the model that has the best training set error (according to the metric specified by stopping_metric), or, if a validation set is provided, the lowest validation set error. Note that the training or validation set errors can be based on a subset of the training or validation data, depending on the values for <code>score_validation_samples</code> or <code>score_training_samples</code>, see below. For early stopping on a predefined error rate on the training data (accuracy for classification or MSE for regression), specify <code>classification_stop</code> or <code>regression_stop.</code></p>
</div>
<div id="training-samples-per-mapreduce-iteration" class="section level3">
<h3>
<span class="header-section-number">44.8.5</span> Training Samples per MapReduce Iteration<a class="anchor" aria-label="anchor" href="#training-samples-per-mapreduce-iteration"><i class="fas fa-link"></i></a>
</h3>
<p>The parameter <code>train_samples_per_iteration</code> matters especially in multi-node operation. It controls the number of rows trained on for each <code>MapReduce</code> iteration. Depending on the value selected, one MapReduce pass can sample observations, and multiple such passes are needed to train for one epoch. All H2O compute nodes then communicate to agree on the best model coefficients (weights/biases) so far, and the model may then be scored (controlled by other parameters below). The default value of -2 indicates auto-tuning, which attemps to keep the communication overhead at 5% of the total runtime. The parameter <code>target_ratio_comm_to_comp</code> controls this ratio. This parameter is explained in more detail in the H2O Deep Learning booklet,</p>
</div>
<div id="categorical-data" class="section level3">
<h3>
<span class="header-section-number">44.8.6</span> Categorical Data<a class="anchor" aria-label="anchor" href="#categorical-data"><i class="fas fa-link"></i></a>
</h3>
<p>For categorical data, a feature with K factor levels is automatically one-hot encoded (horizontalized) into <code>K-1</code> input neurons. Hence, the input neuron layer can grow substantially for datasets with high factor counts. In these cases, it might make sense to reduce the number of hidden neurons in the first hidden layer, such that large numbers of factor levels can be handled. In the limit of 1 neuron in the first hidden layer, the resulting model is similar to logistic regression with stochastic gradient descent, except that for classification problems, there’s still a softmax output layer, and that the activation function is not necessarily a sigmoid (Tanh). If variable importances are computed, it is recommended to turn on <code>use_all_factor_levels</code> (K input neurons for K levels). The experimental option max_categorical_features uses feature hashing to reduce the number of input neurons via the hash trick at the expense of hash collisions and reduced accuracy. Another way to reduce the dimensionality of the (categorical) features is to use <code><a href="https://rdrr.io/pkg/h2o/man/h2o.glrm.html">h2o.glrm()</a></code>, we refer to the GLRM tutorial for more details.</p>
</div>
<div id="sparse-data" class="section level3">
<h3>
<span class="header-section-number">44.8.7</span> Sparse Data<a class="anchor" aria-label="anchor" href="#sparse-data"><i class="fas fa-link"></i></a>
</h3>
<p>If the input data is sparse (many zeros), then it might make sense to enable the sparse option. This will result in the input not being standardized (0 mean, 1 variance), but only de-scaled (1 variance) and 0 values remain 0, leading to more efficient back-propagation. Sparsity is also a reason why CPU implementations can be faster than GPU implementations, because they can take advantage of if/else statements more effectively.</p>
</div>
<div id="missing-values" class="section level3">
<h3>
<span class="header-section-number">44.8.8</span> Missing Values<a class="anchor" aria-label="anchor" href="#missing-values"><i class="fas fa-link"></i></a>
</h3>
<p>H2O Deep Learning automatically does mean imputation for missing values during training (leaving the input layer activation at 0 after standardizing the values). For testing, missing test set values are also treated the same way by default. See the <code>h2o.impute</code> function to do your own mean imputation.</p>
</div>
<div id="loss-functions-distributions-offsets-observation-weights" class="section level3">
<h3>
<span class="header-section-number">44.8.9</span> Loss functions, Distributions, Offsets, Observation Weights<a class="anchor" aria-label="anchor" href="#loss-functions-distributions-offsets-observation-weights"><i class="fas fa-link"></i></a>
</h3>
<p>H2O Deep Learning supports advanced statistical features such as multiple loss functions, non-Gaussian distributions, per-row offsets and observation weights. In addition to Gaussian distributions and Squared loss, H2O Deep Learning supports Poisson, Gamma, Tweedie and Laplace distributions. It also supports Absolute and Huber loss and per-row offsets specified via an <code>offset_column.</code> Observation weights are supported via a user-specified weights_column.</p>
<p>We refer to our H2O Deep Learning R test code examples for more information.</p>
</div>
<div id="exporting-weights-and-biases" class="section level3">
<h3>
<span class="header-section-number">44.8.10</span> Exporting Weights and Biases<a class="anchor" aria-label="anchor" href="#exporting-weights-and-biases"><i class="fas fa-link"></i></a>
</h3>
<p>The model parameters (weights connecting two adjacent layers and per-neuron bias terms) can be stored as H2O Frames (like a dataset) by enabling <code>export_weights_and_biases</code>, and they can be accessed as follows:</p>
<div class="sourceCode" id="cb1030"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1030-1" data-line-number="1">iris_dl &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">5</span>,<span class="kw">as.h2o</span>(iris),</a>
<a class="sourceLine" id="cb1030-2" data-line-number="2">             <span class="dt">export_weights_and_biases=</span>T)</a>
<a class="sourceLine" id="cb1030-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1030-4" data-line-number="4">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1030-5" data-line-number="5"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1030-6" data-line-number="6">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1030-7" data-line-number="7"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1030-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1030-9" data-line-number="9">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1030-10" data-line-number="10"><span class="st">  </span><span class="er">|</span><span class="st">                                                                      </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%</a>
<a class="sourceLine" id="cb1030-11" data-line-number="11">  <span class="op">|</span><span class="st">                                                                            </span></a>
<a class="sourceLine" id="cb1030-12" data-line-number="12"><span class="st">  </span><span class="er">|======================================================================|</span><span class="st"> </span><span class="dv">100</span>%</a>
<a class="sourceLine" id="cb1030-13" data-line-number="13"><span class="kw">h2o.weights</span>(iris_dl, <span class="dt">matrix_id=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1030-14" data-line-number="14"><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width</span></a>
<a class="sourceLine" id="cb1030-15" data-line-number="15"><span class="co">#&gt; 1      -0.0121      0.0959     -0.00246     -0.0531</span></a>
<a class="sourceLine" id="cb1030-16" data-line-number="16"><span class="co">#&gt; 2      -0.0775     -0.0283      0.02226     -0.0396</span></a>
<a class="sourceLine" id="cb1030-17" data-line-number="17"><span class="co">#&gt; 3      -0.0217      0.1061     -0.00390      0.1553</span></a>
<a class="sourceLine" id="cb1030-18" data-line-number="18"><span class="co">#&gt; 4       0.0872      0.1239      0.08696      0.0475</span></a>
<a class="sourceLine" id="cb1030-19" data-line-number="19"><span class="co">#&gt; 5      -0.1207     -0.0628      0.14754      0.0775</span></a>
<a class="sourceLine" id="cb1030-20" data-line-number="20"><span class="co">#&gt; 6       0.0755      0.0612     -0.01426     -0.0901</span></a>
<a class="sourceLine" id="cb1030-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1030-22" data-line-number="22"><span class="co">#&gt; [200 rows x 4 columns]</span></a>
<a class="sourceLine" id="cb1030-23" data-line-number="23"><span class="kw">h2o.weights</span>(iris_dl, <span class="dt">matrix_id=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1030-24" data-line-number="24"><span class="co">#&gt;         C1       C2       C3       C4      C5       C6       C7      C8</span></a>
<a class="sourceLine" id="cb1030-25" data-line-number="25"><span class="co">#&gt; 1  0.09781 -0.06201  0.05942 -0.06693 -0.0405 -0.03773 -0.04421 -0.0445</span></a>
<a class="sourceLine" id="cb1030-26" data-line-number="26"><span class="co">#&gt; 2 -0.09343  0.00631 -0.07245 -0.01743  0.0540  0.12560 -0.04066 -0.0438</span></a>
<a class="sourceLine" id="cb1030-27" data-line-number="27"><span class="co">#&gt; 3  0.09497 -0.06992  0.07802 -0.00765  0.0261  0.05052  0.01860 -0.0131</span></a>
<a class="sourceLine" id="cb1030-28" data-line-number="28"><span class="co">#&gt; 4  0.08538  0.07732  0.00137 -0.08321 -0.1208  0.10262  0.08252  0.0336</span></a>
<a class="sourceLine" id="cb1030-29" data-line-number="29"><span class="co">#&gt; 5 -0.10730  0.07387  0.02719 -0.02809 -0.1043  0.08011  0.10471 -0.1187</span></a>
<a class="sourceLine" id="cb1030-30" data-line-number="30"><span class="co">#&gt; 6 -0.00502  0.00684  0.00216 -0.04546 -0.0200  0.00899  0.00429 -0.0186</span></a>
<a class="sourceLine" id="cb1030-31" data-line-number="31"><span class="co">#&gt;         C9      C10    C11      C12     C13     C14     C15      C16     C17</span></a>
<a class="sourceLine" id="cb1030-32" data-line-number="32"><span class="co">#&gt; 1 -0.03159 -0.00300 0.0951 -0.10219 -0.0251 -0.0875 -0.0716  0.10717  0.0246</span></a>
<a class="sourceLine" id="cb1030-33" data-line-number="33"><span class="co">#&gt; 2 -0.03582 -0.02878 0.0415  0.05277  0.0858 -0.0622 -0.0347  0.07910  0.1095</span></a>
<a class="sourceLine" id="cb1030-34" data-line-number="34"><span class="co">#&gt; 3 -0.08084  0.03058 0.0546  0.00998  0.0717 -0.0338  0.0731  0.07669 -0.0332</span></a>
<a class="sourceLine" id="cb1030-35" data-line-number="35"><span class="co">#&gt; 4 -0.00909  0.10203 0.0289  0.07903  0.0813 -0.0870  0.0536  0.00257 -0.0619</span></a>
<a class="sourceLine" id="cb1030-36" data-line-number="36"><span class="co">#&gt; 5 -0.02522 -0.00881 0.1016  0.09908  0.0938  0.1092 -0.0458 -0.10975  0.0896</span></a>
<a class="sourceLine" id="cb1030-37" data-line-number="37"><span class="co">#&gt; 6 -0.09098 -0.09431 0.1157 -0.07326  0.0569  0.0598  0.0430 -0.07756  0.0185</span></a>
<a class="sourceLine" id="cb1030-38" data-line-number="38"><span class="co">#&gt;        C18      C19      C20     C21     C22      C23     C24     C25      C26</span></a>
<a class="sourceLine" id="cb1030-39" data-line-number="39"><span class="co">#&gt; 1  0.06114 -0.05019 -0.00659 -0.0242  0.0585 -0.05588  0.0877 -0.0787 -0.06874</span></a>
<a class="sourceLine" id="cb1030-40" data-line-number="40"><span class="co">#&gt; 2 -0.06111 -0.01442 -0.05413 -0.1091  0.0900  0.00963 -0.0578  0.1086  0.05375</span></a>
<a class="sourceLine" id="cb1030-41" data-line-number="41"><span class="co">#&gt; 3  0.00766  0.03966  0.04827 -0.1129  0.0697 -0.09623 -0.0542 -0.0295 -0.03485</span></a>
<a class="sourceLine" id="cb1030-42" data-line-number="42"><span class="co">#&gt; 4  0.01004 -0.00334  0.12417 -0.0889 -0.0785  0.11452  0.1017  0.1256  0.03865</span></a>
<a class="sourceLine" id="cb1030-43" data-line-number="43"><span class="co">#&gt; 5 -0.02140  0.09595  0.06294 -0.0768 -0.0025 -0.00938  0.0386 -0.1014 -0.08952</span></a>
<a class="sourceLine" id="cb1030-44" data-line-number="44"><span class="co">#&gt; 6 -0.09092 -0.08096  0.10802 -0.0299 -0.0892  0.08537 -0.0515 -0.0234 -0.00819</span></a>
<a class="sourceLine" id="cb1030-45" data-line-number="45"><span class="co">#&gt;       C27      C28     C29     C30     C31      C32     C33      C34       C35</span></a>
<a class="sourceLine" id="cb1030-46" data-line-number="46"><span class="co">#&gt; 1 -0.0326 -0.11709 -0.0961  0.0540  0.1039 -0.10892 -0.0395  0.08912  0.058430</span></a>
<a class="sourceLine" id="cb1030-47" data-line-number="47"><span class="co">#&gt; 2 -0.0132  0.03993  0.0802  0.0143  0.1129  0.01392 -0.0210  0.04002 -0.000281</span></a>
<a class="sourceLine" id="cb1030-48" data-line-number="48"><span class="co">#&gt; 3 -0.0758 -0.08654  0.0365 -0.0957 -0.1049  0.06900  0.0228 -0.00193  0.035020</span></a>
<a class="sourceLine" id="cb1030-49" data-line-number="49"><span class="co">#&gt; 4 -0.0439 -0.01181 -0.0261  0.1129 -0.0510  0.07112 -0.0710  0.10522 -0.066915</span></a>
<a class="sourceLine" id="cb1030-50" data-line-number="50"><span class="co">#&gt; 5 -0.0555  0.00518 -0.0427  0.1038  0.0865  0.10558 -0.0819 -0.11193 -0.115555</span></a>
<a class="sourceLine" id="cb1030-51" data-line-number="51"><span class="co">#&gt; 6 -0.0498 -0.04183  0.0202  0.0417  0.0364  0.00859  0.0397 -0.05910 -0.025460</span></a>
<a class="sourceLine" id="cb1030-52" data-line-number="52"><span class="co">#&gt;        C36     C37      C38     C39     C40     C41      C42     C43     C44</span></a>
<a class="sourceLine" id="cb1030-53" data-line-number="53"><span class="co">#&gt; 1  0.05709  0.1007 -0.08227  0.0156  0.0487  0.0682 -0.10074  0.0706 -0.1018</span></a>
<a class="sourceLine" id="cb1030-54" data-line-number="54"><span class="co">#&gt; 2  0.02036  0.1126  0.00468  0.1142 -0.0376 -0.0769  0.05995 -0.0439 -0.1197</span></a>
<a class="sourceLine" id="cb1030-55" data-line-number="55"><span class="co">#&gt; 3  0.12090 -0.0141  0.05253  0.0535  0.0678 -0.0860 -0.09221  0.0447 -0.0448</span></a>
<a class="sourceLine" id="cb1030-56" data-line-number="56"><span class="co">#&gt; 4  0.05892  0.0711  0.02525 -0.1179 -0.0629 -0.1116 -0.03958 -0.0120 -0.0331</span></a>
<a class="sourceLine" id="cb1030-57" data-line-number="57"><span class="co">#&gt; 5 -0.09721  0.0923 -0.04987  0.1053 -0.1208 -0.0313  0.05262 -0.0161  0.0652</span></a>
<a class="sourceLine" id="cb1030-58" data-line-number="58"><span class="co">#&gt; 6  0.00309 -0.0151 -0.06517  0.0025 -0.0806 -0.0768 -0.00233 -0.0360 -0.0662</span></a>
<a class="sourceLine" id="cb1030-59" data-line-number="59"><span class="co">#&gt;       C45     C46     C47     C48     C49     C50       C51      C52     C53</span></a>
<a class="sourceLine" id="cb1030-60" data-line-number="60"><span class="co">#&gt; 1 -0.0362  0.0179 -0.0194 -0.0225 -0.0430  0.0759  0.055236  0.11253 -0.0971</span></a>
<a class="sourceLine" id="cb1030-61" data-line-number="61"><span class="co">#&gt; 2 -0.0483 -0.1216  0.0693 -0.0968  0.0153 -0.0218  0.000364  0.00799  0.0524</span></a>
<a class="sourceLine" id="cb1030-62" data-line-number="62"><span class="co">#&gt; 3 -0.0656  0.0960 -0.0481  0.0130 -0.0459  0.1184  0.009815  0.02975  0.0518</span></a>
<a class="sourceLine" id="cb1030-63" data-line-number="63"><span class="co">#&gt; 4  0.0488 -0.1079 -0.0900 -0.0139  0.0248 -0.0279  0.122573  0.00529 -0.1098</span></a>
<a class="sourceLine" id="cb1030-64" data-line-number="64"><span class="co">#&gt; 5  0.0756  0.0473 -0.1077 -0.0314 -0.0308  0.0127 -0.003291  0.09445  0.0936</span></a>
<a class="sourceLine" id="cb1030-65" data-line-number="65"><span class="co">#&gt; 6  0.0485  0.0331 -0.1299 -0.0703 -0.0599  0.1242 -0.063090 -0.06090  0.0935</span></a>
<a class="sourceLine" id="cb1030-66" data-line-number="66"><span class="co">#&gt;        C54     C55     C56     C57      C58     C59     C60     C61     C62</span></a>
<a class="sourceLine" id="cb1030-67" data-line-number="67"><span class="co">#&gt; 1  0.02949 -0.0885 -0.0953 -0.0570  0.02134  0.0173  0.0993 -0.0607  0.0202</span></a>
<a class="sourceLine" id="cb1030-68" data-line-number="68"><span class="co">#&gt; 2 -0.01837 -0.0408 -0.0523 -0.0973  0.11698  0.1113  0.0516 -0.0222  0.0531</span></a>
<a class="sourceLine" id="cb1030-69" data-line-number="69"><span class="co">#&gt; 3 -0.09093 -0.0810  0.0930 -0.0526 -0.06874  0.0715  0.0488 -0.0536  0.1168</span></a>
<a class="sourceLine" id="cb1030-70" data-line-number="70"><span class="co">#&gt; 4 -0.11514  0.0462  0.0120  0.1034  0.00198 -0.0135 -0.0718  0.0332 -0.0450</span></a>
<a class="sourceLine" id="cb1030-71" data-line-number="71"><span class="co">#&gt; 5  0.10390 -0.1217  0.0839  0.0473 -0.11407  0.0644 -0.0374 -0.0074 -0.0176</span></a>
<a class="sourceLine" id="cb1030-72" data-line-number="72"><span class="co">#&gt; 6 -0.00399  0.0146  0.1151  0.0377  0.11397 -0.0232  0.0763  0.0589 -0.0534</span></a>
<a class="sourceLine" id="cb1030-73" data-line-number="73"><span class="co">#&gt;        C63     C64     C65      C66      C67     C68      C69     C70     C71</span></a>
<a class="sourceLine" id="cb1030-74" data-line-number="74"><span class="co">#&gt; 1  0.11120 -0.0574 -0.1284 -0.10925  0.00673 -0.0846 -0.10118 -0.0802 -0.0360</span></a>
<a class="sourceLine" id="cb1030-75" data-line-number="75"><span class="co">#&gt; 2 -0.11334 -0.0208  0.1275 -0.03569 -0.10965  0.0258  0.00676 -0.0874 -0.0154</span></a>
<a class="sourceLine" id="cb1030-76" data-line-number="76"><span class="co">#&gt; 3  0.07925  0.0249 -0.0461 -0.11007  0.09910  0.0520  0.03249  0.0745 -0.0835</span></a>
<a class="sourceLine" id="cb1030-77" data-line-number="77"><span class="co">#&gt; 4  0.11464 -0.0312  0.0496 -0.10607 -0.02827  0.0581 -0.01363  0.1047  0.0303</span></a>
<a class="sourceLine" id="cb1030-78" data-line-number="78"><span class="co">#&gt; 5 -0.00995 -0.0338  0.1128 -0.09390 -0.04503  0.0539 -0.09511 -0.1012  0.1084</span></a>
<a class="sourceLine" id="cb1030-79" data-line-number="79"><span class="co">#&gt; 6 -0.02339 -0.0244  0.0465 -0.00826 -0.09902 -0.0595  0.00641 -0.0622  0.0512</span></a>
<a class="sourceLine" id="cb1030-80" data-line-number="80"><span class="co">#&gt;        C72     C73     C74      C75     C76       C77      C78     C79     C80</span></a>
<a class="sourceLine" id="cb1030-81" data-line-number="81"><span class="co">#&gt; 1 -0.13363 -0.0211  0.0259 -0.00192  0.1049 -0.048446 -0.08756  0.0885  0.0165</span></a>
<a class="sourceLine" id="cb1030-82" data-line-number="82"><span class="co">#&gt; 2 -0.05599 -0.0668  0.0750  0.10355 -0.0936  0.083556 -0.03406 -0.0201  0.0303</span></a>
<a class="sourceLine" id="cb1030-83" data-line-number="83"><span class="co">#&gt; 3 -0.09064  0.0949 -0.0980 -0.12038  0.1166  0.108572  0.01714 -0.0936  0.0447</span></a>
<a class="sourceLine" id="cb1030-84" data-line-number="84"><span class="co">#&gt; 4 -0.04377  0.0338 -0.0539 -0.02126 -0.0229 -0.091181 -0.00556 -0.0738 -0.0715</span></a>
<a class="sourceLine" id="cb1030-85" data-line-number="85"><span class="co">#&gt; 5 -0.00195 -0.0594 -0.0747  0.11553  0.0511  0.011511 -0.11124  0.0332  0.0213</span></a>
<a class="sourceLine" id="cb1030-86" data-line-number="86"><span class="co">#&gt; 6  0.09352  0.1142  0.1040 -0.13166  0.0847 -0.000879  0.07927  0.0684 -0.0454</span></a>
<a class="sourceLine" id="cb1030-87" data-line-number="87"><span class="co">#&gt;       C81     C82     C83      C84      C85      C86     C87      C88     C89</span></a>
<a class="sourceLine" id="cb1030-88" data-line-number="88"><span class="co">#&gt; 1  0.0326 -0.0078  0.0869 -0.00502 -0.02587  0.07701  0.0106  0.08040 -0.0192</span></a>
<a class="sourceLine" id="cb1030-89" data-line-number="89"><span class="co">#&gt; 2  0.1173  0.0182 -0.0956  0.12734  0.08307  0.10440 -0.1156  0.09631  0.0192</span></a>
<a class="sourceLine" id="cb1030-90" data-line-number="90"><span class="co">#&gt; 3 -0.1036  0.0862 -0.0109 -0.10009 -0.02510  0.03452  0.0491  0.00184  0.0671</span></a>
<a class="sourceLine" id="cb1030-91" data-line-number="91"><span class="co">#&gt; 4  0.1001 -0.0736 -0.0909 -0.11013  0.09586  0.00363 -0.0551  0.10031 -0.0485</span></a>
<a class="sourceLine" id="cb1030-92" data-line-number="92"><span class="co">#&gt; 5 -0.1121  0.1228  0.1016  0.06231  0.00133 -0.07595 -0.0515  0.05967  0.0462</span></a>
<a class="sourceLine" id="cb1030-93" data-line-number="93"><span class="co">#&gt; 6  0.1162  0.0659 -0.1095 -0.10556  0.10237  0.10697 -0.0146 -0.04305 -0.0805</span></a>
<a class="sourceLine" id="cb1030-94" data-line-number="94"><span class="co">#&gt;       C90      C91     C92     C93     C94     C95    C96     C97     C98</span></a>
<a class="sourceLine" id="cb1030-95" data-line-number="95"><span class="co">#&gt; 1 -0.0589  0.11023  0.0822 -0.0436 -0.0330 -0.0110 0.0709 -0.0457 -0.0405</span></a>
<a class="sourceLine" id="cb1030-96" data-line-number="96"><span class="co">#&gt; 2 -0.0132  0.01888 -0.0274  0.0693 -0.0145  0.0414 0.0146 -0.0160 -0.0784</span></a>
<a class="sourceLine" id="cb1030-97" data-line-number="97"><span class="co">#&gt; 3  0.1069  0.03973 -0.0151 -0.0910  0.1305 -0.1475 0.0752  0.0949  0.0923</span></a>
<a class="sourceLine" id="cb1030-98" data-line-number="98"><span class="co">#&gt; 4  0.0267  0.02535  0.0658  0.0330  0.0923 -0.1050 0.0208 -0.0826 -0.0607</span></a>
<a class="sourceLine" id="cb1030-99" data-line-number="99"><span class="co">#&gt; 5  0.0191 -0.00118  0.0128  0.0281  0.1179 -0.0372 0.0414 -0.0485  0.0991</span></a>
<a class="sourceLine" id="cb1030-100" data-line-number="100"><span class="co">#&gt; 6  0.0641  0.07836  0.0637  0.0716 -0.0781  0.1023 0.0756  0.0780  0.1120</span></a>
<a class="sourceLine" id="cb1030-101" data-line-number="101"><span class="co">#&gt;       C99     C100    C101      C102    C103    C104    C105     C106    C107</span></a>
<a class="sourceLine" id="cb1030-102" data-line-number="102"><span class="co">#&gt; 1  0.0178  0.00372  0.0403 -0.060378 -0.0538  0.0572 -0.0687 -0.08887  0.1141</span></a>
<a class="sourceLine" id="cb1030-103" data-line-number="103"><span class="co">#&gt; 2  0.0547 -0.05915 -0.0675  0.039563  0.0276 -0.0477  0.0209 -0.05427  0.0858</span></a>
<a class="sourceLine" id="cb1030-104" data-line-number="104"><span class="co">#&gt; 3  0.0144  0.04649 -0.0566 -0.002818 -0.1216 -0.1056 -0.0289  0.03218 -0.0275</span></a>
<a class="sourceLine" id="cb1030-105" data-line-number="105"><span class="co">#&gt; 4 -0.0534  0.06784 -0.0897  0.034436 -0.0512 -0.0110 -0.0609  0.06603  0.0793</span></a>
<a class="sourceLine" id="cb1030-106" data-line-number="106"><span class="co">#&gt; 5  0.1023  0.04934 -0.0950 -0.082225 -0.0693  0.0918  0.1154  0.07736 -0.0937</span></a>
<a class="sourceLine" id="cb1030-107" data-line-number="107"><span class="co">#&gt; 6  0.1139  0.09105  0.0347  0.000489  0.0601  0.0898 -0.1045  0.00397 -0.0477</span></a>
<a class="sourceLine" id="cb1030-108" data-line-number="108"><span class="co">#&gt;      C108    C109     C110    C111    C112    C113    C114     C115    C116</span></a>
<a class="sourceLine" id="cb1030-109" data-line-number="109"><span class="co">#&gt; 1 -0.0661 -0.0819 -0.02407  0.0532 -0.1002  0.1133 -0.0264 -0.01347  0.1091</span></a>
<a class="sourceLine" id="cb1030-110" data-line-number="110"><span class="co">#&gt; 2 -0.0529  0.0559 -0.10082 -0.0257  0.0439 -0.0716 -0.0249  0.03666 -0.1118</span></a>
<a class="sourceLine" id="cb1030-111" data-line-number="111"><span class="co">#&gt; 3  0.0304 -0.0409 -0.10060  0.0776  0.0448  0.0507  0.1176 -0.02704 -0.0455</span></a>
<a class="sourceLine" id="cb1030-112" data-line-number="112"><span class="co">#&gt; 4 -0.0728 -0.0873 -0.00625  0.0679  0.0588  0.0688  0.0428  0.01606  0.0902</span></a>
<a class="sourceLine" id="cb1030-113" data-line-number="113"><span class="co">#&gt; 5  0.1122 -0.0987 -0.01440  0.0689 -0.1162  0.0445  0.0411  0.07530  0.1208</span></a>
<a class="sourceLine" id="cb1030-114" data-line-number="114"><span class="co">#&gt; 6  0.0682 -0.0750  0.11894 -0.1258  0.1012  0.0687  0.0596 -0.00491 -0.0131</span></a>
<a class="sourceLine" id="cb1030-115" data-line-number="115"><span class="co">#&gt;      C117    C118    C119    C120     C121     C122    C123    C124    C125</span></a>
<a class="sourceLine" id="cb1030-116" data-line-number="116"><span class="co">#&gt; 1  0.0598 -0.0745 -0.0662 -0.0315  0.07806 -0.09219 -0.0346 -0.1148 -0.0295</span></a>
<a class="sourceLine" id="cb1030-117" data-line-number="117"><span class="co">#&gt; 2 -0.0724 -0.0693 -0.1182 -0.0830  0.10499  0.00314 -0.0677  0.0844 -0.1150</span></a>
<a class="sourceLine" id="cb1030-118" data-line-number="118"><span class="co">#&gt; 3 -0.0794 -0.0103  0.0403  0.0596 -0.04465 -0.08549  0.0526  0.0918  0.1284</span></a>
<a class="sourceLine" id="cb1030-119" data-line-number="119"><span class="co">#&gt; 4 -0.0898  0.0250 -0.0104  0.0147 -0.07706 -0.04852 -0.1210 -0.0207 -0.1056</span></a>
<a class="sourceLine" id="cb1030-120" data-line-number="120"><span class="co">#&gt; 5 -0.1110 -0.0873 -0.0971 -0.0600 -0.00319  0.06411 -0.0407  0.0815 -0.0234</span></a>
<a class="sourceLine" id="cb1030-121" data-line-number="121"><span class="co">#&gt; 6  0.0154  0.0567 -0.0402 -0.0938  0.05803 -0.02752  0.1044  0.0777 -0.1134</span></a>
<a class="sourceLine" id="cb1030-122" data-line-number="122"><span class="co">#&gt;      C126     C127    C128    C129    C130    C131    C132      C133     C134</span></a>
<a class="sourceLine" id="cb1030-123" data-line-number="123"><span class="co">#&gt; 1  0.0410 -0.00803  0.0398  0.0217  0.0447  0.0381 -0.0616  0.000538  0.08979</span></a>
<a class="sourceLine" id="cb1030-124" data-line-number="124"><span class="co">#&gt; 2 -0.0802 -0.09616 -0.1040  0.0525 -0.0305  0.1008  0.1066  0.083215 -0.08135</span></a>
<a class="sourceLine" id="cb1030-125" data-line-number="125"><span class="co">#&gt; 3  0.0666 -0.00382  0.0847 -0.1361 -0.1099 -0.0242  0.0253 -0.012766  0.00135</span></a>
<a class="sourceLine" id="cb1030-126" data-line-number="126"><span class="co">#&gt; 4 -0.1006  0.09743 -0.0591  0.0992  0.0493 -0.0261  0.0780  0.092394  0.05119</span></a>
<a class="sourceLine" id="cb1030-127" data-line-number="127"><span class="co">#&gt; 5 -0.0985  0.01628  0.0083  0.0831  0.0166  0.1314 -0.1087 -0.037588  0.00157</span></a>
<a class="sourceLine" id="cb1030-128" data-line-number="128"><span class="co">#&gt; 6  0.0521  0.08462 -0.0066 -0.0945 -0.0715 -0.0670 -0.1033 -0.082022 -0.01222</span></a>
<a class="sourceLine" id="cb1030-129" data-line-number="129"><span class="co">#&gt;        C135    C136    C137    C138     C139    C140     C141     C142    C143</span></a>
<a class="sourceLine" id="cb1030-130" data-line-number="130"><span class="co">#&gt; 1 -0.124046  0.0908  0.0155  0.0248 -0.10109 -0.0698  0.09172  0.01846  0.0946</span></a>
<a class="sourceLine" id="cb1030-131" data-line-number="131"><span class="co">#&gt; 2 -0.019879  0.0686 -0.0763 -0.0734 -0.01067 -0.0652 -0.01362 -0.03433 -0.0710</span></a>
<a class="sourceLine" id="cb1030-132" data-line-number="132"><span class="co">#&gt; 3  0.024088  0.0829 -0.0392 -0.0622 -0.12063  0.0346 -0.06455 -0.05257  0.0639</span></a>
<a class="sourceLine" id="cb1030-133" data-line-number="133"><span class="co">#&gt; 4 -0.076358  0.1075  0.0363 -0.1149 -0.04346 -0.0136 -0.00397 -0.10092  0.0683</span></a>
<a class="sourceLine" id="cb1030-134" data-line-number="134"><span class="co">#&gt; 5 -0.089106  0.0461 -0.1100 -0.0970 -0.07456 -0.1162 -0.02448 -0.00928  0.1051</span></a>
<a class="sourceLine" id="cb1030-135" data-line-number="135"><span class="co">#&gt; 6  0.000245 -0.0665  0.0454  0.1103 -0.00866  0.0524 -0.04211 -0.05200  0.0483</span></a>
<a class="sourceLine" id="cb1030-136" data-line-number="136"><span class="co">#&gt;      C144     C145    C146      C147    C148     C149    C150    C151    C152</span></a>
<a class="sourceLine" id="cb1030-137" data-line-number="137"><span class="co">#&gt; 1 -0.0796 -0.01425 -0.0727 -0.028310 -0.1121 -0.00805 -0.1369 -0.0879  0.1052</span></a>
<a class="sourceLine" id="cb1030-138" data-line-number="138"><span class="co">#&gt; 2 -0.1003 -0.06138 -0.0977 -0.000362  0.1019  0.00526  0.0799  0.0314  0.0893</span></a>
<a class="sourceLine" id="cb1030-139" data-line-number="139"><span class="co">#&gt; 3 -0.0678 -0.01967  0.0124  0.033868 -0.1080  0.06632 -0.0990 -0.1203 -0.0708</span></a>
<a class="sourceLine" id="cb1030-140" data-line-number="140"><span class="co">#&gt; 4  0.1066 -0.12188 -0.0294 -0.067370 -0.0304 -0.00849  0.0160  0.0139  0.0713</span></a>
<a class="sourceLine" id="cb1030-141" data-line-number="141"><span class="co">#&gt; 5  0.0120 -0.00354 -0.0680  0.052659 -0.0186 -0.06858  0.0252  0.0182  0.0131</span></a>
<a class="sourceLine" id="cb1030-142" data-line-number="142"><span class="co">#&gt; 6 -0.1099  0.06201 -0.1394 -0.093277 -0.0744 -0.06094 -0.0719  0.0880  0.1100</span></a>
<a class="sourceLine" id="cb1030-143" data-line-number="143"><span class="co">#&gt;      C153    C154    C155    C156     C157    C158    C159     C160    C161</span></a>
<a class="sourceLine" id="cb1030-144" data-line-number="144"><span class="co">#&gt; 1 -0.0526 -0.1168 -0.0607 -0.0552  0.02571 -0.0823 0.06750  0.05499 -0.0140</span></a>
<a class="sourceLine" id="cb1030-145" data-line-number="145"><span class="co">#&gt; 2 -0.0381 -0.0214 -0.0609 -0.0892 -0.05018 -0.0699 0.10227 -0.06483  0.0500</span></a>
<a class="sourceLine" id="cb1030-146" data-line-number="146"><span class="co">#&gt; 3 -0.0539 -0.0138 -0.0165  0.0724 -0.01026 -0.0739 0.10144  0.01399 -0.0421</span></a>
<a class="sourceLine" id="cb1030-147" data-line-number="147"><span class="co">#&gt; 4  0.0134  0.0698 -0.0134  0.0910  0.00774  0.0747 0.00244 -0.01178 -0.0556</span></a>
<a class="sourceLine" id="cb1030-148" data-line-number="148"><span class="co">#&gt; 5 -0.0743 -0.0865  0.0999 -0.0686 -0.09950 -0.0189 0.06879 -0.00773 -0.0843</span></a>
<a class="sourceLine" id="cb1030-149" data-line-number="149"><span class="co">#&gt; 6 -0.0288  0.1181  0.0366  0.0702 -0.03753  0.0478 0.05547 -0.00550 -0.1240</span></a>
<a class="sourceLine" id="cb1030-150" data-line-number="150"><span class="co">#&gt;      C162     C163     C164    C165     C166     C167     C168      C169</span></a>
<a class="sourceLine" id="cb1030-151" data-line-number="151"><span class="co">#&gt; 1 -0.0289 -0.00784 -0.11826 -0.0504  0.00116  0.00238 -0.04161  0.016582</span></a>
<a class="sourceLine" id="cb1030-152" data-line-number="152"><span class="co">#&gt; 2  0.0617  0.00101  0.00237 -0.0450 -0.04024 -0.00635 -0.10608  0.100110</span></a>
<a class="sourceLine" id="cb1030-153" data-line-number="153"><span class="co">#&gt; 3 -0.0743 -0.01313 -0.00721  0.0943 -0.12836  0.05262  0.00918  0.117390</span></a>
<a class="sourceLine" id="cb1030-154" data-line-number="154"><span class="co">#&gt; 4 -0.0123  0.09328  0.00998  0.0976  0.02185 -0.10442  0.05795  0.000439</span></a>
<a class="sourceLine" id="cb1030-155" data-line-number="155"><span class="co">#&gt; 5 -0.1222  0.02158  0.05216  0.0871  0.10632 -0.03831  0.02147  0.069298</span></a>
<a class="sourceLine" id="cb1030-156" data-line-number="156"><span class="co">#&gt; 6  0.0472 -0.08746  0.11417  0.0408 -0.03133 -0.08501  0.10565 -0.030279</span></a>
<a class="sourceLine" id="cb1030-157" data-line-number="157"><span class="co">#&gt;        C170     C171    C172     C173    C174    C175    C176    C177    C178</span></a>
<a class="sourceLine" id="cb1030-158" data-line-number="158"><span class="co">#&gt; 1  0.000488  0.06482 -0.0751  0.10104  0.0157 -0.0343 -0.0766  0.0221  0.0418</span></a>
<a class="sourceLine" id="cb1030-159" data-line-number="159"><span class="co">#&gt; 2  0.081509  0.06270 -0.0618  0.02819  0.0124 -0.0738 -0.0160  0.0410  0.0222</span></a>
<a class="sourceLine" id="cb1030-160" data-line-number="160"><span class="co">#&gt; 3  0.039296 -0.08947 -0.0487  0.00681 -0.0841 -0.0203 -0.0322  0.0172  0.0451</span></a>
<a class="sourceLine" id="cb1030-161" data-line-number="161"><span class="co">#&gt; 4 -0.007223 -0.09042 -0.0472  0.03827  0.0678  0.0565  0.1178 -0.0300  0.0553</span></a>
<a class="sourceLine" id="cb1030-162" data-line-number="162"><span class="co">#&gt; 5  0.018597 -0.00269  0.0306 -0.03748  0.0464 -0.0896 -0.0794 -0.0498  0.0346</span></a>
<a class="sourceLine" id="cb1030-163" data-line-number="163"><span class="co">#&gt; 6  0.115310 -0.09577 -0.1052 -0.07477  0.0838 -0.0265  0.0994 -0.0816 -0.0917</span></a>
<a class="sourceLine" id="cb1030-164" data-line-number="164"><span class="co">#&gt;       C179    C180    C181     C182    C183    C184     C185     C186    C187</span></a>
<a class="sourceLine" id="cb1030-165" data-line-number="165"><span class="co">#&gt; 1  0.05475 -0.0895 -0.0666 -0.06264  0.1170  0.0447 -0.09574  0.00949 -0.1063</span></a>
<a class="sourceLine" id="cb1030-166" data-line-number="166"><span class="co">#&gt; 2  0.06149 -0.0770  0.0794  0.00545 -0.1098  0.1162 -0.09677  0.08620 -0.0159</span></a>
<a class="sourceLine" id="cb1030-167" data-line-number="167"><span class="co">#&gt; 3  0.03257 -0.0105  0.0565 -0.04674 -0.0715  0.0567  0.00377 -0.10301 -0.0290</span></a>
<a class="sourceLine" id="cb1030-168" data-line-number="168"><span class="co">#&gt; 4 -0.07539  0.0727  0.0109 -0.11603  0.0091  0.0784  0.10761  0.02175 -0.0110</span></a>
<a class="sourceLine" id="cb1030-169" data-line-number="169"><span class="co">#&gt; 5  0.07156 -0.0648 -0.1187  0.08141 -0.1242  0.0663 -0.06720 -0.00162 -0.0397</span></a>
<a class="sourceLine" id="cb1030-170" data-line-number="170"><span class="co">#&gt; 6  0.00979  0.0395  0.0255 -0.06883 -0.0925 -0.0136  0.05709  0.01181 -0.1237</span></a>
<a class="sourceLine" id="cb1030-171" data-line-number="171"><span class="co">#&gt;       C188    C189     C190    C191    C192    C193     C194     C195    C196</span></a>
<a class="sourceLine" id="cb1030-172" data-line-number="172"><span class="co">#&gt; 1 -0.11242 -0.0088  0.00826 -0.0589  0.0520 -0.0962  0.00862  0.01765 -0.0110</span></a>
<a class="sourceLine" id="cb1030-173" data-line-number="173"><span class="co">#&gt; 2  0.12246 -0.0676 -0.12001 -0.0318 -0.0734 -0.0378  0.12241 -0.07831 -0.0874</span></a>
<a class="sourceLine" id="cb1030-174" data-line-number="174"><span class="co">#&gt; 3  0.09700 -0.0536 -0.06372 -0.0472  0.1014 -0.0625 -0.08619  0.04682 -0.0629</span></a>
<a class="sourceLine" id="cb1030-175" data-line-number="175"><span class="co">#&gt; 4  0.00391  0.0120  0.04550  0.0641 -0.1188 -0.0743  0.08330 -0.00532  0.0537</span></a>
<a class="sourceLine" id="cb1030-176" data-line-number="176"><span class="co">#&gt; 5  0.06607 -0.0875  0.09217 -0.0337 -0.0173  0.0814 -0.00911 -0.11058 -0.0737</span></a>
<a class="sourceLine" id="cb1030-177" data-line-number="177"><span class="co">#&gt; 6 -0.03989  0.0407  0.10330 -0.0584 -0.0459  0.0908 -0.08028  0.06136  0.1040</span></a>
<a class="sourceLine" id="cb1030-178" data-line-number="178"><span class="co">#&gt;      C197     C198     C199    C200</span></a>
<a class="sourceLine" id="cb1030-179" data-line-number="179"><span class="co">#&gt; 1  0.0499  0.01332 -0.05265  0.0623</span></a>
<a class="sourceLine" id="cb1030-180" data-line-number="180"><span class="co">#&gt; 2 -0.0636  0.00356 -0.04478 -0.0556</span></a>
<a class="sourceLine" id="cb1030-181" data-line-number="181"><span class="co">#&gt; 3 -0.1173 -0.02448 -0.01269  0.0880</span></a>
<a class="sourceLine" id="cb1030-182" data-line-number="182"><span class="co">#&gt; 4  0.0803 -0.04962  0.00303  0.1074</span></a>
<a class="sourceLine" id="cb1030-183" data-line-number="183"><span class="co">#&gt; 5  0.0940 -0.03622  0.12159 -0.1054</span></a>
<a class="sourceLine" id="cb1030-184" data-line-number="184"><span class="co">#&gt; 6 -0.1053  0.10217  0.06158 -0.0473</span></a>
<a class="sourceLine" id="cb1030-185" data-line-number="185"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1030-186" data-line-number="186"><span class="co">#&gt; [200 rows x 200 columns]</span></a>
<a class="sourceLine" id="cb1030-187" data-line-number="187"><span class="kw">h2o.weights</span>(iris_dl, <span class="dt">matrix_id=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1030-188" data-line-number="188"><span class="co">#&gt;        C1    C2     C3      C4      C5      C6      C7     C8     C9      C10</span></a>
<a class="sourceLine" id="cb1030-189" data-line-number="189"><span class="co">#&gt; 1 -0.4911 0.322 -0.450 -0.2154 -0.2402 -0.3599  0.0064 -0.203  0.329 -0.44651</span></a>
<a class="sourceLine" id="cb1030-190" data-line-number="190"><span class="co">#&gt; 2 -0.5077 0.613  0.189  0.4908  0.0567 -0.6699 -0.1962  0.600 -0.188  0.00499</span></a>
<a class="sourceLine" id="cb1030-191" data-line-number="191"><span class="co">#&gt; 3  0.0592 0.220  0.501 -0.0696 -0.2852  0.0267 -0.6827  0.557 -0.419 -0.31044</span></a>
<a class="sourceLine" id="cb1030-192" data-line-number="192"><span class="co">#&gt;      C11    C12    C13    C14     C15    C16    C17    C18    C19     C20</span></a>
<a class="sourceLine" id="cb1030-193" data-line-number="193"><span class="co">#&gt; 1 -0.490 0.0923  0.167 -0.391 -0.0192 -0.440 -0.610  0.556 -0.331  0.1498</span></a>
<a class="sourceLine" id="cb1030-194" data-line-number="194"><span class="co">#&gt; 2  0.327 0.5769 -0.455  0.588  0.6254 -0.129  0.523 -0.235 -0.112 -0.0944</span></a>
<a class="sourceLine" id="cb1030-195" data-line-number="195"><span class="co">#&gt; 3  0.552 0.1912  0.554 -0.169  0.2083  0.216 -0.376  0.229 -0.172  0.5644</span></a>
<a class="sourceLine" id="cb1030-196" data-line-number="196"><span class="co">#&gt;      C21    C22      C23    C24   C25    C26    C27    C28    C29    C30</span></a>
<a class="sourceLine" id="cb1030-197" data-line-number="197"><span class="co">#&gt; 1 0.3146  0.227 0.267997 -0.230 0.667  0.166  0.243 -0.614 -0.078 -0.568</span></a>
<a class="sourceLine" id="cb1030-198" data-line-number="198"><span class="co">#&gt; 2 0.2051  0.483 0.000303 -0.420 0.229  0.435  0.660  0.616  0.414  0.315</span></a>
<a class="sourceLine" id="cb1030-199" data-line-number="199"><span class="co">#&gt; 3 0.0812 -0.159 0.511381 -0.462 0.416 -0.578 -0.409 -0.631 -0.610 -0.358</span></a>
<a class="sourceLine" id="cb1030-200" data-line-number="200"><span class="co">#&gt;       C31   C32    C33     C34      C35     C36     C37    C38     C39     C40</span></a>
<a class="sourceLine" id="cb1030-201" data-line-number="201"><span class="co">#&gt; 1  0.0758 0.429 -0.537 -0.4238  0.38503 -0.1749 -0.0172  0.263 -0.5978 -0.0825</span></a>
<a class="sourceLine" id="cb1030-202" data-line-number="202"><span class="co">#&gt; 2  0.0676 0.668 -0.512 -0.0611 -0.00123  0.0917 -0.4031 -0.294  0.0975  0.5086</span></a>
<a class="sourceLine" id="cb1030-203" data-line-number="203"><span class="co">#&gt; 3 -0.5699 0.633  0.394 -0.5343  0.13648  0.4537 -0.1385  0.378  0.0453  0.0819</span></a>
<a class="sourceLine" id="cb1030-204" data-line-number="204"><span class="co">#&gt;      C41      C42    C43    C44     C45     C46    C47    C48    C49     C50</span></a>
<a class="sourceLine" id="cb1030-205" data-line-number="205"><span class="co">#&gt; 1  0.522 -0.57468  0.322 -0.066  0.0775  0.1552 -0.120 -0.323 -0.541 -0.0977</span></a>
<a class="sourceLine" id="cb1030-206" data-line-number="206"><span class="co">#&gt; 2 -0.374  0.00575 -0.446 -0.103  0.0388 -0.6084 -0.435 -0.379  0.382  0.4350</span></a>
<a class="sourceLine" id="cb1030-207" data-line-number="207"><span class="co">#&gt; 3 -0.449 -0.08967 -0.568  0.485 -0.4561  0.0046 -0.394 -0.395  0.409  0.6194</span></a>
<a class="sourceLine" id="cb1030-208" data-line-number="208"><span class="co">#&gt;      C51   C52    C53    C54    C55    C56     C57    C58    C59     C60   C61</span></a>
<a class="sourceLine" id="cb1030-209" data-line-number="209"><span class="co">#&gt; 1 -0.367 0.275 -0.599 -0.169 -0.103  0.152  0.0415 -0.209  0.373 -0.4638 0.679</span></a>
<a class="sourceLine" id="cb1030-210" data-line-number="210"><span class="co">#&gt; 2 -0.631 0.403  0.199  0.562 -0.668 -0.676 -0.4005  0.180 -0.347  0.0161 0.251</span></a>
<a class="sourceLine" id="cb1030-211" data-line-number="211"><span class="co">#&gt; 3  0.352 0.292  0.500  0.121 -0.142  0.548  0.4876 -0.613 -0.265  0.1988 0.547</span></a>
<a class="sourceLine" id="cb1030-212" data-line-number="212"><span class="co">#&gt;      C62   C63    C64    C65    C66     C67     C68    C69    C70    C71   C72</span></a>
<a class="sourceLine" id="cb1030-213" data-line-number="213"><span class="co">#&gt; 1  0.612 0.663 -0.434  0.678 -0.373 -0.0631 -0.0987  0.557  0.453 -0.222 0.130</span></a>
<a class="sourceLine" id="cb1030-214" data-line-number="214"><span class="co">#&gt; 2 -0.235 0.342  0.198 -0.570  0.431 -0.4893  0.6471 -0.387  0.289  0.338 0.465</span></a>
<a class="sourceLine" id="cb1030-215" data-line-number="215"><span class="co">#&gt; 3  0.667 0.610  0.611 -0.108  0.245 -0.1125 -0.5029 -0.338 -0.240  0.678 0.382</span></a>
<a class="sourceLine" id="cb1030-216" data-line-number="216"><span class="co">#&gt;      C73    C74    C75    C76      C77      C78    C79   C80     C81     C82</span></a>
<a class="sourceLine" id="cb1030-217" data-line-number="217"><span class="co">#&gt; 1 0.3529  0.675  0.202 -0.210  0.00011 -0.66678 -0.586 0.157 -0.5906 -0.0724</span></a>
<a class="sourceLine" id="cb1030-218" data-line-number="218"><span class="co">#&gt; 2 0.0479 -0.402 -0.343  0.304 -0.14364  0.00356  0.410 0.252  0.3587  0.0932</span></a>
<a class="sourceLine" id="cb1030-219" data-line-number="219"><span class="co">#&gt; 3 0.1069  0.669 -0.574  0.434  0.08919  0.59998  0.688 0.246 -0.0134 -0.1733</span></a>
<a class="sourceLine" id="cb1030-220" data-line-number="220"><span class="co">#&gt;      C83    C84    C85    C86     C87    C88    C89    C90     C91    C92</span></a>
<a class="sourceLine" id="cb1030-221" data-line-number="221"><span class="co">#&gt; 1 -0.511 -0.581 -0.402 -0.494 -0.2223 -0.498  0.664  0.529 -0.4264  0.680</span></a>
<a class="sourceLine" id="cb1030-222" data-line-number="222"><span class="co">#&gt; 2  0.389  0.425  0.465  0.251 -0.2815  0.682 -0.175  0.135 -0.5389 -0.130</span></a>
<a class="sourceLine" id="cb1030-223" data-line-number="223"><span class="co">#&gt; 3 -0.561 -0.480 -0.510 -0.309  0.0332 -0.173 -0.549 -0.104  0.0458 -0.362</span></a>
<a class="sourceLine" id="cb1030-224" data-line-number="224"><span class="co">#&gt;       C93      C94   C95    C96    C97     C98     C99   C100  C101   C102</span></a>
<a class="sourceLine" id="cb1030-225" data-line-number="225"><span class="co">#&gt; 1  0.0583  0.00161 0.550  0.123 -0.132  0.6633  0.4693 -0.481 0.633  0.209</span></a>
<a class="sourceLine" id="cb1030-226" data-line-number="226"><span class="co">#&gt; 2 -0.5700  0.21007 0.346 -0.589  0.596  0.0481 -0.6693  0.411 0.146 -0.422</span></a>
<a class="sourceLine" id="cb1030-227" data-line-number="227"><span class="co">#&gt; 3 -0.3148 -0.33106 0.255 -0.605 -0.139 -0.4684  0.0362  0.165 0.393 -0.591</span></a>
<a class="sourceLine" id="cb1030-228" data-line-number="228"><span class="co">#&gt;     C103   C104   C105  C106    C107  C108     C109    C110   C111  C112  C113</span></a>
<a class="sourceLine" id="cb1030-229" data-line-number="229"><span class="co">#&gt; 1  0.384  0.647  0.469 0.119  0.0909 0.116 -0.36315 -0.0837 -0.613 0.356 0.242</span></a>
<a class="sourceLine" id="cb1030-230" data-line-number="230"><span class="co">#&gt; 2 -0.646 -0.246 -0.644 0.475 -0.4186 0.188 -0.15274  0.2386  0.310 0.266 0.373</span></a>
<a class="sourceLine" id="cb1030-231" data-line-number="231"><span class="co">#&gt; 3  0.560  0.602 -0.155 0.199 -0.4567 0.361  0.00432 -0.1044  0.558 0.561 0.536</span></a>
<a class="sourceLine" id="cb1030-232" data-line-number="232"><span class="co">#&gt;       C114    C115     C116    C117   C118   C119  C120   C121   C122   C123</span></a>
<a class="sourceLine" id="cb1030-233" data-line-number="233"><span class="co">#&gt; 1 -0.04066  0.4614  0.00755 -0.6604 -0.476 -0.503 0.517 0.0345 -0.210  0.474</span></a>
<a class="sourceLine" id="cb1030-234" data-line-number="234"><span class="co">#&gt; 2  0.00932 -0.0757 -0.58633 -0.0845 -0.566  0.168 0.315 0.4857  0.600 -0.307</span></a>
<a class="sourceLine" id="cb1030-235" data-line-number="235"><span class="co">#&gt; 3  0.27281 -0.6799  0.56308  0.2669  0.031  0.322 0.373 0.0738  0.179  0.103</span></a>
<a class="sourceLine" id="cb1030-236" data-line-number="236"><span class="co">#&gt;      C124    C125   C126   C127   C128    C129    C130   C131   C132   C133</span></a>
<a class="sourceLine" id="cb1030-237" data-line-number="237"><span class="co">#&gt; 1 -0.0204 -0.3324 -0.424 -0.241 -0.537 -0.2688  0.6393  0.601  0.347 0.4139</span></a>
<a class="sourceLine" id="cb1030-238" data-line-number="238"><span class="co">#&gt; 2  0.3749 -0.3581  0.450 -0.542 -0.284  0.6035 -0.0348 -0.407  0.526 0.0366</span></a>
<a class="sourceLine" id="cb1030-239" data-line-number="239"><span class="co">#&gt; 3 -0.6349  0.0712  0.483 -0.461  0.192 -0.0622 -0.0206 -0.386 -0.218 0.2107</span></a>
<a class="sourceLine" id="cb1030-240" data-line-number="240"><span class="co">#&gt;      C134   C135   C136   C137   C138   C139   C140    C141  C142    C143</span></a>
<a class="sourceLine" id="cb1030-241" data-line-number="241"><span class="co">#&gt; 1  0.0531 -0.090 -0.539 0.0899 -0.292  0.513  0.291  0.5137 0.643  0.0325</span></a>
<a class="sourceLine" id="cb1030-242" data-line-number="242"><span class="co">#&gt; 2  0.2595  0.236  0.676 0.6117 -0.138 -0.512 -0.250 -0.6674 0.482 -0.6275</span></a>
<a class="sourceLine" id="cb1030-243" data-line-number="243"><span class="co">#&gt; 3 -0.1007  0.330 -0.142 0.4216 -0.301 -0.373  0.650  0.0558 0.360  0.3832</span></a>
<a class="sourceLine" id="cb1030-244" data-line-number="244"><span class="co">#&gt;     C144   C145   C146   C147   C148    C149   C150   C151   C152   C153   C154</span></a>
<a class="sourceLine" id="cb1030-245" data-line-number="245"><span class="co">#&gt; 1  0.159  0.536 -0.500 -0.318 -0.596 -0.4009 -0.664 -0.542  0.117  0.374 -0.498</span></a>
<a class="sourceLine" id="cb1030-246" data-line-number="246"><span class="co">#&gt; 2 -0.173  0.590 -0.358 -0.320 -0.612 -0.0905 -0.265  0.556  0.312  0.500 -0.461</span></a>
<a class="sourceLine" id="cb1030-247" data-line-number="247"><span class="co">#&gt; 3 -0.261 -0.543  0.491 -0.223  0.208  0.4160 -0.643  0.328 -0.182 -0.546  0.499</span></a>
<a class="sourceLine" id="cb1030-248" data-line-number="248"><span class="co">#&gt;     C155    C156   C157    C158    C159   C160   C161    C162  C163  C164</span></a>
<a class="sourceLine" id="cb1030-249" data-line-number="249"><span class="co">#&gt; 1  0.558  0.0475 -0.546  0.5032 -0.1460 -0.518  0.616  0.0922 0.470 0.463</span></a>
<a class="sourceLine" id="cb1030-250" data-line-number="250"><span class="co">#&gt; 2 -0.122  0.2647 -0.210 -0.5614  0.0588  0.646  0.439  0.4366 0.597 0.155</span></a>
<a class="sourceLine" id="cb1030-251" data-line-number="251"><span class="co">#&gt; 3  0.237 -0.1104  0.152 -0.0859  0.5055  0.358 -0.159 -0.2986 0.407 0.158</span></a>
<a class="sourceLine" id="cb1030-252" data-line-number="252"><span class="co">#&gt;      C165   C166   C167   C168   C169   C170    C171    C172   C173     C174</span></a>
<a class="sourceLine" id="cb1030-253" data-line-number="253"><span class="co">#&gt; 1  0.4987 0.0135  0.579 -0.540  0.330  0.349 -0.5449  0.0119  0.131 -0.60793</span></a>
<a class="sourceLine" id="cb1030-254" data-line-number="254"><span class="co">#&gt; 2 -0.0114 0.0612  0.439  0.227 -0.490 -0.376  0.4496  0.2026  0.111 -0.06610</span></a>
<a class="sourceLine" id="cb1030-255" data-line-number="255"><span class="co">#&gt; 3  0.2539 0.6555 -0.373 -0.236 -0.245 -0.664 -0.0161 -0.4228 -0.445  0.00453</span></a>
<a class="sourceLine" id="cb1030-256" data-line-number="256"><span class="co">#&gt;     C175    C176  C177   C178   C179  C180   C181    C182   C183   C184   C185</span></a>
<a class="sourceLine" id="cb1030-257" data-line-number="257"><span class="co">#&gt; 1 -0.425 -0.3588 0.355  0.335 0.0707 0.391 -0.373  0.3513 -0.470  0.191  0.573</span></a>
<a class="sourceLine" id="cb1030-258" data-line-number="258"><span class="co">#&gt; 2 -0.154  0.0946 0.472 -0.323 0.6337 0.260  0.164  0.0336 -0.421  0.584  0.397</span></a>
<a class="sourceLine" id="cb1030-259" data-line-number="259"><span class="co">#&gt; 3  0.108  0.3364 0.601  0.557 0.4896 0.625  0.653 -0.3374  0.217 -0.644 -0.423</span></a>
<a class="sourceLine" id="cb1030-260" data-line-number="260"><span class="co">#&gt;     C186   C187      C188    C189   C190   C191   C192   C193   C194   C195</span></a>
<a class="sourceLine" id="cb1030-261" data-line-number="261"><span class="co">#&gt; 1  0.498 -0.340 -0.302494  0.6020  0.397 -0.680  0.646 0.0916 -0.119 -0.486</span></a>
<a class="sourceLine" id="cb1030-262" data-line-number="262"><span class="co">#&gt; 2 -0.300  0.121 -0.000633 -0.0158 -0.363 -0.611 -0.567 0.4150  0.435 -0.069</span></a>
<a class="sourceLine" id="cb1030-263" data-line-number="263"><span class="co">#&gt; 3 -0.255  0.558  0.464244  0.3206  0.509 -0.402 -0.325 0.6049  0.190 -0.375</span></a>
<a class="sourceLine" id="cb1030-264" data-line-number="264"><span class="co">#&gt;     C196    C197   C198   C199   C200</span></a>
<a class="sourceLine" id="cb1030-265" data-line-number="265"><span class="co">#&gt; 1 0.0207 -0.1252 -0.236  0.200  0.666</span></a>
<a class="sourceLine" id="cb1030-266" data-line-number="266"><span class="co">#&gt; 2 0.6217 -0.0986  0.238 -0.557 -0.559</span></a>
<a class="sourceLine" id="cb1030-267" data-line-number="267"><span class="co">#&gt; 3 0.2645 -0.1910 -0.199  0.241 -0.224</span></a>
<a class="sourceLine" id="cb1030-268" data-line-number="268"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1030-269" data-line-number="269"><span class="co">#&gt; [3 rows x 200 columns]</span></a>
<a class="sourceLine" id="cb1030-270" data-line-number="270"><span class="kw">h2o.biases</span>(iris_dl,  <span class="dt">vector_id=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1030-271" data-line-number="271"><span class="co">#&gt;      C1</span></a>
<a class="sourceLine" id="cb1030-272" data-line-number="272"><span class="co">#&gt; 1 0.488</span></a>
<a class="sourceLine" id="cb1030-273" data-line-number="273"><span class="co">#&gt; 2 0.483</span></a>
<a class="sourceLine" id="cb1030-274" data-line-number="274"><span class="co">#&gt; 3 0.480</span></a>
<a class="sourceLine" id="cb1030-275" data-line-number="275"><span class="co">#&gt; 4 0.432</span></a>
<a class="sourceLine" id="cb1030-276" data-line-number="276"><span class="co">#&gt; 5 0.446</span></a>
<a class="sourceLine" id="cb1030-277" data-line-number="277"><span class="co">#&gt; 6 0.481</span></a>
<a class="sourceLine" id="cb1030-278" data-line-number="278"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1030-279" data-line-number="279"><span class="co">#&gt; [200 rows x 1 column]</span></a>
<a class="sourceLine" id="cb1030-280" data-line-number="280"><span class="kw">h2o.biases</span>(iris_dl,  <span class="dt">vector_id=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1030-281" data-line-number="281"><span class="co">#&gt;      C1</span></a>
<a class="sourceLine" id="cb1030-282" data-line-number="282"><span class="co">#&gt; 1 0.995</span></a>
<a class="sourceLine" id="cb1030-283" data-line-number="283"><span class="co">#&gt; 2 1.001</span></a>
<a class="sourceLine" id="cb1030-284" data-line-number="284"><span class="co">#&gt; 3 0.996</span></a>
<a class="sourceLine" id="cb1030-285" data-line-number="285"><span class="co">#&gt; 4 1.000</span></a>
<a class="sourceLine" id="cb1030-286" data-line-number="286"><span class="co">#&gt; 5 1.001</span></a>
<a class="sourceLine" id="cb1030-287" data-line-number="287"><span class="co">#&gt; 6 0.996</span></a>
<a class="sourceLine" id="cb1030-288" data-line-number="288"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1030-289" data-line-number="289"><span class="co">#&gt; [200 rows x 1 column]</span></a>
<a class="sourceLine" id="cb1030-290" data-line-number="290"><span class="kw">h2o.biases</span>(iris_dl,  <span class="dt">vector_id=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1030-291" data-line-number="291"><span class="co">#&gt;          C1</span></a>
<a class="sourceLine" id="cb1030-292" data-line-number="292"><span class="co">#&gt; 1 -0.000531</span></a>
<a class="sourceLine" id="cb1030-293" data-line-number="293"><span class="co">#&gt; 2  0.000643</span></a>
<a class="sourceLine" id="cb1030-294" data-line-number="294"><span class="co">#&gt; 3 -0.001569</span></a>
<a class="sourceLine" id="cb1030-295" data-line-number="295"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1030-296" data-line-number="296"><span class="co">#&gt; [3 rows x 1 column]</span></a>
<a class="sourceLine" id="cb1030-297" data-line-number="297"><span class="co">#plot weights connecting `Sepal.Length` to first hidden neurons</span></a>
<a class="sourceLine" id="cb1030-298" data-line-number="298"><span class="kw">plot</span>(<span class="kw">as.data.frame</span>(<span class="kw">h2o.weights</span>(iris_dl,  <span class="dt">matrix_id=</span><span class="dv">1</span>))[,<span class="dv">1</span>])</a></code></pre></div>
<div class="inline-figure"><img src="604-nn-comparison-deep_learning_tips_files/figure-html/export_weight_biases-1.png" width="70%" style="display: block; margin: auto;"></div>
</div>
<div id="reproducibility" class="section level3">
<h3>
<span class="header-section-number">44.8.11</span> Reproducibility<a class="anchor" aria-label="anchor" href="#reproducibility"><i class="fas fa-link"></i></a>
</h3>
<p>Every run of DeepLearning results in different results since multithreading is done via Hogwild! that benefits from intentional lock-free race conditions between threads. To get reproducible results for small datasets and testing purposes, set <code>reproducible=T</code> and set <code>seed=1337</code> (pick any integer). This will not work for big data for technical reasons, and is probably also not desired because of the significant slowdown (runs on 1 core only).</p>
</div>
<div id="scoring-on-trainingvalidation-sets-during-training" class="section level3">
<h3>
<span class="header-section-number">44.8.12</span> Scoring on Training/Validation Sets During Training<a class="anchor" aria-label="anchor" href="#scoring-on-trainingvalidation-sets-during-training"><i class="fas fa-link"></i></a>
</h3>
<p>The training and/or validation set errors can be based on a subset of the training or validation data, depending on the values for <code>score_validation_samples</code> (defaults to 0: all) or <code>score_training_samples</code> (defaults to 10,000 rows, since the training error is only used for early stopping and monitoring). For large datasets, Deep Learning can automatically sample the validation set to avoid spending too much time in scoring during training, especially since scoring results are not currently displayed in the model returned to R.</p>
<p>Note that the default value of <code>score_duty_cycle=0.1</code> limits the amount of time spent in scoring to 10%, so a large number of scoring samples won’t slow down overall training progress too much, but it will always score once after the first MapReduce iteration, and once at the end of training.</p>
<p>Stratified sampling of the validation dataset can help with scoring on datasets with class imbalance. Note that this option also requires <code>balance_classes</code> to be enabled (used to over/under-sample the training dataset, based on the max. relative size of the resulting training dataset, max_after_balance_size):</p>
<p>More information can be found in the H2O Deep Learning booklet, in our H2O SlideShare Presentations, our H2O YouTube channel, as well as on our H2O Github Repository, especially in our H2O Deep Learning R tests, and H2O Deep Learning Python tests.</p>
</div>
</div>
<div id="all-done-shutdown-h2o" class="section level2">
<h2>
<span class="header-section-number">44.9</span> All done, shutdown H2O<a class="anchor" aria-label="anchor" href="#all-done-shutdown-h2o"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb1031"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.shutdown.html">h2o.shutdown</a></span><span class="op">(</span>prompt<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>

</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">43</span> Tuning Hyperparameters in a Neural Network</a></div>
<div class="next"><a href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#deep-learning-tips-for-classification-and-regression"><span class="header-section-number">44</span> Deep Learning tips for Classification and Regression</a></li>
<li><a class="nav-link" href="#introduction-25"><span class="header-section-number">44.1</span> Introduction</a></li>
<li><a class="nav-link" href="#h2o-r-package"><span class="header-section-number">44.2</span> H2O R Package</a></li>
<li><a class="nav-link" href="#start-h2o"><span class="header-section-number">44.3</span> Start H2O</a></li>
<li><a class="nav-link" href="#lets-have-some-fun-first-decision-boundaries"><span class="header-section-number">44.4</span> Let’s have some fun first: Decision Boundaries</a></li>
<li>
<a class="nav-link" href="#cover-type-dataset"><span class="header-section-number">44.5</span> Cover Type Dataset</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#first-run-of-h2o-deep-learning"><span class="header-section-number">44.5.1</span> First Run of H2O Deep Learning</a></li>
<li><a class="nav-link" href="#variable-importances"><span class="header-section-number">44.5.2</span> Variable Importances</a></li>
<li><a class="nav-link" href="#early-stopping"><span class="header-section-number">44.5.3</span> Early Stopping</a></li>
<li><a class="nav-link" href="#adaptive-learning-rate"><span class="header-section-number">44.5.4</span> Adaptive Learning Rate</a></li>
<li><a class="nav-link" href="#tuning"><span class="header-section-number">44.5.5</span> Tuning</a></li>
<li><a class="nav-link" href="#hyper-parameter-tuning-with-grid-search"><span class="header-section-number">44.5.6</span> Hyper-parameter Tuning with Grid Search</a></li>
<li><a class="nav-link" href="#random-hyper-parameter-search"><span class="header-section-number">44.5.7</span> Random Hyper-Parameter Search</a></li>
<li><a class="nav-link" href="#checkpointing"><span class="header-section-number">44.5.8</span> Checkpointing</a></li>
<li><a class="nav-link" href="#cross-validation"><span class="header-section-number">44.5.9</span> Cross-Validation</a></li>
</ul>
</li>
<li><a class="nav-link" href="#regression-and-binary-classification"><span class="header-section-number">44.6</span> Regression and Binary Classification</a></li>
<li><a class="nav-link" href="#unsupervised-anomaly-detection"><span class="header-section-number">44.7</span> Unsupervised Anomaly detection</a></li>
<li>
<a class="nav-link" href="#h2o-deep-learning-tips-tricks"><span class="header-section-number">44.8</span> H2O Deep Learning Tips &amp; Tricks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#performance-tuning"><span class="header-section-number">44.8.1</span> Performance Tuning</a></li>
<li><a class="nav-link" href="#activation-functions"><span class="header-section-number">44.8.2</span> Activation Functions</a></li>
<li><a class="nav-link" href="#generalization-techniques"><span class="header-section-number">44.8.3</span> Generalization Techniques</a></li>
<li><a class="nav-link" href="#early-stopping-and-optimizing-for-lowest-validation-error"><span class="header-section-number">44.8.4</span> Early stopping and optimizing for lowest validation error</a></li>
<li><a class="nav-link" href="#training-samples-per-mapreduce-iteration"><span class="header-section-number">44.8.5</span> Training Samples per MapReduce Iteration</a></li>
<li><a class="nav-link" href="#categorical-data"><span class="header-section-number">44.8.6</span> Categorical Data</a></li>
<li><a class="nav-link" href="#sparse-data"><span class="header-section-number">44.8.7</span> Sparse Data</a></li>
<li><a class="nav-link" href="#missing-values"><span class="header-section-number">44.8.8</span> Missing Values</a></li>
<li><a class="nav-link" href="#loss-functions-distributions-offsets-observation-weights"><span class="header-section-number">44.8.9</span> Loss functions, Distributions, Offsets, Observation Weights</a></li>
<li><a class="nav-link" href="#exporting-weights-and-biases"><span class="header-section-number">44.8.10</span> Exporting Weights and Biases</a></li>
<li><a class="nav-link" href="#reproducibility"><span class="header-section-number">44.8.11</span> Reproducibility</a></li>
<li><a class="nav-link" href="#scoring-on-trainingvalidation-sets-during-training"><span class="header-section-number">44.8.12</span> Scoring on Training/Validation Sets During Training</a></li>
</ul>
</li>
<li><a class="nav-link" href="#all-done-shutdown-h2o"><span class="header-section-number">44.9</span> All done, shutdown H2O</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hadley/r-pkgs/blob/master/604-nn-comparison-deep_learning_tips.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hadley/r-pkgs/edit/master/604-nn-comparison-deep_learning_tips.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Machine Learning Book</strong>" was written by Alfonso R. Reyes. It was last built on 2020-11-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
