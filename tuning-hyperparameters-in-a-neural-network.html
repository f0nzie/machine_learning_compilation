<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 43 Tuning Hyperparameters in a Neural Network | A Machine Learning Book</title>
<meta name="author" content="Alfonso R. Reyes">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.2.9000/tabs.js"></script><script src="libs/bs3compat-0.2.2.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Machine Learning Book</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prerequisites</a></li>
<li class="book-part">The Basics of Machine Learning</li>
<li><a class="" href="introduction-to-pca.html"><span class="header-section-number">1</span> Introduction to PCA</a></li>
<li><a class="" href="comparison-of-two-pca-packages.html"><span class="header-section-number">2</span> Comparison of two PCA packages</a></li>
<li><a class="" href="detailed-study-of-principal-component-analysis.html"><span class="header-section-number">3</span> Detailed study of Principal Component Analysis</a></li>
<li><a class="" href="detection-of-diabetes-using-logistic-regression.html"><span class="header-section-number">4</span> Detection of diabetes using Logistic Regression</a></li>
<li><a class="" href="sensitivity-analysis-for-a-neural-network.html"><span class="header-section-number">5</span> Sensitivity analysis for a neural network</a></li>
<li><a class="" href="data-visualization-for-ml-models.html"><span class="header-section-number">6</span> Data Visualization for ML models</a></li>
<li class="book-part">Feature Engineering</li>
<li><a class="" href="ten-methods-to-assess-variable-importance.html"><span class="header-section-number">7</span> Ten methods to assess Variable Importance</a></li>
<li><a class="" href="employee-attrition-using-feature-importance.html"><span class="header-section-number">8</span> Employee Attrition using Feature Importance</a></li>
<li><a class="" href="feature-selection-to-enhance-cancer-detection.html"><span class="header-section-number">9</span> Feature Selection to enhance cancer detection</a></li>
<li><a class="" href="dealing-with-unbalanced-data.html"><span class="header-section-number">10</span> Dealing with unbalanced data</a></li>
<li><a class="" href="imputting-missing-values-with-random-forest.html"><span class="header-section-number">11</span> Imputting missing values with Random Forest</a></li>
<li class="book-part">Algorithms Comparison</li>
<li><a class="" href="introduction-to-algorithms-for-classification.html"><span class="header-section-number">12</span> Introduction to algorithms for Classification</a></li>
<li><a class="" href="comparing-classification-algorithms.html"><span class="header-section-number">13</span> Comparing Classification algorithms</a></li>
<li><a class="" href="linear-and-non-linear-algorithms-for-classification.html"><span class="header-section-number">14</span> Linear and Non-Linear Algorithms for Classification</a></li>
<li><a class="" href="predicting-flu-outcome-comparing-eight-classification-algorithms.html"><span class="header-section-number">15</span> Predicting Flu outcome comparing eight classification algorithms</a></li>
<li><a class="" href="classification-on-bad-loans.html"><span class="header-section-number">16</span> Classification on bad loans</a></li>
<li><a class="" href="comparison-of-six-linear-regression-algorithms.html"><span class="header-section-number">17</span> Comparison of six Linear Regression algorithms</a></li>
<li class="book-part">Classification</li>
<li><a class="" href="a-gentle-introduction-to-support-vector-machines.html"><span class="header-section-number">18</span> A gentle introduction to Support Vector Machines</a></li>
<li><a class="" href="broad-view-of-svm.html"><span class="header-section-number">19</span> Broad view of SVM</a></li>
<li><a class="" href="tuning-of-support-vector-machine-prediction.html"><span class="header-section-number">20</span> Tuning of Support Vector Machine prediction</a></li>
<li><a class="" href="who-buys-social-network-ads.html"><span class="header-section-number">21</span> Who buys Social Network ads</a></li>
<li><a class="" href="predicting-ozone-levels.html"><span class="header-section-number">22</span> Predicting Ozone levels</a></li>
<li><a class="" href="building-a-naive-bayes-classifier.html"><span class="header-section-number">23</span> Building a Naive Bayes Classifier</a></li>
<li><a class="" href="detect-mines-vs-rocks-with-random-forest.html"><span class="header-section-number">24</span> Detect mines vs rocks with Random Forest</a></li>
<li><a class="" href="predicting-the-type-of-glass.html"><span class="header-section-number">25</span> Predicting the type of glass</a></li>
<li><a class="" href="naive-bayes-for-sms-spam.html"><span class="header-section-number">26</span> Naive Bayes for SMS spam</a></li>
<li><a class="" href="vehicles-classiification-with-decision-trees.html"><span class="header-section-number">27</span> Vehicles classiification with Decision Trees</a></li>
<li><a class="" href="applying-naive-bayes-on-the-titanic-case.html"><span class="header-section-number">28</span> Applying Naive-Bayes on the Titanic case</a></li>
<li><a class="" href="a-detailed-study-of-bike-sharing-demand.html"><span class="header-section-number">29</span> A detailed study of bike sharing demand</a></li>
<li class="book-part">Linear Regression</li>
<li><a class="" href="linear-regression-with-islr.html"><span class="header-section-number">30</span> Linear Regression with ISLR</a></li>
<li><a class="" href="evaluation-of-three-linear-regression-models.html"><span class="header-section-number">31</span> Evaluation of three linear regression models</a></li>
<li><a class="" href="comparing-regression-models.html"><span class="header-section-number">32</span> Comparing regression models</a></li>
<li><a class="" href="finding-the-factors-of-happiness.html"><span class="header-section-number">33</span> Finding the factors of happiness</a></li>
<li><a class="" href="regression-with-a-neural-network.html"><span class="header-section-number">34</span> Regression with a neural network</a></li>
<li><a class="" href="comparing-multiple-regression-vs-a-neural-network.html"><span class="header-section-number">35</span> Comparing Multiple Regression vs a Neural Network</a></li>
<li><a class="" href="temperature-modeling-using-nested-dataframes.html"><span class="header-section-number">36</span> Temperature modeling using nested dataframes</a></li>
<li class="book-part">Neural Networks</li>
<li><a class="" href="credit-scoring-with-neuralnet.html"><span class="header-section-number">37</span> Credit Scoring with neuralnet</a></li>
<li><a class="" href="wine-classification-with-neuralnet.html"><span class="header-section-number">38</span> Wine classification with neuralnet</a></li>
<li><a class="" href="predicting-the-rating-of-cereals.html"><span class="header-section-number">39</span> Predicting the rating of cereals</a></li>
<li><a class="" href="fitting-a-linear-model-with-neural-networks.html"><span class="header-section-number">40</span> Fitting a linear model with neural networks</a></li>
<li><a class="" href="visualization-of-neural-networks.html"><span class="header-section-number">41</span> Visualization of neural networks</a></li>
<li><a class="" href="build-a-fully-connected-r-neural-network-from-scratch.html"><span class="header-section-number">42</span> Build a fully connected R neural network from scratch</a></li>
<li><a class="active" href="tuning-hyperparameters-in-a-neural-network.html"><span class="header-section-number">43</span> Tuning Hyperparameters in a Neural Network</a></li>
<li><a class="" href="deep-learning-tips-for-classification-and-regression.html"><span class="header-section-number">44</span> Deep Learning tips for Classification and Regression</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="what-is-dot-hat-in-a-regression-output.html"><span class="header-section-number">A</span> What is dot hat in a regression output</a></li>
<li><a class="" href="q-q-normal-to-compare-data-to-distributions.html"><span class="header-section-number">B</span> Q-Q normal to compare data to distributions</a></li>
<li><a class="" href="qq-and-pp-plots.html"><span class="header-section-number">C</span> QQ and PP Plots</a></li>
<li><a class="" href="visualizing-residuals.html"><span class="header-section-number">D</span> Visualizing residuals</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hadley/r-pkgs">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="tuning-hyperparameters-in-a-neural-network" class="section level1">
<h1>
<span class="header-section-number">43</span> Tuning Hyperparameters in a Neural Network<a class="anchor" aria-label="anchor" href="#tuning-hyperparameters-in-a-neural-network"><i class="fas fa-link"></i></a>
</h1>
<ul>
<li>Datasets: <code>yacht_hydrodynamics.data</code>
</li>
<li>Algorithms:
<ul>
<li>Neural Networks</li>
</ul>
</li>
<li>Techniques:
<ul>
<li>Regression Hyperparameters Tuning</li>
</ul>
</li>
</ul>
<div id="introduction-24" class="section level2">
<h2>
<span class="header-section-number">43.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-24"><i class="fas fa-link"></i></a>
</h2>
<p>Regression ANNs predict an output variable as a function of the inputs. The input features (independent variables) can be categorical or numeric types, however, for regression ANNs, we require a numeric dependent variable. If the output variable is a categorical variable (or binary) the ANN will function as a classifier (see next tutorial).</p>
<p>Source: <a href="http://uc-r.github.io/ann_regression" class="uri">http://uc-r.github.io/ann_regression</a></p>
<p>In this tutorial we introduce a neural network used for numeric predictions and cover:</p>
<ul>
<li>Replication requirements: What you’ll need to reproduce the analysis in this tutorial.</li>
<li>Data Preparation: Preparing our data.</li>
<li>1st Regression ANN: Constructing a 1-hidden layer ANN with 1 neuron.</li>
<li>Regression Hyperparameters: Tuning the model.</li>
<li>Wrapping Up: Final comments and some exercises to test your skills.</li>
</ul>
</div>
<div id="replication-requirements" class="section level2">
<h2>
<span class="header-section-number">43.2</span> Replication Requirements<a class="anchor" aria-label="anchor" href="#replication-requirements"><i class="fas fa-link"></i></a>
</h2>
<p>We require the following packages for the analysis.</p>
<div class="sourceCode" id="cb985"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</span>
<span class="co">#&gt; ✔ ggplot2 3.3.0     ✔ purrr   0.3.4</span>
<span class="co">#&gt; ✔ tibble  3.0.1     ✔ dplyr   0.8.5</span>
<span class="co">#&gt; ✔ tidyr   1.0.2     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   1.3.1     ✔ forcats 0.5.0</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bips-hb/neuralnet">neuralnet</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'neuralnet'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     compute</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally">GGally</a></span><span class="op">)</span>
<span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span>
<span class="co">#&gt;   method from   </span>
<span class="co">#&gt;   +.gg   ggplot2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'GGally'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     nasa</span></code></pre></div>
</div>
<div id="data-preparation" class="section level2">
<h2>
<span class="header-section-number">43.3</span> Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"><i class="fas fa-link"></i></a>
</h2>
<p>Our regression ANN will use the <strong>Yacht Hydrodynamics</strong> data set from UCI’s Machine Learning Repository. The yacht data was provided by Dr. Roberto Lopez email. This data set contains data contains results from 308 full-scale experiments performed at the Delft Ship Hydromechanics Laboratory where they test 22 different hull forms. Their experiment tested the effect of variations in the hull geometry and the ship’s Froude number on the craft’s residuary resistance per unit weight of displacement.</p>
<p>To begin we download the data from UCI.</p>
<div class="sourceCode" id="cb986"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">'http://archive.ics.uci.edu/ml/machine-learning-databases/00243/yacht_hydrodynamics.data'</span>

<span class="va">Yacht_Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">url</span>,
                         col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'LongPos_COB'</span>, <span class="st">'Prismatic_Coeff'</span>,
                                       <span class="st">'Len_Disp_Ratio'</span>, <span class="st">'Beam_Draut_Ratio'</span>, 
                                       <span class="st">'Length_Beam_Ratio'</span>,<span class="st">'Froude_Num'</span>, 
                                       <span class="st">'Residuary_Resist'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/na.omit.data.table.html">na.omit</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Parsed with column specification:</span>
<span class="co">#&gt; cols(</span>
<span class="co">#&gt;   LongPos_COB = col_double(),</span>
<span class="co">#&gt;   Prismatic_Coeff = col_double(),</span>
<span class="co">#&gt;   Len_Disp_Ratio = col_double(),</span>
<span class="co">#&gt;   Beam_Draut_Ratio = col_double(),</span>
<span class="co">#&gt;   Length_Beam_Ratio = col_double(),</span>
<span class="co">#&gt;   Froude_Num = col_double(),</span>
<span class="co">#&gt;   Residuary_Resist = col_double()</span>
<span class="co">#&gt; )</span></code></pre></div>
<div class="sourceCode" id="cb987"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">Yacht_Data</span><span class="op">)</span>
<span class="co">#&gt; Rows: 308</span>
<span class="co">#&gt; Columns: 7</span>
<span class="co">#&gt; $ LongPos_COB       &lt;dbl&gt; -2.3, -2.3, -2.3, -2.3, -2.3, -2.3, -2.3, -2.3, -2.…</span>
<span class="co">#&gt; $ Prismatic_Coeff   &lt;dbl&gt; 0.568, 0.568, 0.568, 0.568, 0.568, 0.568, 0.568, 0.…</span>
<span class="co">#&gt; $ Len_Disp_Ratio    &lt;dbl&gt; 4.78, 4.78, 4.78, 4.78, 4.78, 4.78, 4.78, 4.78, 4.7…</span>
<span class="co">#&gt; $ Beam_Draut_Ratio  &lt;dbl&gt; 3.99, 3.99, 3.99, 3.99, 3.99, 3.99, 3.99, 3.99, 3.9…</span>
<span class="co">#&gt; $ Length_Beam_Ratio &lt;dbl&gt; 3.17, 3.17, 3.17, 3.17, 3.17, 3.17, 3.17, 3.17, 3.1…</span>
<span class="co">#&gt; $ Froude_Num        &lt;dbl&gt; 0.125, 0.150, 0.175, 0.200, 0.225, 0.250, 0.275, 0.…</span>
<span class="co">#&gt; $ Residuary_Resist  &lt;dbl&gt; 0.11, 0.27, 0.47, 0.78, 1.18, 1.82, 2.61, 3.76, 4.9…</span></code></pre></div>
<div class="sourceCode" id="cb988"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># save the dataset locally</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">Yacht_Data</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">data_raw_dir</span>, <span class="st">"yach_data.csv"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Prior to any data analysis lets take a look at the data set.</p>
<div class="sourceCode" id="cb989"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">Yacht_Data</span>, title <span class="op">=</span> <span class="st">"Scatterplot Matrix of the Features of the Yacht Data Set"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="603-nn-regression_142-tuning_hyperparameters_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>Here we see an excellent summary of the variation of each feature in our data set. Draw your attention to the bottom-most strip of scatter-plots. This shows the residuary resistance as a function of the other data set features (independent experimental values). The greatest variation appears with the Froude Number feature. It will be interesting to see how this pattern appears in the subsequent regression ANNs.</p>
<p>Prior to regression ANN construction we first must split the Yacht data set into test and training data sets. Before we split, first scale each feature to fall in the
<code>[0,1]</code> interval.</p>
<div class="sourceCode" id="cb990"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Scale the Data</span>
<span class="va">scale01</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">Yacht_Data</span> <span class="op">&lt;-</span> <span class="va">Yacht_Data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">scale01</span><span class="op">)</span>

<span class="co"># Split into test and train sets</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>
<span class="va">Yacht_Data_Train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample.html">sample_frac</a></span><span class="op">(</span>tbl <span class="op">=</span> <span class="va">Yacht_Data</span>, replace <span class="op">=</span> <span class="cn">FALSE</span>, size <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span>
<span class="va">Yacht_Data_Test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join.html">anti_join</a></span><span class="op">(</span><span class="va">Yacht_Data</span>, <span class="va">Yacht_Data_Train</span><span class="op">)</span>
<span class="co">#&gt; Joining, by = c("LongPos_COB", "Prismatic_Coeff", "Len_Disp_Ratio", "Beam_Draut_Ratio", "Length_Beam_Ratio", "Froude_Num", "Residuary_Resist")</span></code></pre></div>
<p>The <code>scale01()</code> function maps each data observation onto the <code>[0,1]</code> interval as called in the dplyr <code><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all()</a></code> function. We then provided a seed for reproducible results and randomly extracted (without replacement) 80% of the observations to build the <code>Yacht_Data_Train</code> data set. Using dplyr’s <code><a href="https://dplyr.tidyverse.org/reference/join.html">anti_join()</a></code> function we extracted all the observations not within the <code>Yacht_Data_Train</code> data set as our test data set in <code>Yacht_Data_Test</code>.</p>
</div>
<div id="st-regression-ann" class="section level2">
<h2>
<span class="header-section-number">43.4</span> 1st Regression ANN<a class="anchor" aria-label="anchor" href="#st-regression-ann"><i class="fas fa-link"></i></a>
</h2>
<p>To begin we construct a 1-hidden layer ANN with 1 neuron, the simplest of all neural networks.</p>
<div class="sourceCode" id="cb991"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12321</span><span class="op">)</span>
<span class="va">Yacht_NN1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html">neuralnet</a></span><span class="op">(</span><span class="va">Residuary_Resist</span> <span class="op">~</span> <span class="va">LongPos_COB</span> <span class="op">+</span> <span class="va">Prismatic_Coeff</span> <span class="op">+</span> 
                         <span class="va">Len_Disp_Ratio</span> <span class="op">+</span> <span class="va">Beam_Draut_Ratio</span> <span class="op">+</span> <span class="va">Length_Beam_Ratio</span> <span class="op">+</span>
                         <span class="va">Froude_Num</span>, data <span class="op">=</span> <span class="va">Yacht_Data_Train</span><span class="op">)</span></code></pre></div>
<p>The <code>Yacht_NN1</code> is a list containing all parameters of the regression ANN as well as the results of the neural network on the test data set. To view a diagram of the <code>Yacht_NN1</code> use the <code><a href="https://rdrr.io/r/graphics/plot.html">plot()</a></code> function.</p>
<div class="sourceCode" id="cb992"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">Yacht_NN1</span>, rep <span class="op">=</span> <span class="st">'best'</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="603-nn-regression_142-tuning_hyperparameters_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>This plot shows the weights learned by the <code>Yacht_NN1</code> neural network, and displays the number of iterations before convergence, as well as the SSE of the training data set. To manually compute the SSE you can use the following:</p>
<div class="sourceCode" id="cb993"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NN1_Train_SSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Yacht_NN1</span><span class="op">$</span><span class="va">net.result</span> <span class="op">-</span> <span class="va">Yacht_Data_Train</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"SSE: "</span>, <span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.round.html">round</a></span><span class="op">(</span><span class="va">NN1_Train_SSE</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "SSE:  0.0365"</span>
<span class="co">## [1] "SSE:  0.0361"</span></code></pre></div>
<p>This SSE is the error associated with the training data set. A superior metric for estimating the generalization capability of the ANN would be the SSE of the test data set. Recall, the test data set contains observations not used to train the <code>Yacht_NN1 ANN</code>. To calculate the test error, we first must run our test observations through the <code>Yacht_NN1</code> ANN. This is accomplished with the neuralnet package <code><a href="https://rdrr.io/pkg/neuralnet/man/compute.html">compute()</a></code> function, which takes as its first input the desired neural network object created by the <code><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html">neuralnet()</a></code> function, and the second argument the test data set feature (independent variable(s)) values.</p>
<div class="sourceCode" id="cb994"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Test_NN1_Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/compute.html">compute</a></span><span class="op">(</span><span class="va">Yacht_NN1</span>, <span class="va">Yacht_Data_Test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">net.result</span>
<span class="va">NN1_Test_SSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Test_NN1_Output</span> <span class="op">-</span> <span class="va">Yacht_Data_Test</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>
<span class="va">NN1_Test_SSE</span>
<span class="co">#&gt; [1] 0.0139</span>
<span class="co">## [1] 0.008417631461</span></code></pre></div>
<p>The <code><a href="https://rdrr.io/pkg/neuralnet/man/compute.html">compute()</a></code> function outputs the response variable, in our case the <code>Residuary_Resist</code>, as estimated by the neural network. Once we have the ANN estimated response we can compute the test SSE. Comparing the test error of 0.0084 to the training error of 0.0361 we see that in our case our test error is smaller than our training error.</p>
</div>
<div id="regression-hyperparameters" class="section level2">
<h2>
<span class="header-section-number">43.5</span> Regression Hyperparameters<a class="anchor" aria-label="anchor" href="#regression-hyperparameters"><i class="fas fa-link"></i></a>
</h2>
<p>We have constructed the most basic of regression ANNs without modifying any of the default hyperparameters associated with the <code><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html">neuralnet()</a></code> function. We should try and improve the network by modifying its basic structure and hyperparameter modification. To begin we will add depth to the hidden layer of the network, then we will change the activation function from the logistic to the tangent hyperbolicus (tanh) to determine if these modifications can improve the test data set SSE. When using the tanh activation function, we first must rescale the data from <span class="math inline">\([0,1]\)</span> to <span class="math inline">\([-1,1]\)</span> using the <code>rescale</code> package. For the purposes of this exercise we will use the same random seed for reproducible results, generally this is not a best practice.</p>
<div class="sourceCode" id="cb995"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 2-Hidden Layers, Layer-1 4-neurons, Layer-2, 1-neuron, logistic activation</span>
<span class="co"># function</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12321</span><span class="op">)</span>
<span class="va">Yacht_NN2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html">neuralnet</a></span><span class="op">(</span><span class="va">Residuary_Resist</span> <span class="op">~</span> <span class="va">LongPos_COB</span> <span class="op">+</span> <span class="va">Prismatic_Coeff</span> <span class="op">+</span> <span class="va">Len_Disp_Ratio</span> <span class="op">+</span> <span class="va">Beam_Draut_Ratio</span> <span class="op">+</span> <span class="va">Length_Beam_Ratio</span> <span class="op">+</span> <span class="va">Froude_Num</span>, 
                       data <span class="op">=</span> <span class="va">Yacht_Data_Train</span>, 
                       hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, 
                       act.fct <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span>

<span class="co">## Training Error</span>
<span class="va">NN2_Train_SSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Yacht_NN2</span><span class="op">$</span><span class="va">net.result</span> <span class="op">-</span> <span class="va">Yacht_Data_Train</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="co">## Test Error</span>
<span class="va">Test_NN2_Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/compute.html">compute</a></span><span class="op">(</span><span class="va">Yacht_NN2</span>, <span class="va">Yacht_Data_Test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">net.result</span>
<span class="va">NN2_Test_SSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Test_NN2_Output</span> <span class="op">-</span> <span class="va">Yacht_Data_Test</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="co"># Rescale for tanh activation function</span>
<span class="va">scale11</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>
<span class="op">}</span>
<span class="va">Yacht_Data_Train</span> <span class="op">&lt;-</span> <span class="va">Yacht_Data_Train</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">scale11</span><span class="op">)</span>
<span class="va">Yacht_Data_Test</span> <span class="op">&lt;-</span> <span class="va">Yacht_Data_Test</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="va">scale11</span><span class="op">)</span>

<span class="co"># 2-Hidden Layers, Layer-1 4-neurons, Layer-2, 1-neuron, tanh activation</span>
<span class="co"># function</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12321</span><span class="op">)</span>
<span class="va">Yacht_NN3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html">neuralnet</a></span><span class="op">(</span><span class="va">Residuary_Resist</span> <span class="op">~</span> <span class="va">LongPos_COB</span> <span class="op">+</span> <span class="va">Prismatic_Coeff</span> <span class="op">+</span> <span class="va">Len_Disp_Ratio</span> <span class="op">+</span> <span class="va">Beam_Draut_Ratio</span> <span class="op">+</span> <span class="va">Length_Beam_Ratio</span> <span class="op">+</span> <span class="va">Froude_Num</span>, 
                       data <span class="op">=</span> <span class="va">Yacht_Data_Train</span>, 
                       hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, 
                       act.fct <span class="op">=</span> <span class="st">"tanh"</span><span class="op">)</span>

<span class="co">## Training Error</span>
<span class="va">NN3_Train_SSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Yacht_NN3</span><span class="op">$</span><span class="va">net.result</span> <span class="op">-</span> <span class="va">Yacht_Data_Train</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="co">## Test Error</span>
<span class="va">Test_NN3_Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/compute.html">compute</a></span><span class="op">(</span><span class="va">Yacht_NN3</span>, <span class="va">Yacht_Data_Test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">net.result</span>
<span class="va">NN3_Test_SSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Test_NN3_Output</span> <span class="op">-</span> <span class="va">Yacht_Data_Test</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="co"># 1-Hidden Layer, 1-neuron, tanh activation function</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12321</span><span class="op">)</span>
<span class="va">Yacht_NN4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html">neuralnet</a></span><span class="op">(</span><span class="va">Residuary_Resist</span> <span class="op">~</span> <span class="va">LongPos_COB</span> <span class="op">+</span> <span class="va">Prismatic_Coeff</span> <span class="op">+</span> <span class="va">Len_Disp_Ratio</span> <span class="op">+</span> <span class="va">Beam_Draut_Ratio</span> <span class="op">+</span> <span class="va">Length_Beam_Ratio</span> <span class="op">+</span> <span class="va">Froude_Num</span>, 
                       data <span class="op">=</span> <span class="va">Yacht_Data_Train</span>, 
                       act.fct <span class="op">=</span> <span class="st">"tanh"</span><span class="op">)</span>

<span class="co">## Training Error</span>
<span class="va">NN4_Train_SSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Yacht_NN4</span><span class="op">$</span><span class="va">net.result</span> <span class="op">-</span> <span class="va">Yacht_Data_Train</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="co">## Test Error</span>
<span class="va">Test_NN4_Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/compute.html">compute</a></span><span class="op">(</span><span class="va">Yacht_NN4</span>, <span class="va">Yacht_Data_Test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">net.result</span>
<span class="va">NN4_Test_SSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Test_NN4_Output</span> <span class="op">-</span> <span class="va">Yacht_Data_Test</span><span class="op">[</span>, <span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></code></pre></div>
<div class="sourceCode" id="cb996"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Bar plot of results</span>
<span class="va">Regression_NN_Errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Network <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NN1"</span>, <span class="st">"NN2"</span>, <span class="st">"NN3"</span>, <span class="st">"NN4"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, 
                               DataSet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Train"</span>, <span class="st">"Test"</span><span class="op">)</span>, time <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, 
                               SSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">NN1_Train_SSE</span>, <span class="va">NN1_Test_SSE</span>, 
                                       <span class="va">NN2_Train_SSE</span>, <span class="va">NN2_Test_SSE</span>, 
                                       <span class="va">NN3_Train_SSE</span>, <span class="va">NN3_Test_SSE</span>, 
                                       <span class="va">NN4_Train_SSE</span>, <span class="va">NN4_Test_SSE</span><span class="op">)</span><span class="op">)</span>

<span class="va">Regression_NN_Errors</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Network</span>, <span class="va">SSE</span>, fill <span class="op">=</span> <span class="va">DataSet</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Regression ANN's SSE"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="603-nn-regression_142-tuning_hyperparameters_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>As evident from the plot, we see that the best regression ANN we found was <code>Yacht_NN2</code> with a training and test SSE of 0.0188 and 0.0057. We make this determination by the value of the training and test SSEs only. <code>Yacht_NN2</code>’s structure is presented here:</p>
<div class="sourceCode" id="cb997"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">Yacht_NN2</span>, rep <span class="op">=</span> <span class="st">"best"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="603-nn-regression_142-tuning_hyperparameters_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb998"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12321</span><span class="op">)</span>
<span class="va">Yacht_NN2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html">neuralnet</a></span><span class="op">(</span><span class="va">Residuary_Resist</span> <span class="op">~</span> <span class="va">LongPos_COB</span> <span class="op">+</span> <span class="va">Prismatic_Coeff</span> <span class="op">+</span> <span class="va">Len_Disp_Ratio</span> <span class="op">+</span> <span class="va">Beam_Draut_Ratio</span> <span class="op">+</span> <span class="va">Length_Beam_Ratio</span> <span class="op">+</span> <span class="va">Froude_Num</span>, 
                       data <span class="op">=</span> <span class="va">Yacht_Data_Train</span>, 
                       hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span>, 
                       act.fct <span class="op">=</span> <span class="st">"logistic"</span>, 
                       rep <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span><span class="op">(</span><span class="va">Yacht_NN2</span>, rep <span class="op">=</span> <span class="st">"best"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="603-nn-regression_142-tuning_hyperparameters_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;"></div>
<p>By setting the same seed, prior to running the 10 repetitions of ANNs, we force the software to reproduce the exact same <code>Yacht_NN2</code> ANN for the first replication. The subsequent 9 generated ANNs, use a different random set of starting weights. Comparing the ‘best’ of the 10 repetitions, to the Yacht_NN2, we observe a decrease in training set error indicating we have a superior set of weights.</p>
</div>
<div id="wrapping-up-2" class="section level2">
<h2>
<span class="header-section-number">43.6</span> Wrapping Up<a class="anchor" aria-label="anchor" href="#wrapping-up-2"><i class="fas fa-link"></i></a>
</h2>
<p>We have briefly covered regression ANNs in this tutorial. In the next tutorial we will cover classification ANNs. The neuralnet package used in this tutorial is one of many tools available for ANN implementation in R. Others include:</p>
<ul>
<li>nnet</li>
<li>autoencoder</li>
<li>caret</li>
<li>RSNNS</li>
<li>h2o</li>
</ul>
<p>Before you move on to the next tutorial, test your new knowledge on the exercises that follow.</p>
<ol style="list-style-type: decimal">
<li><p>Why do we split the yacht data into a training and test data sets?</p></li>
<li><p>Re-load the Yacht Data from the UCI Machine learning repository yacht data without scaling. Run any regression ANN. What happens? Why do you think this happens?</p></li>
<li><p>After completing exercise question 1, re-scale the yacht data. Perform a simple linear regression fitting <code>Residuary_Resist</code> as a function of all other features. Now run a regression neural network (see 1st Regression ANN section). Plot the regression ANN and compare the weights on the features in the ANN to the p-values for the regressors.</p></li>
<li><p>Build your own regression ANN using the scaled yacht data modifying one hyperparameter. Use <code><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html">?neuralnet</a></code> to see the function options. Plot your ANN.</p></li>
</ol>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="build-a-fully-connected-r-neural-network-from-scratch.html"><span class="header-section-number">42</span> Build a fully connected R neural network from scratch</a></div>
<div class="next"><a href="deep-learning-tips-for-classification-and-regression.html"><span class="header-section-number">44</span> Deep Learning tips for Classification and Regression</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#tuning-hyperparameters-in-a-neural-network"><span class="header-section-number">43</span> Tuning Hyperparameters in a Neural Network</a></li>
<li><a class="nav-link" href="#introduction-24"><span class="header-section-number">43.1</span> Introduction</a></li>
<li><a class="nav-link" href="#replication-requirements"><span class="header-section-number">43.2</span> Replication Requirements</a></li>
<li><a class="nav-link" href="#data-preparation"><span class="header-section-number">43.3</span> Data Preparation</a></li>
<li><a class="nav-link" href="#st-regression-ann"><span class="header-section-number">43.4</span> 1st Regression ANN</a></li>
<li><a class="nav-link" href="#regression-hyperparameters"><span class="header-section-number">43.5</span> Regression Hyperparameters</a></li>
<li><a class="nav-link" href="#wrapping-up-2"><span class="header-section-number">43.6</span> Wrapping Up</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hadley/r-pkgs/blob/master/603-nn-regression_142-tuning_hyperparameters.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hadley/r-pkgs/edit/master/603-nn-regression_142-tuning_hyperparameters.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Machine Learning Book</strong>" was written by Alfonso R. Reyes. It was last built on 2020-11-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
